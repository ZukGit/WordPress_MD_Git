#  encoding: utf-8

import tushare as ts
import os
import pandas as pd  # https://www.jianshu.com/p/5c0aa1fa19af
import openpyxl 
from openpyxl import load_workbook,Workbook
import time,datetime  # https://www.jb51.net/article/66019.htm
import re
import os
import tempfile

############################## 全局数据初始化块 数据初始化函数  End ##############################

##############  properities 函数 Begin ##############

class Properties:

    def __init__(self, file_name):
        self.file_name = file_name
        self.properties = {}
        try:
            fopen = open(self.file_name, 'r')
            for line in fopen:
                line = line.strip()
                if line.find('=') > 0 and not line.startswith('#'):
                    strs = line.split('=')
                    self.properties[strs[0].strip()] = strs[1].strip()
        except Exception :
            raise
        else:
            fopen.close()

    def has_key(self, key):
        return key in self.properties

    def get(self, key, default_value=''):
        if key in self.properties:
            return self.properties[key]
        return default_value

    def put(self, key, value):
        self.properties[key] = value
        replace_property(self.file_name, key + '=.*', key + '=' + value, True)


def replace_property(file_name, from_regex, to_str, append_on_not_exists=True):
    tmpfile = tempfile.TemporaryFile()

    if os.path.exists(file_name):
        r_open = open(file_name, 'r')
        pattern = re.compile(r'' + from_regex)
        found = None
        for line in r_open:
            if pattern.search(line) and not line.strip().startswith('#'):
                found = True
                line = re.sub(from_regex, to_str, line)
            tmpfile.write(line.encode())
        if not found and append_on_not_exists:
            tmpfile.write(('\n' + to_str).encode())
        r_open.close()
        tmpfile.seek(0)

        content = tmpfile.read()

        if os.path.exists(file_name):
            os.remove(file_name)

        w_open = open(file_name, 'wb')
        w_open.write(content)
        w_open.close()

        tmpfile.close()
    else:
        print ("file %s not found" % file_name)

##############  properities 函数 End ##############


##############  XLSX excel 函数 Begin ##############

def createexcel(filename):    ### 创建本地文件名称为 filename的文件
    wb = Workbook()
    curPath = os.path.abspath('.')
    cur_desktop_path=os.path.join(os.path.expanduser("~"), 'Desktop')
    curDir = cur_desktop_path+os.sep+"zbin"+os.sep+"J0"+os.sep  ## 创建~/Desktop/zbin/J0 这个 这个工作目录
    #curDir = curPath+os.sep
    if not os.path.exists(curDir):
        os.makedirs(curDir)
    #curPath = os.path.dirname(os.path.abspath('.'))
    #t = time.strftime('%Y%m%d%H%M%S', time.localtime(time.time()))
    #suffix = '.xlsx' # 文件类型
    #newfile = t + suffix
    xlsxPath = curDir + filename
    print("curPath curDir=" + curPath)
    print("createexcel zbin_JO_Dir=" + curDir)
    print("createexcel path=" + xlsxPath)
    if not os.path.exists(xlsxPath):
        wb.save(xlsxPath)
        print(" wb.save(xlsxPath)  xlsxPath =" + xlsxPath)
        time.sleep(1)
    return xlsxPath

def getColumnIndex(table, columnName):   ## 返回 table 中 名称为  columnName 的 那列 的索引
    columnIndex = None
    for i in range(table.ncols):
        if(table.cell_value(0, i) == columnName):
            columnIndex = i
            break
    return columnIndex
#封装函数    https://blog.csdn.net/weixin_41267342/article/details/86634007

##############  XLSX excel 函数 End ##############



############## tscode_股票列表的初始化  Begin ##############
#封装函数    https://blog.csdn.net/weixin_41267342/article/details/86634007
def init_tscode_data(book_name, sheet_name,ts_code_set,tscode_name_dict):
    # 读取excel
    wb = openpyxl.load_workbook(book_name)
    # 读取sheet表
    ws = wb[sheet_name]
    for i in range(ws.max_row):
         # 获取下拉框中的所有选择值
         if (i == 0 or i == 1):
             continue
         #print("i="+str(i)+" 总的列数:" + str(ws.max_row)+"  value:"+str(ws.cell(i,2).value))
         tscode_item = str(ws.cell(i,2).value)
         tscode_name_item = str(ws.cell(i,4).value)
         #print("index="+str(i)+" tscode_item = "+ str(tscode_item) + "   tscode_name_item="+str(tscode_name_item))
         ts_code_set.add(str(ws.cell(i,2).value))
         tscode_name_dict[tscode_item]=tscode_name_item



tscode_set = set()    #### 股票代码的集合   000001.SZ   .... 999999.SH
tscode_name_dict = dict()  #### code-name 的 map的集合
init_tscode_data("股票列表.xlsx","股票列表",tscode_set,tscode_name_dict)
############## tscode_股票列表的初始化  End  ##############


############################## 运行属性 Begin ##############################
pd.set_option('display.max_rows', None)   ##  解决纵向出现...
#pd.set_option('display.width', 1000) 
pd.set_option('expand_frame_repr', False)  ##  解决横向出现...
Cur_Abs_Path=os.path.abspath('.')   # 表示当前所处的文件夹的绝对路径
print("当前绝对路径:"+Cur_Abs_Path)
Cur_Ref_Path=os.path.abspath('..')  # 表示当前所处的文件夹上一级文件夹的绝对路径
print("当前父目录绝对路径:"+Cur_Ref_Path)
############################## 运行属性 End ##############################

############################## 时间Date Begin ##############################

now_yyyymmdd=str(time.strftime('%Y%m%d', time.localtime(time.time())))
print("now_yyyymmdd = "+ str(now_yyyymmdd))

############################## 时间Date End ##############################


############################## Prop初始化 Begin ##############################

#
#Thu Aug 13 22:33:45 CST 2020
#rixianhangqing-time_record_date=20200707
#rixianhangqing-time_start_date=20010101

desktop_path = os.path.join(os.path.expanduser("~"), 'Desktop')
zbin_path = str(desktop_path)+os.sep+"zbin"
j0_properties_path= str(zbin_path)+os.sep+"J0.properties"
print("desktop_path = "+ str(desktop_path))
print("zbin_path = "+ str(zbin_path))
print("j0_properties_path = "+ str(j0_properties_path))
J0_PROPS =  Properties(j0_properties_path)


############################## Prop初始化 End ##############################


pro = ts.pro_api('43acb9a5ddc2cf73c6c4ea54796748f965457ed57daaa736bb778ea2')
# print(J0_PROPS.get(tree_node_name+"record_date"))           #根据key读取value
# J0_PROPS.put(tree_node_name+"record_date", now_yyyymmdd)       ###  覆盖原有的 key 和 value
#  zukgit
# rixianhangqing-time_zukgit_website  =   https://tushare.pro/document/2?doc_id=27      -
tree_node_name="rixianhangqing-time"+"_"
createexcel('daily_201304.xlsx')
daily_201304_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201304.xlsx')
daily_201304_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201304.xlsx', engine='openpyxl')
daily_201304_excel_writer.book = daily_201304_book
daily_201304_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201304_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130401")       ###  更新 记录日期
daily_20130401 = pro.daily(start_date='',end_date='',trade_date='20130401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130401_tscode_list = list() 
for ts_code_sh in daily_20130401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130401_tscode_list.append(stock_name)
daily_20130401_addname_dataframe=pd.DataFrame()
daily_20130401_addname_dataframe['cname'] = daily_20130401_tscode_list
for table_name in daily_20130401.columns.values.tolist():
    daily_20130401_addname_dataframe[table_name] = daily_20130401[table_name]
print("daily_20130401 返回数据 row 行数 = "+str(daily_20130401.shape[0]))
daily_20130401_addname_dataframe.to_excel(daily_201304_excel_writer,'1_1',index=False)
daily_201304_excel_writer.save()
daily_20130402 = pro.daily(start_date='',end_date='',trade_date='20130402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130402_tscode_list = list() 
for ts_code_sh in daily_20130402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130402_tscode_list.append(stock_name)
daily_20130402_addname_dataframe=pd.DataFrame()
daily_20130402_addname_dataframe['cname'] = daily_20130402_tscode_list
for table_name in daily_20130402.columns.values.tolist():
    daily_20130402_addname_dataframe[table_name] = daily_20130402[table_name]
print("daily_20130402 返回数据 row 行数 = "+str(daily_20130402.shape[0]))
daily_20130402_addname_dataframe.to_excel(daily_201304_excel_writer,'2_2',index=False)
daily_201304_excel_writer.save()
daily_20130403 = pro.daily(start_date='',end_date='',trade_date='20130403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130403_tscode_list = list() 
for ts_code_sh in daily_20130403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130403_tscode_list.append(stock_name)
daily_20130403_addname_dataframe=pd.DataFrame()
daily_20130403_addname_dataframe['cname'] = daily_20130403_tscode_list
for table_name in daily_20130403.columns.values.tolist():
    daily_20130403_addname_dataframe[table_name] = daily_20130403[table_name]
print("daily_20130403 返回数据 row 行数 = "+str(daily_20130403.shape[0]))
daily_20130403_addname_dataframe.to_excel(daily_201304_excel_writer,'3_3',index=False)
daily_201304_excel_writer.save()
daily_20130404 = pro.daily(start_date='',end_date='',trade_date='20130404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130404_tscode_list = list() 
for ts_code_sh in daily_20130404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130404_tscode_list.append(stock_name)
daily_20130404_addname_dataframe=pd.DataFrame()
daily_20130404_addname_dataframe['cname'] = daily_20130404_tscode_list
for table_name in daily_20130404.columns.values.tolist():
    daily_20130404_addname_dataframe[table_name] = daily_20130404[table_name]
print("daily_20130404 返回数据 row 行数 = "+str(daily_20130404.shape[0]))
daily_20130404_addname_dataframe.to_excel(daily_201304_excel_writer,'4_4',index=False)
daily_201304_excel_writer.save()
daily_20130405 = pro.daily(start_date='',end_date='',trade_date='20130405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130405_tscode_list = list() 
for ts_code_sh in daily_20130405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130405_tscode_list.append(stock_name)
daily_20130405_addname_dataframe=pd.DataFrame()
daily_20130405_addname_dataframe['cname'] = daily_20130405_tscode_list
for table_name in daily_20130405.columns.values.tolist():
    daily_20130405_addname_dataframe[table_name] = daily_20130405[table_name]
print("daily_20130405 返回数据 row 行数 = "+str(daily_20130405.shape[0]))
daily_20130405_addname_dataframe.to_excel(daily_201304_excel_writer,'5_5',index=False)
daily_201304_excel_writer.save()
daily_20130406 = pro.daily(start_date='',end_date='',trade_date='20130406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130406_tscode_list = list() 
for ts_code_sh in daily_20130406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130406_tscode_list.append(stock_name)
daily_20130406_addname_dataframe=pd.DataFrame()
daily_20130406_addname_dataframe['cname'] = daily_20130406_tscode_list
for table_name in daily_20130406.columns.values.tolist():
    daily_20130406_addname_dataframe[table_name] = daily_20130406[table_name]
print("daily_20130406 返回数据 row 行数 = "+str(daily_20130406.shape[0]))
daily_20130406_addname_dataframe.to_excel(daily_201304_excel_writer,'6_6',index=False)
daily_201304_excel_writer.save()
daily_20130407 = pro.daily(start_date='',end_date='',trade_date='20130407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130407_tscode_list = list() 
for ts_code_sh in daily_20130407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130407_tscode_list.append(stock_name)
daily_20130407_addname_dataframe=pd.DataFrame()
daily_20130407_addname_dataframe['cname'] = daily_20130407_tscode_list
for table_name in daily_20130407.columns.values.tolist():
    daily_20130407_addname_dataframe[table_name] = daily_20130407[table_name]
print("daily_20130407 返回数据 row 行数 = "+str(daily_20130407.shape[0]))
daily_20130407_addname_dataframe.to_excel(daily_201304_excel_writer,'7_7',index=False)
daily_201304_excel_writer.save()
daily_20130408 = pro.daily(start_date='',end_date='',trade_date='20130408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130408_tscode_list = list() 
for ts_code_sh in daily_20130408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130408_tscode_list.append(stock_name)
daily_20130408_addname_dataframe=pd.DataFrame()
daily_20130408_addname_dataframe['cname'] = daily_20130408_tscode_list
for table_name in daily_20130408.columns.values.tolist():
    daily_20130408_addname_dataframe[table_name] = daily_20130408[table_name]
print("daily_20130408 返回数据 row 行数 = "+str(daily_20130408.shape[0]))
daily_20130408_addname_dataframe.to_excel(daily_201304_excel_writer,'8_1',index=False)
daily_201304_excel_writer.save()
daily_20130409 = pro.daily(start_date='',end_date='',trade_date='20130409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130409_tscode_list = list() 
for ts_code_sh in daily_20130409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130409_tscode_list.append(stock_name)
daily_20130409_addname_dataframe=pd.DataFrame()
daily_20130409_addname_dataframe['cname'] = daily_20130409_tscode_list
for table_name in daily_20130409.columns.values.tolist():
    daily_20130409_addname_dataframe[table_name] = daily_20130409[table_name]
print("daily_20130409 返回数据 row 行数 = "+str(daily_20130409.shape[0]))
daily_20130409_addname_dataframe.to_excel(daily_201304_excel_writer,'9_2',index=False)
daily_201304_excel_writer.save()
daily_20130410 = pro.daily(start_date='',end_date='',trade_date='20130410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130410_tscode_list = list() 
for ts_code_sh in daily_20130410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130410_tscode_list.append(stock_name)
daily_20130410_addname_dataframe=pd.DataFrame()
daily_20130410_addname_dataframe['cname'] = daily_20130410_tscode_list
for table_name in daily_20130410.columns.values.tolist():
    daily_20130410_addname_dataframe[table_name] = daily_20130410[table_name]
print("daily_20130410 返回数据 row 行数 = "+str(daily_20130410.shape[0]))
daily_20130410_addname_dataframe.to_excel(daily_201304_excel_writer,'10_3',index=False)
daily_201304_excel_writer.save()
daily_20130411 = pro.daily(start_date='',end_date='',trade_date='20130411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130411_tscode_list = list() 
for ts_code_sh in daily_20130411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130411_tscode_list.append(stock_name)
daily_20130411_addname_dataframe=pd.DataFrame()
daily_20130411_addname_dataframe['cname'] = daily_20130411_tscode_list
for table_name in daily_20130411.columns.values.tolist():
    daily_20130411_addname_dataframe[table_name] = daily_20130411[table_name]
print("daily_20130411 返回数据 row 行数 = "+str(daily_20130411.shape[0]))
daily_20130411_addname_dataframe.to_excel(daily_201304_excel_writer,'11_4',index=False)
daily_201304_excel_writer.save()
daily_20130412 = pro.daily(start_date='',end_date='',trade_date='20130412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130412_tscode_list = list() 
for ts_code_sh in daily_20130412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130412_tscode_list.append(stock_name)
daily_20130412_addname_dataframe=pd.DataFrame()
daily_20130412_addname_dataframe['cname'] = daily_20130412_tscode_list
for table_name in daily_20130412.columns.values.tolist():
    daily_20130412_addname_dataframe[table_name] = daily_20130412[table_name]
print("daily_20130412 返回数据 row 行数 = "+str(daily_20130412.shape[0]))
daily_20130412_addname_dataframe.to_excel(daily_201304_excel_writer,'12_5',index=False)
daily_201304_excel_writer.save()
daily_20130413 = pro.daily(start_date='',end_date='',trade_date='20130413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130413_tscode_list = list() 
for ts_code_sh in daily_20130413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130413_tscode_list.append(stock_name)
daily_20130413_addname_dataframe=pd.DataFrame()
daily_20130413_addname_dataframe['cname'] = daily_20130413_tscode_list
for table_name in daily_20130413.columns.values.tolist():
    daily_20130413_addname_dataframe[table_name] = daily_20130413[table_name]
print("daily_20130413 返回数据 row 行数 = "+str(daily_20130413.shape[0]))
daily_20130413_addname_dataframe.to_excel(daily_201304_excel_writer,'13_6',index=False)
daily_201304_excel_writer.save()
daily_20130414 = pro.daily(start_date='',end_date='',trade_date='20130414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130414_tscode_list = list() 
for ts_code_sh in daily_20130414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130414_tscode_list.append(stock_name)
daily_20130414_addname_dataframe=pd.DataFrame()
daily_20130414_addname_dataframe['cname'] = daily_20130414_tscode_list
for table_name in daily_20130414.columns.values.tolist():
    daily_20130414_addname_dataframe[table_name] = daily_20130414[table_name]
print("daily_20130414 返回数据 row 行数 = "+str(daily_20130414.shape[0]))
daily_20130414_addname_dataframe.to_excel(daily_201304_excel_writer,'14_7',index=False)
daily_201304_excel_writer.save()
daily_20130415 = pro.daily(start_date='',end_date='',trade_date='20130415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130415_tscode_list = list() 
for ts_code_sh in daily_20130415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130415_tscode_list.append(stock_name)
daily_20130415_addname_dataframe=pd.DataFrame()
daily_20130415_addname_dataframe['cname'] = daily_20130415_tscode_list
for table_name in daily_20130415.columns.values.tolist():
    daily_20130415_addname_dataframe[table_name] = daily_20130415[table_name]
print("daily_20130415 返回数据 row 行数 = "+str(daily_20130415.shape[0]))
daily_20130415_addname_dataframe.to_excel(daily_201304_excel_writer,'15_1',index=False)
daily_201304_excel_writer.save()
daily_20130416 = pro.daily(start_date='',end_date='',trade_date='20130416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130416_tscode_list = list() 
for ts_code_sh in daily_20130416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130416_tscode_list.append(stock_name)
daily_20130416_addname_dataframe=pd.DataFrame()
daily_20130416_addname_dataframe['cname'] = daily_20130416_tscode_list
for table_name in daily_20130416.columns.values.tolist():
    daily_20130416_addname_dataframe[table_name] = daily_20130416[table_name]
print("daily_20130416 返回数据 row 行数 = "+str(daily_20130416.shape[0]))
daily_20130416_addname_dataframe.to_excel(daily_201304_excel_writer,'16_2',index=False)
daily_201304_excel_writer.save()
daily_20130417 = pro.daily(start_date='',end_date='',trade_date='20130417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130417_tscode_list = list() 
for ts_code_sh in daily_20130417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130417_tscode_list.append(stock_name)
daily_20130417_addname_dataframe=pd.DataFrame()
daily_20130417_addname_dataframe['cname'] = daily_20130417_tscode_list
for table_name in daily_20130417.columns.values.tolist():
    daily_20130417_addname_dataframe[table_name] = daily_20130417[table_name]
print("daily_20130417 返回数据 row 行数 = "+str(daily_20130417.shape[0]))
daily_20130417_addname_dataframe.to_excel(daily_201304_excel_writer,'17_3',index=False)
daily_201304_excel_writer.save()
daily_20130418 = pro.daily(start_date='',end_date='',trade_date='20130418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130418_tscode_list = list() 
for ts_code_sh in daily_20130418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130418_tscode_list.append(stock_name)
daily_20130418_addname_dataframe=pd.DataFrame()
daily_20130418_addname_dataframe['cname'] = daily_20130418_tscode_list
for table_name in daily_20130418.columns.values.tolist():
    daily_20130418_addname_dataframe[table_name] = daily_20130418[table_name]
print("daily_20130418 返回数据 row 行数 = "+str(daily_20130418.shape[0]))
daily_20130418_addname_dataframe.to_excel(daily_201304_excel_writer,'18_4',index=False)
daily_201304_excel_writer.save()
daily_20130419 = pro.daily(start_date='',end_date='',trade_date='20130419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130419_tscode_list = list() 
for ts_code_sh in daily_20130419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130419_tscode_list.append(stock_name)
daily_20130419_addname_dataframe=pd.DataFrame()
daily_20130419_addname_dataframe['cname'] = daily_20130419_tscode_list
for table_name in daily_20130419.columns.values.tolist():
    daily_20130419_addname_dataframe[table_name] = daily_20130419[table_name]
print("daily_20130419 返回数据 row 行数 = "+str(daily_20130419.shape[0]))
daily_20130419_addname_dataframe.to_excel(daily_201304_excel_writer,'19_5',index=False)
daily_201304_excel_writer.save()
daily_20130420 = pro.daily(start_date='',end_date='',trade_date='20130420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130420_tscode_list = list() 
for ts_code_sh in daily_20130420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130420_tscode_list.append(stock_name)
daily_20130420_addname_dataframe=pd.DataFrame()
daily_20130420_addname_dataframe['cname'] = daily_20130420_tscode_list
for table_name in daily_20130420.columns.values.tolist():
    daily_20130420_addname_dataframe[table_name] = daily_20130420[table_name]
print("daily_20130420 返回数据 row 行数 = "+str(daily_20130420.shape[0]))
daily_20130420_addname_dataframe.to_excel(daily_201304_excel_writer,'20_6',index=False)
daily_201304_excel_writer.save()
daily_20130421 = pro.daily(start_date='',end_date='',trade_date='20130421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130421_tscode_list = list() 
for ts_code_sh in daily_20130421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130421_tscode_list.append(stock_name)
daily_20130421_addname_dataframe=pd.DataFrame()
daily_20130421_addname_dataframe['cname'] = daily_20130421_tscode_list
for table_name in daily_20130421.columns.values.tolist():
    daily_20130421_addname_dataframe[table_name] = daily_20130421[table_name]
print("daily_20130421 返回数据 row 行数 = "+str(daily_20130421.shape[0]))
daily_20130421_addname_dataframe.to_excel(daily_201304_excel_writer,'21_7',index=False)
daily_201304_excel_writer.save()
daily_20130422 = pro.daily(start_date='',end_date='',trade_date='20130422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130422_tscode_list = list() 
for ts_code_sh in daily_20130422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130422_tscode_list.append(stock_name)
daily_20130422_addname_dataframe=pd.DataFrame()
daily_20130422_addname_dataframe['cname'] = daily_20130422_tscode_list
for table_name in daily_20130422.columns.values.tolist():
    daily_20130422_addname_dataframe[table_name] = daily_20130422[table_name]
print("daily_20130422 返回数据 row 行数 = "+str(daily_20130422.shape[0]))
daily_20130422_addname_dataframe.to_excel(daily_201304_excel_writer,'22_1',index=False)
daily_201304_excel_writer.save()
daily_20130423 = pro.daily(start_date='',end_date='',trade_date='20130423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130423_tscode_list = list() 
for ts_code_sh in daily_20130423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130423_tscode_list.append(stock_name)
daily_20130423_addname_dataframe=pd.DataFrame()
daily_20130423_addname_dataframe['cname'] = daily_20130423_tscode_list
for table_name in daily_20130423.columns.values.tolist():
    daily_20130423_addname_dataframe[table_name] = daily_20130423[table_name]
print("daily_20130423 返回数据 row 行数 = "+str(daily_20130423.shape[0]))
daily_20130423_addname_dataframe.to_excel(daily_201304_excel_writer,'23_2',index=False)
daily_201304_excel_writer.save()
daily_20130424 = pro.daily(start_date='',end_date='',trade_date='20130424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130424_tscode_list = list() 
for ts_code_sh in daily_20130424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130424_tscode_list.append(stock_name)
daily_20130424_addname_dataframe=pd.DataFrame()
daily_20130424_addname_dataframe['cname'] = daily_20130424_tscode_list
for table_name in daily_20130424.columns.values.tolist():
    daily_20130424_addname_dataframe[table_name] = daily_20130424[table_name]
print("daily_20130424 返回数据 row 行数 = "+str(daily_20130424.shape[0]))
daily_20130424_addname_dataframe.to_excel(daily_201304_excel_writer,'24_3',index=False)
daily_201304_excel_writer.save()
daily_20130425 = pro.daily(start_date='',end_date='',trade_date='20130425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130425_tscode_list = list() 
for ts_code_sh in daily_20130425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130425_tscode_list.append(stock_name)
daily_20130425_addname_dataframe=pd.DataFrame()
daily_20130425_addname_dataframe['cname'] = daily_20130425_tscode_list
for table_name in daily_20130425.columns.values.tolist():
    daily_20130425_addname_dataframe[table_name] = daily_20130425[table_name]
print("daily_20130425 返回数据 row 行数 = "+str(daily_20130425.shape[0]))
daily_20130425_addname_dataframe.to_excel(daily_201304_excel_writer,'25_4',index=False)
daily_201304_excel_writer.save()
daily_20130426 = pro.daily(start_date='',end_date='',trade_date='20130426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130426_tscode_list = list() 
for ts_code_sh in daily_20130426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130426_tscode_list.append(stock_name)
daily_20130426_addname_dataframe=pd.DataFrame()
daily_20130426_addname_dataframe['cname'] = daily_20130426_tscode_list
for table_name in daily_20130426.columns.values.tolist():
    daily_20130426_addname_dataframe[table_name] = daily_20130426[table_name]
print("daily_20130426 返回数据 row 行数 = "+str(daily_20130426.shape[0]))
daily_20130426_addname_dataframe.to_excel(daily_201304_excel_writer,'26_5',index=False)
daily_201304_excel_writer.save()
daily_20130427 = pro.daily(start_date='',end_date='',trade_date='20130427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130427_tscode_list = list() 
for ts_code_sh in daily_20130427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130427_tscode_list.append(stock_name)
daily_20130427_addname_dataframe=pd.DataFrame()
daily_20130427_addname_dataframe['cname'] = daily_20130427_tscode_list
for table_name in daily_20130427.columns.values.tolist():
    daily_20130427_addname_dataframe[table_name] = daily_20130427[table_name]
print("daily_20130427 返回数据 row 行数 = "+str(daily_20130427.shape[0]))
daily_20130427_addname_dataframe.to_excel(daily_201304_excel_writer,'27_6',index=False)
daily_201304_excel_writer.save()
daily_20130428 = pro.daily(start_date='',end_date='',trade_date='20130428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130428_tscode_list = list() 
for ts_code_sh in daily_20130428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130428_tscode_list.append(stock_name)
daily_20130428_addname_dataframe=pd.DataFrame()
daily_20130428_addname_dataframe['cname'] = daily_20130428_tscode_list
for table_name in daily_20130428.columns.values.tolist():
    daily_20130428_addname_dataframe[table_name] = daily_20130428[table_name]
print("daily_20130428 返回数据 row 行数 = "+str(daily_20130428.shape[0]))
daily_20130428_addname_dataframe.to_excel(daily_201304_excel_writer,'28_7',index=False)
daily_201304_excel_writer.save()
daily_20130429 = pro.daily(start_date='',end_date='',trade_date='20130429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130429_tscode_list = list() 
for ts_code_sh in daily_20130429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130429_tscode_list.append(stock_name)
daily_20130429_addname_dataframe=pd.DataFrame()
daily_20130429_addname_dataframe['cname'] = daily_20130429_tscode_list
for table_name in daily_20130429.columns.values.tolist():
    daily_20130429_addname_dataframe[table_name] = daily_20130429[table_name]
print("daily_20130429 返回数据 row 行数 = "+str(daily_20130429.shape[0]))
daily_20130429_addname_dataframe.to_excel(daily_201304_excel_writer,'29_1',index=False)
daily_201304_excel_writer.save()
daily_20130430 = pro.daily(start_date='',end_date='',trade_date='20130430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130430_tscode_list = list() 
for ts_code_sh in daily_20130430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130430_tscode_list.append(stock_name)
daily_20130430_addname_dataframe=pd.DataFrame()
daily_20130430_addname_dataframe['cname'] = daily_20130430_tscode_list
for table_name in daily_20130430.columns.values.tolist():
    daily_20130430_addname_dataframe[table_name] = daily_20130430[table_name]
print("daily_20130430 返回数据 row 行数 = "+str(daily_20130430.shape[0]))
daily_20130430_addname_dataframe.to_excel(daily_201304_excel_writer,'30_2',index=False)
daily_201304_excel_writer.save()




createexcel('daily_201305.xlsx')
daily_201305_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201305.xlsx')
daily_201305_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201305.xlsx', engine='openpyxl')
daily_201305_excel_writer.book = daily_201305_book
daily_201305_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201305_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130501")       ###  更新 记录日期
daily_20130501 = pro.daily(start_date='',end_date='',trade_date='20130501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130501_tscode_list = list() 
for ts_code_sh in daily_20130501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130501_tscode_list.append(stock_name)
daily_20130501_addname_dataframe=pd.DataFrame()
daily_20130501_addname_dataframe['cname'] = daily_20130501_tscode_list
for table_name in daily_20130501.columns.values.tolist():
    daily_20130501_addname_dataframe[table_name] = daily_20130501[table_name]
print("daily_20130501 返回数据 row 行数 = "+str(daily_20130501.shape[0]))
daily_20130501_addname_dataframe.to_excel(daily_201305_excel_writer,'1_3',index=False)
daily_201305_excel_writer.save()
daily_20130502 = pro.daily(start_date='',end_date='',trade_date='20130502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130502_tscode_list = list() 
for ts_code_sh in daily_20130502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130502_tscode_list.append(stock_name)
daily_20130502_addname_dataframe=pd.DataFrame()
daily_20130502_addname_dataframe['cname'] = daily_20130502_tscode_list
for table_name in daily_20130502.columns.values.tolist():
    daily_20130502_addname_dataframe[table_name] = daily_20130502[table_name]
print("daily_20130502 返回数据 row 行数 = "+str(daily_20130502.shape[0]))
daily_20130502_addname_dataframe.to_excel(daily_201305_excel_writer,'2_4',index=False)
daily_201305_excel_writer.save()
daily_20130503 = pro.daily(start_date='',end_date='',trade_date='20130503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130503_tscode_list = list() 
for ts_code_sh in daily_20130503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130503_tscode_list.append(stock_name)
daily_20130503_addname_dataframe=pd.DataFrame()
daily_20130503_addname_dataframe['cname'] = daily_20130503_tscode_list
for table_name in daily_20130503.columns.values.tolist():
    daily_20130503_addname_dataframe[table_name] = daily_20130503[table_name]
print("daily_20130503 返回数据 row 行数 = "+str(daily_20130503.shape[0]))
daily_20130503_addname_dataframe.to_excel(daily_201305_excel_writer,'3_5',index=False)
daily_201305_excel_writer.save()
daily_20130504 = pro.daily(start_date='',end_date='',trade_date='20130504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130504_tscode_list = list() 
for ts_code_sh in daily_20130504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130504_tscode_list.append(stock_name)
daily_20130504_addname_dataframe=pd.DataFrame()
daily_20130504_addname_dataframe['cname'] = daily_20130504_tscode_list
for table_name in daily_20130504.columns.values.tolist():
    daily_20130504_addname_dataframe[table_name] = daily_20130504[table_name]
print("daily_20130504 返回数据 row 行数 = "+str(daily_20130504.shape[0]))
daily_20130504_addname_dataframe.to_excel(daily_201305_excel_writer,'4_6',index=False)
daily_201305_excel_writer.save()
daily_20130505 = pro.daily(start_date='',end_date='',trade_date='20130505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130505_tscode_list = list() 
for ts_code_sh in daily_20130505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130505_tscode_list.append(stock_name)
daily_20130505_addname_dataframe=pd.DataFrame()
daily_20130505_addname_dataframe['cname'] = daily_20130505_tscode_list
for table_name in daily_20130505.columns.values.tolist():
    daily_20130505_addname_dataframe[table_name] = daily_20130505[table_name]
print("daily_20130505 返回数据 row 行数 = "+str(daily_20130505.shape[0]))
daily_20130505_addname_dataframe.to_excel(daily_201305_excel_writer,'5_7',index=False)
daily_201305_excel_writer.save()
daily_20130506 = pro.daily(start_date='',end_date='',trade_date='20130506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130506_tscode_list = list() 
for ts_code_sh in daily_20130506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130506_tscode_list.append(stock_name)
daily_20130506_addname_dataframe=pd.DataFrame()
daily_20130506_addname_dataframe['cname'] = daily_20130506_tscode_list
for table_name in daily_20130506.columns.values.tolist():
    daily_20130506_addname_dataframe[table_name] = daily_20130506[table_name]
print("daily_20130506 返回数据 row 行数 = "+str(daily_20130506.shape[0]))
daily_20130506_addname_dataframe.to_excel(daily_201305_excel_writer,'6_1',index=False)
daily_201305_excel_writer.save()
daily_20130507 = pro.daily(start_date='',end_date='',trade_date='20130507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130507_tscode_list = list() 
for ts_code_sh in daily_20130507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130507_tscode_list.append(stock_name)
daily_20130507_addname_dataframe=pd.DataFrame()
daily_20130507_addname_dataframe['cname'] = daily_20130507_tscode_list
for table_name in daily_20130507.columns.values.tolist():
    daily_20130507_addname_dataframe[table_name] = daily_20130507[table_name]
print("daily_20130507 返回数据 row 行数 = "+str(daily_20130507.shape[0]))
daily_20130507_addname_dataframe.to_excel(daily_201305_excel_writer,'7_2',index=False)
daily_201305_excel_writer.save()
daily_20130508 = pro.daily(start_date='',end_date='',trade_date='20130508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130508_tscode_list = list() 
for ts_code_sh in daily_20130508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130508_tscode_list.append(stock_name)
daily_20130508_addname_dataframe=pd.DataFrame()
daily_20130508_addname_dataframe['cname'] = daily_20130508_tscode_list
for table_name in daily_20130508.columns.values.tolist():
    daily_20130508_addname_dataframe[table_name] = daily_20130508[table_name]
print("daily_20130508 返回数据 row 行数 = "+str(daily_20130508.shape[0]))
daily_20130508_addname_dataframe.to_excel(daily_201305_excel_writer,'8_3',index=False)
daily_201305_excel_writer.save()
daily_20130509 = pro.daily(start_date='',end_date='',trade_date='20130509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130509_tscode_list = list() 
for ts_code_sh in daily_20130509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130509_tscode_list.append(stock_name)
daily_20130509_addname_dataframe=pd.DataFrame()
daily_20130509_addname_dataframe['cname'] = daily_20130509_tscode_list
for table_name in daily_20130509.columns.values.tolist():
    daily_20130509_addname_dataframe[table_name] = daily_20130509[table_name]
print("daily_20130509 返回数据 row 行数 = "+str(daily_20130509.shape[0]))
daily_20130509_addname_dataframe.to_excel(daily_201305_excel_writer,'9_4',index=False)
daily_201305_excel_writer.save()
daily_20130510 = pro.daily(start_date='',end_date='',trade_date='20130510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130510_tscode_list = list() 
for ts_code_sh in daily_20130510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130510_tscode_list.append(stock_name)
daily_20130510_addname_dataframe=pd.DataFrame()
daily_20130510_addname_dataframe['cname'] = daily_20130510_tscode_list
for table_name in daily_20130510.columns.values.tolist():
    daily_20130510_addname_dataframe[table_name] = daily_20130510[table_name]
print("daily_20130510 返回数据 row 行数 = "+str(daily_20130510.shape[0]))
daily_20130510_addname_dataframe.to_excel(daily_201305_excel_writer,'10_5',index=False)
daily_201305_excel_writer.save()
daily_20130511 = pro.daily(start_date='',end_date='',trade_date='20130511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130511_tscode_list = list() 
for ts_code_sh in daily_20130511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130511_tscode_list.append(stock_name)
daily_20130511_addname_dataframe=pd.DataFrame()
daily_20130511_addname_dataframe['cname'] = daily_20130511_tscode_list
for table_name in daily_20130511.columns.values.tolist():
    daily_20130511_addname_dataframe[table_name] = daily_20130511[table_name]
print("daily_20130511 返回数据 row 行数 = "+str(daily_20130511.shape[0]))
daily_20130511_addname_dataframe.to_excel(daily_201305_excel_writer,'11_6',index=False)
daily_201305_excel_writer.save()
daily_20130512 = pro.daily(start_date='',end_date='',trade_date='20130512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130512_tscode_list = list() 
for ts_code_sh in daily_20130512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130512_tscode_list.append(stock_name)
daily_20130512_addname_dataframe=pd.DataFrame()
daily_20130512_addname_dataframe['cname'] = daily_20130512_tscode_list
for table_name in daily_20130512.columns.values.tolist():
    daily_20130512_addname_dataframe[table_name] = daily_20130512[table_name]
print("daily_20130512 返回数据 row 行数 = "+str(daily_20130512.shape[0]))
daily_20130512_addname_dataframe.to_excel(daily_201305_excel_writer,'12_7',index=False)
daily_201305_excel_writer.save()
daily_20130513 = pro.daily(start_date='',end_date='',trade_date='20130513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130513_tscode_list = list() 
for ts_code_sh in daily_20130513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130513_tscode_list.append(stock_name)
daily_20130513_addname_dataframe=pd.DataFrame()
daily_20130513_addname_dataframe['cname'] = daily_20130513_tscode_list
for table_name in daily_20130513.columns.values.tolist():
    daily_20130513_addname_dataframe[table_name] = daily_20130513[table_name]
print("daily_20130513 返回数据 row 行数 = "+str(daily_20130513.shape[0]))
daily_20130513_addname_dataframe.to_excel(daily_201305_excel_writer,'13_1',index=False)
daily_201305_excel_writer.save()
daily_20130514 = pro.daily(start_date='',end_date='',trade_date='20130514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130514_tscode_list = list() 
for ts_code_sh in daily_20130514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130514_tscode_list.append(stock_name)
daily_20130514_addname_dataframe=pd.DataFrame()
daily_20130514_addname_dataframe['cname'] = daily_20130514_tscode_list
for table_name in daily_20130514.columns.values.tolist():
    daily_20130514_addname_dataframe[table_name] = daily_20130514[table_name]
print("daily_20130514 返回数据 row 行数 = "+str(daily_20130514.shape[0]))
daily_20130514_addname_dataframe.to_excel(daily_201305_excel_writer,'14_2',index=False)
daily_201305_excel_writer.save()
daily_20130515 = pro.daily(start_date='',end_date='',trade_date='20130515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130515_tscode_list = list() 
for ts_code_sh in daily_20130515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130515_tscode_list.append(stock_name)
daily_20130515_addname_dataframe=pd.DataFrame()
daily_20130515_addname_dataframe['cname'] = daily_20130515_tscode_list
for table_name in daily_20130515.columns.values.tolist():
    daily_20130515_addname_dataframe[table_name] = daily_20130515[table_name]
print("daily_20130515 返回数据 row 行数 = "+str(daily_20130515.shape[0]))
daily_20130515_addname_dataframe.to_excel(daily_201305_excel_writer,'15_3',index=False)
daily_201305_excel_writer.save()
daily_20130516 = pro.daily(start_date='',end_date='',trade_date='20130516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130516_tscode_list = list() 
for ts_code_sh in daily_20130516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130516_tscode_list.append(stock_name)
daily_20130516_addname_dataframe=pd.DataFrame()
daily_20130516_addname_dataframe['cname'] = daily_20130516_tscode_list
for table_name in daily_20130516.columns.values.tolist():
    daily_20130516_addname_dataframe[table_name] = daily_20130516[table_name]
print("daily_20130516 返回数据 row 行数 = "+str(daily_20130516.shape[0]))
daily_20130516_addname_dataframe.to_excel(daily_201305_excel_writer,'16_4',index=False)
daily_201305_excel_writer.save()
daily_20130517 = pro.daily(start_date='',end_date='',trade_date='20130517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130517_tscode_list = list() 
for ts_code_sh in daily_20130517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130517_tscode_list.append(stock_name)
daily_20130517_addname_dataframe=pd.DataFrame()
daily_20130517_addname_dataframe['cname'] = daily_20130517_tscode_list
for table_name in daily_20130517.columns.values.tolist():
    daily_20130517_addname_dataframe[table_name] = daily_20130517[table_name]
print("daily_20130517 返回数据 row 行数 = "+str(daily_20130517.shape[0]))
daily_20130517_addname_dataframe.to_excel(daily_201305_excel_writer,'17_5',index=False)
daily_201305_excel_writer.save()
daily_20130518 = pro.daily(start_date='',end_date='',trade_date='20130518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130518_tscode_list = list() 
for ts_code_sh in daily_20130518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130518_tscode_list.append(stock_name)
daily_20130518_addname_dataframe=pd.DataFrame()
daily_20130518_addname_dataframe['cname'] = daily_20130518_tscode_list
for table_name in daily_20130518.columns.values.tolist():
    daily_20130518_addname_dataframe[table_name] = daily_20130518[table_name]
print("daily_20130518 返回数据 row 行数 = "+str(daily_20130518.shape[0]))
daily_20130518_addname_dataframe.to_excel(daily_201305_excel_writer,'18_6',index=False)
daily_201305_excel_writer.save()
daily_20130519 = pro.daily(start_date='',end_date='',trade_date='20130519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130519_tscode_list = list() 
for ts_code_sh in daily_20130519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130519_tscode_list.append(stock_name)
daily_20130519_addname_dataframe=pd.DataFrame()
daily_20130519_addname_dataframe['cname'] = daily_20130519_tscode_list
for table_name in daily_20130519.columns.values.tolist():
    daily_20130519_addname_dataframe[table_name] = daily_20130519[table_name]
print("daily_20130519 返回数据 row 行数 = "+str(daily_20130519.shape[0]))
daily_20130519_addname_dataframe.to_excel(daily_201305_excel_writer,'19_7',index=False)
daily_201305_excel_writer.save()
daily_20130520 = pro.daily(start_date='',end_date='',trade_date='20130520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130520_tscode_list = list() 
for ts_code_sh in daily_20130520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130520_tscode_list.append(stock_name)
daily_20130520_addname_dataframe=pd.DataFrame()
daily_20130520_addname_dataframe['cname'] = daily_20130520_tscode_list
for table_name in daily_20130520.columns.values.tolist():
    daily_20130520_addname_dataframe[table_name] = daily_20130520[table_name]
print("daily_20130520 返回数据 row 行数 = "+str(daily_20130520.shape[0]))
daily_20130520_addname_dataframe.to_excel(daily_201305_excel_writer,'20_1',index=False)
daily_201305_excel_writer.save()
daily_20130521 = pro.daily(start_date='',end_date='',trade_date='20130521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130521_tscode_list = list() 
for ts_code_sh in daily_20130521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130521_tscode_list.append(stock_name)
daily_20130521_addname_dataframe=pd.DataFrame()
daily_20130521_addname_dataframe['cname'] = daily_20130521_tscode_list
for table_name in daily_20130521.columns.values.tolist():
    daily_20130521_addname_dataframe[table_name] = daily_20130521[table_name]
print("daily_20130521 返回数据 row 行数 = "+str(daily_20130521.shape[0]))
daily_20130521_addname_dataframe.to_excel(daily_201305_excel_writer,'21_2',index=False)
daily_201305_excel_writer.save()
daily_20130522 = pro.daily(start_date='',end_date='',trade_date='20130522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130522_tscode_list = list() 
for ts_code_sh in daily_20130522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130522_tscode_list.append(stock_name)
daily_20130522_addname_dataframe=pd.DataFrame()
daily_20130522_addname_dataframe['cname'] = daily_20130522_tscode_list
for table_name in daily_20130522.columns.values.tolist():
    daily_20130522_addname_dataframe[table_name] = daily_20130522[table_name]
print("daily_20130522 返回数据 row 行数 = "+str(daily_20130522.shape[0]))
daily_20130522_addname_dataframe.to_excel(daily_201305_excel_writer,'22_3',index=False)
daily_201305_excel_writer.save()
daily_20130523 = pro.daily(start_date='',end_date='',trade_date='20130523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130523_tscode_list = list() 
for ts_code_sh in daily_20130523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130523_tscode_list.append(stock_name)
daily_20130523_addname_dataframe=pd.DataFrame()
daily_20130523_addname_dataframe['cname'] = daily_20130523_tscode_list
for table_name in daily_20130523.columns.values.tolist():
    daily_20130523_addname_dataframe[table_name] = daily_20130523[table_name]
print("daily_20130523 返回数据 row 行数 = "+str(daily_20130523.shape[0]))
daily_20130523_addname_dataframe.to_excel(daily_201305_excel_writer,'23_4',index=False)
daily_201305_excel_writer.save()
daily_20130524 = pro.daily(start_date='',end_date='',trade_date='20130524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130524_tscode_list = list() 
for ts_code_sh in daily_20130524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130524_tscode_list.append(stock_name)
daily_20130524_addname_dataframe=pd.DataFrame()
daily_20130524_addname_dataframe['cname'] = daily_20130524_tscode_list
for table_name in daily_20130524.columns.values.tolist():
    daily_20130524_addname_dataframe[table_name] = daily_20130524[table_name]
print("daily_20130524 返回数据 row 行数 = "+str(daily_20130524.shape[0]))
daily_20130524_addname_dataframe.to_excel(daily_201305_excel_writer,'24_5',index=False)
daily_201305_excel_writer.save()
daily_20130525 = pro.daily(start_date='',end_date='',trade_date='20130525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130525_tscode_list = list() 
for ts_code_sh in daily_20130525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130525_tscode_list.append(stock_name)
daily_20130525_addname_dataframe=pd.DataFrame()
daily_20130525_addname_dataframe['cname'] = daily_20130525_tscode_list
for table_name in daily_20130525.columns.values.tolist():
    daily_20130525_addname_dataframe[table_name] = daily_20130525[table_name]
print("daily_20130525 返回数据 row 行数 = "+str(daily_20130525.shape[0]))
daily_20130525_addname_dataframe.to_excel(daily_201305_excel_writer,'25_6',index=False)
daily_201305_excel_writer.save()
daily_20130526 = pro.daily(start_date='',end_date='',trade_date='20130526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130526_tscode_list = list() 
for ts_code_sh in daily_20130526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130526_tscode_list.append(stock_name)
daily_20130526_addname_dataframe=pd.DataFrame()
daily_20130526_addname_dataframe['cname'] = daily_20130526_tscode_list
for table_name in daily_20130526.columns.values.tolist():
    daily_20130526_addname_dataframe[table_name] = daily_20130526[table_name]
print("daily_20130526 返回数据 row 行数 = "+str(daily_20130526.shape[0]))
daily_20130526_addname_dataframe.to_excel(daily_201305_excel_writer,'26_7',index=False)
daily_201305_excel_writer.save()
daily_20130527 = pro.daily(start_date='',end_date='',trade_date='20130527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130527_tscode_list = list() 
for ts_code_sh in daily_20130527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130527_tscode_list.append(stock_name)
daily_20130527_addname_dataframe=pd.DataFrame()
daily_20130527_addname_dataframe['cname'] = daily_20130527_tscode_list
for table_name in daily_20130527.columns.values.tolist():
    daily_20130527_addname_dataframe[table_name] = daily_20130527[table_name]
print("daily_20130527 返回数据 row 行数 = "+str(daily_20130527.shape[0]))
daily_20130527_addname_dataframe.to_excel(daily_201305_excel_writer,'27_1',index=False)
daily_201305_excel_writer.save()
daily_20130528 = pro.daily(start_date='',end_date='',trade_date='20130528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130528_tscode_list = list() 
for ts_code_sh in daily_20130528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130528_tscode_list.append(stock_name)
daily_20130528_addname_dataframe=pd.DataFrame()
daily_20130528_addname_dataframe['cname'] = daily_20130528_tscode_list
for table_name in daily_20130528.columns.values.tolist():
    daily_20130528_addname_dataframe[table_name] = daily_20130528[table_name]
print("daily_20130528 返回数据 row 行数 = "+str(daily_20130528.shape[0]))
daily_20130528_addname_dataframe.to_excel(daily_201305_excel_writer,'28_2',index=False)
daily_201305_excel_writer.save()
daily_20130529 = pro.daily(start_date='',end_date='',trade_date='20130529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130529_tscode_list = list() 
for ts_code_sh in daily_20130529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130529_tscode_list.append(stock_name)
daily_20130529_addname_dataframe=pd.DataFrame()
daily_20130529_addname_dataframe['cname'] = daily_20130529_tscode_list
for table_name in daily_20130529.columns.values.tolist():
    daily_20130529_addname_dataframe[table_name] = daily_20130529[table_name]
print("daily_20130529 返回数据 row 行数 = "+str(daily_20130529.shape[0]))
daily_20130529_addname_dataframe.to_excel(daily_201305_excel_writer,'29_3',index=False)
daily_201305_excel_writer.save()
daily_20130530 = pro.daily(start_date='',end_date='',trade_date='20130530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130530_tscode_list = list() 
for ts_code_sh in daily_20130530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130530_tscode_list.append(stock_name)
daily_20130530_addname_dataframe=pd.DataFrame()
daily_20130530_addname_dataframe['cname'] = daily_20130530_tscode_list
for table_name in daily_20130530.columns.values.tolist():
    daily_20130530_addname_dataframe[table_name] = daily_20130530[table_name]
print("daily_20130530 返回数据 row 行数 = "+str(daily_20130530.shape[0]))
daily_20130530_addname_dataframe.to_excel(daily_201305_excel_writer,'30_4',index=False)
daily_201305_excel_writer.save()
daily_20130531 = pro.daily(start_date='',end_date='',trade_date='20130531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130531_tscode_list = list() 
for ts_code_sh in daily_20130531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130531_tscode_list.append(stock_name)
daily_20130531_addname_dataframe=pd.DataFrame()
daily_20130531_addname_dataframe['cname'] = daily_20130531_tscode_list
for table_name in daily_20130531.columns.values.tolist():
    daily_20130531_addname_dataframe[table_name] = daily_20130531[table_name]
print("daily_20130531 返回数据 row 行数 = "+str(daily_20130531.shape[0]))
daily_20130531_addname_dataframe.to_excel(daily_201305_excel_writer,'31_5',index=False)
daily_201305_excel_writer.save()




createexcel('daily_201306.xlsx')
daily_201306_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201306.xlsx')
daily_201306_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201306.xlsx', engine='openpyxl')
daily_201306_excel_writer.book = daily_201306_book
daily_201306_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201306_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130601")       ###  更新 记录日期
daily_20130601 = pro.daily(start_date='',end_date='',trade_date='20130601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130601_tscode_list = list() 
for ts_code_sh in daily_20130601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130601_tscode_list.append(stock_name)
daily_20130601_addname_dataframe=pd.DataFrame()
daily_20130601_addname_dataframe['cname'] = daily_20130601_tscode_list
for table_name in daily_20130601.columns.values.tolist():
    daily_20130601_addname_dataframe[table_name] = daily_20130601[table_name]
print("daily_20130601 返回数据 row 行数 = "+str(daily_20130601.shape[0]))
daily_20130601_addname_dataframe.to_excel(daily_201306_excel_writer,'1_6',index=False)
daily_201306_excel_writer.save()
daily_20130602 = pro.daily(start_date='',end_date='',trade_date='20130602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130602_tscode_list = list() 
for ts_code_sh in daily_20130602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130602_tscode_list.append(stock_name)
daily_20130602_addname_dataframe=pd.DataFrame()
daily_20130602_addname_dataframe['cname'] = daily_20130602_tscode_list
for table_name in daily_20130602.columns.values.tolist():
    daily_20130602_addname_dataframe[table_name] = daily_20130602[table_name]
print("daily_20130602 返回数据 row 行数 = "+str(daily_20130602.shape[0]))
daily_20130602_addname_dataframe.to_excel(daily_201306_excel_writer,'2_7',index=False)
daily_201306_excel_writer.save()
daily_20130603 = pro.daily(start_date='',end_date='',trade_date='20130603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130603_tscode_list = list() 
for ts_code_sh in daily_20130603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130603_tscode_list.append(stock_name)
daily_20130603_addname_dataframe=pd.DataFrame()
daily_20130603_addname_dataframe['cname'] = daily_20130603_tscode_list
for table_name in daily_20130603.columns.values.tolist():
    daily_20130603_addname_dataframe[table_name] = daily_20130603[table_name]
print("daily_20130603 返回数据 row 行数 = "+str(daily_20130603.shape[0]))
daily_20130603_addname_dataframe.to_excel(daily_201306_excel_writer,'3_1',index=False)
daily_201306_excel_writer.save()
daily_20130604 = pro.daily(start_date='',end_date='',trade_date='20130604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130604_tscode_list = list() 
for ts_code_sh in daily_20130604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130604_tscode_list.append(stock_name)
daily_20130604_addname_dataframe=pd.DataFrame()
daily_20130604_addname_dataframe['cname'] = daily_20130604_tscode_list
for table_name in daily_20130604.columns.values.tolist():
    daily_20130604_addname_dataframe[table_name] = daily_20130604[table_name]
print("daily_20130604 返回数据 row 行数 = "+str(daily_20130604.shape[0]))
daily_20130604_addname_dataframe.to_excel(daily_201306_excel_writer,'4_2',index=False)
daily_201306_excel_writer.save()
daily_20130605 = pro.daily(start_date='',end_date='',trade_date='20130605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130605_tscode_list = list() 
for ts_code_sh in daily_20130605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130605_tscode_list.append(stock_name)
daily_20130605_addname_dataframe=pd.DataFrame()
daily_20130605_addname_dataframe['cname'] = daily_20130605_tscode_list
for table_name in daily_20130605.columns.values.tolist():
    daily_20130605_addname_dataframe[table_name] = daily_20130605[table_name]
print("daily_20130605 返回数据 row 行数 = "+str(daily_20130605.shape[0]))
daily_20130605_addname_dataframe.to_excel(daily_201306_excel_writer,'5_3',index=False)
daily_201306_excel_writer.save()
daily_20130606 = pro.daily(start_date='',end_date='',trade_date='20130606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130606_tscode_list = list() 
for ts_code_sh in daily_20130606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130606_tscode_list.append(stock_name)
daily_20130606_addname_dataframe=pd.DataFrame()
daily_20130606_addname_dataframe['cname'] = daily_20130606_tscode_list
for table_name in daily_20130606.columns.values.tolist():
    daily_20130606_addname_dataframe[table_name] = daily_20130606[table_name]
print("daily_20130606 返回数据 row 行数 = "+str(daily_20130606.shape[0]))
daily_20130606_addname_dataframe.to_excel(daily_201306_excel_writer,'6_4',index=False)
daily_201306_excel_writer.save()
daily_20130607 = pro.daily(start_date='',end_date='',trade_date='20130607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130607_tscode_list = list() 
for ts_code_sh in daily_20130607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130607_tscode_list.append(stock_name)
daily_20130607_addname_dataframe=pd.DataFrame()
daily_20130607_addname_dataframe['cname'] = daily_20130607_tscode_list
for table_name in daily_20130607.columns.values.tolist():
    daily_20130607_addname_dataframe[table_name] = daily_20130607[table_name]
print("daily_20130607 返回数据 row 行数 = "+str(daily_20130607.shape[0]))
daily_20130607_addname_dataframe.to_excel(daily_201306_excel_writer,'7_5',index=False)
daily_201306_excel_writer.save()
daily_20130608 = pro.daily(start_date='',end_date='',trade_date='20130608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130608_tscode_list = list() 
for ts_code_sh in daily_20130608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130608_tscode_list.append(stock_name)
daily_20130608_addname_dataframe=pd.DataFrame()
daily_20130608_addname_dataframe['cname'] = daily_20130608_tscode_list
for table_name in daily_20130608.columns.values.tolist():
    daily_20130608_addname_dataframe[table_name] = daily_20130608[table_name]
print("daily_20130608 返回数据 row 行数 = "+str(daily_20130608.shape[0]))
daily_20130608_addname_dataframe.to_excel(daily_201306_excel_writer,'8_6',index=False)
daily_201306_excel_writer.save()
daily_20130609 = pro.daily(start_date='',end_date='',trade_date='20130609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130609_tscode_list = list() 
for ts_code_sh in daily_20130609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130609_tscode_list.append(stock_name)
daily_20130609_addname_dataframe=pd.DataFrame()
daily_20130609_addname_dataframe['cname'] = daily_20130609_tscode_list
for table_name in daily_20130609.columns.values.tolist():
    daily_20130609_addname_dataframe[table_name] = daily_20130609[table_name]
print("daily_20130609 返回数据 row 行数 = "+str(daily_20130609.shape[0]))
daily_20130609_addname_dataframe.to_excel(daily_201306_excel_writer,'9_7',index=False)
daily_201306_excel_writer.save()
daily_20130610 = pro.daily(start_date='',end_date='',trade_date='20130610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130610_tscode_list = list() 
for ts_code_sh in daily_20130610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130610_tscode_list.append(stock_name)
daily_20130610_addname_dataframe=pd.DataFrame()
daily_20130610_addname_dataframe['cname'] = daily_20130610_tscode_list
for table_name in daily_20130610.columns.values.tolist():
    daily_20130610_addname_dataframe[table_name] = daily_20130610[table_name]
print("daily_20130610 返回数据 row 行数 = "+str(daily_20130610.shape[0]))
daily_20130610_addname_dataframe.to_excel(daily_201306_excel_writer,'10_1',index=False)
daily_201306_excel_writer.save()
daily_20130611 = pro.daily(start_date='',end_date='',trade_date='20130611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130611_tscode_list = list() 
for ts_code_sh in daily_20130611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130611_tscode_list.append(stock_name)
daily_20130611_addname_dataframe=pd.DataFrame()
daily_20130611_addname_dataframe['cname'] = daily_20130611_tscode_list
for table_name in daily_20130611.columns.values.tolist():
    daily_20130611_addname_dataframe[table_name] = daily_20130611[table_name]
print("daily_20130611 返回数据 row 行数 = "+str(daily_20130611.shape[0]))
daily_20130611_addname_dataframe.to_excel(daily_201306_excel_writer,'11_2',index=False)
daily_201306_excel_writer.save()
daily_20130612 = pro.daily(start_date='',end_date='',trade_date='20130612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130612_tscode_list = list() 
for ts_code_sh in daily_20130612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130612_tscode_list.append(stock_name)
daily_20130612_addname_dataframe=pd.DataFrame()
daily_20130612_addname_dataframe['cname'] = daily_20130612_tscode_list
for table_name in daily_20130612.columns.values.tolist():
    daily_20130612_addname_dataframe[table_name] = daily_20130612[table_name]
print("daily_20130612 返回数据 row 行数 = "+str(daily_20130612.shape[0]))
daily_20130612_addname_dataframe.to_excel(daily_201306_excel_writer,'12_3',index=False)
daily_201306_excel_writer.save()
daily_20130613 = pro.daily(start_date='',end_date='',trade_date='20130613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130613_tscode_list = list() 
for ts_code_sh in daily_20130613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130613_tscode_list.append(stock_name)
daily_20130613_addname_dataframe=pd.DataFrame()
daily_20130613_addname_dataframe['cname'] = daily_20130613_tscode_list
for table_name in daily_20130613.columns.values.tolist():
    daily_20130613_addname_dataframe[table_name] = daily_20130613[table_name]
print("daily_20130613 返回数据 row 行数 = "+str(daily_20130613.shape[0]))
daily_20130613_addname_dataframe.to_excel(daily_201306_excel_writer,'13_4',index=False)
daily_201306_excel_writer.save()
daily_20130614 = pro.daily(start_date='',end_date='',trade_date='20130614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130614_tscode_list = list() 
for ts_code_sh in daily_20130614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130614_tscode_list.append(stock_name)
daily_20130614_addname_dataframe=pd.DataFrame()
daily_20130614_addname_dataframe['cname'] = daily_20130614_tscode_list
for table_name in daily_20130614.columns.values.tolist():
    daily_20130614_addname_dataframe[table_name] = daily_20130614[table_name]
print("daily_20130614 返回数据 row 行数 = "+str(daily_20130614.shape[0]))
daily_20130614_addname_dataframe.to_excel(daily_201306_excel_writer,'14_5',index=False)
daily_201306_excel_writer.save()
daily_20130615 = pro.daily(start_date='',end_date='',trade_date='20130615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130615_tscode_list = list() 
for ts_code_sh in daily_20130615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130615_tscode_list.append(stock_name)
daily_20130615_addname_dataframe=pd.DataFrame()
daily_20130615_addname_dataframe['cname'] = daily_20130615_tscode_list
for table_name in daily_20130615.columns.values.tolist():
    daily_20130615_addname_dataframe[table_name] = daily_20130615[table_name]
print("daily_20130615 返回数据 row 行数 = "+str(daily_20130615.shape[0]))
daily_20130615_addname_dataframe.to_excel(daily_201306_excel_writer,'15_6',index=False)
daily_201306_excel_writer.save()
daily_20130616 = pro.daily(start_date='',end_date='',trade_date='20130616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130616_tscode_list = list() 
for ts_code_sh in daily_20130616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130616_tscode_list.append(stock_name)
daily_20130616_addname_dataframe=pd.DataFrame()
daily_20130616_addname_dataframe['cname'] = daily_20130616_tscode_list
for table_name in daily_20130616.columns.values.tolist():
    daily_20130616_addname_dataframe[table_name] = daily_20130616[table_name]
print("daily_20130616 返回数据 row 行数 = "+str(daily_20130616.shape[0]))
daily_20130616_addname_dataframe.to_excel(daily_201306_excel_writer,'16_7',index=False)
daily_201306_excel_writer.save()
daily_20130617 = pro.daily(start_date='',end_date='',trade_date='20130617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130617_tscode_list = list() 
for ts_code_sh in daily_20130617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130617_tscode_list.append(stock_name)
daily_20130617_addname_dataframe=pd.DataFrame()
daily_20130617_addname_dataframe['cname'] = daily_20130617_tscode_list
for table_name in daily_20130617.columns.values.tolist():
    daily_20130617_addname_dataframe[table_name] = daily_20130617[table_name]
print("daily_20130617 返回数据 row 行数 = "+str(daily_20130617.shape[0]))
daily_20130617_addname_dataframe.to_excel(daily_201306_excel_writer,'17_1',index=False)
daily_201306_excel_writer.save()
daily_20130618 = pro.daily(start_date='',end_date='',trade_date='20130618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130618_tscode_list = list() 
for ts_code_sh in daily_20130618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130618_tscode_list.append(stock_name)
daily_20130618_addname_dataframe=pd.DataFrame()
daily_20130618_addname_dataframe['cname'] = daily_20130618_tscode_list
for table_name in daily_20130618.columns.values.tolist():
    daily_20130618_addname_dataframe[table_name] = daily_20130618[table_name]
print("daily_20130618 返回数据 row 行数 = "+str(daily_20130618.shape[0]))
daily_20130618_addname_dataframe.to_excel(daily_201306_excel_writer,'18_2',index=False)
daily_201306_excel_writer.save()
daily_20130619 = pro.daily(start_date='',end_date='',trade_date='20130619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130619_tscode_list = list() 
for ts_code_sh in daily_20130619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130619_tscode_list.append(stock_name)
daily_20130619_addname_dataframe=pd.DataFrame()
daily_20130619_addname_dataframe['cname'] = daily_20130619_tscode_list
for table_name in daily_20130619.columns.values.tolist():
    daily_20130619_addname_dataframe[table_name] = daily_20130619[table_name]
print("daily_20130619 返回数据 row 行数 = "+str(daily_20130619.shape[0]))
daily_20130619_addname_dataframe.to_excel(daily_201306_excel_writer,'19_3',index=False)
daily_201306_excel_writer.save()
daily_20130620 = pro.daily(start_date='',end_date='',trade_date='20130620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130620_tscode_list = list() 
for ts_code_sh in daily_20130620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130620_tscode_list.append(stock_name)
daily_20130620_addname_dataframe=pd.DataFrame()
daily_20130620_addname_dataframe['cname'] = daily_20130620_tscode_list
for table_name in daily_20130620.columns.values.tolist():
    daily_20130620_addname_dataframe[table_name] = daily_20130620[table_name]
print("daily_20130620 返回数据 row 行数 = "+str(daily_20130620.shape[0]))
daily_20130620_addname_dataframe.to_excel(daily_201306_excel_writer,'20_4',index=False)
daily_201306_excel_writer.save()
daily_20130621 = pro.daily(start_date='',end_date='',trade_date='20130621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130621_tscode_list = list() 
for ts_code_sh in daily_20130621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130621_tscode_list.append(stock_name)
daily_20130621_addname_dataframe=pd.DataFrame()
daily_20130621_addname_dataframe['cname'] = daily_20130621_tscode_list
for table_name in daily_20130621.columns.values.tolist():
    daily_20130621_addname_dataframe[table_name] = daily_20130621[table_name]
print("daily_20130621 返回数据 row 行数 = "+str(daily_20130621.shape[0]))
daily_20130621_addname_dataframe.to_excel(daily_201306_excel_writer,'21_5',index=False)
daily_201306_excel_writer.save()
daily_20130622 = pro.daily(start_date='',end_date='',trade_date='20130622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130622_tscode_list = list() 
for ts_code_sh in daily_20130622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130622_tscode_list.append(stock_name)
daily_20130622_addname_dataframe=pd.DataFrame()
daily_20130622_addname_dataframe['cname'] = daily_20130622_tscode_list
for table_name in daily_20130622.columns.values.tolist():
    daily_20130622_addname_dataframe[table_name] = daily_20130622[table_name]
print("daily_20130622 返回数据 row 行数 = "+str(daily_20130622.shape[0]))
daily_20130622_addname_dataframe.to_excel(daily_201306_excel_writer,'22_6',index=False)
daily_201306_excel_writer.save()
daily_20130623 = pro.daily(start_date='',end_date='',trade_date='20130623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130623_tscode_list = list() 
for ts_code_sh in daily_20130623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130623_tscode_list.append(stock_name)
daily_20130623_addname_dataframe=pd.DataFrame()
daily_20130623_addname_dataframe['cname'] = daily_20130623_tscode_list
for table_name in daily_20130623.columns.values.tolist():
    daily_20130623_addname_dataframe[table_name] = daily_20130623[table_name]
print("daily_20130623 返回数据 row 行数 = "+str(daily_20130623.shape[0]))
daily_20130623_addname_dataframe.to_excel(daily_201306_excel_writer,'23_7',index=False)
daily_201306_excel_writer.save()
daily_20130624 = pro.daily(start_date='',end_date='',trade_date='20130624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130624_tscode_list = list() 
for ts_code_sh in daily_20130624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130624_tscode_list.append(stock_name)
daily_20130624_addname_dataframe=pd.DataFrame()
daily_20130624_addname_dataframe['cname'] = daily_20130624_tscode_list
for table_name in daily_20130624.columns.values.tolist():
    daily_20130624_addname_dataframe[table_name] = daily_20130624[table_name]
print("daily_20130624 返回数据 row 行数 = "+str(daily_20130624.shape[0]))
daily_20130624_addname_dataframe.to_excel(daily_201306_excel_writer,'24_1',index=False)
daily_201306_excel_writer.save()
daily_20130625 = pro.daily(start_date='',end_date='',trade_date='20130625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130625_tscode_list = list() 
for ts_code_sh in daily_20130625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130625_tscode_list.append(stock_name)
daily_20130625_addname_dataframe=pd.DataFrame()
daily_20130625_addname_dataframe['cname'] = daily_20130625_tscode_list
for table_name in daily_20130625.columns.values.tolist():
    daily_20130625_addname_dataframe[table_name] = daily_20130625[table_name]
print("daily_20130625 返回数据 row 行数 = "+str(daily_20130625.shape[0]))
daily_20130625_addname_dataframe.to_excel(daily_201306_excel_writer,'25_2',index=False)
daily_201306_excel_writer.save()
daily_20130626 = pro.daily(start_date='',end_date='',trade_date='20130626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130626_tscode_list = list() 
for ts_code_sh in daily_20130626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130626_tscode_list.append(stock_name)
daily_20130626_addname_dataframe=pd.DataFrame()
daily_20130626_addname_dataframe['cname'] = daily_20130626_tscode_list
for table_name in daily_20130626.columns.values.tolist():
    daily_20130626_addname_dataframe[table_name] = daily_20130626[table_name]
print("daily_20130626 返回数据 row 行数 = "+str(daily_20130626.shape[0]))
daily_20130626_addname_dataframe.to_excel(daily_201306_excel_writer,'26_3',index=False)
daily_201306_excel_writer.save()
daily_20130627 = pro.daily(start_date='',end_date='',trade_date='20130627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130627_tscode_list = list() 
for ts_code_sh in daily_20130627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130627_tscode_list.append(stock_name)
daily_20130627_addname_dataframe=pd.DataFrame()
daily_20130627_addname_dataframe['cname'] = daily_20130627_tscode_list
for table_name in daily_20130627.columns.values.tolist():
    daily_20130627_addname_dataframe[table_name] = daily_20130627[table_name]
print("daily_20130627 返回数据 row 行数 = "+str(daily_20130627.shape[0]))
daily_20130627_addname_dataframe.to_excel(daily_201306_excel_writer,'27_4',index=False)
daily_201306_excel_writer.save()
daily_20130628 = pro.daily(start_date='',end_date='',trade_date='20130628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130628_tscode_list = list() 
for ts_code_sh in daily_20130628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130628_tscode_list.append(stock_name)
daily_20130628_addname_dataframe=pd.DataFrame()
daily_20130628_addname_dataframe['cname'] = daily_20130628_tscode_list
for table_name in daily_20130628.columns.values.tolist():
    daily_20130628_addname_dataframe[table_name] = daily_20130628[table_name]
print("daily_20130628 返回数据 row 行数 = "+str(daily_20130628.shape[0]))
daily_20130628_addname_dataframe.to_excel(daily_201306_excel_writer,'28_5',index=False)
daily_201306_excel_writer.save()
daily_20130629 = pro.daily(start_date='',end_date='',trade_date='20130629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130629_tscode_list = list() 
for ts_code_sh in daily_20130629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130629_tscode_list.append(stock_name)
daily_20130629_addname_dataframe=pd.DataFrame()
daily_20130629_addname_dataframe['cname'] = daily_20130629_tscode_list
for table_name in daily_20130629.columns.values.tolist():
    daily_20130629_addname_dataframe[table_name] = daily_20130629[table_name]
print("daily_20130629 返回数据 row 行数 = "+str(daily_20130629.shape[0]))
daily_20130629_addname_dataframe.to_excel(daily_201306_excel_writer,'29_6',index=False)
daily_201306_excel_writer.save()
daily_20130630 = pro.daily(start_date='',end_date='',trade_date='20130630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130630_tscode_list = list() 
for ts_code_sh in daily_20130630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130630_tscode_list.append(stock_name)
daily_20130630_addname_dataframe=pd.DataFrame()
daily_20130630_addname_dataframe['cname'] = daily_20130630_tscode_list
for table_name in daily_20130630.columns.values.tolist():
    daily_20130630_addname_dataframe[table_name] = daily_20130630[table_name]
print("daily_20130630 返回数据 row 行数 = "+str(daily_20130630.shape[0]))
daily_20130630_addname_dataframe.to_excel(daily_201306_excel_writer,'30_7',index=False)
daily_201306_excel_writer.save()




createexcel('daily_201307.xlsx')
daily_201307_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201307.xlsx')
daily_201307_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201307.xlsx', engine='openpyxl')
daily_201307_excel_writer.book = daily_201307_book
daily_201307_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201307_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130701")       ###  更新 记录日期
daily_20130701 = pro.daily(start_date='',end_date='',trade_date='20130701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130701_tscode_list = list() 
for ts_code_sh in daily_20130701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130701_tscode_list.append(stock_name)
daily_20130701_addname_dataframe=pd.DataFrame()
daily_20130701_addname_dataframe['cname'] = daily_20130701_tscode_list
for table_name in daily_20130701.columns.values.tolist():
    daily_20130701_addname_dataframe[table_name] = daily_20130701[table_name]
print("daily_20130701 返回数据 row 行数 = "+str(daily_20130701.shape[0]))
daily_20130701_addname_dataframe.to_excel(daily_201307_excel_writer,'1_1',index=False)
daily_201307_excel_writer.save()
daily_20130702 = pro.daily(start_date='',end_date='',trade_date='20130702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130702_tscode_list = list() 
for ts_code_sh in daily_20130702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130702_tscode_list.append(stock_name)
daily_20130702_addname_dataframe=pd.DataFrame()
daily_20130702_addname_dataframe['cname'] = daily_20130702_tscode_list
for table_name in daily_20130702.columns.values.tolist():
    daily_20130702_addname_dataframe[table_name] = daily_20130702[table_name]
print("daily_20130702 返回数据 row 行数 = "+str(daily_20130702.shape[0]))
daily_20130702_addname_dataframe.to_excel(daily_201307_excel_writer,'2_2',index=False)
daily_201307_excel_writer.save()
daily_20130703 = pro.daily(start_date='',end_date='',trade_date='20130703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130703_tscode_list = list() 
for ts_code_sh in daily_20130703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130703_tscode_list.append(stock_name)
daily_20130703_addname_dataframe=pd.DataFrame()
daily_20130703_addname_dataframe['cname'] = daily_20130703_tscode_list
for table_name in daily_20130703.columns.values.tolist():
    daily_20130703_addname_dataframe[table_name] = daily_20130703[table_name]
print("daily_20130703 返回数据 row 行数 = "+str(daily_20130703.shape[0]))
daily_20130703_addname_dataframe.to_excel(daily_201307_excel_writer,'3_3',index=False)
daily_201307_excel_writer.save()
daily_20130704 = pro.daily(start_date='',end_date='',trade_date='20130704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130704_tscode_list = list() 
for ts_code_sh in daily_20130704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130704_tscode_list.append(stock_name)
daily_20130704_addname_dataframe=pd.DataFrame()
daily_20130704_addname_dataframe['cname'] = daily_20130704_tscode_list
for table_name in daily_20130704.columns.values.tolist():
    daily_20130704_addname_dataframe[table_name] = daily_20130704[table_name]
print("daily_20130704 返回数据 row 行数 = "+str(daily_20130704.shape[0]))
daily_20130704_addname_dataframe.to_excel(daily_201307_excel_writer,'4_4',index=False)
daily_201307_excel_writer.save()
daily_20130705 = pro.daily(start_date='',end_date='',trade_date='20130705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130705_tscode_list = list() 
for ts_code_sh in daily_20130705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130705_tscode_list.append(stock_name)
daily_20130705_addname_dataframe=pd.DataFrame()
daily_20130705_addname_dataframe['cname'] = daily_20130705_tscode_list
for table_name in daily_20130705.columns.values.tolist():
    daily_20130705_addname_dataframe[table_name] = daily_20130705[table_name]
print("daily_20130705 返回数据 row 行数 = "+str(daily_20130705.shape[0]))
daily_20130705_addname_dataframe.to_excel(daily_201307_excel_writer,'5_5',index=False)
daily_201307_excel_writer.save()
daily_20130706 = pro.daily(start_date='',end_date='',trade_date='20130706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130706_tscode_list = list() 
for ts_code_sh in daily_20130706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130706_tscode_list.append(stock_name)
daily_20130706_addname_dataframe=pd.DataFrame()
daily_20130706_addname_dataframe['cname'] = daily_20130706_tscode_list
for table_name in daily_20130706.columns.values.tolist():
    daily_20130706_addname_dataframe[table_name] = daily_20130706[table_name]
print("daily_20130706 返回数据 row 行数 = "+str(daily_20130706.shape[0]))
daily_20130706_addname_dataframe.to_excel(daily_201307_excel_writer,'6_6',index=False)
daily_201307_excel_writer.save()
daily_20130707 = pro.daily(start_date='',end_date='',trade_date='20130707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130707_tscode_list = list() 
for ts_code_sh in daily_20130707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130707_tscode_list.append(stock_name)
daily_20130707_addname_dataframe=pd.DataFrame()
daily_20130707_addname_dataframe['cname'] = daily_20130707_tscode_list
for table_name in daily_20130707.columns.values.tolist():
    daily_20130707_addname_dataframe[table_name] = daily_20130707[table_name]
print("daily_20130707 返回数据 row 行数 = "+str(daily_20130707.shape[0]))
daily_20130707_addname_dataframe.to_excel(daily_201307_excel_writer,'7_7',index=False)
daily_201307_excel_writer.save()
daily_20130708 = pro.daily(start_date='',end_date='',trade_date='20130708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130708_tscode_list = list() 
for ts_code_sh in daily_20130708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130708_tscode_list.append(stock_name)
daily_20130708_addname_dataframe=pd.DataFrame()
daily_20130708_addname_dataframe['cname'] = daily_20130708_tscode_list
for table_name in daily_20130708.columns.values.tolist():
    daily_20130708_addname_dataframe[table_name] = daily_20130708[table_name]
print("daily_20130708 返回数据 row 行数 = "+str(daily_20130708.shape[0]))
daily_20130708_addname_dataframe.to_excel(daily_201307_excel_writer,'8_1',index=False)
daily_201307_excel_writer.save()
daily_20130709 = pro.daily(start_date='',end_date='',trade_date='20130709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130709_tscode_list = list() 
for ts_code_sh in daily_20130709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130709_tscode_list.append(stock_name)
daily_20130709_addname_dataframe=pd.DataFrame()
daily_20130709_addname_dataframe['cname'] = daily_20130709_tscode_list
for table_name in daily_20130709.columns.values.tolist():
    daily_20130709_addname_dataframe[table_name] = daily_20130709[table_name]
print("daily_20130709 返回数据 row 行数 = "+str(daily_20130709.shape[0]))
daily_20130709_addname_dataframe.to_excel(daily_201307_excel_writer,'9_2',index=False)
daily_201307_excel_writer.save()
daily_20130710 = pro.daily(start_date='',end_date='',trade_date='20130710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130710_tscode_list = list() 
for ts_code_sh in daily_20130710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130710_tscode_list.append(stock_name)
daily_20130710_addname_dataframe=pd.DataFrame()
daily_20130710_addname_dataframe['cname'] = daily_20130710_tscode_list
for table_name in daily_20130710.columns.values.tolist():
    daily_20130710_addname_dataframe[table_name] = daily_20130710[table_name]
print("daily_20130710 返回数据 row 行数 = "+str(daily_20130710.shape[0]))
daily_20130710_addname_dataframe.to_excel(daily_201307_excel_writer,'10_3',index=False)
daily_201307_excel_writer.save()
daily_20130711 = pro.daily(start_date='',end_date='',trade_date='20130711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130711_tscode_list = list() 
for ts_code_sh in daily_20130711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130711_tscode_list.append(stock_name)
daily_20130711_addname_dataframe=pd.DataFrame()
daily_20130711_addname_dataframe['cname'] = daily_20130711_tscode_list
for table_name in daily_20130711.columns.values.tolist():
    daily_20130711_addname_dataframe[table_name] = daily_20130711[table_name]
print("daily_20130711 返回数据 row 行数 = "+str(daily_20130711.shape[0]))
daily_20130711_addname_dataframe.to_excel(daily_201307_excel_writer,'11_4',index=False)
daily_201307_excel_writer.save()
daily_20130712 = pro.daily(start_date='',end_date='',trade_date='20130712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130712_tscode_list = list() 
for ts_code_sh in daily_20130712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130712_tscode_list.append(stock_name)
daily_20130712_addname_dataframe=pd.DataFrame()
daily_20130712_addname_dataframe['cname'] = daily_20130712_tscode_list
for table_name in daily_20130712.columns.values.tolist():
    daily_20130712_addname_dataframe[table_name] = daily_20130712[table_name]
print("daily_20130712 返回数据 row 行数 = "+str(daily_20130712.shape[0]))
daily_20130712_addname_dataframe.to_excel(daily_201307_excel_writer,'12_5',index=False)
daily_201307_excel_writer.save()
daily_20130713 = pro.daily(start_date='',end_date='',trade_date='20130713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130713_tscode_list = list() 
for ts_code_sh in daily_20130713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130713_tscode_list.append(stock_name)
daily_20130713_addname_dataframe=pd.DataFrame()
daily_20130713_addname_dataframe['cname'] = daily_20130713_tscode_list
for table_name in daily_20130713.columns.values.tolist():
    daily_20130713_addname_dataframe[table_name] = daily_20130713[table_name]
print("daily_20130713 返回数据 row 行数 = "+str(daily_20130713.shape[0]))
daily_20130713_addname_dataframe.to_excel(daily_201307_excel_writer,'13_6',index=False)
daily_201307_excel_writer.save()
daily_20130714 = pro.daily(start_date='',end_date='',trade_date='20130714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130714_tscode_list = list() 
for ts_code_sh in daily_20130714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130714_tscode_list.append(stock_name)
daily_20130714_addname_dataframe=pd.DataFrame()
daily_20130714_addname_dataframe['cname'] = daily_20130714_tscode_list
for table_name in daily_20130714.columns.values.tolist():
    daily_20130714_addname_dataframe[table_name] = daily_20130714[table_name]
print("daily_20130714 返回数据 row 行数 = "+str(daily_20130714.shape[0]))
daily_20130714_addname_dataframe.to_excel(daily_201307_excel_writer,'14_7',index=False)
daily_201307_excel_writer.save()
daily_20130715 = pro.daily(start_date='',end_date='',trade_date='20130715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130715_tscode_list = list() 
for ts_code_sh in daily_20130715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130715_tscode_list.append(stock_name)
daily_20130715_addname_dataframe=pd.DataFrame()
daily_20130715_addname_dataframe['cname'] = daily_20130715_tscode_list
for table_name in daily_20130715.columns.values.tolist():
    daily_20130715_addname_dataframe[table_name] = daily_20130715[table_name]
print("daily_20130715 返回数据 row 行数 = "+str(daily_20130715.shape[0]))
daily_20130715_addname_dataframe.to_excel(daily_201307_excel_writer,'15_1',index=False)
daily_201307_excel_writer.save()
daily_20130716 = pro.daily(start_date='',end_date='',trade_date='20130716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130716_tscode_list = list() 
for ts_code_sh in daily_20130716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130716_tscode_list.append(stock_name)
daily_20130716_addname_dataframe=pd.DataFrame()
daily_20130716_addname_dataframe['cname'] = daily_20130716_tscode_list
for table_name in daily_20130716.columns.values.tolist():
    daily_20130716_addname_dataframe[table_name] = daily_20130716[table_name]
print("daily_20130716 返回数据 row 行数 = "+str(daily_20130716.shape[0]))
daily_20130716_addname_dataframe.to_excel(daily_201307_excel_writer,'16_2',index=False)
daily_201307_excel_writer.save()
daily_20130717 = pro.daily(start_date='',end_date='',trade_date='20130717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130717_tscode_list = list() 
for ts_code_sh in daily_20130717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130717_tscode_list.append(stock_name)
daily_20130717_addname_dataframe=pd.DataFrame()
daily_20130717_addname_dataframe['cname'] = daily_20130717_tscode_list
for table_name in daily_20130717.columns.values.tolist():
    daily_20130717_addname_dataframe[table_name] = daily_20130717[table_name]
print("daily_20130717 返回数据 row 行数 = "+str(daily_20130717.shape[0]))
daily_20130717_addname_dataframe.to_excel(daily_201307_excel_writer,'17_3',index=False)
daily_201307_excel_writer.save()
daily_20130718 = pro.daily(start_date='',end_date='',trade_date='20130718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130718_tscode_list = list() 
for ts_code_sh in daily_20130718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130718_tscode_list.append(stock_name)
daily_20130718_addname_dataframe=pd.DataFrame()
daily_20130718_addname_dataframe['cname'] = daily_20130718_tscode_list
for table_name in daily_20130718.columns.values.tolist():
    daily_20130718_addname_dataframe[table_name] = daily_20130718[table_name]
print("daily_20130718 返回数据 row 行数 = "+str(daily_20130718.shape[0]))
daily_20130718_addname_dataframe.to_excel(daily_201307_excel_writer,'18_4',index=False)
daily_201307_excel_writer.save()
daily_20130719 = pro.daily(start_date='',end_date='',trade_date='20130719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130719_tscode_list = list() 
for ts_code_sh in daily_20130719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130719_tscode_list.append(stock_name)
daily_20130719_addname_dataframe=pd.DataFrame()
daily_20130719_addname_dataframe['cname'] = daily_20130719_tscode_list
for table_name in daily_20130719.columns.values.tolist():
    daily_20130719_addname_dataframe[table_name] = daily_20130719[table_name]
print("daily_20130719 返回数据 row 行数 = "+str(daily_20130719.shape[0]))
daily_20130719_addname_dataframe.to_excel(daily_201307_excel_writer,'19_5',index=False)
daily_201307_excel_writer.save()
daily_20130720 = pro.daily(start_date='',end_date='',trade_date='20130720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130720_tscode_list = list() 
for ts_code_sh in daily_20130720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130720_tscode_list.append(stock_name)
daily_20130720_addname_dataframe=pd.DataFrame()
daily_20130720_addname_dataframe['cname'] = daily_20130720_tscode_list
for table_name in daily_20130720.columns.values.tolist():
    daily_20130720_addname_dataframe[table_name] = daily_20130720[table_name]
print("daily_20130720 返回数据 row 行数 = "+str(daily_20130720.shape[0]))
daily_20130720_addname_dataframe.to_excel(daily_201307_excel_writer,'20_6',index=False)
daily_201307_excel_writer.save()
daily_20130721 = pro.daily(start_date='',end_date='',trade_date='20130721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130721_tscode_list = list() 
for ts_code_sh in daily_20130721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130721_tscode_list.append(stock_name)
daily_20130721_addname_dataframe=pd.DataFrame()
daily_20130721_addname_dataframe['cname'] = daily_20130721_tscode_list
for table_name in daily_20130721.columns.values.tolist():
    daily_20130721_addname_dataframe[table_name] = daily_20130721[table_name]
print("daily_20130721 返回数据 row 行数 = "+str(daily_20130721.shape[0]))
daily_20130721_addname_dataframe.to_excel(daily_201307_excel_writer,'21_7',index=False)
daily_201307_excel_writer.save()
daily_20130722 = pro.daily(start_date='',end_date='',trade_date='20130722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130722_tscode_list = list() 
for ts_code_sh in daily_20130722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130722_tscode_list.append(stock_name)
daily_20130722_addname_dataframe=pd.DataFrame()
daily_20130722_addname_dataframe['cname'] = daily_20130722_tscode_list
for table_name in daily_20130722.columns.values.tolist():
    daily_20130722_addname_dataframe[table_name] = daily_20130722[table_name]
print("daily_20130722 返回数据 row 行数 = "+str(daily_20130722.shape[0]))
daily_20130722_addname_dataframe.to_excel(daily_201307_excel_writer,'22_1',index=False)
daily_201307_excel_writer.save()
daily_20130723 = pro.daily(start_date='',end_date='',trade_date='20130723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130723_tscode_list = list() 
for ts_code_sh in daily_20130723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130723_tscode_list.append(stock_name)
daily_20130723_addname_dataframe=pd.DataFrame()
daily_20130723_addname_dataframe['cname'] = daily_20130723_tscode_list
for table_name in daily_20130723.columns.values.tolist():
    daily_20130723_addname_dataframe[table_name] = daily_20130723[table_name]
print("daily_20130723 返回数据 row 行数 = "+str(daily_20130723.shape[0]))
daily_20130723_addname_dataframe.to_excel(daily_201307_excel_writer,'23_2',index=False)
daily_201307_excel_writer.save()
daily_20130724 = pro.daily(start_date='',end_date='',trade_date='20130724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130724_tscode_list = list() 
for ts_code_sh in daily_20130724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130724_tscode_list.append(stock_name)
daily_20130724_addname_dataframe=pd.DataFrame()
daily_20130724_addname_dataframe['cname'] = daily_20130724_tscode_list
for table_name in daily_20130724.columns.values.tolist():
    daily_20130724_addname_dataframe[table_name] = daily_20130724[table_name]
print("daily_20130724 返回数据 row 行数 = "+str(daily_20130724.shape[0]))
daily_20130724_addname_dataframe.to_excel(daily_201307_excel_writer,'24_3',index=False)
daily_201307_excel_writer.save()
daily_20130725 = pro.daily(start_date='',end_date='',trade_date='20130725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130725_tscode_list = list() 
for ts_code_sh in daily_20130725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130725_tscode_list.append(stock_name)
daily_20130725_addname_dataframe=pd.DataFrame()
daily_20130725_addname_dataframe['cname'] = daily_20130725_tscode_list
for table_name in daily_20130725.columns.values.tolist():
    daily_20130725_addname_dataframe[table_name] = daily_20130725[table_name]
print("daily_20130725 返回数据 row 行数 = "+str(daily_20130725.shape[0]))
daily_20130725_addname_dataframe.to_excel(daily_201307_excel_writer,'25_4',index=False)
daily_201307_excel_writer.save()
daily_20130726 = pro.daily(start_date='',end_date='',trade_date='20130726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130726_tscode_list = list() 
for ts_code_sh in daily_20130726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130726_tscode_list.append(stock_name)
daily_20130726_addname_dataframe=pd.DataFrame()
daily_20130726_addname_dataframe['cname'] = daily_20130726_tscode_list
for table_name in daily_20130726.columns.values.tolist():
    daily_20130726_addname_dataframe[table_name] = daily_20130726[table_name]
print("daily_20130726 返回数据 row 行数 = "+str(daily_20130726.shape[0]))
daily_20130726_addname_dataframe.to_excel(daily_201307_excel_writer,'26_5',index=False)
daily_201307_excel_writer.save()
daily_20130727 = pro.daily(start_date='',end_date='',trade_date='20130727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130727_tscode_list = list() 
for ts_code_sh in daily_20130727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130727_tscode_list.append(stock_name)
daily_20130727_addname_dataframe=pd.DataFrame()
daily_20130727_addname_dataframe['cname'] = daily_20130727_tscode_list
for table_name in daily_20130727.columns.values.tolist():
    daily_20130727_addname_dataframe[table_name] = daily_20130727[table_name]
print("daily_20130727 返回数据 row 行数 = "+str(daily_20130727.shape[0]))
daily_20130727_addname_dataframe.to_excel(daily_201307_excel_writer,'27_6',index=False)
daily_201307_excel_writer.save()
daily_20130728 = pro.daily(start_date='',end_date='',trade_date='20130728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130728_tscode_list = list() 
for ts_code_sh in daily_20130728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130728_tscode_list.append(stock_name)
daily_20130728_addname_dataframe=pd.DataFrame()
daily_20130728_addname_dataframe['cname'] = daily_20130728_tscode_list
for table_name in daily_20130728.columns.values.tolist():
    daily_20130728_addname_dataframe[table_name] = daily_20130728[table_name]
print("daily_20130728 返回数据 row 行数 = "+str(daily_20130728.shape[0]))
daily_20130728_addname_dataframe.to_excel(daily_201307_excel_writer,'28_7',index=False)
daily_201307_excel_writer.save()
daily_20130729 = pro.daily(start_date='',end_date='',trade_date='20130729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130729_tscode_list = list() 
for ts_code_sh in daily_20130729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130729_tscode_list.append(stock_name)
daily_20130729_addname_dataframe=pd.DataFrame()
daily_20130729_addname_dataframe['cname'] = daily_20130729_tscode_list
for table_name in daily_20130729.columns.values.tolist():
    daily_20130729_addname_dataframe[table_name] = daily_20130729[table_name]
print("daily_20130729 返回数据 row 行数 = "+str(daily_20130729.shape[0]))
daily_20130729_addname_dataframe.to_excel(daily_201307_excel_writer,'29_1',index=False)
daily_201307_excel_writer.save()
daily_20130730 = pro.daily(start_date='',end_date='',trade_date='20130730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130730_tscode_list = list() 
for ts_code_sh in daily_20130730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130730_tscode_list.append(stock_name)
daily_20130730_addname_dataframe=pd.DataFrame()
daily_20130730_addname_dataframe['cname'] = daily_20130730_tscode_list
for table_name in daily_20130730.columns.values.tolist():
    daily_20130730_addname_dataframe[table_name] = daily_20130730[table_name]
print("daily_20130730 返回数据 row 行数 = "+str(daily_20130730.shape[0]))
daily_20130730_addname_dataframe.to_excel(daily_201307_excel_writer,'30_2',index=False)
daily_201307_excel_writer.save()
daily_20130731 = pro.daily(start_date='',end_date='',trade_date='20130731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130731_tscode_list = list() 
for ts_code_sh in daily_20130731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130731_tscode_list.append(stock_name)
daily_20130731_addname_dataframe=pd.DataFrame()
daily_20130731_addname_dataframe['cname'] = daily_20130731_tscode_list
for table_name in daily_20130731.columns.values.tolist():
    daily_20130731_addname_dataframe[table_name] = daily_20130731[table_name]
print("daily_20130731 返回数据 row 行数 = "+str(daily_20130731.shape[0]))
daily_20130731_addname_dataframe.to_excel(daily_201307_excel_writer,'31_3',index=False)
daily_201307_excel_writer.save()




createexcel('daily_201308.xlsx')
daily_201308_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201308.xlsx')
daily_201308_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201308.xlsx', engine='openpyxl')
daily_201308_excel_writer.book = daily_201308_book
daily_201308_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201308_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130801")       ###  更新 记录日期
daily_20130801 = pro.daily(start_date='',end_date='',trade_date='20130801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130801_tscode_list = list() 
for ts_code_sh in daily_20130801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130801_tscode_list.append(stock_name)
daily_20130801_addname_dataframe=pd.DataFrame()
daily_20130801_addname_dataframe['cname'] = daily_20130801_tscode_list
for table_name in daily_20130801.columns.values.tolist():
    daily_20130801_addname_dataframe[table_name] = daily_20130801[table_name]
print("daily_20130801 返回数据 row 行数 = "+str(daily_20130801.shape[0]))
daily_20130801_addname_dataframe.to_excel(daily_201308_excel_writer,'1_4',index=False)
daily_201308_excel_writer.save()
daily_20130802 = pro.daily(start_date='',end_date='',trade_date='20130802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130802_tscode_list = list() 
for ts_code_sh in daily_20130802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130802_tscode_list.append(stock_name)
daily_20130802_addname_dataframe=pd.DataFrame()
daily_20130802_addname_dataframe['cname'] = daily_20130802_tscode_list
for table_name in daily_20130802.columns.values.tolist():
    daily_20130802_addname_dataframe[table_name] = daily_20130802[table_name]
print("daily_20130802 返回数据 row 行数 = "+str(daily_20130802.shape[0]))
daily_20130802_addname_dataframe.to_excel(daily_201308_excel_writer,'2_5',index=False)
daily_201308_excel_writer.save()
daily_20130803 = pro.daily(start_date='',end_date='',trade_date='20130803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130803_tscode_list = list() 
for ts_code_sh in daily_20130803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130803_tscode_list.append(stock_name)
daily_20130803_addname_dataframe=pd.DataFrame()
daily_20130803_addname_dataframe['cname'] = daily_20130803_tscode_list
for table_name in daily_20130803.columns.values.tolist():
    daily_20130803_addname_dataframe[table_name] = daily_20130803[table_name]
print("daily_20130803 返回数据 row 行数 = "+str(daily_20130803.shape[0]))
daily_20130803_addname_dataframe.to_excel(daily_201308_excel_writer,'3_6',index=False)
daily_201308_excel_writer.save()
daily_20130804 = pro.daily(start_date='',end_date='',trade_date='20130804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130804_tscode_list = list() 
for ts_code_sh in daily_20130804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130804_tscode_list.append(stock_name)
daily_20130804_addname_dataframe=pd.DataFrame()
daily_20130804_addname_dataframe['cname'] = daily_20130804_tscode_list
for table_name in daily_20130804.columns.values.tolist():
    daily_20130804_addname_dataframe[table_name] = daily_20130804[table_name]
print("daily_20130804 返回数据 row 行数 = "+str(daily_20130804.shape[0]))
daily_20130804_addname_dataframe.to_excel(daily_201308_excel_writer,'4_7',index=False)
daily_201308_excel_writer.save()
daily_20130805 = pro.daily(start_date='',end_date='',trade_date='20130805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130805_tscode_list = list() 
for ts_code_sh in daily_20130805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130805_tscode_list.append(stock_name)
daily_20130805_addname_dataframe=pd.DataFrame()
daily_20130805_addname_dataframe['cname'] = daily_20130805_tscode_list
for table_name in daily_20130805.columns.values.tolist():
    daily_20130805_addname_dataframe[table_name] = daily_20130805[table_name]
print("daily_20130805 返回数据 row 行数 = "+str(daily_20130805.shape[0]))
daily_20130805_addname_dataframe.to_excel(daily_201308_excel_writer,'5_1',index=False)
daily_201308_excel_writer.save()
daily_20130806 = pro.daily(start_date='',end_date='',trade_date='20130806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130806_tscode_list = list() 
for ts_code_sh in daily_20130806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130806_tscode_list.append(stock_name)
daily_20130806_addname_dataframe=pd.DataFrame()
daily_20130806_addname_dataframe['cname'] = daily_20130806_tscode_list
for table_name in daily_20130806.columns.values.tolist():
    daily_20130806_addname_dataframe[table_name] = daily_20130806[table_name]
print("daily_20130806 返回数据 row 行数 = "+str(daily_20130806.shape[0]))
daily_20130806_addname_dataframe.to_excel(daily_201308_excel_writer,'6_2',index=False)
daily_201308_excel_writer.save()
daily_20130807 = pro.daily(start_date='',end_date='',trade_date='20130807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130807_tscode_list = list() 
for ts_code_sh in daily_20130807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130807_tscode_list.append(stock_name)
daily_20130807_addname_dataframe=pd.DataFrame()
daily_20130807_addname_dataframe['cname'] = daily_20130807_tscode_list
for table_name in daily_20130807.columns.values.tolist():
    daily_20130807_addname_dataframe[table_name] = daily_20130807[table_name]
print("daily_20130807 返回数据 row 行数 = "+str(daily_20130807.shape[0]))
daily_20130807_addname_dataframe.to_excel(daily_201308_excel_writer,'7_3',index=False)
daily_201308_excel_writer.save()
daily_20130808 = pro.daily(start_date='',end_date='',trade_date='20130808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130808_tscode_list = list() 
for ts_code_sh in daily_20130808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130808_tscode_list.append(stock_name)
daily_20130808_addname_dataframe=pd.DataFrame()
daily_20130808_addname_dataframe['cname'] = daily_20130808_tscode_list
for table_name in daily_20130808.columns.values.tolist():
    daily_20130808_addname_dataframe[table_name] = daily_20130808[table_name]
print("daily_20130808 返回数据 row 行数 = "+str(daily_20130808.shape[0]))
daily_20130808_addname_dataframe.to_excel(daily_201308_excel_writer,'8_4',index=False)
daily_201308_excel_writer.save()
daily_20130809 = pro.daily(start_date='',end_date='',trade_date='20130809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130809_tscode_list = list() 
for ts_code_sh in daily_20130809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130809_tscode_list.append(stock_name)
daily_20130809_addname_dataframe=pd.DataFrame()
daily_20130809_addname_dataframe['cname'] = daily_20130809_tscode_list
for table_name in daily_20130809.columns.values.tolist():
    daily_20130809_addname_dataframe[table_name] = daily_20130809[table_name]
print("daily_20130809 返回数据 row 行数 = "+str(daily_20130809.shape[0]))
daily_20130809_addname_dataframe.to_excel(daily_201308_excel_writer,'9_5',index=False)
daily_201308_excel_writer.save()
daily_20130810 = pro.daily(start_date='',end_date='',trade_date='20130810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130810_tscode_list = list() 
for ts_code_sh in daily_20130810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130810_tscode_list.append(stock_name)
daily_20130810_addname_dataframe=pd.DataFrame()
daily_20130810_addname_dataframe['cname'] = daily_20130810_tscode_list
for table_name in daily_20130810.columns.values.tolist():
    daily_20130810_addname_dataframe[table_name] = daily_20130810[table_name]
print("daily_20130810 返回数据 row 行数 = "+str(daily_20130810.shape[0]))
daily_20130810_addname_dataframe.to_excel(daily_201308_excel_writer,'10_6',index=False)
daily_201308_excel_writer.save()
daily_20130811 = pro.daily(start_date='',end_date='',trade_date='20130811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130811_tscode_list = list() 
for ts_code_sh in daily_20130811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130811_tscode_list.append(stock_name)
daily_20130811_addname_dataframe=pd.DataFrame()
daily_20130811_addname_dataframe['cname'] = daily_20130811_tscode_list
for table_name in daily_20130811.columns.values.tolist():
    daily_20130811_addname_dataframe[table_name] = daily_20130811[table_name]
print("daily_20130811 返回数据 row 行数 = "+str(daily_20130811.shape[0]))
daily_20130811_addname_dataframe.to_excel(daily_201308_excel_writer,'11_7',index=False)
daily_201308_excel_writer.save()
daily_20130812 = pro.daily(start_date='',end_date='',trade_date='20130812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130812_tscode_list = list() 
for ts_code_sh in daily_20130812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130812_tscode_list.append(stock_name)
daily_20130812_addname_dataframe=pd.DataFrame()
daily_20130812_addname_dataframe['cname'] = daily_20130812_tscode_list
for table_name in daily_20130812.columns.values.tolist():
    daily_20130812_addname_dataframe[table_name] = daily_20130812[table_name]
print("daily_20130812 返回数据 row 行数 = "+str(daily_20130812.shape[0]))
daily_20130812_addname_dataframe.to_excel(daily_201308_excel_writer,'12_1',index=False)
daily_201308_excel_writer.save()
daily_20130813 = pro.daily(start_date='',end_date='',trade_date='20130813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130813_tscode_list = list() 
for ts_code_sh in daily_20130813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130813_tscode_list.append(stock_name)
daily_20130813_addname_dataframe=pd.DataFrame()
daily_20130813_addname_dataframe['cname'] = daily_20130813_tscode_list
for table_name in daily_20130813.columns.values.tolist():
    daily_20130813_addname_dataframe[table_name] = daily_20130813[table_name]
print("daily_20130813 返回数据 row 行数 = "+str(daily_20130813.shape[0]))
daily_20130813_addname_dataframe.to_excel(daily_201308_excel_writer,'13_2',index=False)
daily_201308_excel_writer.save()
daily_20130814 = pro.daily(start_date='',end_date='',trade_date='20130814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130814_tscode_list = list() 
for ts_code_sh in daily_20130814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130814_tscode_list.append(stock_name)
daily_20130814_addname_dataframe=pd.DataFrame()
daily_20130814_addname_dataframe['cname'] = daily_20130814_tscode_list
for table_name in daily_20130814.columns.values.tolist():
    daily_20130814_addname_dataframe[table_name] = daily_20130814[table_name]
print("daily_20130814 返回数据 row 行数 = "+str(daily_20130814.shape[0]))
daily_20130814_addname_dataframe.to_excel(daily_201308_excel_writer,'14_3',index=False)
daily_201308_excel_writer.save()
daily_20130815 = pro.daily(start_date='',end_date='',trade_date='20130815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130815_tscode_list = list() 
for ts_code_sh in daily_20130815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130815_tscode_list.append(stock_name)
daily_20130815_addname_dataframe=pd.DataFrame()
daily_20130815_addname_dataframe['cname'] = daily_20130815_tscode_list
for table_name in daily_20130815.columns.values.tolist():
    daily_20130815_addname_dataframe[table_name] = daily_20130815[table_name]
print("daily_20130815 返回数据 row 行数 = "+str(daily_20130815.shape[0]))
daily_20130815_addname_dataframe.to_excel(daily_201308_excel_writer,'15_4',index=False)
daily_201308_excel_writer.save()
daily_20130816 = pro.daily(start_date='',end_date='',trade_date='20130816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130816_tscode_list = list() 
for ts_code_sh in daily_20130816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130816_tscode_list.append(stock_name)
daily_20130816_addname_dataframe=pd.DataFrame()
daily_20130816_addname_dataframe['cname'] = daily_20130816_tscode_list
for table_name in daily_20130816.columns.values.tolist():
    daily_20130816_addname_dataframe[table_name] = daily_20130816[table_name]
print("daily_20130816 返回数据 row 行数 = "+str(daily_20130816.shape[0]))
daily_20130816_addname_dataframe.to_excel(daily_201308_excel_writer,'16_5',index=False)
daily_201308_excel_writer.save()
daily_20130817 = pro.daily(start_date='',end_date='',trade_date='20130817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130817_tscode_list = list() 
for ts_code_sh in daily_20130817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130817_tscode_list.append(stock_name)
daily_20130817_addname_dataframe=pd.DataFrame()
daily_20130817_addname_dataframe['cname'] = daily_20130817_tscode_list
for table_name in daily_20130817.columns.values.tolist():
    daily_20130817_addname_dataframe[table_name] = daily_20130817[table_name]
print("daily_20130817 返回数据 row 行数 = "+str(daily_20130817.shape[0]))
daily_20130817_addname_dataframe.to_excel(daily_201308_excel_writer,'17_6',index=False)
daily_201308_excel_writer.save()
daily_20130818 = pro.daily(start_date='',end_date='',trade_date='20130818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130818_tscode_list = list() 
for ts_code_sh in daily_20130818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130818_tscode_list.append(stock_name)
daily_20130818_addname_dataframe=pd.DataFrame()
daily_20130818_addname_dataframe['cname'] = daily_20130818_tscode_list
for table_name in daily_20130818.columns.values.tolist():
    daily_20130818_addname_dataframe[table_name] = daily_20130818[table_name]
print("daily_20130818 返回数据 row 行数 = "+str(daily_20130818.shape[0]))
daily_20130818_addname_dataframe.to_excel(daily_201308_excel_writer,'18_7',index=False)
daily_201308_excel_writer.save()
daily_20130819 = pro.daily(start_date='',end_date='',trade_date='20130819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130819_tscode_list = list() 
for ts_code_sh in daily_20130819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130819_tscode_list.append(stock_name)
daily_20130819_addname_dataframe=pd.DataFrame()
daily_20130819_addname_dataframe['cname'] = daily_20130819_tscode_list
for table_name in daily_20130819.columns.values.tolist():
    daily_20130819_addname_dataframe[table_name] = daily_20130819[table_name]
print("daily_20130819 返回数据 row 行数 = "+str(daily_20130819.shape[0]))
daily_20130819_addname_dataframe.to_excel(daily_201308_excel_writer,'19_1',index=False)
daily_201308_excel_writer.save()
daily_20130820 = pro.daily(start_date='',end_date='',trade_date='20130820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130820_tscode_list = list() 
for ts_code_sh in daily_20130820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130820_tscode_list.append(stock_name)
daily_20130820_addname_dataframe=pd.DataFrame()
daily_20130820_addname_dataframe['cname'] = daily_20130820_tscode_list
for table_name in daily_20130820.columns.values.tolist():
    daily_20130820_addname_dataframe[table_name] = daily_20130820[table_name]
print("daily_20130820 返回数据 row 行数 = "+str(daily_20130820.shape[0]))
daily_20130820_addname_dataframe.to_excel(daily_201308_excel_writer,'20_2',index=False)
daily_201308_excel_writer.save()
daily_20130821 = pro.daily(start_date='',end_date='',trade_date='20130821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130821_tscode_list = list() 
for ts_code_sh in daily_20130821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130821_tscode_list.append(stock_name)
daily_20130821_addname_dataframe=pd.DataFrame()
daily_20130821_addname_dataframe['cname'] = daily_20130821_tscode_list
for table_name in daily_20130821.columns.values.tolist():
    daily_20130821_addname_dataframe[table_name] = daily_20130821[table_name]
print("daily_20130821 返回数据 row 行数 = "+str(daily_20130821.shape[0]))
daily_20130821_addname_dataframe.to_excel(daily_201308_excel_writer,'21_3',index=False)
daily_201308_excel_writer.save()
daily_20130822 = pro.daily(start_date='',end_date='',trade_date='20130822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130822_tscode_list = list() 
for ts_code_sh in daily_20130822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130822_tscode_list.append(stock_name)
daily_20130822_addname_dataframe=pd.DataFrame()
daily_20130822_addname_dataframe['cname'] = daily_20130822_tscode_list
for table_name in daily_20130822.columns.values.tolist():
    daily_20130822_addname_dataframe[table_name] = daily_20130822[table_name]
print("daily_20130822 返回数据 row 行数 = "+str(daily_20130822.shape[0]))
daily_20130822_addname_dataframe.to_excel(daily_201308_excel_writer,'22_4',index=False)
daily_201308_excel_writer.save()
daily_20130823 = pro.daily(start_date='',end_date='',trade_date='20130823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130823_tscode_list = list() 
for ts_code_sh in daily_20130823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130823_tscode_list.append(stock_name)
daily_20130823_addname_dataframe=pd.DataFrame()
daily_20130823_addname_dataframe['cname'] = daily_20130823_tscode_list
for table_name in daily_20130823.columns.values.tolist():
    daily_20130823_addname_dataframe[table_name] = daily_20130823[table_name]
print("daily_20130823 返回数据 row 行数 = "+str(daily_20130823.shape[0]))
daily_20130823_addname_dataframe.to_excel(daily_201308_excel_writer,'23_5',index=False)
daily_201308_excel_writer.save()
daily_20130824 = pro.daily(start_date='',end_date='',trade_date='20130824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130824_tscode_list = list() 
for ts_code_sh in daily_20130824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130824_tscode_list.append(stock_name)
daily_20130824_addname_dataframe=pd.DataFrame()
daily_20130824_addname_dataframe['cname'] = daily_20130824_tscode_list
for table_name in daily_20130824.columns.values.tolist():
    daily_20130824_addname_dataframe[table_name] = daily_20130824[table_name]
print("daily_20130824 返回数据 row 行数 = "+str(daily_20130824.shape[0]))
daily_20130824_addname_dataframe.to_excel(daily_201308_excel_writer,'24_6',index=False)
daily_201308_excel_writer.save()
daily_20130825 = pro.daily(start_date='',end_date='',trade_date='20130825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130825_tscode_list = list() 
for ts_code_sh in daily_20130825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130825_tscode_list.append(stock_name)
daily_20130825_addname_dataframe=pd.DataFrame()
daily_20130825_addname_dataframe['cname'] = daily_20130825_tscode_list
for table_name in daily_20130825.columns.values.tolist():
    daily_20130825_addname_dataframe[table_name] = daily_20130825[table_name]
print("daily_20130825 返回数据 row 行数 = "+str(daily_20130825.shape[0]))
daily_20130825_addname_dataframe.to_excel(daily_201308_excel_writer,'25_7',index=False)
daily_201308_excel_writer.save()
daily_20130826 = pro.daily(start_date='',end_date='',trade_date='20130826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130826_tscode_list = list() 
for ts_code_sh in daily_20130826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130826_tscode_list.append(stock_name)
daily_20130826_addname_dataframe=pd.DataFrame()
daily_20130826_addname_dataframe['cname'] = daily_20130826_tscode_list
for table_name in daily_20130826.columns.values.tolist():
    daily_20130826_addname_dataframe[table_name] = daily_20130826[table_name]
print("daily_20130826 返回数据 row 行数 = "+str(daily_20130826.shape[0]))
daily_20130826_addname_dataframe.to_excel(daily_201308_excel_writer,'26_1',index=False)
daily_201308_excel_writer.save()
daily_20130827 = pro.daily(start_date='',end_date='',trade_date='20130827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130827_tscode_list = list() 
for ts_code_sh in daily_20130827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130827_tscode_list.append(stock_name)
daily_20130827_addname_dataframe=pd.DataFrame()
daily_20130827_addname_dataframe['cname'] = daily_20130827_tscode_list
for table_name in daily_20130827.columns.values.tolist():
    daily_20130827_addname_dataframe[table_name] = daily_20130827[table_name]
print("daily_20130827 返回数据 row 行数 = "+str(daily_20130827.shape[0]))
daily_20130827_addname_dataframe.to_excel(daily_201308_excel_writer,'27_2',index=False)
daily_201308_excel_writer.save()
daily_20130828 = pro.daily(start_date='',end_date='',trade_date='20130828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130828_tscode_list = list() 
for ts_code_sh in daily_20130828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130828_tscode_list.append(stock_name)
daily_20130828_addname_dataframe=pd.DataFrame()
daily_20130828_addname_dataframe['cname'] = daily_20130828_tscode_list
for table_name in daily_20130828.columns.values.tolist():
    daily_20130828_addname_dataframe[table_name] = daily_20130828[table_name]
print("daily_20130828 返回数据 row 行数 = "+str(daily_20130828.shape[0]))
daily_20130828_addname_dataframe.to_excel(daily_201308_excel_writer,'28_3',index=False)
daily_201308_excel_writer.save()
daily_20130829 = pro.daily(start_date='',end_date='',trade_date='20130829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130829_tscode_list = list() 
for ts_code_sh in daily_20130829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130829_tscode_list.append(stock_name)
daily_20130829_addname_dataframe=pd.DataFrame()
daily_20130829_addname_dataframe['cname'] = daily_20130829_tscode_list
for table_name in daily_20130829.columns.values.tolist():
    daily_20130829_addname_dataframe[table_name] = daily_20130829[table_name]
print("daily_20130829 返回数据 row 行数 = "+str(daily_20130829.shape[0]))
daily_20130829_addname_dataframe.to_excel(daily_201308_excel_writer,'29_4',index=False)
daily_201308_excel_writer.save()
daily_20130830 = pro.daily(start_date='',end_date='',trade_date='20130830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130830_tscode_list = list() 
for ts_code_sh in daily_20130830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130830_tscode_list.append(stock_name)
daily_20130830_addname_dataframe=pd.DataFrame()
daily_20130830_addname_dataframe['cname'] = daily_20130830_tscode_list
for table_name in daily_20130830.columns.values.tolist():
    daily_20130830_addname_dataframe[table_name] = daily_20130830[table_name]
print("daily_20130830 返回数据 row 行数 = "+str(daily_20130830.shape[0]))
daily_20130830_addname_dataframe.to_excel(daily_201308_excel_writer,'30_5',index=False)
daily_201308_excel_writer.save()
daily_20130831 = pro.daily(start_date='',end_date='',trade_date='20130831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130831_tscode_list = list() 
for ts_code_sh in daily_20130831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130831_tscode_list.append(stock_name)
daily_20130831_addname_dataframe=pd.DataFrame()
daily_20130831_addname_dataframe['cname'] = daily_20130831_tscode_list
for table_name in daily_20130831.columns.values.tolist():
    daily_20130831_addname_dataframe[table_name] = daily_20130831[table_name]
print("daily_20130831 返回数据 row 行数 = "+str(daily_20130831.shape[0]))
daily_20130831_addname_dataframe.to_excel(daily_201308_excel_writer,'31_6',index=False)
daily_201308_excel_writer.save()




createexcel('daily_201309.xlsx')
daily_201309_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201309.xlsx')
daily_201309_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201309.xlsx', engine='openpyxl')
daily_201309_excel_writer.book = daily_201309_book
daily_201309_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201309_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130901")       ###  更新 记录日期
daily_20130901 = pro.daily(start_date='',end_date='',trade_date='20130901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130901_tscode_list = list() 
for ts_code_sh in daily_20130901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130901_tscode_list.append(stock_name)
daily_20130901_addname_dataframe=pd.DataFrame()
daily_20130901_addname_dataframe['cname'] = daily_20130901_tscode_list
for table_name in daily_20130901.columns.values.tolist():
    daily_20130901_addname_dataframe[table_name] = daily_20130901[table_name]
print("daily_20130901 返回数据 row 行数 = "+str(daily_20130901.shape[0]))
daily_20130901_addname_dataframe.to_excel(daily_201309_excel_writer,'1_7',index=False)
daily_201309_excel_writer.save()
daily_20130902 = pro.daily(start_date='',end_date='',trade_date='20130902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130902_tscode_list = list() 
for ts_code_sh in daily_20130902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130902_tscode_list.append(stock_name)
daily_20130902_addname_dataframe=pd.DataFrame()
daily_20130902_addname_dataframe['cname'] = daily_20130902_tscode_list
for table_name in daily_20130902.columns.values.tolist():
    daily_20130902_addname_dataframe[table_name] = daily_20130902[table_name]
print("daily_20130902 返回数据 row 行数 = "+str(daily_20130902.shape[0]))
daily_20130902_addname_dataframe.to_excel(daily_201309_excel_writer,'2_1',index=False)
daily_201309_excel_writer.save()
daily_20130903 = pro.daily(start_date='',end_date='',trade_date='20130903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130903_tscode_list = list() 
for ts_code_sh in daily_20130903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130903_tscode_list.append(stock_name)
daily_20130903_addname_dataframe=pd.DataFrame()
daily_20130903_addname_dataframe['cname'] = daily_20130903_tscode_list
for table_name in daily_20130903.columns.values.tolist():
    daily_20130903_addname_dataframe[table_name] = daily_20130903[table_name]
print("daily_20130903 返回数据 row 行数 = "+str(daily_20130903.shape[0]))
daily_20130903_addname_dataframe.to_excel(daily_201309_excel_writer,'3_2',index=False)
daily_201309_excel_writer.save()
daily_20130904 = pro.daily(start_date='',end_date='',trade_date='20130904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130904_tscode_list = list() 
for ts_code_sh in daily_20130904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130904_tscode_list.append(stock_name)
daily_20130904_addname_dataframe=pd.DataFrame()
daily_20130904_addname_dataframe['cname'] = daily_20130904_tscode_list
for table_name in daily_20130904.columns.values.tolist():
    daily_20130904_addname_dataframe[table_name] = daily_20130904[table_name]
print("daily_20130904 返回数据 row 行数 = "+str(daily_20130904.shape[0]))
daily_20130904_addname_dataframe.to_excel(daily_201309_excel_writer,'4_3',index=False)
daily_201309_excel_writer.save()
daily_20130905 = pro.daily(start_date='',end_date='',trade_date='20130905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130905_tscode_list = list() 
for ts_code_sh in daily_20130905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130905_tscode_list.append(stock_name)
daily_20130905_addname_dataframe=pd.DataFrame()
daily_20130905_addname_dataframe['cname'] = daily_20130905_tscode_list
for table_name in daily_20130905.columns.values.tolist():
    daily_20130905_addname_dataframe[table_name] = daily_20130905[table_name]
print("daily_20130905 返回数据 row 行数 = "+str(daily_20130905.shape[0]))
daily_20130905_addname_dataframe.to_excel(daily_201309_excel_writer,'5_4',index=False)
daily_201309_excel_writer.save()
daily_20130906 = pro.daily(start_date='',end_date='',trade_date='20130906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130906_tscode_list = list() 
for ts_code_sh in daily_20130906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130906_tscode_list.append(stock_name)
daily_20130906_addname_dataframe=pd.DataFrame()
daily_20130906_addname_dataframe['cname'] = daily_20130906_tscode_list
for table_name in daily_20130906.columns.values.tolist():
    daily_20130906_addname_dataframe[table_name] = daily_20130906[table_name]
print("daily_20130906 返回数据 row 行数 = "+str(daily_20130906.shape[0]))
daily_20130906_addname_dataframe.to_excel(daily_201309_excel_writer,'6_5',index=False)
daily_201309_excel_writer.save()
daily_20130907 = pro.daily(start_date='',end_date='',trade_date='20130907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130907_tscode_list = list() 
for ts_code_sh in daily_20130907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130907_tscode_list.append(stock_name)
daily_20130907_addname_dataframe=pd.DataFrame()
daily_20130907_addname_dataframe['cname'] = daily_20130907_tscode_list
for table_name in daily_20130907.columns.values.tolist():
    daily_20130907_addname_dataframe[table_name] = daily_20130907[table_name]
print("daily_20130907 返回数据 row 行数 = "+str(daily_20130907.shape[0]))
daily_20130907_addname_dataframe.to_excel(daily_201309_excel_writer,'7_6',index=False)
daily_201309_excel_writer.save()
daily_20130908 = pro.daily(start_date='',end_date='',trade_date='20130908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130908_tscode_list = list() 
for ts_code_sh in daily_20130908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130908_tscode_list.append(stock_name)
daily_20130908_addname_dataframe=pd.DataFrame()
daily_20130908_addname_dataframe['cname'] = daily_20130908_tscode_list
for table_name in daily_20130908.columns.values.tolist():
    daily_20130908_addname_dataframe[table_name] = daily_20130908[table_name]
print("daily_20130908 返回数据 row 行数 = "+str(daily_20130908.shape[0]))
daily_20130908_addname_dataframe.to_excel(daily_201309_excel_writer,'8_7',index=False)
daily_201309_excel_writer.save()
daily_20130909 = pro.daily(start_date='',end_date='',trade_date='20130909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130909_tscode_list = list() 
for ts_code_sh in daily_20130909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130909_tscode_list.append(stock_name)
daily_20130909_addname_dataframe=pd.DataFrame()
daily_20130909_addname_dataframe['cname'] = daily_20130909_tscode_list
for table_name in daily_20130909.columns.values.tolist():
    daily_20130909_addname_dataframe[table_name] = daily_20130909[table_name]
print("daily_20130909 返回数据 row 行数 = "+str(daily_20130909.shape[0]))
daily_20130909_addname_dataframe.to_excel(daily_201309_excel_writer,'9_1',index=False)
daily_201309_excel_writer.save()
daily_20130910 = pro.daily(start_date='',end_date='',trade_date='20130910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130910_tscode_list = list() 
for ts_code_sh in daily_20130910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130910_tscode_list.append(stock_name)
daily_20130910_addname_dataframe=pd.DataFrame()
daily_20130910_addname_dataframe['cname'] = daily_20130910_tscode_list
for table_name in daily_20130910.columns.values.tolist():
    daily_20130910_addname_dataframe[table_name] = daily_20130910[table_name]
print("daily_20130910 返回数据 row 行数 = "+str(daily_20130910.shape[0]))
daily_20130910_addname_dataframe.to_excel(daily_201309_excel_writer,'10_2',index=False)
daily_201309_excel_writer.save()
daily_20130911 = pro.daily(start_date='',end_date='',trade_date='20130911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130911_tscode_list = list() 
for ts_code_sh in daily_20130911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130911_tscode_list.append(stock_name)
daily_20130911_addname_dataframe=pd.DataFrame()
daily_20130911_addname_dataframe['cname'] = daily_20130911_tscode_list
for table_name in daily_20130911.columns.values.tolist():
    daily_20130911_addname_dataframe[table_name] = daily_20130911[table_name]
print("daily_20130911 返回数据 row 行数 = "+str(daily_20130911.shape[0]))
daily_20130911_addname_dataframe.to_excel(daily_201309_excel_writer,'11_3',index=False)
daily_201309_excel_writer.save()
daily_20130912 = pro.daily(start_date='',end_date='',trade_date='20130912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130912_tscode_list = list() 
for ts_code_sh in daily_20130912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130912_tscode_list.append(stock_name)
daily_20130912_addname_dataframe=pd.DataFrame()
daily_20130912_addname_dataframe['cname'] = daily_20130912_tscode_list
for table_name in daily_20130912.columns.values.tolist():
    daily_20130912_addname_dataframe[table_name] = daily_20130912[table_name]
print("daily_20130912 返回数据 row 行数 = "+str(daily_20130912.shape[0]))
daily_20130912_addname_dataframe.to_excel(daily_201309_excel_writer,'12_4',index=False)
daily_201309_excel_writer.save()
daily_20130913 = pro.daily(start_date='',end_date='',trade_date='20130913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130913_tscode_list = list() 
for ts_code_sh in daily_20130913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130913_tscode_list.append(stock_name)
daily_20130913_addname_dataframe=pd.DataFrame()
daily_20130913_addname_dataframe['cname'] = daily_20130913_tscode_list
for table_name in daily_20130913.columns.values.tolist():
    daily_20130913_addname_dataframe[table_name] = daily_20130913[table_name]
print("daily_20130913 返回数据 row 行数 = "+str(daily_20130913.shape[0]))
daily_20130913_addname_dataframe.to_excel(daily_201309_excel_writer,'13_5',index=False)
daily_201309_excel_writer.save()
daily_20130914 = pro.daily(start_date='',end_date='',trade_date='20130914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130914_tscode_list = list() 
for ts_code_sh in daily_20130914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130914_tscode_list.append(stock_name)
daily_20130914_addname_dataframe=pd.DataFrame()
daily_20130914_addname_dataframe['cname'] = daily_20130914_tscode_list
for table_name in daily_20130914.columns.values.tolist():
    daily_20130914_addname_dataframe[table_name] = daily_20130914[table_name]
print("daily_20130914 返回数据 row 行数 = "+str(daily_20130914.shape[0]))
daily_20130914_addname_dataframe.to_excel(daily_201309_excel_writer,'14_6',index=False)
daily_201309_excel_writer.save()
daily_20130915 = pro.daily(start_date='',end_date='',trade_date='20130915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130915_tscode_list = list() 
for ts_code_sh in daily_20130915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130915_tscode_list.append(stock_name)
daily_20130915_addname_dataframe=pd.DataFrame()
daily_20130915_addname_dataframe['cname'] = daily_20130915_tscode_list
for table_name in daily_20130915.columns.values.tolist():
    daily_20130915_addname_dataframe[table_name] = daily_20130915[table_name]
print("daily_20130915 返回数据 row 行数 = "+str(daily_20130915.shape[0]))
daily_20130915_addname_dataframe.to_excel(daily_201309_excel_writer,'15_7',index=False)
daily_201309_excel_writer.save()
daily_20130916 = pro.daily(start_date='',end_date='',trade_date='20130916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130916_tscode_list = list() 
for ts_code_sh in daily_20130916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130916_tscode_list.append(stock_name)
daily_20130916_addname_dataframe=pd.DataFrame()
daily_20130916_addname_dataframe['cname'] = daily_20130916_tscode_list
for table_name in daily_20130916.columns.values.tolist():
    daily_20130916_addname_dataframe[table_name] = daily_20130916[table_name]
print("daily_20130916 返回数据 row 行数 = "+str(daily_20130916.shape[0]))
daily_20130916_addname_dataframe.to_excel(daily_201309_excel_writer,'16_1',index=False)
daily_201309_excel_writer.save()
daily_20130917 = pro.daily(start_date='',end_date='',trade_date='20130917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130917_tscode_list = list() 
for ts_code_sh in daily_20130917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130917_tscode_list.append(stock_name)
daily_20130917_addname_dataframe=pd.DataFrame()
daily_20130917_addname_dataframe['cname'] = daily_20130917_tscode_list
for table_name in daily_20130917.columns.values.tolist():
    daily_20130917_addname_dataframe[table_name] = daily_20130917[table_name]
print("daily_20130917 返回数据 row 行数 = "+str(daily_20130917.shape[0]))
daily_20130917_addname_dataframe.to_excel(daily_201309_excel_writer,'17_2',index=False)
daily_201309_excel_writer.save()
daily_20130918 = pro.daily(start_date='',end_date='',trade_date='20130918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130918_tscode_list = list() 
for ts_code_sh in daily_20130918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130918_tscode_list.append(stock_name)
daily_20130918_addname_dataframe=pd.DataFrame()
daily_20130918_addname_dataframe['cname'] = daily_20130918_tscode_list
for table_name in daily_20130918.columns.values.tolist():
    daily_20130918_addname_dataframe[table_name] = daily_20130918[table_name]
print("daily_20130918 返回数据 row 行数 = "+str(daily_20130918.shape[0]))
daily_20130918_addname_dataframe.to_excel(daily_201309_excel_writer,'18_3',index=False)
daily_201309_excel_writer.save()
daily_20130919 = pro.daily(start_date='',end_date='',trade_date='20130919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130919_tscode_list = list() 
for ts_code_sh in daily_20130919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130919_tscode_list.append(stock_name)
daily_20130919_addname_dataframe=pd.DataFrame()
daily_20130919_addname_dataframe['cname'] = daily_20130919_tscode_list
for table_name in daily_20130919.columns.values.tolist():
    daily_20130919_addname_dataframe[table_name] = daily_20130919[table_name]
print("daily_20130919 返回数据 row 行数 = "+str(daily_20130919.shape[0]))
daily_20130919_addname_dataframe.to_excel(daily_201309_excel_writer,'19_4',index=False)
daily_201309_excel_writer.save()
daily_20130920 = pro.daily(start_date='',end_date='',trade_date='20130920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130920_tscode_list = list() 
for ts_code_sh in daily_20130920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130920_tscode_list.append(stock_name)
daily_20130920_addname_dataframe=pd.DataFrame()
daily_20130920_addname_dataframe['cname'] = daily_20130920_tscode_list
for table_name in daily_20130920.columns.values.tolist():
    daily_20130920_addname_dataframe[table_name] = daily_20130920[table_name]
print("daily_20130920 返回数据 row 行数 = "+str(daily_20130920.shape[0]))
daily_20130920_addname_dataframe.to_excel(daily_201309_excel_writer,'20_5',index=False)
daily_201309_excel_writer.save()
daily_20130921 = pro.daily(start_date='',end_date='',trade_date='20130921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130921_tscode_list = list() 
for ts_code_sh in daily_20130921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130921_tscode_list.append(stock_name)
daily_20130921_addname_dataframe=pd.DataFrame()
daily_20130921_addname_dataframe['cname'] = daily_20130921_tscode_list
for table_name in daily_20130921.columns.values.tolist():
    daily_20130921_addname_dataframe[table_name] = daily_20130921[table_name]
print("daily_20130921 返回数据 row 行数 = "+str(daily_20130921.shape[0]))
daily_20130921_addname_dataframe.to_excel(daily_201309_excel_writer,'21_6',index=False)
daily_201309_excel_writer.save()
daily_20130922 = pro.daily(start_date='',end_date='',trade_date='20130922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130922_tscode_list = list() 
for ts_code_sh in daily_20130922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130922_tscode_list.append(stock_name)
daily_20130922_addname_dataframe=pd.DataFrame()
daily_20130922_addname_dataframe['cname'] = daily_20130922_tscode_list
for table_name in daily_20130922.columns.values.tolist():
    daily_20130922_addname_dataframe[table_name] = daily_20130922[table_name]
print("daily_20130922 返回数据 row 行数 = "+str(daily_20130922.shape[0]))
daily_20130922_addname_dataframe.to_excel(daily_201309_excel_writer,'22_7',index=False)
daily_201309_excel_writer.save()
daily_20130923 = pro.daily(start_date='',end_date='',trade_date='20130923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130923_tscode_list = list() 
for ts_code_sh in daily_20130923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130923_tscode_list.append(stock_name)
daily_20130923_addname_dataframe=pd.DataFrame()
daily_20130923_addname_dataframe['cname'] = daily_20130923_tscode_list
for table_name in daily_20130923.columns.values.tolist():
    daily_20130923_addname_dataframe[table_name] = daily_20130923[table_name]
print("daily_20130923 返回数据 row 行数 = "+str(daily_20130923.shape[0]))
daily_20130923_addname_dataframe.to_excel(daily_201309_excel_writer,'23_1',index=False)
daily_201309_excel_writer.save()
daily_20130924 = pro.daily(start_date='',end_date='',trade_date='20130924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130924_tscode_list = list() 
for ts_code_sh in daily_20130924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130924_tscode_list.append(stock_name)
daily_20130924_addname_dataframe=pd.DataFrame()
daily_20130924_addname_dataframe['cname'] = daily_20130924_tscode_list
for table_name in daily_20130924.columns.values.tolist():
    daily_20130924_addname_dataframe[table_name] = daily_20130924[table_name]
print("daily_20130924 返回数据 row 行数 = "+str(daily_20130924.shape[0]))
daily_20130924_addname_dataframe.to_excel(daily_201309_excel_writer,'24_2',index=False)
daily_201309_excel_writer.save()
daily_20130925 = pro.daily(start_date='',end_date='',trade_date='20130925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130925_tscode_list = list() 
for ts_code_sh in daily_20130925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130925_tscode_list.append(stock_name)
daily_20130925_addname_dataframe=pd.DataFrame()
daily_20130925_addname_dataframe['cname'] = daily_20130925_tscode_list
for table_name in daily_20130925.columns.values.tolist():
    daily_20130925_addname_dataframe[table_name] = daily_20130925[table_name]
print("daily_20130925 返回数据 row 行数 = "+str(daily_20130925.shape[0]))
daily_20130925_addname_dataframe.to_excel(daily_201309_excel_writer,'25_3',index=False)
daily_201309_excel_writer.save()
daily_20130926 = pro.daily(start_date='',end_date='',trade_date='20130926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130926_tscode_list = list() 
for ts_code_sh in daily_20130926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130926_tscode_list.append(stock_name)
daily_20130926_addname_dataframe=pd.DataFrame()
daily_20130926_addname_dataframe['cname'] = daily_20130926_tscode_list
for table_name in daily_20130926.columns.values.tolist():
    daily_20130926_addname_dataframe[table_name] = daily_20130926[table_name]
print("daily_20130926 返回数据 row 行数 = "+str(daily_20130926.shape[0]))
daily_20130926_addname_dataframe.to_excel(daily_201309_excel_writer,'26_4',index=False)
daily_201309_excel_writer.save()
daily_20130927 = pro.daily(start_date='',end_date='',trade_date='20130927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130927_tscode_list = list() 
for ts_code_sh in daily_20130927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130927_tscode_list.append(stock_name)
daily_20130927_addname_dataframe=pd.DataFrame()
daily_20130927_addname_dataframe['cname'] = daily_20130927_tscode_list
for table_name in daily_20130927.columns.values.tolist():
    daily_20130927_addname_dataframe[table_name] = daily_20130927[table_name]
print("daily_20130927 返回数据 row 行数 = "+str(daily_20130927.shape[0]))
daily_20130927_addname_dataframe.to_excel(daily_201309_excel_writer,'27_5',index=False)
daily_201309_excel_writer.save()
daily_20130928 = pro.daily(start_date='',end_date='',trade_date='20130928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130928_tscode_list = list() 
for ts_code_sh in daily_20130928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130928_tscode_list.append(stock_name)
daily_20130928_addname_dataframe=pd.DataFrame()
daily_20130928_addname_dataframe['cname'] = daily_20130928_tscode_list
for table_name in daily_20130928.columns.values.tolist():
    daily_20130928_addname_dataframe[table_name] = daily_20130928[table_name]
print("daily_20130928 返回数据 row 行数 = "+str(daily_20130928.shape[0]))
daily_20130928_addname_dataframe.to_excel(daily_201309_excel_writer,'28_6',index=False)
daily_201309_excel_writer.save()
daily_20130929 = pro.daily(start_date='',end_date='',trade_date='20130929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130929_tscode_list = list() 
for ts_code_sh in daily_20130929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130929_tscode_list.append(stock_name)
daily_20130929_addname_dataframe=pd.DataFrame()
daily_20130929_addname_dataframe['cname'] = daily_20130929_tscode_list
for table_name in daily_20130929.columns.values.tolist():
    daily_20130929_addname_dataframe[table_name] = daily_20130929[table_name]
print("daily_20130929 返回数据 row 行数 = "+str(daily_20130929.shape[0]))
daily_20130929_addname_dataframe.to_excel(daily_201309_excel_writer,'29_7',index=False)
daily_201309_excel_writer.save()
daily_20130930 = pro.daily(start_date='',end_date='',trade_date='20130930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130930_tscode_list = list() 
for ts_code_sh in daily_20130930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130930_tscode_list.append(stock_name)
daily_20130930_addname_dataframe=pd.DataFrame()
daily_20130930_addname_dataframe['cname'] = daily_20130930_tscode_list
for table_name in daily_20130930.columns.values.tolist():
    daily_20130930_addname_dataframe[table_name] = daily_20130930[table_name]
print("daily_20130930 返回数据 row 行数 = "+str(daily_20130930.shape[0]))
daily_20130930_addname_dataframe.to_excel(daily_201309_excel_writer,'30_1',index=False)
daily_201309_excel_writer.save()




createexcel('daily_201310.xlsx')
daily_201310_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201310.xlsx')
daily_201310_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201310.xlsx', engine='openpyxl')
daily_201310_excel_writer.book = daily_201310_book
daily_201310_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201310_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20131001")       ###  更新 记录日期
daily_20131001 = pro.daily(start_date='',end_date='',trade_date='20131001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131001_tscode_list = list() 
for ts_code_sh in daily_20131001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131001_tscode_list.append(stock_name)
daily_20131001_addname_dataframe=pd.DataFrame()
daily_20131001_addname_dataframe['cname'] = daily_20131001_tscode_list
for table_name in daily_20131001.columns.values.tolist():
    daily_20131001_addname_dataframe[table_name] = daily_20131001[table_name]
print("daily_20131001 返回数据 row 行数 = "+str(daily_20131001.shape[0]))
daily_20131001_addname_dataframe.to_excel(daily_201310_excel_writer,'1_2',index=False)
daily_201310_excel_writer.save()
daily_20131002 = pro.daily(start_date='',end_date='',trade_date='20131002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131002_tscode_list = list() 
for ts_code_sh in daily_20131002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131002_tscode_list.append(stock_name)
daily_20131002_addname_dataframe=pd.DataFrame()
daily_20131002_addname_dataframe['cname'] = daily_20131002_tscode_list
for table_name in daily_20131002.columns.values.tolist():
    daily_20131002_addname_dataframe[table_name] = daily_20131002[table_name]
print("daily_20131002 返回数据 row 行数 = "+str(daily_20131002.shape[0]))
daily_20131002_addname_dataframe.to_excel(daily_201310_excel_writer,'2_3',index=False)
daily_201310_excel_writer.save()
daily_20131003 = pro.daily(start_date='',end_date='',trade_date='20131003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131003_tscode_list = list() 
for ts_code_sh in daily_20131003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131003_tscode_list.append(stock_name)
daily_20131003_addname_dataframe=pd.DataFrame()
daily_20131003_addname_dataframe['cname'] = daily_20131003_tscode_list
for table_name in daily_20131003.columns.values.tolist():
    daily_20131003_addname_dataframe[table_name] = daily_20131003[table_name]
print("daily_20131003 返回数据 row 行数 = "+str(daily_20131003.shape[0]))
daily_20131003_addname_dataframe.to_excel(daily_201310_excel_writer,'3_4',index=False)
daily_201310_excel_writer.save()
daily_20131004 = pro.daily(start_date='',end_date='',trade_date='20131004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131004_tscode_list = list() 
for ts_code_sh in daily_20131004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131004_tscode_list.append(stock_name)
daily_20131004_addname_dataframe=pd.DataFrame()
daily_20131004_addname_dataframe['cname'] = daily_20131004_tscode_list
for table_name in daily_20131004.columns.values.tolist():
    daily_20131004_addname_dataframe[table_name] = daily_20131004[table_name]
print("daily_20131004 返回数据 row 行数 = "+str(daily_20131004.shape[0]))
daily_20131004_addname_dataframe.to_excel(daily_201310_excel_writer,'4_5',index=False)
daily_201310_excel_writer.save()
daily_20131005 = pro.daily(start_date='',end_date='',trade_date='20131005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131005_tscode_list = list() 
for ts_code_sh in daily_20131005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131005_tscode_list.append(stock_name)
daily_20131005_addname_dataframe=pd.DataFrame()
daily_20131005_addname_dataframe['cname'] = daily_20131005_tscode_list
for table_name in daily_20131005.columns.values.tolist():
    daily_20131005_addname_dataframe[table_name] = daily_20131005[table_name]
print("daily_20131005 返回数据 row 行数 = "+str(daily_20131005.shape[0]))
daily_20131005_addname_dataframe.to_excel(daily_201310_excel_writer,'5_6',index=False)
daily_201310_excel_writer.save()
daily_20131006 = pro.daily(start_date='',end_date='',trade_date='20131006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131006_tscode_list = list() 
for ts_code_sh in daily_20131006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131006_tscode_list.append(stock_name)
daily_20131006_addname_dataframe=pd.DataFrame()
daily_20131006_addname_dataframe['cname'] = daily_20131006_tscode_list
for table_name in daily_20131006.columns.values.tolist():
    daily_20131006_addname_dataframe[table_name] = daily_20131006[table_name]
print("daily_20131006 返回数据 row 行数 = "+str(daily_20131006.shape[0]))
daily_20131006_addname_dataframe.to_excel(daily_201310_excel_writer,'6_7',index=False)
daily_201310_excel_writer.save()
daily_20131007 = pro.daily(start_date='',end_date='',trade_date='20131007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131007_tscode_list = list() 
for ts_code_sh in daily_20131007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131007_tscode_list.append(stock_name)
daily_20131007_addname_dataframe=pd.DataFrame()
daily_20131007_addname_dataframe['cname'] = daily_20131007_tscode_list
for table_name in daily_20131007.columns.values.tolist():
    daily_20131007_addname_dataframe[table_name] = daily_20131007[table_name]
print("daily_20131007 返回数据 row 行数 = "+str(daily_20131007.shape[0]))
daily_20131007_addname_dataframe.to_excel(daily_201310_excel_writer,'7_1',index=False)
daily_201310_excel_writer.save()
daily_20131008 = pro.daily(start_date='',end_date='',trade_date='20131008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131008_tscode_list = list() 
for ts_code_sh in daily_20131008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131008_tscode_list.append(stock_name)
daily_20131008_addname_dataframe=pd.DataFrame()
daily_20131008_addname_dataframe['cname'] = daily_20131008_tscode_list
for table_name in daily_20131008.columns.values.tolist():
    daily_20131008_addname_dataframe[table_name] = daily_20131008[table_name]
print("daily_20131008 返回数据 row 行数 = "+str(daily_20131008.shape[0]))
daily_20131008_addname_dataframe.to_excel(daily_201310_excel_writer,'8_2',index=False)
daily_201310_excel_writer.save()
daily_20131009 = pro.daily(start_date='',end_date='',trade_date='20131009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131009_tscode_list = list() 
for ts_code_sh in daily_20131009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131009_tscode_list.append(stock_name)
daily_20131009_addname_dataframe=pd.DataFrame()
daily_20131009_addname_dataframe['cname'] = daily_20131009_tscode_list
for table_name in daily_20131009.columns.values.tolist():
    daily_20131009_addname_dataframe[table_name] = daily_20131009[table_name]
print("daily_20131009 返回数据 row 行数 = "+str(daily_20131009.shape[0]))
daily_20131009_addname_dataframe.to_excel(daily_201310_excel_writer,'9_3',index=False)
daily_201310_excel_writer.save()
daily_20131010 = pro.daily(start_date='',end_date='',trade_date='20131010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131010_tscode_list = list() 
for ts_code_sh in daily_20131010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131010_tscode_list.append(stock_name)
daily_20131010_addname_dataframe=pd.DataFrame()
daily_20131010_addname_dataframe['cname'] = daily_20131010_tscode_list
for table_name in daily_20131010.columns.values.tolist():
    daily_20131010_addname_dataframe[table_name] = daily_20131010[table_name]
print("daily_20131010 返回数据 row 行数 = "+str(daily_20131010.shape[0]))
daily_20131010_addname_dataframe.to_excel(daily_201310_excel_writer,'10_4',index=False)
daily_201310_excel_writer.save()
daily_20131011 = pro.daily(start_date='',end_date='',trade_date='20131011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131011_tscode_list = list() 
for ts_code_sh in daily_20131011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131011_tscode_list.append(stock_name)
daily_20131011_addname_dataframe=pd.DataFrame()
daily_20131011_addname_dataframe['cname'] = daily_20131011_tscode_list
for table_name in daily_20131011.columns.values.tolist():
    daily_20131011_addname_dataframe[table_name] = daily_20131011[table_name]
print("daily_20131011 返回数据 row 行数 = "+str(daily_20131011.shape[0]))
daily_20131011_addname_dataframe.to_excel(daily_201310_excel_writer,'11_5',index=False)
daily_201310_excel_writer.save()
daily_20131012 = pro.daily(start_date='',end_date='',trade_date='20131012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131012_tscode_list = list() 
for ts_code_sh in daily_20131012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131012_tscode_list.append(stock_name)
daily_20131012_addname_dataframe=pd.DataFrame()
daily_20131012_addname_dataframe['cname'] = daily_20131012_tscode_list
for table_name in daily_20131012.columns.values.tolist():
    daily_20131012_addname_dataframe[table_name] = daily_20131012[table_name]
print("daily_20131012 返回数据 row 行数 = "+str(daily_20131012.shape[0]))
daily_20131012_addname_dataframe.to_excel(daily_201310_excel_writer,'12_6',index=False)
daily_201310_excel_writer.save()
daily_20131013 = pro.daily(start_date='',end_date='',trade_date='20131013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131013_tscode_list = list() 
for ts_code_sh in daily_20131013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131013_tscode_list.append(stock_name)
daily_20131013_addname_dataframe=pd.DataFrame()
daily_20131013_addname_dataframe['cname'] = daily_20131013_tscode_list
for table_name in daily_20131013.columns.values.tolist():
    daily_20131013_addname_dataframe[table_name] = daily_20131013[table_name]
print("daily_20131013 返回数据 row 行数 = "+str(daily_20131013.shape[0]))
daily_20131013_addname_dataframe.to_excel(daily_201310_excel_writer,'13_7',index=False)
daily_201310_excel_writer.save()
daily_20131014 = pro.daily(start_date='',end_date='',trade_date='20131014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131014_tscode_list = list() 
for ts_code_sh in daily_20131014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131014_tscode_list.append(stock_name)
daily_20131014_addname_dataframe=pd.DataFrame()
daily_20131014_addname_dataframe['cname'] = daily_20131014_tscode_list
for table_name in daily_20131014.columns.values.tolist():
    daily_20131014_addname_dataframe[table_name] = daily_20131014[table_name]
print("daily_20131014 返回数据 row 行数 = "+str(daily_20131014.shape[0]))
daily_20131014_addname_dataframe.to_excel(daily_201310_excel_writer,'14_1',index=False)
daily_201310_excel_writer.save()
daily_20131015 = pro.daily(start_date='',end_date='',trade_date='20131015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131015_tscode_list = list() 
for ts_code_sh in daily_20131015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131015_tscode_list.append(stock_name)
daily_20131015_addname_dataframe=pd.DataFrame()
daily_20131015_addname_dataframe['cname'] = daily_20131015_tscode_list
for table_name in daily_20131015.columns.values.tolist():
    daily_20131015_addname_dataframe[table_name] = daily_20131015[table_name]
print("daily_20131015 返回数据 row 行数 = "+str(daily_20131015.shape[0]))
daily_20131015_addname_dataframe.to_excel(daily_201310_excel_writer,'15_2',index=False)
daily_201310_excel_writer.save()
daily_20131016 = pro.daily(start_date='',end_date='',trade_date='20131016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131016_tscode_list = list() 
for ts_code_sh in daily_20131016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131016_tscode_list.append(stock_name)
daily_20131016_addname_dataframe=pd.DataFrame()
daily_20131016_addname_dataframe['cname'] = daily_20131016_tscode_list
for table_name in daily_20131016.columns.values.tolist():
    daily_20131016_addname_dataframe[table_name] = daily_20131016[table_name]
print("daily_20131016 返回数据 row 行数 = "+str(daily_20131016.shape[0]))
daily_20131016_addname_dataframe.to_excel(daily_201310_excel_writer,'16_3',index=False)
daily_201310_excel_writer.save()
daily_20131017 = pro.daily(start_date='',end_date='',trade_date='20131017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131017_tscode_list = list() 
for ts_code_sh in daily_20131017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131017_tscode_list.append(stock_name)
daily_20131017_addname_dataframe=pd.DataFrame()
daily_20131017_addname_dataframe['cname'] = daily_20131017_tscode_list
for table_name in daily_20131017.columns.values.tolist():
    daily_20131017_addname_dataframe[table_name] = daily_20131017[table_name]
print("daily_20131017 返回数据 row 行数 = "+str(daily_20131017.shape[0]))
daily_20131017_addname_dataframe.to_excel(daily_201310_excel_writer,'17_4',index=False)
daily_201310_excel_writer.save()
daily_20131018 = pro.daily(start_date='',end_date='',trade_date='20131018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131018_tscode_list = list() 
for ts_code_sh in daily_20131018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131018_tscode_list.append(stock_name)
daily_20131018_addname_dataframe=pd.DataFrame()
daily_20131018_addname_dataframe['cname'] = daily_20131018_tscode_list
for table_name in daily_20131018.columns.values.tolist():
    daily_20131018_addname_dataframe[table_name] = daily_20131018[table_name]
print("daily_20131018 返回数据 row 行数 = "+str(daily_20131018.shape[0]))
daily_20131018_addname_dataframe.to_excel(daily_201310_excel_writer,'18_5',index=False)
daily_201310_excel_writer.save()
daily_20131019 = pro.daily(start_date='',end_date='',trade_date='20131019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131019_tscode_list = list() 
for ts_code_sh in daily_20131019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131019_tscode_list.append(stock_name)
daily_20131019_addname_dataframe=pd.DataFrame()
daily_20131019_addname_dataframe['cname'] = daily_20131019_tscode_list
for table_name in daily_20131019.columns.values.tolist():
    daily_20131019_addname_dataframe[table_name] = daily_20131019[table_name]
print("daily_20131019 返回数据 row 行数 = "+str(daily_20131019.shape[0]))
daily_20131019_addname_dataframe.to_excel(daily_201310_excel_writer,'19_6',index=False)
daily_201310_excel_writer.save()
daily_20131020 = pro.daily(start_date='',end_date='',trade_date='20131020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131020_tscode_list = list() 
for ts_code_sh in daily_20131020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131020_tscode_list.append(stock_name)
daily_20131020_addname_dataframe=pd.DataFrame()
daily_20131020_addname_dataframe['cname'] = daily_20131020_tscode_list
for table_name in daily_20131020.columns.values.tolist():
    daily_20131020_addname_dataframe[table_name] = daily_20131020[table_name]
print("daily_20131020 返回数据 row 行数 = "+str(daily_20131020.shape[0]))
daily_20131020_addname_dataframe.to_excel(daily_201310_excel_writer,'20_7',index=False)
daily_201310_excel_writer.save()
daily_20131021 = pro.daily(start_date='',end_date='',trade_date='20131021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131021_tscode_list = list() 
for ts_code_sh in daily_20131021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131021_tscode_list.append(stock_name)
daily_20131021_addname_dataframe=pd.DataFrame()
daily_20131021_addname_dataframe['cname'] = daily_20131021_tscode_list
for table_name in daily_20131021.columns.values.tolist():
    daily_20131021_addname_dataframe[table_name] = daily_20131021[table_name]
print("daily_20131021 返回数据 row 行数 = "+str(daily_20131021.shape[0]))
daily_20131021_addname_dataframe.to_excel(daily_201310_excel_writer,'21_1',index=False)
daily_201310_excel_writer.save()
daily_20131022 = pro.daily(start_date='',end_date='',trade_date='20131022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131022_tscode_list = list() 
for ts_code_sh in daily_20131022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131022_tscode_list.append(stock_name)
daily_20131022_addname_dataframe=pd.DataFrame()
daily_20131022_addname_dataframe['cname'] = daily_20131022_tscode_list
for table_name in daily_20131022.columns.values.tolist():
    daily_20131022_addname_dataframe[table_name] = daily_20131022[table_name]
print("daily_20131022 返回数据 row 行数 = "+str(daily_20131022.shape[0]))
daily_20131022_addname_dataframe.to_excel(daily_201310_excel_writer,'22_2',index=False)
daily_201310_excel_writer.save()
daily_20131023 = pro.daily(start_date='',end_date='',trade_date='20131023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131023_tscode_list = list() 
for ts_code_sh in daily_20131023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131023_tscode_list.append(stock_name)
daily_20131023_addname_dataframe=pd.DataFrame()
daily_20131023_addname_dataframe['cname'] = daily_20131023_tscode_list
for table_name in daily_20131023.columns.values.tolist():
    daily_20131023_addname_dataframe[table_name] = daily_20131023[table_name]
print("daily_20131023 返回数据 row 行数 = "+str(daily_20131023.shape[0]))
daily_20131023_addname_dataframe.to_excel(daily_201310_excel_writer,'23_3',index=False)
daily_201310_excel_writer.save()
daily_20131024 = pro.daily(start_date='',end_date='',trade_date='20131024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131024_tscode_list = list() 
for ts_code_sh in daily_20131024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131024_tscode_list.append(stock_name)
daily_20131024_addname_dataframe=pd.DataFrame()
daily_20131024_addname_dataframe['cname'] = daily_20131024_tscode_list
for table_name in daily_20131024.columns.values.tolist():
    daily_20131024_addname_dataframe[table_name] = daily_20131024[table_name]
print("daily_20131024 返回数据 row 行数 = "+str(daily_20131024.shape[0]))
daily_20131024_addname_dataframe.to_excel(daily_201310_excel_writer,'24_4',index=False)
daily_201310_excel_writer.save()
daily_20131025 = pro.daily(start_date='',end_date='',trade_date='20131025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131025_tscode_list = list() 
for ts_code_sh in daily_20131025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131025_tscode_list.append(stock_name)
daily_20131025_addname_dataframe=pd.DataFrame()
daily_20131025_addname_dataframe['cname'] = daily_20131025_tscode_list
for table_name in daily_20131025.columns.values.tolist():
    daily_20131025_addname_dataframe[table_name] = daily_20131025[table_name]
print("daily_20131025 返回数据 row 行数 = "+str(daily_20131025.shape[0]))
daily_20131025_addname_dataframe.to_excel(daily_201310_excel_writer,'25_5',index=False)
daily_201310_excel_writer.save()
daily_20131026 = pro.daily(start_date='',end_date='',trade_date='20131026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131026_tscode_list = list() 
for ts_code_sh in daily_20131026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131026_tscode_list.append(stock_name)
daily_20131026_addname_dataframe=pd.DataFrame()
daily_20131026_addname_dataframe['cname'] = daily_20131026_tscode_list
for table_name in daily_20131026.columns.values.tolist():
    daily_20131026_addname_dataframe[table_name] = daily_20131026[table_name]
print("daily_20131026 返回数据 row 行数 = "+str(daily_20131026.shape[0]))
daily_20131026_addname_dataframe.to_excel(daily_201310_excel_writer,'26_6',index=False)
daily_201310_excel_writer.save()
daily_20131027 = pro.daily(start_date='',end_date='',trade_date='20131027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131027_tscode_list = list() 
for ts_code_sh in daily_20131027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131027_tscode_list.append(stock_name)
daily_20131027_addname_dataframe=pd.DataFrame()
daily_20131027_addname_dataframe['cname'] = daily_20131027_tscode_list
for table_name in daily_20131027.columns.values.tolist():
    daily_20131027_addname_dataframe[table_name] = daily_20131027[table_name]
print("daily_20131027 返回数据 row 行数 = "+str(daily_20131027.shape[0]))
daily_20131027_addname_dataframe.to_excel(daily_201310_excel_writer,'27_7',index=False)
daily_201310_excel_writer.save()
daily_20131028 = pro.daily(start_date='',end_date='',trade_date='20131028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131028_tscode_list = list() 
for ts_code_sh in daily_20131028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131028_tscode_list.append(stock_name)
daily_20131028_addname_dataframe=pd.DataFrame()
daily_20131028_addname_dataframe['cname'] = daily_20131028_tscode_list
for table_name in daily_20131028.columns.values.tolist():
    daily_20131028_addname_dataframe[table_name] = daily_20131028[table_name]
print("daily_20131028 返回数据 row 行数 = "+str(daily_20131028.shape[0]))
daily_20131028_addname_dataframe.to_excel(daily_201310_excel_writer,'28_1',index=False)
daily_201310_excel_writer.save()
daily_20131029 = pro.daily(start_date='',end_date='',trade_date='20131029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131029_tscode_list = list() 
for ts_code_sh in daily_20131029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131029_tscode_list.append(stock_name)
daily_20131029_addname_dataframe=pd.DataFrame()
daily_20131029_addname_dataframe['cname'] = daily_20131029_tscode_list
for table_name in daily_20131029.columns.values.tolist():
    daily_20131029_addname_dataframe[table_name] = daily_20131029[table_name]
print("daily_20131029 返回数据 row 行数 = "+str(daily_20131029.shape[0]))
daily_20131029_addname_dataframe.to_excel(daily_201310_excel_writer,'29_2',index=False)
daily_201310_excel_writer.save()
daily_20131030 = pro.daily(start_date='',end_date='',trade_date='20131030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131030_tscode_list = list() 
for ts_code_sh in daily_20131030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131030_tscode_list.append(stock_name)
daily_20131030_addname_dataframe=pd.DataFrame()
daily_20131030_addname_dataframe['cname'] = daily_20131030_tscode_list
for table_name in daily_20131030.columns.values.tolist():
    daily_20131030_addname_dataframe[table_name] = daily_20131030[table_name]
print("daily_20131030 返回数据 row 行数 = "+str(daily_20131030.shape[0]))
daily_20131030_addname_dataframe.to_excel(daily_201310_excel_writer,'30_3',index=False)
daily_201310_excel_writer.save()
daily_20131031 = pro.daily(start_date='',end_date='',trade_date='20131031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131031_tscode_list = list() 
for ts_code_sh in daily_20131031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131031_tscode_list.append(stock_name)
daily_20131031_addname_dataframe=pd.DataFrame()
daily_20131031_addname_dataframe['cname'] = daily_20131031_tscode_list
for table_name in daily_20131031.columns.values.tolist():
    daily_20131031_addname_dataframe[table_name] = daily_20131031[table_name]
print("daily_20131031 返回数据 row 行数 = "+str(daily_20131031.shape[0]))
daily_20131031_addname_dataframe.to_excel(daily_201310_excel_writer,'31_4',index=False)
daily_201310_excel_writer.save()




createexcel('daily_201311.xlsx')
daily_201311_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201311.xlsx')
daily_201311_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201311.xlsx', engine='openpyxl')
daily_201311_excel_writer.book = daily_201311_book
daily_201311_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201311_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20131101")       ###  更新 记录日期
daily_20131101 = pro.daily(start_date='',end_date='',trade_date='20131101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131101_tscode_list = list() 
for ts_code_sh in daily_20131101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131101_tscode_list.append(stock_name)
daily_20131101_addname_dataframe=pd.DataFrame()
daily_20131101_addname_dataframe['cname'] = daily_20131101_tscode_list
for table_name in daily_20131101.columns.values.tolist():
    daily_20131101_addname_dataframe[table_name] = daily_20131101[table_name]
print("daily_20131101 返回数据 row 行数 = "+str(daily_20131101.shape[0]))
daily_20131101_addname_dataframe.to_excel(daily_201311_excel_writer,'1_5',index=False)
daily_201311_excel_writer.save()
daily_20131102 = pro.daily(start_date='',end_date='',trade_date='20131102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131102_tscode_list = list() 
for ts_code_sh in daily_20131102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131102_tscode_list.append(stock_name)
daily_20131102_addname_dataframe=pd.DataFrame()
daily_20131102_addname_dataframe['cname'] = daily_20131102_tscode_list
for table_name in daily_20131102.columns.values.tolist():
    daily_20131102_addname_dataframe[table_name] = daily_20131102[table_name]
print("daily_20131102 返回数据 row 行数 = "+str(daily_20131102.shape[0]))
daily_20131102_addname_dataframe.to_excel(daily_201311_excel_writer,'2_6',index=False)
daily_201311_excel_writer.save()
daily_20131103 = pro.daily(start_date='',end_date='',trade_date='20131103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131103_tscode_list = list() 
for ts_code_sh in daily_20131103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131103_tscode_list.append(stock_name)
daily_20131103_addname_dataframe=pd.DataFrame()
daily_20131103_addname_dataframe['cname'] = daily_20131103_tscode_list
for table_name in daily_20131103.columns.values.tolist():
    daily_20131103_addname_dataframe[table_name] = daily_20131103[table_name]
print("daily_20131103 返回数据 row 行数 = "+str(daily_20131103.shape[0]))
daily_20131103_addname_dataframe.to_excel(daily_201311_excel_writer,'3_7',index=False)
daily_201311_excel_writer.save()
daily_20131104 = pro.daily(start_date='',end_date='',trade_date='20131104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131104_tscode_list = list() 
for ts_code_sh in daily_20131104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131104_tscode_list.append(stock_name)
daily_20131104_addname_dataframe=pd.DataFrame()
daily_20131104_addname_dataframe['cname'] = daily_20131104_tscode_list
for table_name in daily_20131104.columns.values.tolist():
    daily_20131104_addname_dataframe[table_name] = daily_20131104[table_name]
print("daily_20131104 返回数据 row 行数 = "+str(daily_20131104.shape[0]))
daily_20131104_addname_dataframe.to_excel(daily_201311_excel_writer,'4_1',index=False)
daily_201311_excel_writer.save()
daily_20131105 = pro.daily(start_date='',end_date='',trade_date='20131105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131105_tscode_list = list() 
for ts_code_sh in daily_20131105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131105_tscode_list.append(stock_name)
daily_20131105_addname_dataframe=pd.DataFrame()
daily_20131105_addname_dataframe['cname'] = daily_20131105_tscode_list
for table_name in daily_20131105.columns.values.tolist():
    daily_20131105_addname_dataframe[table_name] = daily_20131105[table_name]
print("daily_20131105 返回数据 row 行数 = "+str(daily_20131105.shape[0]))
daily_20131105_addname_dataframe.to_excel(daily_201311_excel_writer,'5_2',index=False)
daily_201311_excel_writer.save()
daily_20131106 = pro.daily(start_date='',end_date='',trade_date='20131106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131106_tscode_list = list() 
for ts_code_sh in daily_20131106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131106_tscode_list.append(stock_name)
daily_20131106_addname_dataframe=pd.DataFrame()
daily_20131106_addname_dataframe['cname'] = daily_20131106_tscode_list
for table_name in daily_20131106.columns.values.tolist():
    daily_20131106_addname_dataframe[table_name] = daily_20131106[table_name]
print("daily_20131106 返回数据 row 行数 = "+str(daily_20131106.shape[0]))
daily_20131106_addname_dataframe.to_excel(daily_201311_excel_writer,'6_3',index=False)
daily_201311_excel_writer.save()
daily_20131107 = pro.daily(start_date='',end_date='',trade_date='20131107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131107_tscode_list = list() 
for ts_code_sh in daily_20131107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131107_tscode_list.append(stock_name)
daily_20131107_addname_dataframe=pd.DataFrame()
daily_20131107_addname_dataframe['cname'] = daily_20131107_tscode_list
for table_name in daily_20131107.columns.values.tolist():
    daily_20131107_addname_dataframe[table_name] = daily_20131107[table_name]
print("daily_20131107 返回数据 row 行数 = "+str(daily_20131107.shape[0]))
daily_20131107_addname_dataframe.to_excel(daily_201311_excel_writer,'7_4',index=False)
daily_201311_excel_writer.save()
daily_20131108 = pro.daily(start_date='',end_date='',trade_date='20131108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131108_tscode_list = list() 
for ts_code_sh in daily_20131108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131108_tscode_list.append(stock_name)
daily_20131108_addname_dataframe=pd.DataFrame()
daily_20131108_addname_dataframe['cname'] = daily_20131108_tscode_list
for table_name in daily_20131108.columns.values.tolist():
    daily_20131108_addname_dataframe[table_name] = daily_20131108[table_name]
print("daily_20131108 返回数据 row 行数 = "+str(daily_20131108.shape[0]))
daily_20131108_addname_dataframe.to_excel(daily_201311_excel_writer,'8_5',index=False)
daily_201311_excel_writer.save()
daily_20131109 = pro.daily(start_date='',end_date='',trade_date='20131109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131109_tscode_list = list() 
for ts_code_sh in daily_20131109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131109_tscode_list.append(stock_name)
daily_20131109_addname_dataframe=pd.DataFrame()
daily_20131109_addname_dataframe['cname'] = daily_20131109_tscode_list
for table_name in daily_20131109.columns.values.tolist():
    daily_20131109_addname_dataframe[table_name] = daily_20131109[table_name]
print("daily_20131109 返回数据 row 行数 = "+str(daily_20131109.shape[0]))
daily_20131109_addname_dataframe.to_excel(daily_201311_excel_writer,'9_6',index=False)
daily_201311_excel_writer.save()
daily_20131110 = pro.daily(start_date='',end_date='',trade_date='20131110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131110_tscode_list = list() 
for ts_code_sh in daily_20131110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131110_tscode_list.append(stock_name)
daily_20131110_addname_dataframe=pd.DataFrame()
daily_20131110_addname_dataframe['cname'] = daily_20131110_tscode_list
for table_name in daily_20131110.columns.values.tolist():
    daily_20131110_addname_dataframe[table_name] = daily_20131110[table_name]
print("daily_20131110 返回数据 row 行数 = "+str(daily_20131110.shape[0]))
daily_20131110_addname_dataframe.to_excel(daily_201311_excel_writer,'10_7',index=False)
daily_201311_excel_writer.save()
daily_20131111 = pro.daily(start_date='',end_date='',trade_date='20131111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131111_tscode_list = list() 
for ts_code_sh in daily_20131111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131111_tscode_list.append(stock_name)
daily_20131111_addname_dataframe=pd.DataFrame()
daily_20131111_addname_dataframe['cname'] = daily_20131111_tscode_list
for table_name in daily_20131111.columns.values.tolist():
    daily_20131111_addname_dataframe[table_name] = daily_20131111[table_name]
print("daily_20131111 返回数据 row 行数 = "+str(daily_20131111.shape[0]))
daily_20131111_addname_dataframe.to_excel(daily_201311_excel_writer,'11_1',index=False)
daily_201311_excel_writer.save()
daily_20131112 = pro.daily(start_date='',end_date='',trade_date='20131112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131112_tscode_list = list() 
for ts_code_sh in daily_20131112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131112_tscode_list.append(stock_name)
daily_20131112_addname_dataframe=pd.DataFrame()
daily_20131112_addname_dataframe['cname'] = daily_20131112_tscode_list
for table_name in daily_20131112.columns.values.tolist():
    daily_20131112_addname_dataframe[table_name] = daily_20131112[table_name]
print("daily_20131112 返回数据 row 行数 = "+str(daily_20131112.shape[0]))
daily_20131112_addname_dataframe.to_excel(daily_201311_excel_writer,'12_2',index=False)
daily_201311_excel_writer.save()
daily_20131113 = pro.daily(start_date='',end_date='',trade_date='20131113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131113_tscode_list = list() 
for ts_code_sh in daily_20131113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131113_tscode_list.append(stock_name)
daily_20131113_addname_dataframe=pd.DataFrame()
daily_20131113_addname_dataframe['cname'] = daily_20131113_tscode_list
for table_name in daily_20131113.columns.values.tolist():
    daily_20131113_addname_dataframe[table_name] = daily_20131113[table_name]
print("daily_20131113 返回数据 row 行数 = "+str(daily_20131113.shape[0]))
daily_20131113_addname_dataframe.to_excel(daily_201311_excel_writer,'13_3',index=False)
daily_201311_excel_writer.save()
daily_20131114 = pro.daily(start_date='',end_date='',trade_date='20131114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131114_tscode_list = list() 
for ts_code_sh in daily_20131114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131114_tscode_list.append(stock_name)
daily_20131114_addname_dataframe=pd.DataFrame()
daily_20131114_addname_dataframe['cname'] = daily_20131114_tscode_list
for table_name in daily_20131114.columns.values.tolist():
    daily_20131114_addname_dataframe[table_name] = daily_20131114[table_name]
print("daily_20131114 返回数据 row 行数 = "+str(daily_20131114.shape[0]))
daily_20131114_addname_dataframe.to_excel(daily_201311_excel_writer,'14_4',index=False)
daily_201311_excel_writer.save()
daily_20131115 = pro.daily(start_date='',end_date='',trade_date='20131115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131115_tscode_list = list() 
for ts_code_sh in daily_20131115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131115_tscode_list.append(stock_name)
daily_20131115_addname_dataframe=pd.DataFrame()
daily_20131115_addname_dataframe['cname'] = daily_20131115_tscode_list
for table_name in daily_20131115.columns.values.tolist():
    daily_20131115_addname_dataframe[table_name] = daily_20131115[table_name]
print("daily_20131115 返回数据 row 行数 = "+str(daily_20131115.shape[0]))
daily_20131115_addname_dataframe.to_excel(daily_201311_excel_writer,'15_5',index=False)
daily_201311_excel_writer.save()
daily_20131116 = pro.daily(start_date='',end_date='',trade_date='20131116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131116_tscode_list = list() 
for ts_code_sh in daily_20131116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131116_tscode_list.append(stock_name)
daily_20131116_addname_dataframe=pd.DataFrame()
daily_20131116_addname_dataframe['cname'] = daily_20131116_tscode_list
for table_name in daily_20131116.columns.values.tolist():
    daily_20131116_addname_dataframe[table_name] = daily_20131116[table_name]
print("daily_20131116 返回数据 row 行数 = "+str(daily_20131116.shape[0]))
daily_20131116_addname_dataframe.to_excel(daily_201311_excel_writer,'16_6',index=False)
daily_201311_excel_writer.save()
daily_20131117 = pro.daily(start_date='',end_date='',trade_date='20131117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131117_tscode_list = list() 
for ts_code_sh in daily_20131117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131117_tscode_list.append(stock_name)
daily_20131117_addname_dataframe=pd.DataFrame()
daily_20131117_addname_dataframe['cname'] = daily_20131117_tscode_list
for table_name in daily_20131117.columns.values.tolist():
    daily_20131117_addname_dataframe[table_name] = daily_20131117[table_name]
print("daily_20131117 返回数据 row 行数 = "+str(daily_20131117.shape[0]))
daily_20131117_addname_dataframe.to_excel(daily_201311_excel_writer,'17_7',index=False)
daily_201311_excel_writer.save()
daily_20131118 = pro.daily(start_date='',end_date='',trade_date='20131118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131118_tscode_list = list() 
for ts_code_sh in daily_20131118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131118_tscode_list.append(stock_name)
daily_20131118_addname_dataframe=pd.DataFrame()
daily_20131118_addname_dataframe['cname'] = daily_20131118_tscode_list
for table_name in daily_20131118.columns.values.tolist():
    daily_20131118_addname_dataframe[table_name] = daily_20131118[table_name]
print("daily_20131118 返回数据 row 行数 = "+str(daily_20131118.shape[0]))
daily_20131118_addname_dataframe.to_excel(daily_201311_excel_writer,'18_1',index=False)
daily_201311_excel_writer.save()
daily_20131119 = pro.daily(start_date='',end_date='',trade_date='20131119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131119_tscode_list = list() 
for ts_code_sh in daily_20131119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131119_tscode_list.append(stock_name)
daily_20131119_addname_dataframe=pd.DataFrame()
daily_20131119_addname_dataframe['cname'] = daily_20131119_tscode_list
for table_name in daily_20131119.columns.values.tolist():
    daily_20131119_addname_dataframe[table_name] = daily_20131119[table_name]
print("daily_20131119 返回数据 row 行数 = "+str(daily_20131119.shape[0]))
daily_20131119_addname_dataframe.to_excel(daily_201311_excel_writer,'19_2',index=False)
daily_201311_excel_writer.save()
daily_20131120 = pro.daily(start_date='',end_date='',trade_date='20131120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131120_tscode_list = list() 
for ts_code_sh in daily_20131120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131120_tscode_list.append(stock_name)
daily_20131120_addname_dataframe=pd.DataFrame()
daily_20131120_addname_dataframe['cname'] = daily_20131120_tscode_list
for table_name in daily_20131120.columns.values.tolist():
    daily_20131120_addname_dataframe[table_name] = daily_20131120[table_name]
print("daily_20131120 返回数据 row 行数 = "+str(daily_20131120.shape[0]))
daily_20131120_addname_dataframe.to_excel(daily_201311_excel_writer,'20_3',index=False)
daily_201311_excel_writer.save()
daily_20131121 = pro.daily(start_date='',end_date='',trade_date='20131121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131121_tscode_list = list() 
for ts_code_sh in daily_20131121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131121_tscode_list.append(stock_name)
daily_20131121_addname_dataframe=pd.DataFrame()
daily_20131121_addname_dataframe['cname'] = daily_20131121_tscode_list
for table_name in daily_20131121.columns.values.tolist():
    daily_20131121_addname_dataframe[table_name] = daily_20131121[table_name]
print("daily_20131121 返回数据 row 行数 = "+str(daily_20131121.shape[0]))
daily_20131121_addname_dataframe.to_excel(daily_201311_excel_writer,'21_4',index=False)
daily_201311_excel_writer.save()
daily_20131122 = pro.daily(start_date='',end_date='',trade_date='20131122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131122_tscode_list = list() 
for ts_code_sh in daily_20131122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131122_tscode_list.append(stock_name)
daily_20131122_addname_dataframe=pd.DataFrame()
daily_20131122_addname_dataframe['cname'] = daily_20131122_tscode_list
for table_name in daily_20131122.columns.values.tolist():
    daily_20131122_addname_dataframe[table_name] = daily_20131122[table_name]
print("daily_20131122 返回数据 row 行数 = "+str(daily_20131122.shape[0]))
daily_20131122_addname_dataframe.to_excel(daily_201311_excel_writer,'22_5',index=False)
daily_201311_excel_writer.save()
daily_20131123 = pro.daily(start_date='',end_date='',trade_date='20131123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131123_tscode_list = list() 
for ts_code_sh in daily_20131123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131123_tscode_list.append(stock_name)
daily_20131123_addname_dataframe=pd.DataFrame()
daily_20131123_addname_dataframe['cname'] = daily_20131123_tscode_list
for table_name in daily_20131123.columns.values.tolist():
    daily_20131123_addname_dataframe[table_name] = daily_20131123[table_name]
print("daily_20131123 返回数据 row 行数 = "+str(daily_20131123.shape[0]))
daily_20131123_addname_dataframe.to_excel(daily_201311_excel_writer,'23_6',index=False)
daily_201311_excel_writer.save()
daily_20131124 = pro.daily(start_date='',end_date='',trade_date='20131124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131124_tscode_list = list() 
for ts_code_sh in daily_20131124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131124_tscode_list.append(stock_name)
daily_20131124_addname_dataframe=pd.DataFrame()
daily_20131124_addname_dataframe['cname'] = daily_20131124_tscode_list
for table_name in daily_20131124.columns.values.tolist():
    daily_20131124_addname_dataframe[table_name] = daily_20131124[table_name]
print("daily_20131124 返回数据 row 行数 = "+str(daily_20131124.shape[0]))
daily_20131124_addname_dataframe.to_excel(daily_201311_excel_writer,'24_7',index=False)
daily_201311_excel_writer.save()
daily_20131125 = pro.daily(start_date='',end_date='',trade_date='20131125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131125_tscode_list = list() 
for ts_code_sh in daily_20131125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131125_tscode_list.append(stock_name)
daily_20131125_addname_dataframe=pd.DataFrame()
daily_20131125_addname_dataframe['cname'] = daily_20131125_tscode_list
for table_name in daily_20131125.columns.values.tolist():
    daily_20131125_addname_dataframe[table_name] = daily_20131125[table_name]
print("daily_20131125 返回数据 row 行数 = "+str(daily_20131125.shape[0]))
daily_20131125_addname_dataframe.to_excel(daily_201311_excel_writer,'25_1',index=False)
daily_201311_excel_writer.save()
daily_20131126 = pro.daily(start_date='',end_date='',trade_date='20131126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131126_tscode_list = list() 
for ts_code_sh in daily_20131126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131126_tscode_list.append(stock_name)
daily_20131126_addname_dataframe=pd.DataFrame()
daily_20131126_addname_dataframe['cname'] = daily_20131126_tscode_list
for table_name in daily_20131126.columns.values.tolist():
    daily_20131126_addname_dataframe[table_name] = daily_20131126[table_name]
print("daily_20131126 返回数据 row 行数 = "+str(daily_20131126.shape[0]))
daily_20131126_addname_dataframe.to_excel(daily_201311_excel_writer,'26_2',index=False)
daily_201311_excel_writer.save()
daily_20131127 = pro.daily(start_date='',end_date='',trade_date='20131127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131127_tscode_list = list() 
for ts_code_sh in daily_20131127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131127_tscode_list.append(stock_name)
daily_20131127_addname_dataframe=pd.DataFrame()
daily_20131127_addname_dataframe['cname'] = daily_20131127_tscode_list
for table_name in daily_20131127.columns.values.tolist():
    daily_20131127_addname_dataframe[table_name] = daily_20131127[table_name]
print("daily_20131127 返回数据 row 行数 = "+str(daily_20131127.shape[0]))
daily_20131127_addname_dataframe.to_excel(daily_201311_excel_writer,'27_3',index=False)
daily_201311_excel_writer.save()
daily_20131128 = pro.daily(start_date='',end_date='',trade_date='20131128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131128_tscode_list = list() 
for ts_code_sh in daily_20131128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131128_tscode_list.append(stock_name)
daily_20131128_addname_dataframe=pd.DataFrame()
daily_20131128_addname_dataframe['cname'] = daily_20131128_tscode_list
for table_name in daily_20131128.columns.values.tolist():
    daily_20131128_addname_dataframe[table_name] = daily_20131128[table_name]
print("daily_20131128 返回数据 row 行数 = "+str(daily_20131128.shape[0]))
daily_20131128_addname_dataframe.to_excel(daily_201311_excel_writer,'28_4',index=False)
daily_201311_excel_writer.save()
daily_20131129 = pro.daily(start_date='',end_date='',trade_date='20131129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131129_tscode_list = list() 
for ts_code_sh in daily_20131129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131129_tscode_list.append(stock_name)
daily_20131129_addname_dataframe=pd.DataFrame()
daily_20131129_addname_dataframe['cname'] = daily_20131129_tscode_list
for table_name in daily_20131129.columns.values.tolist():
    daily_20131129_addname_dataframe[table_name] = daily_20131129[table_name]
print("daily_20131129 返回数据 row 行数 = "+str(daily_20131129.shape[0]))
daily_20131129_addname_dataframe.to_excel(daily_201311_excel_writer,'29_5',index=False)
daily_201311_excel_writer.save()
daily_20131130 = pro.daily(start_date='',end_date='',trade_date='20131130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131130_tscode_list = list() 
for ts_code_sh in daily_20131130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131130_tscode_list.append(stock_name)
daily_20131130_addname_dataframe=pd.DataFrame()
daily_20131130_addname_dataframe['cname'] = daily_20131130_tscode_list
for table_name in daily_20131130.columns.values.tolist():
    daily_20131130_addname_dataframe[table_name] = daily_20131130[table_name]
print("daily_20131130 返回数据 row 行数 = "+str(daily_20131130.shape[0]))
daily_20131130_addname_dataframe.to_excel(daily_201311_excel_writer,'30_6',index=False)
daily_201311_excel_writer.save()




createexcel('daily_201312.xlsx')
daily_201312_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201312.xlsx')
daily_201312_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201312.xlsx', engine='openpyxl')
daily_201312_excel_writer.book = daily_201312_book
daily_201312_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201312_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20131201")       ###  更新 记录日期
daily_20131201 = pro.daily(start_date='',end_date='',trade_date='20131201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131201_tscode_list = list() 
for ts_code_sh in daily_20131201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131201_tscode_list.append(stock_name)
daily_20131201_addname_dataframe=pd.DataFrame()
daily_20131201_addname_dataframe['cname'] = daily_20131201_tscode_list
for table_name in daily_20131201.columns.values.tolist():
    daily_20131201_addname_dataframe[table_name] = daily_20131201[table_name]
print("daily_20131201 返回数据 row 行数 = "+str(daily_20131201.shape[0]))
daily_20131201_addname_dataframe.to_excel(daily_201312_excel_writer,'1_7',index=False)
daily_201312_excel_writer.save()
daily_20131202 = pro.daily(start_date='',end_date='',trade_date='20131202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131202_tscode_list = list() 
for ts_code_sh in daily_20131202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131202_tscode_list.append(stock_name)
daily_20131202_addname_dataframe=pd.DataFrame()
daily_20131202_addname_dataframe['cname'] = daily_20131202_tscode_list
for table_name in daily_20131202.columns.values.tolist():
    daily_20131202_addname_dataframe[table_name] = daily_20131202[table_name]
print("daily_20131202 返回数据 row 行数 = "+str(daily_20131202.shape[0]))
daily_20131202_addname_dataframe.to_excel(daily_201312_excel_writer,'2_1',index=False)
daily_201312_excel_writer.save()
daily_20131203 = pro.daily(start_date='',end_date='',trade_date='20131203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131203_tscode_list = list() 
for ts_code_sh in daily_20131203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131203_tscode_list.append(stock_name)
daily_20131203_addname_dataframe=pd.DataFrame()
daily_20131203_addname_dataframe['cname'] = daily_20131203_tscode_list
for table_name in daily_20131203.columns.values.tolist():
    daily_20131203_addname_dataframe[table_name] = daily_20131203[table_name]
print("daily_20131203 返回数据 row 行数 = "+str(daily_20131203.shape[0]))
daily_20131203_addname_dataframe.to_excel(daily_201312_excel_writer,'3_2',index=False)
daily_201312_excel_writer.save()
daily_20131204 = pro.daily(start_date='',end_date='',trade_date='20131204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131204_tscode_list = list() 
for ts_code_sh in daily_20131204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131204_tscode_list.append(stock_name)
daily_20131204_addname_dataframe=pd.DataFrame()
daily_20131204_addname_dataframe['cname'] = daily_20131204_tscode_list
for table_name in daily_20131204.columns.values.tolist():
    daily_20131204_addname_dataframe[table_name] = daily_20131204[table_name]
print("daily_20131204 返回数据 row 行数 = "+str(daily_20131204.shape[0]))
daily_20131204_addname_dataframe.to_excel(daily_201312_excel_writer,'4_3',index=False)
daily_201312_excel_writer.save()
daily_20131205 = pro.daily(start_date='',end_date='',trade_date='20131205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131205_tscode_list = list() 
for ts_code_sh in daily_20131205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131205_tscode_list.append(stock_name)
daily_20131205_addname_dataframe=pd.DataFrame()
daily_20131205_addname_dataframe['cname'] = daily_20131205_tscode_list
for table_name in daily_20131205.columns.values.tolist():
    daily_20131205_addname_dataframe[table_name] = daily_20131205[table_name]
print("daily_20131205 返回数据 row 行数 = "+str(daily_20131205.shape[0]))
daily_20131205_addname_dataframe.to_excel(daily_201312_excel_writer,'5_4',index=False)
daily_201312_excel_writer.save()
daily_20131206 = pro.daily(start_date='',end_date='',trade_date='20131206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131206_tscode_list = list() 
for ts_code_sh in daily_20131206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131206_tscode_list.append(stock_name)
daily_20131206_addname_dataframe=pd.DataFrame()
daily_20131206_addname_dataframe['cname'] = daily_20131206_tscode_list
for table_name in daily_20131206.columns.values.tolist():
    daily_20131206_addname_dataframe[table_name] = daily_20131206[table_name]
print("daily_20131206 返回数据 row 行数 = "+str(daily_20131206.shape[0]))
daily_20131206_addname_dataframe.to_excel(daily_201312_excel_writer,'6_5',index=False)
daily_201312_excel_writer.save()
daily_20131207 = pro.daily(start_date='',end_date='',trade_date='20131207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131207_tscode_list = list() 
for ts_code_sh in daily_20131207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131207_tscode_list.append(stock_name)
daily_20131207_addname_dataframe=pd.DataFrame()
daily_20131207_addname_dataframe['cname'] = daily_20131207_tscode_list
for table_name in daily_20131207.columns.values.tolist():
    daily_20131207_addname_dataframe[table_name] = daily_20131207[table_name]
print("daily_20131207 返回数据 row 行数 = "+str(daily_20131207.shape[0]))
daily_20131207_addname_dataframe.to_excel(daily_201312_excel_writer,'7_6',index=False)
daily_201312_excel_writer.save()
daily_20131208 = pro.daily(start_date='',end_date='',trade_date='20131208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131208_tscode_list = list() 
for ts_code_sh in daily_20131208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131208_tscode_list.append(stock_name)
daily_20131208_addname_dataframe=pd.DataFrame()
daily_20131208_addname_dataframe['cname'] = daily_20131208_tscode_list
for table_name in daily_20131208.columns.values.tolist():
    daily_20131208_addname_dataframe[table_name] = daily_20131208[table_name]
print("daily_20131208 返回数据 row 行数 = "+str(daily_20131208.shape[0]))
daily_20131208_addname_dataframe.to_excel(daily_201312_excel_writer,'8_7',index=False)
daily_201312_excel_writer.save()
daily_20131209 = pro.daily(start_date='',end_date='',trade_date='20131209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131209_tscode_list = list() 
for ts_code_sh in daily_20131209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131209_tscode_list.append(stock_name)
daily_20131209_addname_dataframe=pd.DataFrame()
daily_20131209_addname_dataframe['cname'] = daily_20131209_tscode_list
for table_name in daily_20131209.columns.values.tolist():
    daily_20131209_addname_dataframe[table_name] = daily_20131209[table_name]
print("daily_20131209 返回数据 row 行数 = "+str(daily_20131209.shape[0]))
daily_20131209_addname_dataframe.to_excel(daily_201312_excel_writer,'9_1',index=False)
daily_201312_excel_writer.save()
daily_20131210 = pro.daily(start_date='',end_date='',trade_date='20131210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131210_tscode_list = list() 
for ts_code_sh in daily_20131210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131210_tscode_list.append(stock_name)
daily_20131210_addname_dataframe=pd.DataFrame()
daily_20131210_addname_dataframe['cname'] = daily_20131210_tscode_list
for table_name in daily_20131210.columns.values.tolist():
    daily_20131210_addname_dataframe[table_name] = daily_20131210[table_name]
print("daily_20131210 返回数据 row 行数 = "+str(daily_20131210.shape[0]))
daily_20131210_addname_dataframe.to_excel(daily_201312_excel_writer,'10_2',index=False)
daily_201312_excel_writer.save()
daily_20131211 = pro.daily(start_date='',end_date='',trade_date='20131211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131211_tscode_list = list() 
for ts_code_sh in daily_20131211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131211_tscode_list.append(stock_name)
daily_20131211_addname_dataframe=pd.DataFrame()
daily_20131211_addname_dataframe['cname'] = daily_20131211_tscode_list
for table_name in daily_20131211.columns.values.tolist():
    daily_20131211_addname_dataframe[table_name] = daily_20131211[table_name]
print("daily_20131211 返回数据 row 行数 = "+str(daily_20131211.shape[0]))
daily_20131211_addname_dataframe.to_excel(daily_201312_excel_writer,'11_3',index=False)
daily_201312_excel_writer.save()
daily_20131212 = pro.daily(start_date='',end_date='',trade_date='20131212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131212_tscode_list = list() 
for ts_code_sh in daily_20131212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131212_tscode_list.append(stock_name)
daily_20131212_addname_dataframe=pd.DataFrame()
daily_20131212_addname_dataframe['cname'] = daily_20131212_tscode_list
for table_name in daily_20131212.columns.values.tolist():
    daily_20131212_addname_dataframe[table_name] = daily_20131212[table_name]
print("daily_20131212 返回数据 row 行数 = "+str(daily_20131212.shape[0]))
daily_20131212_addname_dataframe.to_excel(daily_201312_excel_writer,'12_4',index=False)
daily_201312_excel_writer.save()
daily_20131213 = pro.daily(start_date='',end_date='',trade_date='20131213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131213_tscode_list = list() 
for ts_code_sh in daily_20131213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131213_tscode_list.append(stock_name)
daily_20131213_addname_dataframe=pd.DataFrame()
daily_20131213_addname_dataframe['cname'] = daily_20131213_tscode_list
for table_name in daily_20131213.columns.values.tolist():
    daily_20131213_addname_dataframe[table_name] = daily_20131213[table_name]
print("daily_20131213 返回数据 row 行数 = "+str(daily_20131213.shape[0]))
daily_20131213_addname_dataframe.to_excel(daily_201312_excel_writer,'13_5',index=False)
daily_201312_excel_writer.save()
daily_20131214 = pro.daily(start_date='',end_date='',trade_date='20131214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131214_tscode_list = list() 
for ts_code_sh in daily_20131214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131214_tscode_list.append(stock_name)
daily_20131214_addname_dataframe=pd.DataFrame()
daily_20131214_addname_dataframe['cname'] = daily_20131214_tscode_list
for table_name in daily_20131214.columns.values.tolist():
    daily_20131214_addname_dataframe[table_name] = daily_20131214[table_name]
print("daily_20131214 返回数据 row 行数 = "+str(daily_20131214.shape[0]))
daily_20131214_addname_dataframe.to_excel(daily_201312_excel_writer,'14_6',index=False)
daily_201312_excel_writer.save()
daily_20131215 = pro.daily(start_date='',end_date='',trade_date='20131215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131215_tscode_list = list() 
for ts_code_sh in daily_20131215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131215_tscode_list.append(stock_name)
daily_20131215_addname_dataframe=pd.DataFrame()
daily_20131215_addname_dataframe['cname'] = daily_20131215_tscode_list
for table_name in daily_20131215.columns.values.tolist():
    daily_20131215_addname_dataframe[table_name] = daily_20131215[table_name]
print("daily_20131215 返回数据 row 行数 = "+str(daily_20131215.shape[0]))
daily_20131215_addname_dataframe.to_excel(daily_201312_excel_writer,'15_7',index=False)
daily_201312_excel_writer.save()
daily_20131216 = pro.daily(start_date='',end_date='',trade_date='20131216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131216_tscode_list = list() 
for ts_code_sh in daily_20131216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131216_tscode_list.append(stock_name)
daily_20131216_addname_dataframe=pd.DataFrame()
daily_20131216_addname_dataframe['cname'] = daily_20131216_tscode_list
for table_name in daily_20131216.columns.values.tolist():
    daily_20131216_addname_dataframe[table_name] = daily_20131216[table_name]
print("daily_20131216 返回数据 row 行数 = "+str(daily_20131216.shape[0]))
daily_20131216_addname_dataframe.to_excel(daily_201312_excel_writer,'16_1',index=False)
daily_201312_excel_writer.save()
daily_20131217 = pro.daily(start_date='',end_date='',trade_date='20131217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131217_tscode_list = list() 
for ts_code_sh in daily_20131217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131217_tscode_list.append(stock_name)
daily_20131217_addname_dataframe=pd.DataFrame()
daily_20131217_addname_dataframe['cname'] = daily_20131217_tscode_list
for table_name in daily_20131217.columns.values.tolist():
    daily_20131217_addname_dataframe[table_name] = daily_20131217[table_name]
print("daily_20131217 返回数据 row 行数 = "+str(daily_20131217.shape[0]))
daily_20131217_addname_dataframe.to_excel(daily_201312_excel_writer,'17_2',index=False)
daily_201312_excel_writer.save()
daily_20131218 = pro.daily(start_date='',end_date='',trade_date='20131218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131218_tscode_list = list() 
for ts_code_sh in daily_20131218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131218_tscode_list.append(stock_name)
daily_20131218_addname_dataframe=pd.DataFrame()
daily_20131218_addname_dataframe['cname'] = daily_20131218_tscode_list
for table_name in daily_20131218.columns.values.tolist():
    daily_20131218_addname_dataframe[table_name] = daily_20131218[table_name]
print("daily_20131218 返回数据 row 行数 = "+str(daily_20131218.shape[0]))
daily_20131218_addname_dataframe.to_excel(daily_201312_excel_writer,'18_3',index=False)
daily_201312_excel_writer.save()
daily_20131219 = pro.daily(start_date='',end_date='',trade_date='20131219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131219_tscode_list = list() 
for ts_code_sh in daily_20131219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131219_tscode_list.append(stock_name)
daily_20131219_addname_dataframe=pd.DataFrame()
daily_20131219_addname_dataframe['cname'] = daily_20131219_tscode_list
for table_name in daily_20131219.columns.values.tolist():
    daily_20131219_addname_dataframe[table_name] = daily_20131219[table_name]
print("daily_20131219 返回数据 row 行数 = "+str(daily_20131219.shape[0]))
daily_20131219_addname_dataframe.to_excel(daily_201312_excel_writer,'19_4',index=False)
daily_201312_excel_writer.save()
daily_20131220 = pro.daily(start_date='',end_date='',trade_date='20131220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131220_tscode_list = list() 
for ts_code_sh in daily_20131220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131220_tscode_list.append(stock_name)
daily_20131220_addname_dataframe=pd.DataFrame()
daily_20131220_addname_dataframe['cname'] = daily_20131220_tscode_list
for table_name in daily_20131220.columns.values.tolist():
    daily_20131220_addname_dataframe[table_name] = daily_20131220[table_name]
print("daily_20131220 返回数据 row 行数 = "+str(daily_20131220.shape[0]))
daily_20131220_addname_dataframe.to_excel(daily_201312_excel_writer,'20_5',index=False)
daily_201312_excel_writer.save()
daily_20131221 = pro.daily(start_date='',end_date='',trade_date='20131221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131221_tscode_list = list() 
for ts_code_sh in daily_20131221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131221_tscode_list.append(stock_name)
daily_20131221_addname_dataframe=pd.DataFrame()
daily_20131221_addname_dataframe['cname'] = daily_20131221_tscode_list
for table_name in daily_20131221.columns.values.tolist():
    daily_20131221_addname_dataframe[table_name] = daily_20131221[table_name]
print("daily_20131221 返回数据 row 行数 = "+str(daily_20131221.shape[0]))
daily_20131221_addname_dataframe.to_excel(daily_201312_excel_writer,'21_6',index=False)
daily_201312_excel_writer.save()
daily_20131222 = pro.daily(start_date='',end_date='',trade_date='20131222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131222_tscode_list = list() 
for ts_code_sh in daily_20131222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131222_tscode_list.append(stock_name)
daily_20131222_addname_dataframe=pd.DataFrame()
daily_20131222_addname_dataframe['cname'] = daily_20131222_tscode_list
for table_name in daily_20131222.columns.values.tolist():
    daily_20131222_addname_dataframe[table_name] = daily_20131222[table_name]
print("daily_20131222 返回数据 row 行数 = "+str(daily_20131222.shape[0]))
daily_20131222_addname_dataframe.to_excel(daily_201312_excel_writer,'22_7',index=False)
daily_201312_excel_writer.save()
daily_20131223 = pro.daily(start_date='',end_date='',trade_date='20131223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131223_tscode_list = list() 
for ts_code_sh in daily_20131223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131223_tscode_list.append(stock_name)
daily_20131223_addname_dataframe=pd.DataFrame()
daily_20131223_addname_dataframe['cname'] = daily_20131223_tscode_list
for table_name in daily_20131223.columns.values.tolist():
    daily_20131223_addname_dataframe[table_name] = daily_20131223[table_name]
print("daily_20131223 返回数据 row 行数 = "+str(daily_20131223.shape[0]))
daily_20131223_addname_dataframe.to_excel(daily_201312_excel_writer,'23_1',index=False)
daily_201312_excel_writer.save()
daily_20131224 = pro.daily(start_date='',end_date='',trade_date='20131224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131224_tscode_list = list() 
for ts_code_sh in daily_20131224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131224_tscode_list.append(stock_name)
daily_20131224_addname_dataframe=pd.DataFrame()
daily_20131224_addname_dataframe['cname'] = daily_20131224_tscode_list
for table_name in daily_20131224.columns.values.tolist():
    daily_20131224_addname_dataframe[table_name] = daily_20131224[table_name]
print("daily_20131224 返回数据 row 行数 = "+str(daily_20131224.shape[0]))
daily_20131224_addname_dataframe.to_excel(daily_201312_excel_writer,'24_2',index=False)
daily_201312_excel_writer.save()
daily_20131225 = pro.daily(start_date='',end_date='',trade_date='20131225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131225_tscode_list = list() 
for ts_code_sh in daily_20131225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131225_tscode_list.append(stock_name)
daily_20131225_addname_dataframe=pd.DataFrame()
daily_20131225_addname_dataframe['cname'] = daily_20131225_tscode_list
for table_name in daily_20131225.columns.values.tolist():
    daily_20131225_addname_dataframe[table_name] = daily_20131225[table_name]
print("daily_20131225 返回数据 row 行数 = "+str(daily_20131225.shape[0]))
daily_20131225_addname_dataframe.to_excel(daily_201312_excel_writer,'25_3',index=False)
daily_201312_excel_writer.save()
daily_20131226 = pro.daily(start_date='',end_date='',trade_date='20131226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131226_tscode_list = list() 
for ts_code_sh in daily_20131226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131226_tscode_list.append(stock_name)
daily_20131226_addname_dataframe=pd.DataFrame()
daily_20131226_addname_dataframe['cname'] = daily_20131226_tscode_list
for table_name in daily_20131226.columns.values.tolist():
    daily_20131226_addname_dataframe[table_name] = daily_20131226[table_name]
print("daily_20131226 返回数据 row 行数 = "+str(daily_20131226.shape[0]))
daily_20131226_addname_dataframe.to_excel(daily_201312_excel_writer,'26_4',index=False)
daily_201312_excel_writer.save()
daily_20131227 = pro.daily(start_date='',end_date='',trade_date='20131227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131227_tscode_list = list() 
for ts_code_sh in daily_20131227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131227_tscode_list.append(stock_name)
daily_20131227_addname_dataframe=pd.DataFrame()
daily_20131227_addname_dataframe['cname'] = daily_20131227_tscode_list
for table_name in daily_20131227.columns.values.tolist():
    daily_20131227_addname_dataframe[table_name] = daily_20131227[table_name]
print("daily_20131227 返回数据 row 行数 = "+str(daily_20131227.shape[0]))
daily_20131227_addname_dataframe.to_excel(daily_201312_excel_writer,'27_5',index=False)
daily_201312_excel_writer.save()
daily_20131228 = pro.daily(start_date='',end_date='',trade_date='20131228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131228_tscode_list = list() 
for ts_code_sh in daily_20131228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131228_tscode_list.append(stock_name)
daily_20131228_addname_dataframe=pd.DataFrame()
daily_20131228_addname_dataframe['cname'] = daily_20131228_tscode_list
for table_name in daily_20131228.columns.values.tolist():
    daily_20131228_addname_dataframe[table_name] = daily_20131228[table_name]
print("daily_20131228 返回数据 row 行数 = "+str(daily_20131228.shape[0]))
daily_20131228_addname_dataframe.to_excel(daily_201312_excel_writer,'28_6',index=False)
daily_201312_excel_writer.save()
daily_20131229 = pro.daily(start_date='',end_date='',trade_date='20131229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131229_tscode_list = list() 
for ts_code_sh in daily_20131229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131229_tscode_list.append(stock_name)
daily_20131229_addname_dataframe=pd.DataFrame()
daily_20131229_addname_dataframe['cname'] = daily_20131229_tscode_list
for table_name in daily_20131229.columns.values.tolist():
    daily_20131229_addname_dataframe[table_name] = daily_20131229[table_name]
print("daily_20131229 返回数据 row 行数 = "+str(daily_20131229.shape[0]))
daily_20131229_addname_dataframe.to_excel(daily_201312_excel_writer,'29_7',index=False)
daily_201312_excel_writer.save()
daily_20131230 = pro.daily(start_date='',end_date='',trade_date='20131230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131230_tscode_list = list() 
for ts_code_sh in daily_20131230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131230_tscode_list.append(stock_name)
daily_20131230_addname_dataframe=pd.DataFrame()
daily_20131230_addname_dataframe['cname'] = daily_20131230_tscode_list
for table_name in daily_20131230.columns.values.tolist():
    daily_20131230_addname_dataframe[table_name] = daily_20131230[table_name]
print("daily_20131230 返回数据 row 行数 = "+str(daily_20131230.shape[0]))
daily_20131230_addname_dataframe.to_excel(daily_201312_excel_writer,'30_1',index=False)
daily_201312_excel_writer.save()
daily_20131231 = pro.daily(start_date='',end_date='',trade_date='20131231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131231_tscode_list = list() 
for ts_code_sh in daily_20131231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131231_tscode_list.append(stock_name)
daily_20131231_addname_dataframe=pd.DataFrame()
daily_20131231_addname_dataframe['cname'] = daily_20131231_tscode_list
for table_name in daily_20131231.columns.values.tolist():
    daily_20131231_addname_dataframe[table_name] = daily_20131231[table_name]
print("daily_20131231 返回数据 row 行数 = "+str(daily_20131231.shape[0]))
daily_20131231_addname_dataframe.to_excel(daily_201312_excel_writer,'31_2',index=False)
daily_201312_excel_writer.save()




createexcel('daily_201401.xlsx')
daily_201401_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201401.xlsx')
daily_201401_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201401.xlsx', engine='openpyxl')
daily_201401_excel_writer.book = daily_201401_book
daily_201401_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201401_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140101")       ###  更新 记录日期
daily_20140101 = pro.daily(start_date='',end_date='',trade_date='20140101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140101_tscode_list = list() 
for ts_code_sh in daily_20140101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140101_tscode_list.append(stock_name)
daily_20140101_addname_dataframe=pd.DataFrame()
daily_20140101_addname_dataframe['cname'] = daily_20140101_tscode_list
for table_name in daily_20140101.columns.values.tolist():
    daily_20140101_addname_dataframe[table_name] = daily_20140101[table_name]
print("daily_20140101 返回数据 row 行数 = "+str(daily_20140101.shape[0]))
daily_20140101_addname_dataframe.to_excel(daily_201401_excel_writer,'1_3',index=False)
daily_201401_excel_writer.save()
daily_20140102 = pro.daily(start_date='',end_date='',trade_date='20140102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140102_tscode_list = list() 
for ts_code_sh in daily_20140102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140102_tscode_list.append(stock_name)
daily_20140102_addname_dataframe=pd.DataFrame()
daily_20140102_addname_dataframe['cname'] = daily_20140102_tscode_list
for table_name in daily_20140102.columns.values.tolist():
    daily_20140102_addname_dataframe[table_name] = daily_20140102[table_name]
print("daily_20140102 返回数据 row 行数 = "+str(daily_20140102.shape[0]))
daily_20140102_addname_dataframe.to_excel(daily_201401_excel_writer,'2_4',index=False)
daily_201401_excel_writer.save()
daily_20140103 = pro.daily(start_date='',end_date='',trade_date='20140103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140103_tscode_list = list() 
for ts_code_sh in daily_20140103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140103_tscode_list.append(stock_name)
daily_20140103_addname_dataframe=pd.DataFrame()
daily_20140103_addname_dataframe['cname'] = daily_20140103_tscode_list
for table_name in daily_20140103.columns.values.tolist():
    daily_20140103_addname_dataframe[table_name] = daily_20140103[table_name]
print("daily_20140103 返回数据 row 行数 = "+str(daily_20140103.shape[0]))
daily_20140103_addname_dataframe.to_excel(daily_201401_excel_writer,'3_5',index=False)
daily_201401_excel_writer.save()
daily_20140104 = pro.daily(start_date='',end_date='',trade_date='20140104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140104_tscode_list = list() 
for ts_code_sh in daily_20140104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140104_tscode_list.append(stock_name)
daily_20140104_addname_dataframe=pd.DataFrame()
daily_20140104_addname_dataframe['cname'] = daily_20140104_tscode_list
for table_name in daily_20140104.columns.values.tolist():
    daily_20140104_addname_dataframe[table_name] = daily_20140104[table_name]
print("daily_20140104 返回数据 row 行数 = "+str(daily_20140104.shape[0]))
daily_20140104_addname_dataframe.to_excel(daily_201401_excel_writer,'4_6',index=False)
daily_201401_excel_writer.save()
daily_20140105 = pro.daily(start_date='',end_date='',trade_date='20140105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140105_tscode_list = list() 
for ts_code_sh in daily_20140105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140105_tscode_list.append(stock_name)
daily_20140105_addname_dataframe=pd.DataFrame()
daily_20140105_addname_dataframe['cname'] = daily_20140105_tscode_list
for table_name in daily_20140105.columns.values.tolist():
    daily_20140105_addname_dataframe[table_name] = daily_20140105[table_name]
print("daily_20140105 返回数据 row 行数 = "+str(daily_20140105.shape[0]))
daily_20140105_addname_dataframe.to_excel(daily_201401_excel_writer,'5_7',index=False)
daily_201401_excel_writer.save()
daily_20140106 = pro.daily(start_date='',end_date='',trade_date='20140106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140106_tscode_list = list() 
for ts_code_sh in daily_20140106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140106_tscode_list.append(stock_name)
daily_20140106_addname_dataframe=pd.DataFrame()
daily_20140106_addname_dataframe['cname'] = daily_20140106_tscode_list
for table_name in daily_20140106.columns.values.tolist():
    daily_20140106_addname_dataframe[table_name] = daily_20140106[table_name]
print("daily_20140106 返回数据 row 行数 = "+str(daily_20140106.shape[0]))
daily_20140106_addname_dataframe.to_excel(daily_201401_excel_writer,'6_1',index=False)
daily_201401_excel_writer.save()
daily_20140107 = pro.daily(start_date='',end_date='',trade_date='20140107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140107_tscode_list = list() 
for ts_code_sh in daily_20140107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140107_tscode_list.append(stock_name)
daily_20140107_addname_dataframe=pd.DataFrame()
daily_20140107_addname_dataframe['cname'] = daily_20140107_tscode_list
for table_name in daily_20140107.columns.values.tolist():
    daily_20140107_addname_dataframe[table_name] = daily_20140107[table_name]
print("daily_20140107 返回数据 row 行数 = "+str(daily_20140107.shape[0]))
daily_20140107_addname_dataframe.to_excel(daily_201401_excel_writer,'7_2',index=False)
daily_201401_excel_writer.save()
daily_20140108 = pro.daily(start_date='',end_date='',trade_date='20140108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140108_tscode_list = list() 
for ts_code_sh in daily_20140108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140108_tscode_list.append(stock_name)
daily_20140108_addname_dataframe=pd.DataFrame()
daily_20140108_addname_dataframe['cname'] = daily_20140108_tscode_list
for table_name in daily_20140108.columns.values.tolist():
    daily_20140108_addname_dataframe[table_name] = daily_20140108[table_name]
print("daily_20140108 返回数据 row 行数 = "+str(daily_20140108.shape[0]))
daily_20140108_addname_dataframe.to_excel(daily_201401_excel_writer,'8_3',index=False)
daily_201401_excel_writer.save()
daily_20140109 = pro.daily(start_date='',end_date='',trade_date='20140109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140109_tscode_list = list() 
for ts_code_sh in daily_20140109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140109_tscode_list.append(stock_name)
daily_20140109_addname_dataframe=pd.DataFrame()
daily_20140109_addname_dataframe['cname'] = daily_20140109_tscode_list
for table_name in daily_20140109.columns.values.tolist():
    daily_20140109_addname_dataframe[table_name] = daily_20140109[table_name]
print("daily_20140109 返回数据 row 行数 = "+str(daily_20140109.shape[0]))
daily_20140109_addname_dataframe.to_excel(daily_201401_excel_writer,'9_4',index=False)
daily_201401_excel_writer.save()
daily_20140110 = pro.daily(start_date='',end_date='',trade_date='20140110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140110_tscode_list = list() 
for ts_code_sh in daily_20140110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140110_tscode_list.append(stock_name)
daily_20140110_addname_dataframe=pd.DataFrame()
daily_20140110_addname_dataframe['cname'] = daily_20140110_tscode_list
for table_name in daily_20140110.columns.values.tolist():
    daily_20140110_addname_dataframe[table_name] = daily_20140110[table_name]
print("daily_20140110 返回数据 row 行数 = "+str(daily_20140110.shape[0]))
daily_20140110_addname_dataframe.to_excel(daily_201401_excel_writer,'10_5',index=False)
daily_201401_excel_writer.save()
daily_20140111 = pro.daily(start_date='',end_date='',trade_date='20140111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140111_tscode_list = list() 
for ts_code_sh in daily_20140111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140111_tscode_list.append(stock_name)
daily_20140111_addname_dataframe=pd.DataFrame()
daily_20140111_addname_dataframe['cname'] = daily_20140111_tscode_list
for table_name in daily_20140111.columns.values.tolist():
    daily_20140111_addname_dataframe[table_name] = daily_20140111[table_name]
print("daily_20140111 返回数据 row 行数 = "+str(daily_20140111.shape[0]))
daily_20140111_addname_dataframe.to_excel(daily_201401_excel_writer,'11_6',index=False)
daily_201401_excel_writer.save()
daily_20140112 = pro.daily(start_date='',end_date='',trade_date='20140112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140112_tscode_list = list() 
for ts_code_sh in daily_20140112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140112_tscode_list.append(stock_name)
daily_20140112_addname_dataframe=pd.DataFrame()
daily_20140112_addname_dataframe['cname'] = daily_20140112_tscode_list
for table_name in daily_20140112.columns.values.tolist():
    daily_20140112_addname_dataframe[table_name] = daily_20140112[table_name]
print("daily_20140112 返回数据 row 行数 = "+str(daily_20140112.shape[0]))
daily_20140112_addname_dataframe.to_excel(daily_201401_excel_writer,'12_7',index=False)
daily_201401_excel_writer.save()
daily_20140113 = pro.daily(start_date='',end_date='',trade_date='20140113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140113_tscode_list = list() 
for ts_code_sh in daily_20140113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140113_tscode_list.append(stock_name)
daily_20140113_addname_dataframe=pd.DataFrame()
daily_20140113_addname_dataframe['cname'] = daily_20140113_tscode_list
for table_name in daily_20140113.columns.values.tolist():
    daily_20140113_addname_dataframe[table_name] = daily_20140113[table_name]
print("daily_20140113 返回数据 row 行数 = "+str(daily_20140113.shape[0]))
daily_20140113_addname_dataframe.to_excel(daily_201401_excel_writer,'13_1',index=False)
daily_201401_excel_writer.save()
daily_20140114 = pro.daily(start_date='',end_date='',trade_date='20140114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140114_tscode_list = list() 
for ts_code_sh in daily_20140114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140114_tscode_list.append(stock_name)
daily_20140114_addname_dataframe=pd.DataFrame()
daily_20140114_addname_dataframe['cname'] = daily_20140114_tscode_list
for table_name in daily_20140114.columns.values.tolist():
    daily_20140114_addname_dataframe[table_name] = daily_20140114[table_name]
print("daily_20140114 返回数据 row 行数 = "+str(daily_20140114.shape[0]))
daily_20140114_addname_dataframe.to_excel(daily_201401_excel_writer,'14_2',index=False)
daily_201401_excel_writer.save()
daily_20140115 = pro.daily(start_date='',end_date='',trade_date='20140115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140115_tscode_list = list() 
for ts_code_sh in daily_20140115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140115_tscode_list.append(stock_name)
daily_20140115_addname_dataframe=pd.DataFrame()
daily_20140115_addname_dataframe['cname'] = daily_20140115_tscode_list
for table_name in daily_20140115.columns.values.tolist():
    daily_20140115_addname_dataframe[table_name] = daily_20140115[table_name]
print("daily_20140115 返回数据 row 行数 = "+str(daily_20140115.shape[0]))
daily_20140115_addname_dataframe.to_excel(daily_201401_excel_writer,'15_3',index=False)
daily_201401_excel_writer.save()
daily_20140116 = pro.daily(start_date='',end_date='',trade_date='20140116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140116_tscode_list = list() 
for ts_code_sh in daily_20140116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140116_tscode_list.append(stock_name)
daily_20140116_addname_dataframe=pd.DataFrame()
daily_20140116_addname_dataframe['cname'] = daily_20140116_tscode_list
for table_name in daily_20140116.columns.values.tolist():
    daily_20140116_addname_dataframe[table_name] = daily_20140116[table_name]
print("daily_20140116 返回数据 row 行数 = "+str(daily_20140116.shape[0]))
daily_20140116_addname_dataframe.to_excel(daily_201401_excel_writer,'16_4',index=False)
daily_201401_excel_writer.save()
daily_20140117 = pro.daily(start_date='',end_date='',trade_date='20140117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140117_tscode_list = list() 
for ts_code_sh in daily_20140117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140117_tscode_list.append(stock_name)
daily_20140117_addname_dataframe=pd.DataFrame()
daily_20140117_addname_dataframe['cname'] = daily_20140117_tscode_list
for table_name in daily_20140117.columns.values.tolist():
    daily_20140117_addname_dataframe[table_name] = daily_20140117[table_name]
print("daily_20140117 返回数据 row 行数 = "+str(daily_20140117.shape[0]))
daily_20140117_addname_dataframe.to_excel(daily_201401_excel_writer,'17_5',index=False)
daily_201401_excel_writer.save()
daily_20140118 = pro.daily(start_date='',end_date='',trade_date='20140118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140118_tscode_list = list() 
for ts_code_sh in daily_20140118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140118_tscode_list.append(stock_name)
daily_20140118_addname_dataframe=pd.DataFrame()
daily_20140118_addname_dataframe['cname'] = daily_20140118_tscode_list
for table_name in daily_20140118.columns.values.tolist():
    daily_20140118_addname_dataframe[table_name] = daily_20140118[table_name]
print("daily_20140118 返回数据 row 行数 = "+str(daily_20140118.shape[0]))
daily_20140118_addname_dataframe.to_excel(daily_201401_excel_writer,'18_6',index=False)
daily_201401_excel_writer.save()
daily_20140119 = pro.daily(start_date='',end_date='',trade_date='20140119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140119_tscode_list = list() 
for ts_code_sh in daily_20140119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140119_tscode_list.append(stock_name)
daily_20140119_addname_dataframe=pd.DataFrame()
daily_20140119_addname_dataframe['cname'] = daily_20140119_tscode_list
for table_name in daily_20140119.columns.values.tolist():
    daily_20140119_addname_dataframe[table_name] = daily_20140119[table_name]
print("daily_20140119 返回数据 row 行数 = "+str(daily_20140119.shape[0]))
daily_20140119_addname_dataframe.to_excel(daily_201401_excel_writer,'19_7',index=False)
daily_201401_excel_writer.save()
daily_20140120 = pro.daily(start_date='',end_date='',trade_date='20140120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140120_tscode_list = list() 
for ts_code_sh in daily_20140120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140120_tscode_list.append(stock_name)
daily_20140120_addname_dataframe=pd.DataFrame()
daily_20140120_addname_dataframe['cname'] = daily_20140120_tscode_list
for table_name in daily_20140120.columns.values.tolist():
    daily_20140120_addname_dataframe[table_name] = daily_20140120[table_name]
print("daily_20140120 返回数据 row 行数 = "+str(daily_20140120.shape[0]))
daily_20140120_addname_dataframe.to_excel(daily_201401_excel_writer,'20_1',index=False)
daily_201401_excel_writer.save()
daily_20140121 = pro.daily(start_date='',end_date='',trade_date='20140121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140121_tscode_list = list() 
for ts_code_sh in daily_20140121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140121_tscode_list.append(stock_name)
daily_20140121_addname_dataframe=pd.DataFrame()
daily_20140121_addname_dataframe['cname'] = daily_20140121_tscode_list
for table_name in daily_20140121.columns.values.tolist():
    daily_20140121_addname_dataframe[table_name] = daily_20140121[table_name]
print("daily_20140121 返回数据 row 行数 = "+str(daily_20140121.shape[0]))
daily_20140121_addname_dataframe.to_excel(daily_201401_excel_writer,'21_2',index=False)
daily_201401_excel_writer.save()
daily_20140122 = pro.daily(start_date='',end_date='',trade_date='20140122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140122_tscode_list = list() 
for ts_code_sh in daily_20140122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140122_tscode_list.append(stock_name)
daily_20140122_addname_dataframe=pd.DataFrame()
daily_20140122_addname_dataframe['cname'] = daily_20140122_tscode_list
for table_name in daily_20140122.columns.values.tolist():
    daily_20140122_addname_dataframe[table_name] = daily_20140122[table_name]
print("daily_20140122 返回数据 row 行数 = "+str(daily_20140122.shape[0]))
daily_20140122_addname_dataframe.to_excel(daily_201401_excel_writer,'22_3',index=False)
daily_201401_excel_writer.save()
daily_20140123 = pro.daily(start_date='',end_date='',trade_date='20140123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140123_tscode_list = list() 
for ts_code_sh in daily_20140123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140123_tscode_list.append(stock_name)
daily_20140123_addname_dataframe=pd.DataFrame()
daily_20140123_addname_dataframe['cname'] = daily_20140123_tscode_list
for table_name in daily_20140123.columns.values.tolist():
    daily_20140123_addname_dataframe[table_name] = daily_20140123[table_name]
print("daily_20140123 返回数据 row 行数 = "+str(daily_20140123.shape[0]))
daily_20140123_addname_dataframe.to_excel(daily_201401_excel_writer,'23_4',index=False)
daily_201401_excel_writer.save()
daily_20140124 = pro.daily(start_date='',end_date='',trade_date='20140124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140124_tscode_list = list() 
for ts_code_sh in daily_20140124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140124_tscode_list.append(stock_name)
daily_20140124_addname_dataframe=pd.DataFrame()
daily_20140124_addname_dataframe['cname'] = daily_20140124_tscode_list
for table_name in daily_20140124.columns.values.tolist():
    daily_20140124_addname_dataframe[table_name] = daily_20140124[table_name]
print("daily_20140124 返回数据 row 行数 = "+str(daily_20140124.shape[0]))
daily_20140124_addname_dataframe.to_excel(daily_201401_excel_writer,'24_5',index=False)
daily_201401_excel_writer.save()
daily_20140125 = pro.daily(start_date='',end_date='',trade_date='20140125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140125_tscode_list = list() 
for ts_code_sh in daily_20140125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140125_tscode_list.append(stock_name)
daily_20140125_addname_dataframe=pd.DataFrame()
daily_20140125_addname_dataframe['cname'] = daily_20140125_tscode_list
for table_name in daily_20140125.columns.values.tolist():
    daily_20140125_addname_dataframe[table_name] = daily_20140125[table_name]
print("daily_20140125 返回数据 row 行数 = "+str(daily_20140125.shape[0]))
daily_20140125_addname_dataframe.to_excel(daily_201401_excel_writer,'25_6',index=False)
daily_201401_excel_writer.save()
daily_20140126 = pro.daily(start_date='',end_date='',trade_date='20140126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140126_tscode_list = list() 
for ts_code_sh in daily_20140126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140126_tscode_list.append(stock_name)
daily_20140126_addname_dataframe=pd.DataFrame()
daily_20140126_addname_dataframe['cname'] = daily_20140126_tscode_list
for table_name in daily_20140126.columns.values.tolist():
    daily_20140126_addname_dataframe[table_name] = daily_20140126[table_name]
print("daily_20140126 返回数据 row 行数 = "+str(daily_20140126.shape[0]))
daily_20140126_addname_dataframe.to_excel(daily_201401_excel_writer,'26_7',index=False)
daily_201401_excel_writer.save()
daily_20140127 = pro.daily(start_date='',end_date='',trade_date='20140127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140127_tscode_list = list() 
for ts_code_sh in daily_20140127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140127_tscode_list.append(stock_name)
daily_20140127_addname_dataframe=pd.DataFrame()
daily_20140127_addname_dataframe['cname'] = daily_20140127_tscode_list
for table_name in daily_20140127.columns.values.tolist():
    daily_20140127_addname_dataframe[table_name] = daily_20140127[table_name]
print("daily_20140127 返回数据 row 行数 = "+str(daily_20140127.shape[0]))
daily_20140127_addname_dataframe.to_excel(daily_201401_excel_writer,'27_1',index=False)
daily_201401_excel_writer.save()
daily_20140128 = pro.daily(start_date='',end_date='',trade_date='20140128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140128_tscode_list = list() 
for ts_code_sh in daily_20140128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140128_tscode_list.append(stock_name)
daily_20140128_addname_dataframe=pd.DataFrame()
daily_20140128_addname_dataframe['cname'] = daily_20140128_tscode_list
for table_name in daily_20140128.columns.values.tolist():
    daily_20140128_addname_dataframe[table_name] = daily_20140128[table_name]
print("daily_20140128 返回数据 row 行数 = "+str(daily_20140128.shape[0]))
daily_20140128_addname_dataframe.to_excel(daily_201401_excel_writer,'28_2',index=False)
daily_201401_excel_writer.save()
daily_20140129 = pro.daily(start_date='',end_date='',trade_date='20140129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140129_tscode_list = list() 
for ts_code_sh in daily_20140129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140129_tscode_list.append(stock_name)
daily_20140129_addname_dataframe=pd.DataFrame()
daily_20140129_addname_dataframe['cname'] = daily_20140129_tscode_list
for table_name in daily_20140129.columns.values.tolist():
    daily_20140129_addname_dataframe[table_name] = daily_20140129[table_name]
print("daily_20140129 返回数据 row 行数 = "+str(daily_20140129.shape[0]))
daily_20140129_addname_dataframe.to_excel(daily_201401_excel_writer,'29_3',index=False)
daily_201401_excel_writer.save()
daily_20140130 = pro.daily(start_date='',end_date='',trade_date='20140130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140130_tscode_list = list() 
for ts_code_sh in daily_20140130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140130_tscode_list.append(stock_name)
daily_20140130_addname_dataframe=pd.DataFrame()
daily_20140130_addname_dataframe['cname'] = daily_20140130_tscode_list
for table_name in daily_20140130.columns.values.tolist():
    daily_20140130_addname_dataframe[table_name] = daily_20140130[table_name]
print("daily_20140130 返回数据 row 行数 = "+str(daily_20140130.shape[0]))
daily_20140130_addname_dataframe.to_excel(daily_201401_excel_writer,'30_4',index=False)
daily_201401_excel_writer.save()
daily_20140131 = pro.daily(start_date='',end_date='',trade_date='20140131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140131_tscode_list = list() 
for ts_code_sh in daily_20140131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140131_tscode_list.append(stock_name)
daily_20140131_addname_dataframe=pd.DataFrame()
daily_20140131_addname_dataframe['cname'] = daily_20140131_tscode_list
for table_name in daily_20140131.columns.values.tolist():
    daily_20140131_addname_dataframe[table_name] = daily_20140131[table_name]
print("daily_20140131 返回数据 row 行数 = "+str(daily_20140131.shape[0]))
daily_20140131_addname_dataframe.to_excel(daily_201401_excel_writer,'31_5',index=False)
daily_201401_excel_writer.save()




createexcel('daily_201402.xlsx')
daily_201402_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201402.xlsx')
daily_201402_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201402.xlsx', engine='openpyxl')
daily_201402_excel_writer.book = daily_201402_book
daily_201402_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201402_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140201")       ###  更新 记录日期
daily_20140201 = pro.daily(start_date='',end_date='',trade_date='20140201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140201_tscode_list = list() 
for ts_code_sh in daily_20140201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140201_tscode_list.append(stock_name)
daily_20140201_addname_dataframe=pd.DataFrame()
daily_20140201_addname_dataframe['cname'] = daily_20140201_tscode_list
for table_name in daily_20140201.columns.values.tolist():
    daily_20140201_addname_dataframe[table_name] = daily_20140201[table_name]
print("daily_20140201 返回数据 row 行数 = "+str(daily_20140201.shape[0]))
daily_20140201_addname_dataframe.to_excel(daily_201402_excel_writer,'1_6',index=False)
daily_201402_excel_writer.save()
daily_20140202 = pro.daily(start_date='',end_date='',trade_date='20140202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140202_tscode_list = list() 
for ts_code_sh in daily_20140202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140202_tscode_list.append(stock_name)
daily_20140202_addname_dataframe=pd.DataFrame()
daily_20140202_addname_dataframe['cname'] = daily_20140202_tscode_list
for table_name in daily_20140202.columns.values.tolist():
    daily_20140202_addname_dataframe[table_name] = daily_20140202[table_name]
print("daily_20140202 返回数据 row 行数 = "+str(daily_20140202.shape[0]))
daily_20140202_addname_dataframe.to_excel(daily_201402_excel_writer,'2_7',index=False)
daily_201402_excel_writer.save()
daily_20140203 = pro.daily(start_date='',end_date='',trade_date='20140203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140203_tscode_list = list() 
for ts_code_sh in daily_20140203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140203_tscode_list.append(stock_name)
daily_20140203_addname_dataframe=pd.DataFrame()
daily_20140203_addname_dataframe['cname'] = daily_20140203_tscode_list
for table_name in daily_20140203.columns.values.tolist():
    daily_20140203_addname_dataframe[table_name] = daily_20140203[table_name]
print("daily_20140203 返回数据 row 行数 = "+str(daily_20140203.shape[0]))
daily_20140203_addname_dataframe.to_excel(daily_201402_excel_writer,'3_1',index=False)
daily_201402_excel_writer.save()
daily_20140204 = pro.daily(start_date='',end_date='',trade_date='20140204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140204_tscode_list = list() 
for ts_code_sh in daily_20140204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140204_tscode_list.append(stock_name)
daily_20140204_addname_dataframe=pd.DataFrame()
daily_20140204_addname_dataframe['cname'] = daily_20140204_tscode_list
for table_name in daily_20140204.columns.values.tolist():
    daily_20140204_addname_dataframe[table_name] = daily_20140204[table_name]
print("daily_20140204 返回数据 row 行数 = "+str(daily_20140204.shape[0]))
daily_20140204_addname_dataframe.to_excel(daily_201402_excel_writer,'4_2',index=False)
daily_201402_excel_writer.save()
daily_20140205 = pro.daily(start_date='',end_date='',trade_date='20140205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140205_tscode_list = list() 
for ts_code_sh in daily_20140205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140205_tscode_list.append(stock_name)
daily_20140205_addname_dataframe=pd.DataFrame()
daily_20140205_addname_dataframe['cname'] = daily_20140205_tscode_list
for table_name in daily_20140205.columns.values.tolist():
    daily_20140205_addname_dataframe[table_name] = daily_20140205[table_name]
print("daily_20140205 返回数据 row 行数 = "+str(daily_20140205.shape[0]))
daily_20140205_addname_dataframe.to_excel(daily_201402_excel_writer,'5_3',index=False)
daily_201402_excel_writer.save()
daily_20140206 = pro.daily(start_date='',end_date='',trade_date='20140206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140206_tscode_list = list() 
for ts_code_sh in daily_20140206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140206_tscode_list.append(stock_name)
daily_20140206_addname_dataframe=pd.DataFrame()
daily_20140206_addname_dataframe['cname'] = daily_20140206_tscode_list
for table_name in daily_20140206.columns.values.tolist():
    daily_20140206_addname_dataframe[table_name] = daily_20140206[table_name]
print("daily_20140206 返回数据 row 行数 = "+str(daily_20140206.shape[0]))
daily_20140206_addname_dataframe.to_excel(daily_201402_excel_writer,'6_4',index=False)
daily_201402_excel_writer.save()
daily_20140207 = pro.daily(start_date='',end_date='',trade_date='20140207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140207_tscode_list = list() 
for ts_code_sh in daily_20140207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140207_tscode_list.append(stock_name)
daily_20140207_addname_dataframe=pd.DataFrame()
daily_20140207_addname_dataframe['cname'] = daily_20140207_tscode_list
for table_name in daily_20140207.columns.values.tolist():
    daily_20140207_addname_dataframe[table_name] = daily_20140207[table_name]
print("daily_20140207 返回数据 row 行数 = "+str(daily_20140207.shape[0]))
daily_20140207_addname_dataframe.to_excel(daily_201402_excel_writer,'7_5',index=False)
daily_201402_excel_writer.save()
daily_20140208 = pro.daily(start_date='',end_date='',trade_date='20140208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140208_tscode_list = list() 
for ts_code_sh in daily_20140208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140208_tscode_list.append(stock_name)
daily_20140208_addname_dataframe=pd.DataFrame()
daily_20140208_addname_dataframe['cname'] = daily_20140208_tscode_list
for table_name in daily_20140208.columns.values.tolist():
    daily_20140208_addname_dataframe[table_name] = daily_20140208[table_name]
print("daily_20140208 返回数据 row 行数 = "+str(daily_20140208.shape[0]))
daily_20140208_addname_dataframe.to_excel(daily_201402_excel_writer,'8_6',index=False)
daily_201402_excel_writer.save()
daily_20140209 = pro.daily(start_date='',end_date='',trade_date='20140209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140209_tscode_list = list() 
for ts_code_sh in daily_20140209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140209_tscode_list.append(stock_name)
daily_20140209_addname_dataframe=pd.DataFrame()
daily_20140209_addname_dataframe['cname'] = daily_20140209_tscode_list
for table_name in daily_20140209.columns.values.tolist():
    daily_20140209_addname_dataframe[table_name] = daily_20140209[table_name]
print("daily_20140209 返回数据 row 行数 = "+str(daily_20140209.shape[0]))
daily_20140209_addname_dataframe.to_excel(daily_201402_excel_writer,'9_7',index=False)
daily_201402_excel_writer.save()
daily_20140210 = pro.daily(start_date='',end_date='',trade_date='20140210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140210_tscode_list = list() 
for ts_code_sh in daily_20140210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140210_tscode_list.append(stock_name)
daily_20140210_addname_dataframe=pd.DataFrame()
daily_20140210_addname_dataframe['cname'] = daily_20140210_tscode_list
for table_name in daily_20140210.columns.values.tolist():
    daily_20140210_addname_dataframe[table_name] = daily_20140210[table_name]
print("daily_20140210 返回数据 row 行数 = "+str(daily_20140210.shape[0]))
daily_20140210_addname_dataframe.to_excel(daily_201402_excel_writer,'10_1',index=False)
daily_201402_excel_writer.save()
daily_20140211 = pro.daily(start_date='',end_date='',trade_date='20140211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140211_tscode_list = list() 
for ts_code_sh in daily_20140211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140211_tscode_list.append(stock_name)
daily_20140211_addname_dataframe=pd.DataFrame()
daily_20140211_addname_dataframe['cname'] = daily_20140211_tscode_list
for table_name in daily_20140211.columns.values.tolist():
    daily_20140211_addname_dataframe[table_name] = daily_20140211[table_name]
print("daily_20140211 返回数据 row 行数 = "+str(daily_20140211.shape[0]))
daily_20140211_addname_dataframe.to_excel(daily_201402_excel_writer,'11_2',index=False)
daily_201402_excel_writer.save()
daily_20140212 = pro.daily(start_date='',end_date='',trade_date='20140212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140212_tscode_list = list() 
for ts_code_sh in daily_20140212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140212_tscode_list.append(stock_name)
daily_20140212_addname_dataframe=pd.DataFrame()
daily_20140212_addname_dataframe['cname'] = daily_20140212_tscode_list
for table_name in daily_20140212.columns.values.tolist():
    daily_20140212_addname_dataframe[table_name] = daily_20140212[table_name]
print("daily_20140212 返回数据 row 行数 = "+str(daily_20140212.shape[0]))
daily_20140212_addname_dataframe.to_excel(daily_201402_excel_writer,'12_3',index=False)
daily_201402_excel_writer.save()
daily_20140213 = pro.daily(start_date='',end_date='',trade_date='20140213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140213_tscode_list = list() 
for ts_code_sh in daily_20140213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140213_tscode_list.append(stock_name)
daily_20140213_addname_dataframe=pd.DataFrame()
daily_20140213_addname_dataframe['cname'] = daily_20140213_tscode_list
for table_name in daily_20140213.columns.values.tolist():
    daily_20140213_addname_dataframe[table_name] = daily_20140213[table_name]
print("daily_20140213 返回数据 row 行数 = "+str(daily_20140213.shape[0]))
daily_20140213_addname_dataframe.to_excel(daily_201402_excel_writer,'13_4',index=False)
daily_201402_excel_writer.save()
daily_20140214 = pro.daily(start_date='',end_date='',trade_date='20140214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140214_tscode_list = list() 
for ts_code_sh in daily_20140214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140214_tscode_list.append(stock_name)
daily_20140214_addname_dataframe=pd.DataFrame()
daily_20140214_addname_dataframe['cname'] = daily_20140214_tscode_list
for table_name in daily_20140214.columns.values.tolist():
    daily_20140214_addname_dataframe[table_name] = daily_20140214[table_name]
print("daily_20140214 返回数据 row 行数 = "+str(daily_20140214.shape[0]))
daily_20140214_addname_dataframe.to_excel(daily_201402_excel_writer,'14_5',index=False)
daily_201402_excel_writer.save()
daily_20140215 = pro.daily(start_date='',end_date='',trade_date='20140215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140215_tscode_list = list() 
for ts_code_sh in daily_20140215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140215_tscode_list.append(stock_name)
daily_20140215_addname_dataframe=pd.DataFrame()
daily_20140215_addname_dataframe['cname'] = daily_20140215_tscode_list
for table_name in daily_20140215.columns.values.tolist():
    daily_20140215_addname_dataframe[table_name] = daily_20140215[table_name]
print("daily_20140215 返回数据 row 行数 = "+str(daily_20140215.shape[0]))
daily_20140215_addname_dataframe.to_excel(daily_201402_excel_writer,'15_6',index=False)
daily_201402_excel_writer.save()
daily_20140216 = pro.daily(start_date='',end_date='',trade_date='20140216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140216_tscode_list = list() 
for ts_code_sh in daily_20140216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140216_tscode_list.append(stock_name)
daily_20140216_addname_dataframe=pd.DataFrame()
daily_20140216_addname_dataframe['cname'] = daily_20140216_tscode_list
for table_name in daily_20140216.columns.values.tolist():
    daily_20140216_addname_dataframe[table_name] = daily_20140216[table_name]
print("daily_20140216 返回数据 row 行数 = "+str(daily_20140216.shape[0]))
daily_20140216_addname_dataframe.to_excel(daily_201402_excel_writer,'16_7',index=False)
daily_201402_excel_writer.save()
daily_20140217 = pro.daily(start_date='',end_date='',trade_date='20140217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140217_tscode_list = list() 
for ts_code_sh in daily_20140217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140217_tscode_list.append(stock_name)
daily_20140217_addname_dataframe=pd.DataFrame()
daily_20140217_addname_dataframe['cname'] = daily_20140217_tscode_list
for table_name in daily_20140217.columns.values.tolist():
    daily_20140217_addname_dataframe[table_name] = daily_20140217[table_name]
print("daily_20140217 返回数据 row 行数 = "+str(daily_20140217.shape[0]))
daily_20140217_addname_dataframe.to_excel(daily_201402_excel_writer,'17_1',index=False)
daily_201402_excel_writer.save()
daily_20140218 = pro.daily(start_date='',end_date='',trade_date='20140218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140218_tscode_list = list() 
for ts_code_sh in daily_20140218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140218_tscode_list.append(stock_name)
daily_20140218_addname_dataframe=pd.DataFrame()
daily_20140218_addname_dataframe['cname'] = daily_20140218_tscode_list
for table_name in daily_20140218.columns.values.tolist():
    daily_20140218_addname_dataframe[table_name] = daily_20140218[table_name]
print("daily_20140218 返回数据 row 行数 = "+str(daily_20140218.shape[0]))
daily_20140218_addname_dataframe.to_excel(daily_201402_excel_writer,'18_2',index=False)
daily_201402_excel_writer.save()
daily_20140219 = pro.daily(start_date='',end_date='',trade_date='20140219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140219_tscode_list = list() 
for ts_code_sh in daily_20140219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140219_tscode_list.append(stock_name)
daily_20140219_addname_dataframe=pd.DataFrame()
daily_20140219_addname_dataframe['cname'] = daily_20140219_tscode_list
for table_name in daily_20140219.columns.values.tolist():
    daily_20140219_addname_dataframe[table_name] = daily_20140219[table_name]
print("daily_20140219 返回数据 row 行数 = "+str(daily_20140219.shape[0]))
daily_20140219_addname_dataframe.to_excel(daily_201402_excel_writer,'19_3',index=False)
daily_201402_excel_writer.save()
daily_20140220 = pro.daily(start_date='',end_date='',trade_date='20140220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140220_tscode_list = list() 
for ts_code_sh in daily_20140220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140220_tscode_list.append(stock_name)
daily_20140220_addname_dataframe=pd.DataFrame()
daily_20140220_addname_dataframe['cname'] = daily_20140220_tscode_list
for table_name in daily_20140220.columns.values.tolist():
    daily_20140220_addname_dataframe[table_name] = daily_20140220[table_name]
print("daily_20140220 返回数据 row 行数 = "+str(daily_20140220.shape[0]))
daily_20140220_addname_dataframe.to_excel(daily_201402_excel_writer,'20_4',index=False)
daily_201402_excel_writer.save()
daily_20140221 = pro.daily(start_date='',end_date='',trade_date='20140221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140221_tscode_list = list() 
for ts_code_sh in daily_20140221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140221_tscode_list.append(stock_name)
daily_20140221_addname_dataframe=pd.DataFrame()
daily_20140221_addname_dataframe['cname'] = daily_20140221_tscode_list
for table_name in daily_20140221.columns.values.tolist():
    daily_20140221_addname_dataframe[table_name] = daily_20140221[table_name]
print("daily_20140221 返回数据 row 行数 = "+str(daily_20140221.shape[0]))
daily_20140221_addname_dataframe.to_excel(daily_201402_excel_writer,'21_5',index=False)
daily_201402_excel_writer.save()
daily_20140222 = pro.daily(start_date='',end_date='',trade_date='20140222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140222_tscode_list = list() 
for ts_code_sh in daily_20140222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140222_tscode_list.append(stock_name)
daily_20140222_addname_dataframe=pd.DataFrame()
daily_20140222_addname_dataframe['cname'] = daily_20140222_tscode_list
for table_name in daily_20140222.columns.values.tolist():
    daily_20140222_addname_dataframe[table_name] = daily_20140222[table_name]
print("daily_20140222 返回数据 row 行数 = "+str(daily_20140222.shape[0]))
daily_20140222_addname_dataframe.to_excel(daily_201402_excel_writer,'22_6',index=False)
daily_201402_excel_writer.save()
daily_20140223 = pro.daily(start_date='',end_date='',trade_date='20140223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140223_tscode_list = list() 
for ts_code_sh in daily_20140223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140223_tscode_list.append(stock_name)
daily_20140223_addname_dataframe=pd.DataFrame()
daily_20140223_addname_dataframe['cname'] = daily_20140223_tscode_list
for table_name in daily_20140223.columns.values.tolist():
    daily_20140223_addname_dataframe[table_name] = daily_20140223[table_name]
print("daily_20140223 返回数据 row 行数 = "+str(daily_20140223.shape[0]))
daily_20140223_addname_dataframe.to_excel(daily_201402_excel_writer,'23_7',index=False)
daily_201402_excel_writer.save()
daily_20140224 = pro.daily(start_date='',end_date='',trade_date='20140224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140224_tscode_list = list() 
for ts_code_sh in daily_20140224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140224_tscode_list.append(stock_name)
daily_20140224_addname_dataframe=pd.DataFrame()
daily_20140224_addname_dataframe['cname'] = daily_20140224_tscode_list
for table_name in daily_20140224.columns.values.tolist():
    daily_20140224_addname_dataframe[table_name] = daily_20140224[table_name]
print("daily_20140224 返回数据 row 行数 = "+str(daily_20140224.shape[0]))
daily_20140224_addname_dataframe.to_excel(daily_201402_excel_writer,'24_1',index=False)
daily_201402_excel_writer.save()
daily_20140225 = pro.daily(start_date='',end_date='',trade_date='20140225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140225_tscode_list = list() 
for ts_code_sh in daily_20140225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140225_tscode_list.append(stock_name)
daily_20140225_addname_dataframe=pd.DataFrame()
daily_20140225_addname_dataframe['cname'] = daily_20140225_tscode_list
for table_name in daily_20140225.columns.values.tolist():
    daily_20140225_addname_dataframe[table_name] = daily_20140225[table_name]
print("daily_20140225 返回数据 row 行数 = "+str(daily_20140225.shape[0]))
daily_20140225_addname_dataframe.to_excel(daily_201402_excel_writer,'25_2',index=False)
daily_201402_excel_writer.save()
daily_20140226 = pro.daily(start_date='',end_date='',trade_date='20140226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140226_tscode_list = list() 
for ts_code_sh in daily_20140226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140226_tscode_list.append(stock_name)
daily_20140226_addname_dataframe=pd.DataFrame()
daily_20140226_addname_dataframe['cname'] = daily_20140226_tscode_list
for table_name in daily_20140226.columns.values.tolist():
    daily_20140226_addname_dataframe[table_name] = daily_20140226[table_name]
print("daily_20140226 返回数据 row 行数 = "+str(daily_20140226.shape[0]))
daily_20140226_addname_dataframe.to_excel(daily_201402_excel_writer,'26_3',index=False)
daily_201402_excel_writer.save()
daily_20140227 = pro.daily(start_date='',end_date='',trade_date='20140227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140227_tscode_list = list() 
for ts_code_sh in daily_20140227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140227_tscode_list.append(stock_name)
daily_20140227_addname_dataframe=pd.DataFrame()
daily_20140227_addname_dataframe['cname'] = daily_20140227_tscode_list
for table_name in daily_20140227.columns.values.tolist():
    daily_20140227_addname_dataframe[table_name] = daily_20140227[table_name]
print("daily_20140227 返回数据 row 行数 = "+str(daily_20140227.shape[0]))
daily_20140227_addname_dataframe.to_excel(daily_201402_excel_writer,'27_4',index=False)
daily_201402_excel_writer.save()
daily_20140228 = pro.daily(start_date='',end_date='',trade_date='20140228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140228_tscode_list = list() 
for ts_code_sh in daily_20140228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140228_tscode_list.append(stock_name)
daily_20140228_addname_dataframe=pd.DataFrame()
daily_20140228_addname_dataframe['cname'] = daily_20140228_tscode_list
for table_name in daily_20140228.columns.values.tolist():
    daily_20140228_addname_dataframe[table_name] = daily_20140228[table_name]
print("daily_20140228 返回数据 row 行数 = "+str(daily_20140228.shape[0]))
daily_20140228_addname_dataframe.to_excel(daily_201402_excel_writer,'28_5',index=False)
daily_201402_excel_writer.save()




createexcel('daily_201403.xlsx')
daily_201403_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201403.xlsx')
daily_201403_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201403.xlsx', engine='openpyxl')
daily_201403_excel_writer.book = daily_201403_book
daily_201403_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201403_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140301")       ###  更新 记录日期
daily_20140301 = pro.daily(start_date='',end_date='',trade_date='20140301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140301_tscode_list = list() 
for ts_code_sh in daily_20140301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140301_tscode_list.append(stock_name)
daily_20140301_addname_dataframe=pd.DataFrame()
daily_20140301_addname_dataframe['cname'] = daily_20140301_tscode_list
for table_name in daily_20140301.columns.values.tolist():
    daily_20140301_addname_dataframe[table_name] = daily_20140301[table_name]
print("daily_20140301 返回数据 row 行数 = "+str(daily_20140301.shape[0]))
daily_20140301_addname_dataframe.to_excel(daily_201403_excel_writer,'1_6',index=False)
daily_201403_excel_writer.save()
daily_20140302 = pro.daily(start_date='',end_date='',trade_date='20140302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140302_tscode_list = list() 
for ts_code_sh in daily_20140302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140302_tscode_list.append(stock_name)
daily_20140302_addname_dataframe=pd.DataFrame()
daily_20140302_addname_dataframe['cname'] = daily_20140302_tscode_list
for table_name in daily_20140302.columns.values.tolist():
    daily_20140302_addname_dataframe[table_name] = daily_20140302[table_name]
print("daily_20140302 返回数据 row 行数 = "+str(daily_20140302.shape[0]))
daily_20140302_addname_dataframe.to_excel(daily_201403_excel_writer,'2_7',index=False)
daily_201403_excel_writer.save()
daily_20140303 = pro.daily(start_date='',end_date='',trade_date='20140303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140303_tscode_list = list() 
for ts_code_sh in daily_20140303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140303_tscode_list.append(stock_name)
daily_20140303_addname_dataframe=pd.DataFrame()
daily_20140303_addname_dataframe['cname'] = daily_20140303_tscode_list
for table_name in daily_20140303.columns.values.tolist():
    daily_20140303_addname_dataframe[table_name] = daily_20140303[table_name]
print("daily_20140303 返回数据 row 行数 = "+str(daily_20140303.shape[0]))
daily_20140303_addname_dataframe.to_excel(daily_201403_excel_writer,'3_1',index=False)
daily_201403_excel_writer.save()
daily_20140304 = pro.daily(start_date='',end_date='',trade_date='20140304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140304_tscode_list = list() 
for ts_code_sh in daily_20140304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140304_tscode_list.append(stock_name)
daily_20140304_addname_dataframe=pd.DataFrame()
daily_20140304_addname_dataframe['cname'] = daily_20140304_tscode_list
for table_name in daily_20140304.columns.values.tolist():
    daily_20140304_addname_dataframe[table_name] = daily_20140304[table_name]
print("daily_20140304 返回数据 row 行数 = "+str(daily_20140304.shape[0]))
daily_20140304_addname_dataframe.to_excel(daily_201403_excel_writer,'4_2',index=False)
daily_201403_excel_writer.save()
daily_20140305 = pro.daily(start_date='',end_date='',trade_date='20140305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140305_tscode_list = list() 
for ts_code_sh in daily_20140305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140305_tscode_list.append(stock_name)
daily_20140305_addname_dataframe=pd.DataFrame()
daily_20140305_addname_dataframe['cname'] = daily_20140305_tscode_list
for table_name in daily_20140305.columns.values.tolist():
    daily_20140305_addname_dataframe[table_name] = daily_20140305[table_name]
print("daily_20140305 返回数据 row 行数 = "+str(daily_20140305.shape[0]))
daily_20140305_addname_dataframe.to_excel(daily_201403_excel_writer,'5_3',index=False)
daily_201403_excel_writer.save()
daily_20140306 = pro.daily(start_date='',end_date='',trade_date='20140306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140306_tscode_list = list() 
for ts_code_sh in daily_20140306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140306_tscode_list.append(stock_name)
daily_20140306_addname_dataframe=pd.DataFrame()
daily_20140306_addname_dataframe['cname'] = daily_20140306_tscode_list
for table_name in daily_20140306.columns.values.tolist():
    daily_20140306_addname_dataframe[table_name] = daily_20140306[table_name]
print("daily_20140306 返回数据 row 行数 = "+str(daily_20140306.shape[0]))
daily_20140306_addname_dataframe.to_excel(daily_201403_excel_writer,'6_4',index=False)
daily_201403_excel_writer.save()
daily_20140307 = pro.daily(start_date='',end_date='',trade_date='20140307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140307_tscode_list = list() 
for ts_code_sh in daily_20140307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140307_tscode_list.append(stock_name)
daily_20140307_addname_dataframe=pd.DataFrame()
daily_20140307_addname_dataframe['cname'] = daily_20140307_tscode_list
for table_name in daily_20140307.columns.values.tolist():
    daily_20140307_addname_dataframe[table_name] = daily_20140307[table_name]
print("daily_20140307 返回数据 row 行数 = "+str(daily_20140307.shape[0]))
daily_20140307_addname_dataframe.to_excel(daily_201403_excel_writer,'7_5',index=False)
daily_201403_excel_writer.save()
daily_20140308 = pro.daily(start_date='',end_date='',trade_date='20140308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140308_tscode_list = list() 
for ts_code_sh in daily_20140308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140308_tscode_list.append(stock_name)
daily_20140308_addname_dataframe=pd.DataFrame()
daily_20140308_addname_dataframe['cname'] = daily_20140308_tscode_list
for table_name in daily_20140308.columns.values.tolist():
    daily_20140308_addname_dataframe[table_name] = daily_20140308[table_name]
print("daily_20140308 返回数据 row 行数 = "+str(daily_20140308.shape[0]))
daily_20140308_addname_dataframe.to_excel(daily_201403_excel_writer,'8_6',index=False)
daily_201403_excel_writer.save()
daily_20140309 = pro.daily(start_date='',end_date='',trade_date='20140309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140309_tscode_list = list() 
for ts_code_sh in daily_20140309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140309_tscode_list.append(stock_name)
daily_20140309_addname_dataframe=pd.DataFrame()
daily_20140309_addname_dataframe['cname'] = daily_20140309_tscode_list
for table_name in daily_20140309.columns.values.tolist():
    daily_20140309_addname_dataframe[table_name] = daily_20140309[table_name]
print("daily_20140309 返回数据 row 行数 = "+str(daily_20140309.shape[0]))
daily_20140309_addname_dataframe.to_excel(daily_201403_excel_writer,'9_7',index=False)
daily_201403_excel_writer.save()
daily_20140310 = pro.daily(start_date='',end_date='',trade_date='20140310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140310_tscode_list = list() 
for ts_code_sh in daily_20140310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140310_tscode_list.append(stock_name)
daily_20140310_addname_dataframe=pd.DataFrame()
daily_20140310_addname_dataframe['cname'] = daily_20140310_tscode_list
for table_name in daily_20140310.columns.values.tolist():
    daily_20140310_addname_dataframe[table_name] = daily_20140310[table_name]
print("daily_20140310 返回数据 row 行数 = "+str(daily_20140310.shape[0]))
daily_20140310_addname_dataframe.to_excel(daily_201403_excel_writer,'10_1',index=False)
daily_201403_excel_writer.save()
daily_20140311 = pro.daily(start_date='',end_date='',trade_date='20140311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140311_tscode_list = list() 
for ts_code_sh in daily_20140311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140311_tscode_list.append(stock_name)
daily_20140311_addname_dataframe=pd.DataFrame()
daily_20140311_addname_dataframe['cname'] = daily_20140311_tscode_list
for table_name in daily_20140311.columns.values.tolist():
    daily_20140311_addname_dataframe[table_name] = daily_20140311[table_name]
print("daily_20140311 返回数据 row 行数 = "+str(daily_20140311.shape[0]))
daily_20140311_addname_dataframe.to_excel(daily_201403_excel_writer,'11_2',index=False)
daily_201403_excel_writer.save()
daily_20140312 = pro.daily(start_date='',end_date='',trade_date='20140312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140312_tscode_list = list() 
for ts_code_sh in daily_20140312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140312_tscode_list.append(stock_name)
daily_20140312_addname_dataframe=pd.DataFrame()
daily_20140312_addname_dataframe['cname'] = daily_20140312_tscode_list
for table_name in daily_20140312.columns.values.tolist():
    daily_20140312_addname_dataframe[table_name] = daily_20140312[table_name]
print("daily_20140312 返回数据 row 行数 = "+str(daily_20140312.shape[0]))
daily_20140312_addname_dataframe.to_excel(daily_201403_excel_writer,'12_3',index=False)
daily_201403_excel_writer.save()
daily_20140313 = pro.daily(start_date='',end_date='',trade_date='20140313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140313_tscode_list = list() 
for ts_code_sh in daily_20140313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140313_tscode_list.append(stock_name)
daily_20140313_addname_dataframe=pd.DataFrame()
daily_20140313_addname_dataframe['cname'] = daily_20140313_tscode_list
for table_name in daily_20140313.columns.values.tolist():
    daily_20140313_addname_dataframe[table_name] = daily_20140313[table_name]
print("daily_20140313 返回数据 row 行数 = "+str(daily_20140313.shape[0]))
daily_20140313_addname_dataframe.to_excel(daily_201403_excel_writer,'13_4',index=False)
daily_201403_excel_writer.save()
daily_20140314 = pro.daily(start_date='',end_date='',trade_date='20140314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140314_tscode_list = list() 
for ts_code_sh in daily_20140314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140314_tscode_list.append(stock_name)
daily_20140314_addname_dataframe=pd.DataFrame()
daily_20140314_addname_dataframe['cname'] = daily_20140314_tscode_list
for table_name in daily_20140314.columns.values.tolist():
    daily_20140314_addname_dataframe[table_name] = daily_20140314[table_name]
print("daily_20140314 返回数据 row 行数 = "+str(daily_20140314.shape[0]))
daily_20140314_addname_dataframe.to_excel(daily_201403_excel_writer,'14_5',index=False)
daily_201403_excel_writer.save()
daily_20140315 = pro.daily(start_date='',end_date='',trade_date='20140315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140315_tscode_list = list() 
for ts_code_sh in daily_20140315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140315_tscode_list.append(stock_name)
daily_20140315_addname_dataframe=pd.DataFrame()
daily_20140315_addname_dataframe['cname'] = daily_20140315_tscode_list
for table_name in daily_20140315.columns.values.tolist():
    daily_20140315_addname_dataframe[table_name] = daily_20140315[table_name]
print("daily_20140315 返回数据 row 行数 = "+str(daily_20140315.shape[0]))
daily_20140315_addname_dataframe.to_excel(daily_201403_excel_writer,'15_6',index=False)
daily_201403_excel_writer.save()
daily_20140316 = pro.daily(start_date='',end_date='',trade_date='20140316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140316_tscode_list = list() 
for ts_code_sh in daily_20140316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140316_tscode_list.append(stock_name)
daily_20140316_addname_dataframe=pd.DataFrame()
daily_20140316_addname_dataframe['cname'] = daily_20140316_tscode_list
for table_name in daily_20140316.columns.values.tolist():
    daily_20140316_addname_dataframe[table_name] = daily_20140316[table_name]
print("daily_20140316 返回数据 row 行数 = "+str(daily_20140316.shape[0]))
daily_20140316_addname_dataframe.to_excel(daily_201403_excel_writer,'16_7',index=False)
daily_201403_excel_writer.save()
daily_20140317 = pro.daily(start_date='',end_date='',trade_date='20140317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140317_tscode_list = list() 
for ts_code_sh in daily_20140317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140317_tscode_list.append(stock_name)
daily_20140317_addname_dataframe=pd.DataFrame()
daily_20140317_addname_dataframe['cname'] = daily_20140317_tscode_list
for table_name in daily_20140317.columns.values.tolist():
    daily_20140317_addname_dataframe[table_name] = daily_20140317[table_name]
print("daily_20140317 返回数据 row 行数 = "+str(daily_20140317.shape[0]))
daily_20140317_addname_dataframe.to_excel(daily_201403_excel_writer,'17_1',index=False)
daily_201403_excel_writer.save()
daily_20140318 = pro.daily(start_date='',end_date='',trade_date='20140318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140318_tscode_list = list() 
for ts_code_sh in daily_20140318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140318_tscode_list.append(stock_name)
daily_20140318_addname_dataframe=pd.DataFrame()
daily_20140318_addname_dataframe['cname'] = daily_20140318_tscode_list
for table_name in daily_20140318.columns.values.tolist():
    daily_20140318_addname_dataframe[table_name] = daily_20140318[table_name]
print("daily_20140318 返回数据 row 行数 = "+str(daily_20140318.shape[0]))
daily_20140318_addname_dataframe.to_excel(daily_201403_excel_writer,'18_2',index=False)
daily_201403_excel_writer.save()
daily_20140319 = pro.daily(start_date='',end_date='',trade_date='20140319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140319_tscode_list = list() 
for ts_code_sh in daily_20140319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140319_tscode_list.append(stock_name)
daily_20140319_addname_dataframe=pd.DataFrame()
daily_20140319_addname_dataframe['cname'] = daily_20140319_tscode_list
for table_name in daily_20140319.columns.values.tolist():
    daily_20140319_addname_dataframe[table_name] = daily_20140319[table_name]
print("daily_20140319 返回数据 row 行数 = "+str(daily_20140319.shape[0]))
daily_20140319_addname_dataframe.to_excel(daily_201403_excel_writer,'19_3',index=False)
daily_201403_excel_writer.save()
daily_20140320 = pro.daily(start_date='',end_date='',trade_date='20140320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140320_tscode_list = list() 
for ts_code_sh in daily_20140320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140320_tscode_list.append(stock_name)
daily_20140320_addname_dataframe=pd.DataFrame()
daily_20140320_addname_dataframe['cname'] = daily_20140320_tscode_list
for table_name in daily_20140320.columns.values.tolist():
    daily_20140320_addname_dataframe[table_name] = daily_20140320[table_name]
print("daily_20140320 返回数据 row 行数 = "+str(daily_20140320.shape[0]))
daily_20140320_addname_dataframe.to_excel(daily_201403_excel_writer,'20_4',index=False)
daily_201403_excel_writer.save()
daily_20140321 = pro.daily(start_date='',end_date='',trade_date='20140321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140321_tscode_list = list() 
for ts_code_sh in daily_20140321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140321_tscode_list.append(stock_name)
daily_20140321_addname_dataframe=pd.DataFrame()
daily_20140321_addname_dataframe['cname'] = daily_20140321_tscode_list
for table_name in daily_20140321.columns.values.tolist():
    daily_20140321_addname_dataframe[table_name] = daily_20140321[table_name]
print("daily_20140321 返回数据 row 行数 = "+str(daily_20140321.shape[0]))
daily_20140321_addname_dataframe.to_excel(daily_201403_excel_writer,'21_5',index=False)
daily_201403_excel_writer.save()
daily_20140322 = pro.daily(start_date='',end_date='',trade_date='20140322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140322_tscode_list = list() 
for ts_code_sh in daily_20140322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140322_tscode_list.append(stock_name)
daily_20140322_addname_dataframe=pd.DataFrame()
daily_20140322_addname_dataframe['cname'] = daily_20140322_tscode_list
for table_name in daily_20140322.columns.values.tolist():
    daily_20140322_addname_dataframe[table_name] = daily_20140322[table_name]
print("daily_20140322 返回数据 row 行数 = "+str(daily_20140322.shape[0]))
daily_20140322_addname_dataframe.to_excel(daily_201403_excel_writer,'22_6',index=False)
daily_201403_excel_writer.save()
daily_20140323 = pro.daily(start_date='',end_date='',trade_date='20140323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140323_tscode_list = list() 
for ts_code_sh in daily_20140323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140323_tscode_list.append(stock_name)
daily_20140323_addname_dataframe=pd.DataFrame()
daily_20140323_addname_dataframe['cname'] = daily_20140323_tscode_list
for table_name in daily_20140323.columns.values.tolist():
    daily_20140323_addname_dataframe[table_name] = daily_20140323[table_name]
print("daily_20140323 返回数据 row 行数 = "+str(daily_20140323.shape[0]))
daily_20140323_addname_dataframe.to_excel(daily_201403_excel_writer,'23_7',index=False)
daily_201403_excel_writer.save()
daily_20140324 = pro.daily(start_date='',end_date='',trade_date='20140324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140324_tscode_list = list() 
for ts_code_sh in daily_20140324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140324_tscode_list.append(stock_name)
daily_20140324_addname_dataframe=pd.DataFrame()
daily_20140324_addname_dataframe['cname'] = daily_20140324_tscode_list
for table_name in daily_20140324.columns.values.tolist():
    daily_20140324_addname_dataframe[table_name] = daily_20140324[table_name]
print("daily_20140324 返回数据 row 行数 = "+str(daily_20140324.shape[0]))
daily_20140324_addname_dataframe.to_excel(daily_201403_excel_writer,'24_1',index=False)
daily_201403_excel_writer.save()
daily_20140325 = pro.daily(start_date='',end_date='',trade_date='20140325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140325_tscode_list = list() 
for ts_code_sh in daily_20140325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140325_tscode_list.append(stock_name)
daily_20140325_addname_dataframe=pd.DataFrame()
daily_20140325_addname_dataframe['cname'] = daily_20140325_tscode_list
for table_name in daily_20140325.columns.values.tolist():
    daily_20140325_addname_dataframe[table_name] = daily_20140325[table_name]
print("daily_20140325 返回数据 row 行数 = "+str(daily_20140325.shape[0]))
daily_20140325_addname_dataframe.to_excel(daily_201403_excel_writer,'25_2',index=False)
daily_201403_excel_writer.save()
daily_20140326 = pro.daily(start_date='',end_date='',trade_date='20140326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140326_tscode_list = list() 
for ts_code_sh in daily_20140326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140326_tscode_list.append(stock_name)
daily_20140326_addname_dataframe=pd.DataFrame()
daily_20140326_addname_dataframe['cname'] = daily_20140326_tscode_list
for table_name in daily_20140326.columns.values.tolist():
    daily_20140326_addname_dataframe[table_name] = daily_20140326[table_name]
print("daily_20140326 返回数据 row 行数 = "+str(daily_20140326.shape[0]))
daily_20140326_addname_dataframe.to_excel(daily_201403_excel_writer,'26_3',index=False)
daily_201403_excel_writer.save()
daily_20140327 = pro.daily(start_date='',end_date='',trade_date='20140327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140327_tscode_list = list() 
for ts_code_sh in daily_20140327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140327_tscode_list.append(stock_name)
daily_20140327_addname_dataframe=pd.DataFrame()
daily_20140327_addname_dataframe['cname'] = daily_20140327_tscode_list
for table_name in daily_20140327.columns.values.tolist():
    daily_20140327_addname_dataframe[table_name] = daily_20140327[table_name]
print("daily_20140327 返回数据 row 行数 = "+str(daily_20140327.shape[0]))
daily_20140327_addname_dataframe.to_excel(daily_201403_excel_writer,'27_4',index=False)
daily_201403_excel_writer.save()
daily_20140328 = pro.daily(start_date='',end_date='',trade_date='20140328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140328_tscode_list = list() 
for ts_code_sh in daily_20140328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140328_tscode_list.append(stock_name)
daily_20140328_addname_dataframe=pd.DataFrame()
daily_20140328_addname_dataframe['cname'] = daily_20140328_tscode_list
for table_name in daily_20140328.columns.values.tolist():
    daily_20140328_addname_dataframe[table_name] = daily_20140328[table_name]
print("daily_20140328 返回数据 row 行数 = "+str(daily_20140328.shape[0]))
daily_20140328_addname_dataframe.to_excel(daily_201403_excel_writer,'28_5',index=False)
daily_201403_excel_writer.save()
daily_20140329 = pro.daily(start_date='',end_date='',trade_date='20140329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140329_tscode_list = list() 
for ts_code_sh in daily_20140329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140329_tscode_list.append(stock_name)
daily_20140329_addname_dataframe=pd.DataFrame()
daily_20140329_addname_dataframe['cname'] = daily_20140329_tscode_list
for table_name in daily_20140329.columns.values.tolist():
    daily_20140329_addname_dataframe[table_name] = daily_20140329[table_name]
print("daily_20140329 返回数据 row 行数 = "+str(daily_20140329.shape[0]))
daily_20140329_addname_dataframe.to_excel(daily_201403_excel_writer,'29_6',index=False)
daily_201403_excel_writer.save()
daily_20140330 = pro.daily(start_date='',end_date='',trade_date='20140330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140330_tscode_list = list() 
for ts_code_sh in daily_20140330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140330_tscode_list.append(stock_name)
daily_20140330_addname_dataframe=pd.DataFrame()
daily_20140330_addname_dataframe['cname'] = daily_20140330_tscode_list
for table_name in daily_20140330.columns.values.tolist():
    daily_20140330_addname_dataframe[table_name] = daily_20140330[table_name]
print("daily_20140330 返回数据 row 行数 = "+str(daily_20140330.shape[0]))
daily_20140330_addname_dataframe.to_excel(daily_201403_excel_writer,'30_7',index=False)
daily_201403_excel_writer.save()
daily_20140331 = pro.daily(start_date='',end_date='',trade_date='20140331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140331_tscode_list = list() 
for ts_code_sh in daily_20140331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140331_tscode_list.append(stock_name)
daily_20140331_addname_dataframe=pd.DataFrame()
daily_20140331_addname_dataframe['cname'] = daily_20140331_tscode_list
for table_name in daily_20140331.columns.values.tolist():
    daily_20140331_addname_dataframe[table_name] = daily_20140331[table_name]
print("daily_20140331 返回数据 row 行数 = "+str(daily_20140331.shape[0]))
daily_20140331_addname_dataframe.to_excel(daily_201403_excel_writer,'31_1',index=False)
daily_201403_excel_writer.save()




createexcel('daily_201404.xlsx')
daily_201404_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201404.xlsx')
daily_201404_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201404.xlsx', engine='openpyxl')
daily_201404_excel_writer.book = daily_201404_book
daily_201404_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201404_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140401")       ###  更新 记录日期
daily_20140401 = pro.daily(start_date='',end_date='',trade_date='20140401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140401_tscode_list = list() 
for ts_code_sh in daily_20140401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140401_tscode_list.append(stock_name)
daily_20140401_addname_dataframe=pd.DataFrame()
daily_20140401_addname_dataframe['cname'] = daily_20140401_tscode_list
for table_name in daily_20140401.columns.values.tolist():
    daily_20140401_addname_dataframe[table_name] = daily_20140401[table_name]
print("daily_20140401 返回数据 row 行数 = "+str(daily_20140401.shape[0]))
daily_20140401_addname_dataframe.to_excel(daily_201404_excel_writer,'1_2',index=False)
daily_201404_excel_writer.save()
daily_20140402 = pro.daily(start_date='',end_date='',trade_date='20140402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140402_tscode_list = list() 
for ts_code_sh in daily_20140402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140402_tscode_list.append(stock_name)
daily_20140402_addname_dataframe=pd.DataFrame()
daily_20140402_addname_dataframe['cname'] = daily_20140402_tscode_list
for table_name in daily_20140402.columns.values.tolist():
    daily_20140402_addname_dataframe[table_name] = daily_20140402[table_name]
print("daily_20140402 返回数据 row 行数 = "+str(daily_20140402.shape[0]))
daily_20140402_addname_dataframe.to_excel(daily_201404_excel_writer,'2_3',index=False)
daily_201404_excel_writer.save()
daily_20140403 = pro.daily(start_date='',end_date='',trade_date='20140403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140403_tscode_list = list() 
for ts_code_sh in daily_20140403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140403_tscode_list.append(stock_name)
daily_20140403_addname_dataframe=pd.DataFrame()
daily_20140403_addname_dataframe['cname'] = daily_20140403_tscode_list
for table_name in daily_20140403.columns.values.tolist():
    daily_20140403_addname_dataframe[table_name] = daily_20140403[table_name]
print("daily_20140403 返回数据 row 行数 = "+str(daily_20140403.shape[0]))
daily_20140403_addname_dataframe.to_excel(daily_201404_excel_writer,'3_4',index=False)
daily_201404_excel_writer.save()
daily_20140404 = pro.daily(start_date='',end_date='',trade_date='20140404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140404_tscode_list = list() 
for ts_code_sh in daily_20140404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140404_tscode_list.append(stock_name)
daily_20140404_addname_dataframe=pd.DataFrame()
daily_20140404_addname_dataframe['cname'] = daily_20140404_tscode_list
for table_name in daily_20140404.columns.values.tolist():
    daily_20140404_addname_dataframe[table_name] = daily_20140404[table_name]
print("daily_20140404 返回数据 row 行数 = "+str(daily_20140404.shape[0]))
daily_20140404_addname_dataframe.to_excel(daily_201404_excel_writer,'4_5',index=False)
daily_201404_excel_writer.save()
daily_20140405 = pro.daily(start_date='',end_date='',trade_date='20140405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140405_tscode_list = list() 
for ts_code_sh in daily_20140405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140405_tscode_list.append(stock_name)
daily_20140405_addname_dataframe=pd.DataFrame()
daily_20140405_addname_dataframe['cname'] = daily_20140405_tscode_list
for table_name in daily_20140405.columns.values.tolist():
    daily_20140405_addname_dataframe[table_name] = daily_20140405[table_name]
print("daily_20140405 返回数据 row 行数 = "+str(daily_20140405.shape[0]))
daily_20140405_addname_dataframe.to_excel(daily_201404_excel_writer,'5_6',index=False)
daily_201404_excel_writer.save()
daily_20140406 = pro.daily(start_date='',end_date='',trade_date='20140406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140406_tscode_list = list() 
for ts_code_sh in daily_20140406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140406_tscode_list.append(stock_name)
daily_20140406_addname_dataframe=pd.DataFrame()
daily_20140406_addname_dataframe['cname'] = daily_20140406_tscode_list
for table_name in daily_20140406.columns.values.tolist():
    daily_20140406_addname_dataframe[table_name] = daily_20140406[table_name]
print("daily_20140406 返回数据 row 行数 = "+str(daily_20140406.shape[0]))
daily_20140406_addname_dataframe.to_excel(daily_201404_excel_writer,'6_7',index=False)
daily_201404_excel_writer.save()
daily_20140407 = pro.daily(start_date='',end_date='',trade_date='20140407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140407_tscode_list = list() 
for ts_code_sh in daily_20140407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140407_tscode_list.append(stock_name)
daily_20140407_addname_dataframe=pd.DataFrame()
daily_20140407_addname_dataframe['cname'] = daily_20140407_tscode_list
for table_name in daily_20140407.columns.values.tolist():
    daily_20140407_addname_dataframe[table_name] = daily_20140407[table_name]
print("daily_20140407 返回数据 row 行数 = "+str(daily_20140407.shape[0]))
daily_20140407_addname_dataframe.to_excel(daily_201404_excel_writer,'7_1',index=False)
daily_201404_excel_writer.save()
daily_20140408 = pro.daily(start_date='',end_date='',trade_date='20140408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140408_tscode_list = list() 
for ts_code_sh in daily_20140408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140408_tscode_list.append(stock_name)
daily_20140408_addname_dataframe=pd.DataFrame()
daily_20140408_addname_dataframe['cname'] = daily_20140408_tscode_list
for table_name in daily_20140408.columns.values.tolist():
    daily_20140408_addname_dataframe[table_name] = daily_20140408[table_name]
print("daily_20140408 返回数据 row 行数 = "+str(daily_20140408.shape[0]))
daily_20140408_addname_dataframe.to_excel(daily_201404_excel_writer,'8_2',index=False)
daily_201404_excel_writer.save()
daily_20140409 = pro.daily(start_date='',end_date='',trade_date='20140409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140409_tscode_list = list() 
for ts_code_sh in daily_20140409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140409_tscode_list.append(stock_name)
daily_20140409_addname_dataframe=pd.DataFrame()
daily_20140409_addname_dataframe['cname'] = daily_20140409_tscode_list
for table_name in daily_20140409.columns.values.tolist():
    daily_20140409_addname_dataframe[table_name] = daily_20140409[table_name]
print("daily_20140409 返回数据 row 行数 = "+str(daily_20140409.shape[0]))
daily_20140409_addname_dataframe.to_excel(daily_201404_excel_writer,'9_3',index=False)
daily_201404_excel_writer.save()
daily_20140410 = pro.daily(start_date='',end_date='',trade_date='20140410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140410_tscode_list = list() 
for ts_code_sh in daily_20140410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140410_tscode_list.append(stock_name)
daily_20140410_addname_dataframe=pd.DataFrame()
daily_20140410_addname_dataframe['cname'] = daily_20140410_tscode_list
for table_name in daily_20140410.columns.values.tolist():
    daily_20140410_addname_dataframe[table_name] = daily_20140410[table_name]
print("daily_20140410 返回数据 row 行数 = "+str(daily_20140410.shape[0]))
daily_20140410_addname_dataframe.to_excel(daily_201404_excel_writer,'10_4',index=False)
daily_201404_excel_writer.save()
daily_20140411 = pro.daily(start_date='',end_date='',trade_date='20140411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140411_tscode_list = list() 
for ts_code_sh in daily_20140411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140411_tscode_list.append(stock_name)
daily_20140411_addname_dataframe=pd.DataFrame()
daily_20140411_addname_dataframe['cname'] = daily_20140411_tscode_list
for table_name in daily_20140411.columns.values.tolist():
    daily_20140411_addname_dataframe[table_name] = daily_20140411[table_name]
print("daily_20140411 返回数据 row 行数 = "+str(daily_20140411.shape[0]))
daily_20140411_addname_dataframe.to_excel(daily_201404_excel_writer,'11_5',index=False)
daily_201404_excel_writer.save()
daily_20140412 = pro.daily(start_date='',end_date='',trade_date='20140412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140412_tscode_list = list() 
for ts_code_sh in daily_20140412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140412_tscode_list.append(stock_name)
daily_20140412_addname_dataframe=pd.DataFrame()
daily_20140412_addname_dataframe['cname'] = daily_20140412_tscode_list
for table_name in daily_20140412.columns.values.tolist():
    daily_20140412_addname_dataframe[table_name] = daily_20140412[table_name]
print("daily_20140412 返回数据 row 行数 = "+str(daily_20140412.shape[0]))
daily_20140412_addname_dataframe.to_excel(daily_201404_excel_writer,'12_6',index=False)
daily_201404_excel_writer.save()
daily_20140413 = pro.daily(start_date='',end_date='',trade_date='20140413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140413_tscode_list = list() 
for ts_code_sh in daily_20140413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140413_tscode_list.append(stock_name)
daily_20140413_addname_dataframe=pd.DataFrame()
daily_20140413_addname_dataframe['cname'] = daily_20140413_tscode_list
for table_name in daily_20140413.columns.values.tolist():
    daily_20140413_addname_dataframe[table_name] = daily_20140413[table_name]
print("daily_20140413 返回数据 row 行数 = "+str(daily_20140413.shape[0]))
daily_20140413_addname_dataframe.to_excel(daily_201404_excel_writer,'13_7',index=False)
daily_201404_excel_writer.save()
daily_20140414 = pro.daily(start_date='',end_date='',trade_date='20140414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140414_tscode_list = list() 
for ts_code_sh in daily_20140414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140414_tscode_list.append(stock_name)
daily_20140414_addname_dataframe=pd.DataFrame()
daily_20140414_addname_dataframe['cname'] = daily_20140414_tscode_list
for table_name in daily_20140414.columns.values.tolist():
    daily_20140414_addname_dataframe[table_name] = daily_20140414[table_name]
print("daily_20140414 返回数据 row 行数 = "+str(daily_20140414.shape[0]))
daily_20140414_addname_dataframe.to_excel(daily_201404_excel_writer,'14_1',index=False)
daily_201404_excel_writer.save()
daily_20140415 = pro.daily(start_date='',end_date='',trade_date='20140415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140415_tscode_list = list() 
for ts_code_sh in daily_20140415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140415_tscode_list.append(stock_name)
daily_20140415_addname_dataframe=pd.DataFrame()
daily_20140415_addname_dataframe['cname'] = daily_20140415_tscode_list
for table_name in daily_20140415.columns.values.tolist():
    daily_20140415_addname_dataframe[table_name] = daily_20140415[table_name]
print("daily_20140415 返回数据 row 行数 = "+str(daily_20140415.shape[0]))
daily_20140415_addname_dataframe.to_excel(daily_201404_excel_writer,'15_2',index=False)
daily_201404_excel_writer.save()
daily_20140416 = pro.daily(start_date='',end_date='',trade_date='20140416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140416_tscode_list = list() 
for ts_code_sh in daily_20140416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140416_tscode_list.append(stock_name)
daily_20140416_addname_dataframe=pd.DataFrame()
daily_20140416_addname_dataframe['cname'] = daily_20140416_tscode_list
for table_name in daily_20140416.columns.values.tolist():
    daily_20140416_addname_dataframe[table_name] = daily_20140416[table_name]
print("daily_20140416 返回数据 row 行数 = "+str(daily_20140416.shape[0]))
daily_20140416_addname_dataframe.to_excel(daily_201404_excel_writer,'16_3',index=False)
daily_201404_excel_writer.save()
daily_20140417 = pro.daily(start_date='',end_date='',trade_date='20140417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140417_tscode_list = list() 
for ts_code_sh in daily_20140417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140417_tscode_list.append(stock_name)
daily_20140417_addname_dataframe=pd.DataFrame()
daily_20140417_addname_dataframe['cname'] = daily_20140417_tscode_list
for table_name in daily_20140417.columns.values.tolist():
    daily_20140417_addname_dataframe[table_name] = daily_20140417[table_name]
print("daily_20140417 返回数据 row 行数 = "+str(daily_20140417.shape[0]))
daily_20140417_addname_dataframe.to_excel(daily_201404_excel_writer,'17_4',index=False)
daily_201404_excel_writer.save()
daily_20140418 = pro.daily(start_date='',end_date='',trade_date='20140418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140418_tscode_list = list() 
for ts_code_sh in daily_20140418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140418_tscode_list.append(stock_name)
daily_20140418_addname_dataframe=pd.DataFrame()
daily_20140418_addname_dataframe['cname'] = daily_20140418_tscode_list
for table_name in daily_20140418.columns.values.tolist():
    daily_20140418_addname_dataframe[table_name] = daily_20140418[table_name]
print("daily_20140418 返回数据 row 行数 = "+str(daily_20140418.shape[0]))
daily_20140418_addname_dataframe.to_excel(daily_201404_excel_writer,'18_5',index=False)
daily_201404_excel_writer.save()
daily_20140419 = pro.daily(start_date='',end_date='',trade_date='20140419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140419_tscode_list = list() 
for ts_code_sh in daily_20140419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140419_tscode_list.append(stock_name)
daily_20140419_addname_dataframe=pd.DataFrame()
daily_20140419_addname_dataframe['cname'] = daily_20140419_tscode_list
for table_name in daily_20140419.columns.values.tolist():
    daily_20140419_addname_dataframe[table_name] = daily_20140419[table_name]
print("daily_20140419 返回数据 row 行数 = "+str(daily_20140419.shape[0]))
daily_20140419_addname_dataframe.to_excel(daily_201404_excel_writer,'19_6',index=False)
daily_201404_excel_writer.save()
daily_20140420 = pro.daily(start_date='',end_date='',trade_date='20140420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140420_tscode_list = list() 
for ts_code_sh in daily_20140420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140420_tscode_list.append(stock_name)
daily_20140420_addname_dataframe=pd.DataFrame()
daily_20140420_addname_dataframe['cname'] = daily_20140420_tscode_list
for table_name in daily_20140420.columns.values.tolist():
    daily_20140420_addname_dataframe[table_name] = daily_20140420[table_name]
print("daily_20140420 返回数据 row 行数 = "+str(daily_20140420.shape[0]))
daily_20140420_addname_dataframe.to_excel(daily_201404_excel_writer,'20_7',index=False)
daily_201404_excel_writer.save()
daily_20140421 = pro.daily(start_date='',end_date='',trade_date='20140421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140421_tscode_list = list() 
for ts_code_sh in daily_20140421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140421_tscode_list.append(stock_name)
daily_20140421_addname_dataframe=pd.DataFrame()
daily_20140421_addname_dataframe['cname'] = daily_20140421_tscode_list
for table_name in daily_20140421.columns.values.tolist():
    daily_20140421_addname_dataframe[table_name] = daily_20140421[table_name]
print("daily_20140421 返回数据 row 行数 = "+str(daily_20140421.shape[0]))
daily_20140421_addname_dataframe.to_excel(daily_201404_excel_writer,'21_1',index=False)
daily_201404_excel_writer.save()
daily_20140422 = pro.daily(start_date='',end_date='',trade_date='20140422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140422_tscode_list = list() 
for ts_code_sh in daily_20140422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140422_tscode_list.append(stock_name)
daily_20140422_addname_dataframe=pd.DataFrame()
daily_20140422_addname_dataframe['cname'] = daily_20140422_tscode_list
for table_name in daily_20140422.columns.values.tolist():
    daily_20140422_addname_dataframe[table_name] = daily_20140422[table_name]
print("daily_20140422 返回数据 row 行数 = "+str(daily_20140422.shape[0]))
daily_20140422_addname_dataframe.to_excel(daily_201404_excel_writer,'22_2',index=False)
daily_201404_excel_writer.save()
daily_20140423 = pro.daily(start_date='',end_date='',trade_date='20140423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140423_tscode_list = list() 
for ts_code_sh in daily_20140423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140423_tscode_list.append(stock_name)
daily_20140423_addname_dataframe=pd.DataFrame()
daily_20140423_addname_dataframe['cname'] = daily_20140423_tscode_list
for table_name in daily_20140423.columns.values.tolist():
    daily_20140423_addname_dataframe[table_name] = daily_20140423[table_name]
print("daily_20140423 返回数据 row 行数 = "+str(daily_20140423.shape[0]))
daily_20140423_addname_dataframe.to_excel(daily_201404_excel_writer,'23_3',index=False)
daily_201404_excel_writer.save()
daily_20140424 = pro.daily(start_date='',end_date='',trade_date='20140424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140424_tscode_list = list() 
for ts_code_sh in daily_20140424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140424_tscode_list.append(stock_name)
daily_20140424_addname_dataframe=pd.DataFrame()
daily_20140424_addname_dataframe['cname'] = daily_20140424_tscode_list
for table_name in daily_20140424.columns.values.tolist():
    daily_20140424_addname_dataframe[table_name] = daily_20140424[table_name]
print("daily_20140424 返回数据 row 行数 = "+str(daily_20140424.shape[0]))
daily_20140424_addname_dataframe.to_excel(daily_201404_excel_writer,'24_4',index=False)
daily_201404_excel_writer.save()
daily_20140425 = pro.daily(start_date='',end_date='',trade_date='20140425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140425_tscode_list = list() 
for ts_code_sh in daily_20140425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140425_tscode_list.append(stock_name)
daily_20140425_addname_dataframe=pd.DataFrame()
daily_20140425_addname_dataframe['cname'] = daily_20140425_tscode_list
for table_name in daily_20140425.columns.values.tolist():
    daily_20140425_addname_dataframe[table_name] = daily_20140425[table_name]
print("daily_20140425 返回数据 row 行数 = "+str(daily_20140425.shape[0]))
daily_20140425_addname_dataframe.to_excel(daily_201404_excel_writer,'25_5',index=False)
daily_201404_excel_writer.save()
daily_20140426 = pro.daily(start_date='',end_date='',trade_date='20140426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140426_tscode_list = list() 
for ts_code_sh in daily_20140426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140426_tscode_list.append(stock_name)
daily_20140426_addname_dataframe=pd.DataFrame()
daily_20140426_addname_dataframe['cname'] = daily_20140426_tscode_list
for table_name in daily_20140426.columns.values.tolist():
    daily_20140426_addname_dataframe[table_name] = daily_20140426[table_name]
print("daily_20140426 返回数据 row 行数 = "+str(daily_20140426.shape[0]))
daily_20140426_addname_dataframe.to_excel(daily_201404_excel_writer,'26_6',index=False)
daily_201404_excel_writer.save()
daily_20140427 = pro.daily(start_date='',end_date='',trade_date='20140427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140427_tscode_list = list() 
for ts_code_sh in daily_20140427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140427_tscode_list.append(stock_name)
daily_20140427_addname_dataframe=pd.DataFrame()
daily_20140427_addname_dataframe['cname'] = daily_20140427_tscode_list
for table_name in daily_20140427.columns.values.tolist():
    daily_20140427_addname_dataframe[table_name] = daily_20140427[table_name]
print("daily_20140427 返回数据 row 行数 = "+str(daily_20140427.shape[0]))
daily_20140427_addname_dataframe.to_excel(daily_201404_excel_writer,'27_7',index=False)
daily_201404_excel_writer.save()
daily_20140428 = pro.daily(start_date='',end_date='',trade_date='20140428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140428_tscode_list = list() 
for ts_code_sh in daily_20140428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140428_tscode_list.append(stock_name)
daily_20140428_addname_dataframe=pd.DataFrame()
daily_20140428_addname_dataframe['cname'] = daily_20140428_tscode_list
for table_name in daily_20140428.columns.values.tolist():
    daily_20140428_addname_dataframe[table_name] = daily_20140428[table_name]
print("daily_20140428 返回数据 row 行数 = "+str(daily_20140428.shape[0]))
daily_20140428_addname_dataframe.to_excel(daily_201404_excel_writer,'28_1',index=False)
daily_201404_excel_writer.save()
daily_20140429 = pro.daily(start_date='',end_date='',trade_date='20140429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140429_tscode_list = list() 
for ts_code_sh in daily_20140429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140429_tscode_list.append(stock_name)
daily_20140429_addname_dataframe=pd.DataFrame()
daily_20140429_addname_dataframe['cname'] = daily_20140429_tscode_list
for table_name in daily_20140429.columns.values.tolist():
    daily_20140429_addname_dataframe[table_name] = daily_20140429[table_name]
print("daily_20140429 返回数据 row 行数 = "+str(daily_20140429.shape[0]))
daily_20140429_addname_dataframe.to_excel(daily_201404_excel_writer,'29_2',index=False)
daily_201404_excel_writer.save()
daily_20140430 = pro.daily(start_date='',end_date='',trade_date='20140430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140430_tscode_list = list() 
for ts_code_sh in daily_20140430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140430_tscode_list.append(stock_name)
daily_20140430_addname_dataframe=pd.DataFrame()
daily_20140430_addname_dataframe['cname'] = daily_20140430_tscode_list
for table_name in daily_20140430.columns.values.tolist():
    daily_20140430_addname_dataframe[table_name] = daily_20140430[table_name]
print("daily_20140430 返回数据 row 行数 = "+str(daily_20140430.shape[0]))
daily_20140430_addname_dataframe.to_excel(daily_201404_excel_writer,'30_3',index=False)
daily_201404_excel_writer.save()




createexcel('daily_201405.xlsx')
daily_201405_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201405.xlsx')
daily_201405_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201405.xlsx', engine='openpyxl')
daily_201405_excel_writer.book = daily_201405_book
daily_201405_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201405_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140501")       ###  更新 记录日期
daily_20140501 = pro.daily(start_date='',end_date='',trade_date='20140501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140501_tscode_list = list() 
for ts_code_sh in daily_20140501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140501_tscode_list.append(stock_name)
daily_20140501_addname_dataframe=pd.DataFrame()
daily_20140501_addname_dataframe['cname'] = daily_20140501_tscode_list
for table_name in daily_20140501.columns.values.tolist():
    daily_20140501_addname_dataframe[table_name] = daily_20140501[table_name]
print("daily_20140501 返回数据 row 行数 = "+str(daily_20140501.shape[0]))
daily_20140501_addname_dataframe.to_excel(daily_201405_excel_writer,'1_4',index=False)
daily_201405_excel_writer.save()
daily_20140502 = pro.daily(start_date='',end_date='',trade_date='20140502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140502_tscode_list = list() 
for ts_code_sh in daily_20140502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140502_tscode_list.append(stock_name)
daily_20140502_addname_dataframe=pd.DataFrame()
daily_20140502_addname_dataframe['cname'] = daily_20140502_tscode_list
for table_name in daily_20140502.columns.values.tolist():
    daily_20140502_addname_dataframe[table_name] = daily_20140502[table_name]
print("daily_20140502 返回数据 row 行数 = "+str(daily_20140502.shape[0]))
daily_20140502_addname_dataframe.to_excel(daily_201405_excel_writer,'2_5',index=False)
daily_201405_excel_writer.save()
daily_20140503 = pro.daily(start_date='',end_date='',trade_date='20140503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140503_tscode_list = list() 
for ts_code_sh in daily_20140503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140503_tscode_list.append(stock_name)
daily_20140503_addname_dataframe=pd.DataFrame()
daily_20140503_addname_dataframe['cname'] = daily_20140503_tscode_list
for table_name in daily_20140503.columns.values.tolist():
    daily_20140503_addname_dataframe[table_name] = daily_20140503[table_name]
print("daily_20140503 返回数据 row 行数 = "+str(daily_20140503.shape[0]))
daily_20140503_addname_dataframe.to_excel(daily_201405_excel_writer,'3_6',index=False)
daily_201405_excel_writer.save()
daily_20140504 = pro.daily(start_date='',end_date='',trade_date='20140504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140504_tscode_list = list() 
for ts_code_sh in daily_20140504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140504_tscode_list.append(stock_name)
daily_20140504_addname_dataframe=pd.DataFrame()
daily_20140504_addname_dataframe['cname'] = daily_20140504_tscode_list
for table_name in daily_20140504.columns.values.tolist():
    daily_20140504_addname_dataframe[table_name] = daily_20140504[table_name]
print("daily_20140504 返回数据 row 行数 = "+str(daily_20140504.shape[0]))
daily_20140504_addname_dataframe.to_excel(daily_201405_excel_writer,'4_7',index=False)
daily_201405_excel_writer.save()
daily_20140505 = pro.daily(start_date='',end_date='',trade_date='20140505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140505_tscode_list = list() 
for ts_code_sh in daily_20140505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140505_tscode_list.append(stock_name)
daily_20140505_addname_dataframe=pd.DataFrame()
daily_20140505_addname_dataframe['cname'] = daily_20140505_tscode_list
for table_name in daily_20140505.columns.values.tolist():
    daily_20140505_addname_dataframe[table_name] = daily_20140505[table_name]
print("daily_20140505 返回数据 row 行数 = "+str(daily_20140505.shape[0]))
daily_20140505_addname_dataframe.to_excel(daily_201405_excel_writer,'5_1',index=False)
daily_201405_excel_writer.save()
daily_20140506 = pro.daily(start_date='',end_date='',trade_date='20140506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140506_tscode_list = list() 
for ts_code_sh in daily_20140506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140506_tscode_list.append(stock_name)
daily_20140506_addname_dataframe=pd.DataFrame()
daily_20140506_addname_dataframe['cname'] = daily_20140506_tscode_list
for table_name in daily_20140506.columns.values.tolist():
    daily_20140506_addname_dataframe[table_name] = daily_20140506[table_name]
print("daily_20140506 返回数据 row 行数 = "+str(daily_20140506.shape[0]))
daily_20140506_addname_dataframe.to_excel(daily_201405_excel_writer,'6_2',index=False)
daily_201405_excel_writer.save()
daily_20140507 = pro.daily(start_date='',end_date='',trade_date='20140507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140507_tscode_list = list() 
for ts_code_sh in daily_20140507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140507_tscode_list.append(stock_name)
daily_20140507_addname_dataframe=pd.DataFrame()
daily_20140507_addname_dataframe['cname'] = daily_20140507_tscode_list
for table_name in daily_20140507.columns.values.tolist():
    daily_20140507_addname_dataframe[table_name] = daily_20140507[table_name]
print("daily_20140507 返回数据 row 行数 = "+str(daily_20140507.shape[0]))
daily_20140507_addname_dataframe.to_excel(daily_201405_excel_writer,'7_3',index=False)
daily_201405_excel_writer.save()
daily_20140508 = pro.daily(start_date='',end_date='',trade_date='20140508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140508_tscode_list = list() 
for ts_code_sh in daily_20140508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140508_tscode_list.append(stock_name)
daily_20140508_addname_dataframe=pd.DataFrame()
daily_20140508_addname_dataframe['cname'] = daily_20140508_tscode_list
for table_name in daily_20140508.columns.values.tolist():
    daily_20140508_addname_dataframe[table_name] = daily_20140508[table_name]
print("daily_20140508 返回数据 row 行数 = "+str(daily_20140508.shape[0]))
daily_20140508_addname_dataframe.to_excel(daily_201405_excel_writer,'8_4',index=False)
daily_201405_excel_writer.save()
daily_20140509 = pro.daily(start_date='',end_date='',trade_date='20140509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140509_tscode_list = list() 
for ts_code_sh in daily_20140509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140509_tscode_list.append(stock_name)
daily_20140509_addname_dataframe=pd.DataFrame()
daily_20140509_addname_dataframe['cname'] = daily_20140509_tscode_list
for table_name in daily_20140509.columns.values.tolist():
    daily_20140509_addname_dataframe[table_name] = daily_20140509[table_name]
print("daily_20140509 返回数据 row 行数 = "+str(daily_20140509.shape[0]))
daily_20140509_addname_dataframe.to_excel(daily_201405_excel_writer,'9_5',index=False)
daily_201405_excel_writer.save()
daily_20140510 = pro.daily(start_date='',end_date='',trade_date='20140510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140510_tscode_list = list() 
for ts_code_sh in daily_20140510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140510_tscode_list.append(stock_name)
daily_20140510_addname_dataframe=pd.DataFrame()
daily_20140510_addname_dataframe['cname'] = daily_20140510_tscode_list
for table_name in daily_20140510.columns.values.tolist():
    daily_20140510_addname_dataframe[table_name] = daily_20140510[table_name]
print("daily_20140510 返回数据 row 行数 = "+str(daily_20140510.shape[0]))
daily_20140510_addname_dataframe.to_excel(daily_201405_excel_writer,'10_6',index=False)
daily_201405_excel_writer.save()
daily_20140511 = pro.daily(start_date='',end_date='',trade_date='20140511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140511_tscode_list = list() 
for ts_code_sh in daily_20140511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140511_tscode_list.append(stock_name)
daily_20140511_addname_dataframe=pd.DataFrame()
daily_20140511_addname_dataframe['cname'] = daily_20140511_tscode_list
for table_name in daily_20140511.columns.values.tolist():
    daily_20140511_addname_dataframe[table_name] = daily_20140511[table_name]
print("daily_20140511 返回数据 row 行数 = "+str(daily_20140511.shape[0]))
daily_20140511_addname_dataframe.to_excel(daily_201405_excel_writer,'11_7',index=False)
daily_201405_excel_writer.save()
daily_20140512 = pro.daily(start_date='',end_date='',trade_date='20140512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140512_tscode_list = list() 
for ts_code_sh in daily_20140512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140512_tscode_list.append(stock_name)
daily_20140512_addname_dataframe=pd.DataFrame()
daily_20140512_addname_dataframe['cname'] = daily_20140512_tscode_list
for table_name in daily_20140512.columns.values.tolist():
    daily_20140512_addname_dataframe[table_name] = daily_20140512[table_name]
print("daily_20140512 返回数据 row 行数 = "+str(daily_20140512.shape[0]))
daily_20140512_addname_dataframe.to_excel(daily_201405_excel_writer,'12_1',index=False)
daily_201405_excel_writer.save()
daily_20140513 = pro.daily(start_date='',end_date='',trade_date='20140513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140513_tscode_list = list() 
for ts_code_sh in daily_20140513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140513_tscode_list.append(stock_name)
daily_20140513_addname_dataframe=pd.DataFrame()
daily_20140513_addname_dataframe['cname'] = daily_20140513_tscode_list
for table_name in daily_20140513.columns.values.tolist():
    daily_20140513_addname_dataframe[table_name] = daily_20140513[table_name]
print("daily_20140513 返回数据 row 行数 = "+str(daily_20140513.shape[0]))
daily_20140513_addname_dataframe.to_excel(daily_201405_excel_writer,'13_2',index=False)
daily_201405_excel_writer.save()
daily_20140514 = pro.daily(start_date='',end_date='',trade_date='20140514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140514_tscode_list = list() 
for ts_code_sh in daily_20140514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140514_tscode_list.append(stock_name)
daily_20140514_addname_dataframe=pd.DataFrame()
daily_20140514_addname_dataframe['cname'] = daily_20140514_tscode_list
for table_name in daily_20140514.columns.values.tolist():
    daily_20140514_addname_dataframe[table_name] = daily_20140514[table_name]
print("daily_20140514 返回数据 row 行数 = "+str(daily_20140514.shape[0]))
daily_20140514_addname_dataframe.to_excel(daily_201405_excel_writer,'14_3',index=False)
daily_201405_excel_writer.save()
daily_20140515 = pro.daily(start_date='',end_date='',trade_date='20140515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140515_tscode_list = list() 
for ts_code_sh in daily_20140515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140515_tscode_list.append(stock_name)
daily_20140515_addname_dataframe=pd.DataFrame()
daily_20140515_addname_dataframe['cname'] = daily_20140515_tscode_list
for table_name in daily_20140515.columns.values.tolist():
    daily_20140515_addname_dataframe[table_name] = daily_20140515[table_name]
print("daily_20140515 返回数据 row 行数 = "+str(daily_20140515.shape[0]))
daily_20140515_addname_dataframe.to_excel(daily_201405_excel_writer,'15_4',index=False)
daily_201405_excel_writer.save()
daily_20140516 = pro.daily(start_date='',end_date='',trade_date='20140516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140516_tscode_list = list() 
for ts_code_sh in daily_20140516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140516_tscode_list.append(stock_name)
daily_20140516_addname_dataframe=pd.DataFrame()
daily_20140516_addname_dataframe['cname'] = daily_20140516_tscode_list
for table_name in daily_20140516.columns.values.tolist():
    daily_20140516_addname_dataframe[table_name] = daily_20140516[table_name]
print("daily_20140516 返回数据 row 行数 = "+str(daily_20140516.shape[0]))
daily_20140516_addname_dataframe.to_excel(daily_201405_excel_writer,'16_5',index=False)
daily_201405_excel_writer.save()
daily_20140517 = pro.daily(start_date='',end_date='',trade_date='20140517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140517_tscode_list = list() 
for ts_code_sh in daily_20140517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140517_tscode_list.append(stock_name)
daily_20140517_addname_dataframe=pd.DataFrame()
daily_20140517_addname_dataframe['cname'] = daily_20140517_tscode_list
for table_name in daily_20140517.columns.values.tolist():
    daily_20140517_addname_dataframe[table_name] = daily_20140517[table_name]
print("daily_20140517 返回数据 row 行数 = "+str(daily_20140517.shape[0]))
daily_20140517_addname_dataframe.to_excel(daily_201405_excel_writer,'17_6',index=False)
daily_201405_excel_writer.save()
daily_20140518 = pro.daily(start_date='',end_date='',trade_date='20140518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140518_tscode_list = list() 
for ts_code_sh in daily_20140518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140518_tscode_list.append(stock_name)
daily_20140518_addname_dataframe=pd.DataFrame()
daily_20140518_addname_dataframe['cname'] = daily_20140518_tscode_list
for table_name in daily_20140518.columns.values.tolist():
    daily_20140518_addname_dataframe[table_name] = daily_20140518[table_name]
print("daily_20140518 返回数据 row 行数 = "+str(daily_20140518.shape[0]))
daily_20140518_addname_dataframe.to_excel(daily_201405_excel_writer,'18_7',index=False)
daily_201405_excel_writer.save()
daily_20140519 = pro.daily(start_date='',end_date='',trade_date='20140519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140519_tscode_list = list() 
for ts_code_sh in daily_20140519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140519_tscode_list.append(stock_name)
daily_20140519_addname_dataframe=pd.DataFrame()
daily_20140519_addname_dataframe['cname'] = daily_20140519_tscode_list
for table_name in daily_20140519.columns.values.tolist():
    daily_20140519_addname_dataframe[table_name] = daily_20140519[table_name]
print("daily_20140519 返回数据 row 行数 = "+str(daily_20140519.shape[0]))
daily_20140519_addname_dataframe.to_excel(daily_201405_excel_writer,'19_1',index=False)
daily_201405_excel_writer.save()
daily_20140520 = pro.daily(start_date='',end_date='',trade_date='20140520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140520_tscode_list = list() 
for ts_code_sh in daily_20140520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140520_tscode_list.append(stock_name)
daily_20140520_addname_dataframe=pd.DataFrame()
daily_20140520_addname_dataframe['cname'] = daily_20140520_tscode_list
for table_name in daily_20140520.columns.values.tolist():
    daily_20140520_addname_dataframe[table_name] = daily_20140520[table_name]
print("daily_20140520 返回数据 row 行数 = "+str(daily_20140520.shape[0]))
daily_20140520_addname_dataframe.to_excel(daily_201405_excel_writer,'20_2',index=False)
daily_201405_excel_writer.save()
daily_20140521 = pro.daily(start_date='',end_date='',trade_date='20140521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140521_tscode_list = list() 
for ts_code_sh in daily_20140521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140521_tscode_list.append(stock_name)
daily_20140521_addname_dataframe=pd.DataFrame()
daily_20140521_addname_dataframe['cname'] = daily_20140521_tscode_list
for table_name in daily_20140521.columns.values.tolist():
    daily_20140521_addname_dataframe[table_name] = daily_20140521[table_name]
print("daily_20140521 返回数据 row 行数 = "+str(daily_20140521.shape[0]))
daily_20140521_addname_dataframe.to_excel(daily_201405_excel_writer,'21_3',index=False)
daily_201405_excel_writer.save()
daily_20140522 = pro.daily(start_date='',end_date='',trade_date='20140522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140522_tscode_list = list() 
for ts_code_sh in daily_20140522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140522_tscode_list.append(stock_name)
daily_20140522_addname_dataframe=pd.DataFrame()
daily_20140522_addname_dataframe['cname'] = daily_20140522_tscode_list
for table_name in daily_20140522.columns.values.tolist():
    daily_20140522_addname_dataframe[table_name] = daily_20140522[table_name]
print("daily_20140522 返回数据 row 行数 = "+str(daily_20140522.shape[0]))
daily_20140522_addname_dataframe.to_excel(daily_201405_excel_writer,'22_4',index=False)
daily_201405_excel_writer.save()
daily_20140523 = pro.daily(start_date='',end_date='',trade_date='20140523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140523_tscode_list = list() 
for ts_code_sh in daily_20140523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140523_tscode_list.append(stock_name)
daily_20140523_addname_dataframe=pd.DataFrame()
daily_20140523_addname_dataframe['cname'] = daily_20140523_tscode_list
for table_name in daily_20140523.columns.values.tolist():
    daily_20140523_addname_dataframe[table_name] = daily_20140523[table_name]
print("daily_20140523 返回数据 row 行数 = "+str(daily_20140523.shape[0]))
daily_20140523_addname_dataframe.to_excel(daily_201405_excel_writer,'23_5',index=False)
daily_201405_excel_writer.save()
daily_20140524 = pro.daily(start_date='',end_date='',trade_date='20140524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140524_tscode_list = list() 
for ts_code_sh in daily_20140524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140524_tscode_list.append(stock_name)
daily_20140524_addname_dataframe=pd.DataFrame()
daily_20140524_addname_dataframe['cname'] = daily_20140524_tscode_list
for table_name in daily_20140524.columns.values.tolist():
    daily_20140524_addname_dataframe[table_name] = daily_20140524[table_name]
print("daily_20140524 返回数据 row 行数 = "+str(daily_20140524.shape[0]))
daily_20140524_addname_dataframe.to_excel(daily_201405_excel_writer,'24_6',index=False)
daily_201405_excel_writer.save()
daily_20140525 = pro.daily(start_date='',end_date='',trade_date='20140525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140525_tscode_list = list() 
for ts_code_sh in daily_20140525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140525_tscode_list.append(stock_name)
daily_20140525_addname_dataframe=pd.DataFrame()
daily_20140525_addname_dataframe['cname'] = daily_20140525_tscode_list
for table_name in daily_20140525.columns.values.tolist():
    daily_20140525_addname_dataframe[table_name] = daily_20140525[table_name]
print("daily_20140525 返回数据 row 行数 = "+str(daily_20140525.shape[0]))
daily_20140525_addname_dataframe.to_excel(daily_201405_excel_writer,'25_7',index=False)
daily_201405_excel_writer.save()
daily_20140526 = pro.daily(start_date='',end_date='',trade_date='20140526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140526_tscode_list = list() 
for ts_code_sh in daily_20140526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140526_tscode_list.append(stock_name)
daily_20140526_addname_dataframe=pd.DataFrame()
daily_20140526_addname_dataframe['cname'] = daily_20140526_tscode_list
for table_name in daily_20140526.columns.values.tolist():
    daily_20140526_addname_dataframe[table_name] = daily_20140526[table_name]
print("daily_20140526 返回数据 row 行数 = "+str(daily_20140526.shape[0]))
daily_20140526_addname_dataframe.to_excel(daily_201405_excel_writer,'26_1',index=False)
daily_201405_excel_writer.save()
daily_20140527 = pro.daily(start_date='',end_date='',trade_date='20140527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140527_tscode_list = list() 
for ts_code_sh in daily_20140527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140527_tscode_list.append(stock_name)
daily_20140527_addname_dataframe=pd.DataFrame()
daily_20140527_addname_dataframe['cname'] = daily_20140527_tscode_list
for table_name in daily_20140527.columns.values.tolist():
    daily_20140527_addname_dataframe[table_name] = daily_20140527[table_name]
print("daily_20140527 返回数据 row 行数 = "+str(daily_20140527.shape[0]))
daily_20140527_addname_dataframe.to_excel(daily_201405_excel_writer,'27_2',index=False)
daily_201405_excel_writer.save()
daily_20140528 = pro.daily(start_date='',end_date='',trade_date='20140528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140528_tscode_list = list() 
for ts_code_sh in daily_20140528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140528_tscode_list.append(stock_name)
daily_20140528_addname_dataframe=pd.DataFrame()
daily_20140528_addname_dataframe['cname'] = daily_20140528_tscode_list
for table_name in daily_20140528.columns.values.tolist():
    daily_20140528_addname_dataframe[table_name] = daily_20140528[table_name]
print("daily_20140528 返回数据 row 行数 = "+str(daily_20140528.shape[0]))
daily_20140528_addname_dataframe.to_excel(daily_201405_excel_writer,'28_3',index=False)
daily_201405_excel_writer.save()
daily_20140529 = pro.daily(start_date='',end_date='',trade_date='20140529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140529_tscode_list = list() 
for ts_code_sh in daily_20140529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140529_tscode_list.append(stock_name)
daily_20140529_addname_dataframe=pd.DataFrame()
daily_20140529_addname_dataframe['cname'] = daily_20140529_tscode_list
for table_name in daily_20140529.columns.values.tolist():
    daily_20140529_addname_dataframe[table_name] = daily_20140529[table_name]
print("daily_20140529 返回数据 row 行数 = "+str(daily_20140529.shape[0]))
daily_20140529_addname_dataframe.to_excel(daily_201405_excel_writer,'29_4',index=False)
daily_201405_excel_writer.save()
daily_20140530 = pro.daily(start_date='',end_date='',trade_date='20140530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140530_tscode_list = list() 
for ts_code_sh in daily_20140530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140530_tscode_list.append(stock_name)
daily_20140530_addname_dataframe=pd.DataFrame()
daily_20140530_addname_dataframe['cname'] = daily_20140530_tscode_list
for table_name in daily_20140530.columns.values.tolist():
    daily_20140530_addname_dataframe[table_name] = daily_20140530[table_name]
print("daily_20140530 返回数据 row 行数 = "+str(daily_20140530.shape[0]))
daily_20140530_addname_dataframe.to_excel(daily_201405_excel_writer,'30_5',index=False)
daily_201405_excel_writer.save()
daily_20140531 = pro.daily(start_date='',end_date='',trade_date='20140531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140531_tscode_list = list() 
for ts_code_sh in daily_20140531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140531_tscode_list.append(stock_name)
daily_20140531_addname_dataframe=pd.DataFrame()
daily_20140531_addname_dataframe['cname'] = daily_20140531_tscode_list
for table_name in daily_20140531.columns.values.tolist():
    daily_20140531_addname_dataframe[table_name] = daily_20140531[table_name]
print("daily_20140531 返回数据 row 行数 = "+str(daily_20140531.shape[0]))
daily_20140531_addname_dataframe.to_excel(daily_201405_excel_writer,'31_6',index=False)
daily_201405_excel_writer.save()




createexcel('daily_201406.xlsx')
daily_201406_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201406.xlsx')
daily_201406_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201406.xlsx', engine='openpyxl')
daily_201406_excel_writer.book = daily_201406_book
daily_201406_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201406_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140601")       ###  更新 记录日期
daily_20140601 = pro.daily(start_date='',end_date='',trade_date='20140601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140601_tscode_list = list() 
for ts_code_sh in daily_20140601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140601_tscode_list.append(stock_name)
daily_20140601_addname_dataframe=pd.DataFrame()
daily_20140601_addname_dataframe['cname'] = daily_20140601_tscode_list
for table_name in daily_20140601.columns.values.tolist():
    daily_20140601_addname_dataframe[table_name] = daily_20140601[table_name]
print("daily_20140601 返回数据 row 行数 = "+str(daily_20140601.shape[0]))
daily_20140601_addname_dataframe.to_excel(daily_201406_excel_writer,'1_7',index=False)
daily_201406_excel_writer.save()
daily_20140602 = pro.daily(start_date='',end_date='',trade_date='20140602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140602_tscode_list = list() 
for ts_code_sh in daily_20140602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140602_tscode_list.append(stock_name)
daily_20140602_addname_dataframe=pd.DataFrame()
daily_20140602_addname_dataframe['cname'] = daily_20140602_tscode_list
for table_name in daily_20140602.columns.values.tolist():
    daily_20140602_addname_dataframe[table_name] = daily_20140602[table_name]
print("daily_20140602 返回数据 row 行数 = "+str(daily_20140602.shape[0]))
daily_20140602_addname_dataframe.to_excel(daily_201406_excel_writer,'2_1',index=False)
daily_201406_excel_writer.save()
daily_20140603 = pro.daily(start_date='',end_date='',trade_date='20140603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140603_tscode_list = list() 
for ts_code_sh in daily_20140603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140603_tscode_list.append(stock_name)
daily_20140603_addname_dataframe=pd.DataFrame()
daily_20140603_addname_dataframe['cname'] = daily_20140603_tscode_list
for table_name in daily_20140603.columns.values.tolist():
    daily_20140603_addname_dataframe[table_name] = daily_20140603[table_name]
print("daily_20140603 返回数据 row 行数 = "+str(daily_20140603.shape[0]))
daily_20140603_addname_dataframe.to_excel(daily_201406_excel_writer,'3_2',index=False)
daily_201406_excel_writer.save()
daily_20140604 = pro.daily(start_date='',end_date='',trade_date='20140604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140604_tscode_list = list() 
for ts_code_sh in daily_20140604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140604_tscode_list.append(stock_name)
daily_20140604_addname_dataframe=pd.DataFrame()
daily_20140604_addname_dataframe['cname'] = daily_20140604_tscode_list
for table_name in daily_20140604.columns.values.tolist():
    daily_20140604_addname_dataframe[table_name] = daily_20140604[table_name]
print("daily_20140604 返回数据 row 行数 = "+str(daily_20140604.shape[0]))
daily_20140604_addname_dataframe.to_excel(daily_201406_excel_writer,'4_3',index=False)
daily_201406_excel_writer.save()
daily_20140605 = pro.daily(start_date='',end_date='',trade_date='20140605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140605_tscode_list = list() 
for ts_code_sh in daily_20140605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140605_tscode_list.append(stock_name)
daily_20140605_addname_dataframe=pd.DataFrame()
daily_20140605_addname_dataframe['cname'] = daily_20140605_tscode_list
for table_name in daily_20140605.columns.values.tolist():
    daily_20140605_addname_dataframe[table_name] = daily_20140605[table_name]
print("daily_20140605 返回数据 row 行数 = "+str(daily_20140605.shape[0]))
daily_20140605_addname_dataframe.to_excel(daily_201406_excel_writer,'5_4',index=False)
daily_201406_excel_writer.save()
daily_20140606 = pro.daily(start_date='',end_date='',trade_date='20140606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140606_tscode_list = list() 
for ts_code_sh in daily_20140606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140606_tscode_list.append(stock_name)
daily_20140606_addname_dataframe=pd.DataFrame()
daily_20140606_addname_dataframe['cname'] = daily_20140606_tscode_list
for table_name in daily_20140606.columns.values.tolist():
    daily_20140606_addname_dataframe[table_name] = daily_20140606[table_name]
print("daily_20140606 返回数据 row 行数 = "+str(daily_20140606.shape[0]))
daily_20140606_addname_dataframe.to_excel(daily_201406_excel_writer,'6_5',index=False)
daily_201406_excel_writer.save()
daily_20140607 = pro.daily(start_date='',end_date='',trade_date='20140607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140607_tscode_list = list() 
for ts_code_sh in daily_20140607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140607_tscode_list.append(stock_name)
daily_20140607_addname_dataframe=pd.DataFrame()
daily_20140607_addname_dataframe['cname'] = daily_20140607_tscode_list
for table_name in daily_20140607.columns.values.tolist():
    daily_20140607_addname_dataframe[table_name] = daily_20140607[table_name]
print("daily_20140607 返回数据 row 行数 = "+str(daily_20140607.shape[0]))
daily_20140607_addname_dataframe.to_excel(daily_201406_excel_writer,'7_6',index=False)
daily_201406_excel_writer.save()
daily_20140608 = pro.daily(start_date='',end_date='',trade_date='20140608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140608_tscode_list = list() 
for ts_code_sh in daily_20140608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140608_tscode_list.append(stock_name)
daily_20140608_addname_dataframe=pd.DataFrame()
daily_20140608_addname_dataframe['cname'] = daily_20140608_tscode_list
for table_name in daily_20140608.columns.values.tolist():
    daily_20140608_addname_dataframe[table_name] = daily_20140608[table_name]
print("daily_20140608 返回数据 row 行数 = "+str(daily_20140608.shape[0]))
daily_20140608_addname_dataframe.to_excel(daily_201406_excel_writer,'8_7',index=False)
daily_201406_excel_writer.save()
daily_20140609 = pro.daily(start_date='',end_date='',trade_date='20140609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140609_tscode_list = list() 
for ts_code_sh in daily_20140609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140609_tscode_list.append(stock_name)
daily_20140609_addname_dataframe=pd.DataFrame()
daily_20140609_addname_dataframe['cname'] = daily_20140609_tscode_list
for table_name in daily_20140609.columns.values.tolist():
    daily_20140609_addname_dataframe[table_name] = daily_20140609[table_name]
print("daily_20140609 返回数据 row 行数 = "+str(daily_20140609.shape[0]))
daily_20140609_addname_dataframe.to_excel(daily_201406_excel_writer,'9_1',index=False)
daily_201406_excel_writer.save()
daily_20140610 = pro.daily(start_date='',end_date='',trade_date='20140610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140610_tscode_list = list() 
for ts_code_sh in daily_20140610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140610_tscode_list.append(stock_name)
daily_20140610_addname_dataframe=pd.DataFrame()
daily_20140610_addname_dataframe['cname'] = daily_20140610_tscode_list
for table_name in daily_20140610.columns.values.tolist():
    daily_20140610_addname_dataframe[table_name] = daily_20140610[table_name]
print("daily_20140610 返回数据 row 行数 = "+str(daily_20140610.shape[0]))
daily_20140610_addname_dataframe.to_excel(daily_201406_excel_writer,'10_2',index=False)
daily_201406_excel_writer.save()
daily_20140611 = pro.daily(start_date='',end_date='',trade_date='20140611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140611_tscode_list = list() 
for ts_code_sh in daily_20140611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140611_tscode_list.append(stock_name)
daily_20140611_addname_dataframe=pd.DataFrame()
daily_20140611_addname_dataframe['cname'] = daily_20140611_tscode_list
for table_name in daily_20140611.columns.values.tolist():
    daily_20140611_addname_dataframe[table_name] = daily_20140611[table_name]
print("daily_20140611 返回数据 row 行数 = "+str(daily_20140611.shape[0]))
daily_20140611_addname_dataframe.to_excel(daily_201406_excel_writer,'11_3',index=False)
daily_201406_excel_writer.save()
daily_20140612 = pro.daily(start_date='',end_date='',trade_date='20140612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140612_tscode_list = list() 
for ts_code_sh in daily_20140612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140612_tscode_list.append(stock_name)
daily_20140612_addname_dataframe=pd.DataFrame()
daily_20140612_addname_dataframe['cname'] = daily_20140612_tscode_list
for table_name in daily_20140612.columns.values.tolist():
    daily_20140612_addname_dataframe[table_name] = daily_20140612[table_name]
print("daily_20140612 返回数据 row 行数 = "+str(daily_20140612.shape[0]))
daily_20140612_addname_dataframe.to_excel(daily_201406_excel_writer,'12_4',index=False)
daily_201406_excel_writer.save()
daily_20140613 = pro.daily(start_date='',end_date='',trade_date='20140613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140613_tscode_list = list() 
for ts_code_sh in daily_20140613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140613_tscode_list.append(stock_name)
daily_20140613_addname_dataframe=pd.DataFrame()
daily_20140613_addname_dataframe['cname'] = daily_20140613_tscode_list
for table_name in daily_20140613.columns.values.tolist():
    daily_20140613_addname_dataframe[table_name] = daily_20140613[table_name]
print("daily_20140613 返回数据 row 行数 = "+str(daily_20140613.shape[0]))
daily_20140613_addname_dataframe.to_excel(daily_201406_excel_writer,'13_5',index=False)
daily_201406_excel_writer.save()
daily_20140614 = pro.daily(start_date='',end_date='',trade_date='20140614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140614_tscode_list = list() 
for ts_code_sh in daily_20140614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140614_tscode_list.append(stock_name)
daily_20140614_addname_dataframe=pd.DataFrame()
daily_20140614_addname_dataframe['cname'] = daily_20140614_tscode_list
for table_name in daily_20140614.columns.values.tolist():
    daily_20140614_addname_dataframe[table_name] = daily_20140614[table_name]
print("daily_20140614 返回数据 row 行数 = "+str(daily_20140614.shape[0]))
daily_20140614_addname_dataframe.to_excel(daily_201406_excel_writer,'14_6',index=False)
daily_201406_excel_writer.save()
daily_20140615 = pro.daily(start_date='',end_date='',trade_date='20140615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140615_tscode_list = list() 
for ts_code_sh in daily_20140615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140615_tscode_list.append(stock_name)
daily_20140615_addname_dataframe=pd.DataFrame()
daily_20140615_addname_dataframe['cname'] = daily_20140615_tscode_list
for table_name in daily_20140615.columns.values.tolist():
    daily_20140615_addname_dataframe[table_name] = daily_20140615[table_name]
print("daily_20140615 返回数据 row 行数 = "+str(daily_20140615.shape[0]))
daily_20140615_addname_dataframe.to_excel(daily_201406_excel_writer,'15_7',index=False)
daily_201406_excel_writer.save()
daily_20140616 = pro.daily(start_date='',end_date='',trade_date='20140616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140616_tscode_list = list() 
for ts_code_sh in daily_20140616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140616_tscode_list.append(stock_name)
daily_20140616_addname_dataframe=pd.DataFrame()
daily_20140616_addname_dataframe['cname'] = daily_20140616_tscode_list
for table_name in daily_20140616.columns.values.tolist():
    daily_20140616_addname_dataframe[table_name] = daily_20140616[table_name]
print("daily_20140616 返回数据 row 行数 = "+str(daily_20140616.shape[0]))
daily_20140616_addname_dataframe.to_excel(daily_201406_excel_writer,'16_1',index=False)
daily_201406_excel_writer.save()
daily_20140617 = pro.daily(start_date='',end_date='',trade_date='20140617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140617_tscode_list = list() 
for ts_code_sh in daily_20140617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140617_tscode_list.append(stock_name)
daily_20140617_addname_dataframe=pd.DataFrame()
daily_20140617_addname_dataframe['cname'] = daily_20140617_tscode_list
for table_name in daily_20140617.columns.values.tolist():
    daily_20140617_addname_dataframe[table_name] = daily_20140617[table_name]
print("daily_20140617 返回数据 row 行数 = "+str(daily_20140617.shape[0]))
daily_20140617_addname_dataframe.to_excel(daily_201406_excel_writer,'17_2',index=False)
daily_201406_excel_writer.save()
daily_20140618 = pro.daily(start_date='',end_date='',trade_date='20140618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140618_tscode_list = list() 
for ts_code_sh in daily_20140618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140618_tscode_list.append(stock_name)
daily_20140618_addname_dataframe=pd.DataFrame()
daily_20140618_addname_dataframe['cname'] = daily_20140618_tscode_list
for table_name in daily_20140618.columns.values.tolist():
    daily_20140618_addname_dataframe[table_name] = daily_20140618[table_name]
print("daily_20140618 返回数据 row 行数 = "+str(daily_20140618.shape[0]))
daily_20140618_addname_dataframe.to_excel(daily_201406_excel_writer,'18_3',index=False)
daily_201406_excel_writer.save()
daily_20140619 = pro.daily(start_date='',end_date='',trade_date='20140619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140619_tscode_list = list() 
for ts_code_sh in daily_20140619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140619_tscode_list.append(stock_name)
daily_20140619_addname_dataframe=pd.DataFrame()
daily_20140619_addname_dataframe['cname'] = daily_20140619_tscode_list
for table_name in daily_20140619.columns.values.tolist():
    daily_20140619_addname_dataframe[table_name] = daily_20140619[table_name]
print("daily_20140619 返回数据 row 行数 = "+str(daily_20140619.shape[0]))
daily_20140619_addname_dataframe.to_excel(daily_201406_excel_writer,'19_4',index=False)
daily_201406_excel_writer.save()
daily_20140620 = pro.daily(start_date='',end_date='',trade_date='20140620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140620_tscode_list = list() 
for ts_code_sh in daily_20140620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140620_tscode_list.append(stock_name)
daily_20140620_addname_dataframe=pd.DataFrame()
daily_20140620_addname_dataframe['cname'] = daily_20140620_tscode_list
for table_name in daily_20140620.columns.values.tolist():
    daily_20140620_addname_dataframe[table_name] = daily_20140620[table_name]
print("daily_20140620 返回数据 row 行数 = "+str(daily_20140620.shape[0]))
daily_20140620_addname_dataframe.to_excel(daily_201406_excel_writer,'20_5',index=False)
daily_201406_excel_writer.save()
daily_20140621 = pro.daily(start_date='',end_date='',trade_date='20140621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140621_tscode_list = list() 
for ts_code_sh in daily_20140621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140621_tscode_list.append(stock_name)
daily_20140621_addname_dataframe=pd.DataFrame()
daily_20140621_addname_dataframe['cname'] = daily_20140621_tscode_list
for table_name in daily_20140621.columns.values.tolist():
    daily_20140621_addname_dataframe[table_name] = daily_20140621[table_name]
print("daily_20140621 返回数据 row 行数 = "+str(daily_20140621.shape[0]))
daily_20140621_addname_dataframe.to_excel(daily_201406_excel_writer,'21_6',index=False)
daily_201406_excel_writer.save()
daily_20140622 = pro.daily(start_date='',end_date='',trade_date='20140622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140622_tscode_list = list() 
for ts_code_sh in daily_20140622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140622_tscode_list.append(stock_name)
daily_20140622_addname_dataframe=pd.DataFrame()
daily_20140622_addname_dataframe['cname'] = daily_20140622_tscode_list
for table_name in daily_20140622.columns.values.tolist():
    daily_20140622_addname_dataframe[table_name] = daily_20140622[table_name]
print("daily_20140622 返回数据 row 行数 = "+str(daily_20140622.shape[0]))
daily_20140622_addname_dataframe.to_excel(daily_201406_excel_writer,'22_7',index=False)
daily_201406_excel_writer.save()
daily_20140623 = pro.daily(start_date='',end_date='',trade_date='20140623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140623_tscode_list = list() 
for ts_code_sh in daily_20140623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140623_tscode_list.append(stock_name)
daily_20140623_addname_dataframe=pd.DataFrame()
daily_20140623_addname_dataframe['cname'] = daily_20140623_tscode_list
for table_name in daily_20140623.columns.values.tolist():
    daily_20140623_addname_dataframe[table_name] = daily_20140623[table_name]
print("daily_20140623 返回数据 row 行数 = "+str(daily_20140623.shape[0]))
daily_20140623_addname_dataframe.to_excel(daily_201406_excel_writer,'23_1',index=False)
daily_201406_excel_writer.save()
daily_20140624 = pro.daily(start_date='',end_date='',trade_date='20140624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140624_tscode_list = list() 
for ts_code_sh in daily_20140624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140624_tscode_list.append(stock_name)
daily_20140624_addname_dataframe=pd.DataFrame()
daily_20140624_addname_dataframe['cname'] = daily_20140624_tscode_list
for table_name in daily_20140624.columns.values.tolist():
    daily_20140624_addname_dataframe[table_name] = daily_20140624[table_name]
print("daily_20140624 返回数据 row 行数 = "+str(daily_20140624.shape[0]))
daily_20140624_addname_dataframe.to_excel(daily_201406_excel_writer,'24_2',index=False)
daily_201406_excel_writer.save()
daily_20140625 = pro.daily(start_date='',end_date='',trade_date='20140625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140625_tscode_list = list() 
for ts_code_sh in daily_20140625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140625_tscode_list.append(stock_name)
daily_20140625_addname_dataframe=pd.DataFrame()
daily_20140625_addname_dataframe['cname'] = daily_20140625_tscode_list
for table_name in daily_20140625.columns.values.tolist():
    daily_20140625_addname_dataframe[table_name] = daily_20140625[table_name]
print("daily_20140625 返回数据 row 行数 = "+str(daily_20140625.shape[0]))
daily_20140625_addname_dataframe.to_excel(daily_201406_excel_writer,'25_3',index=False)
daily_201406_excel_writer.save()
daily_20140626 = pro.daily(start_date='',end_date='',trade_date='20140626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140626_tscode_list = list() 
for ts_code_sh in daily_20140626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140626_tscode_list.append(stock_name)
daily_20140626_addname_dataframe=pd.DataFrame()
daily_20140626_addname_dataframe['cname'] = daily_20140626_tscode_list
for table_name in daily_20140626.columns.values.tolist():
    daily_20140626_addname_dataframe[table_name] = daily_20140626[table_name]
print("daily_20140626 返回数据 row 行数 = "+str(daily_20140626.shape[0]))
daily_20140626_addname_dataframe.to_excel(daily_201406_excel_writer,'26_4',index=False)
daily_201406_excel_writer.save()
daily_20140627 = pro.daily(start_date='',end_date='',trade_date='20140627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140627_tscode_list = list() 
for ts_code_sh in daily_20140627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140627_tscode_list.append(stock_name)
daily_20140627_addname_dataframe=pd.DataFrame()
daily_20140627_addname_dataframe['cname'] = daily_20140627_tscode_list
for table_name in daily_20140627.columns.values.tolist():
    daily_20140627_addname_dataframe[table_name] = daily_20140627[table_name]
print("daily_20140627 返回数据 row 行数 = "+str(daily_20140627.shape[0]))
daily_20140627_addname_dataframe.to_excel(daily_201406_excel_writer,'27_5',index=False)
daily_201406_excel_writer.save()
daily_20140628 = pro.daily(start_date='',end_date='',trade_date='20140628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140628_tscode_list = list() 
for ts_code_sh in daily_20140628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140628_tscode_list.append(stock_name)
daily_20140628_addname_dataframe=pd.DataFrame()
daily_20140628_addname_dataframe['cname'] = daily_20140628_tscode_list
for table_name in daily_20140628.columns.values.tolist():
    daily_20140628_addname_dataframe[table_name] = daily_20140628[table_name]
print("daily_20140628 返回数据 row 行数 = "+str(daily_20140628.shape[0]))
daily_20140628_addname_dataframe.to_excel(daily_201406_excel_writer,'28_6',index=False)
daily_201406_excel_writer.save()
daily_20140629 = pro.daily(start_date='',end_date='',trade_date='20140629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140629_tscode_list = list() 
for ts_code_sh in daily_20140629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140629_tscode_list.append(stock_name)
daily_20140629_addname_dataframe=pd.DataFrame()
daily_20140629_addname_dataframe['cname'] = daily_20140629_tscode_list
for table_name in daily_20140629.columns.values.tolist():
    daily_20140629_addname_dataframe[table_name] = daily_20140629[table_name]
print("daily_20140629 返回数据 row 行数 = "+str(daily_20140629.shape[0]))
daily_20140629_addname_dataframe.to_excel(daily_201406_excel_writer,'29_7',index=False)
daily_201406_excel_writer.save()
daily_20140630 = pro.daily(start_date='',end_date='',trade_date='20140630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140630_tscode_list = list() 
for ts_code_sh in daily_20140630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140630_tscode_list.append(stock_name)
daily_20140630_addname_dataframe=pd.DataFrame()
daily_20140630_addname_dataframe['cname'] = daily_20140630_tscode_list
for table_name in daily_20140630.columns.values.tolist():
    daily_20140630_addname_dataframe[table_name] = daily_20140630[table_name]
print("daily_20140630 返回数据 row 行数 = "+str(daily_20140630.shape[0]))
daily_20140630_addname_dataframe.to_excel(daily_201406_excel_writer,'30_1',index=False)
daily_201406_excel_writer.save()




createexcel('daily_201407.xlsx')
daily_201407_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201407.xlsx')
daily_201407_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201407.xlsx', engine='openpyxl')
daily_201407_excel_writer.book = daily_201407_book
daily_201407_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201407_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140701")       ###  更新 记录日期
daily_20140701 = pro.daily(start_date='',end_date='',trade_date='20140701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140701_tscode_list = list() 
for ts_code_sh in daily_20140701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140701_tscode_list.append(stock_name)
daily_20140701_addname_dataframe=pd.DataFrame()
daily_20140701_addname_dataframe['cname'] = daily_20140701_tscode_list
for table_name in daily_20140701.columns.values.tolist():
    daily_20140701_addname_dataframe[table_name] = daily_20140701[table_name]
print("daily_20140701 返回数据 row 行数 = "+str(daily_20140701.shape[0]))
daily_20140701_addname_dataframe.to_excel(daily_201407_excel_writer,'1_2',index=False)
daily_201407_excel_writer.save()
daily_20140702 = pro.daily(start_date='',end_date='',trade_date='20140702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140702_tscode_list = list() 
for ts_code_sh in daily_20140702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140702_tscode_list.append(stock_name)
daily_20140702_addname_dataframe=pd.DataFrame()
daily_20140702_addname_dataframe['cname'] = daily_20140702_tscode_list
for table_name in daily_20140702.columns.values.tolist():
    daily_20140702_addname_dataframe[table_name] = daily_20140702[table_name]
print("daily_20140702 返回数据 row 行数 = "+str(daily_20140702.shape[0]))
daily_20140702_addname_dataframe.to_excel(daily_201407_excel_writer,'2_3',index=False)
daily_201407_excel_writer.save()
daily_20140703 = pro.daily(start_date='',end_date='',trade_date='20140703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140703_tscode_list = list() 
for ts_code_sh in daily_20140703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140703_tscode_list.append(stock_name)
daily_20140703_addname_dataframe=pd.DataFrame()
daily_20140703_addname_dataframe['cname'] = daily_20140703_tscode_list
for table_name in daily_20140703.columns.values.tolist():
    daily_20140703_addname_dataframe[table_name] = daily_20140703[table_name]
print("daily_20140703 返回数据 row 行数 = "+str(daily_20140703.shape[0]))
daily_20140703_addname_dataframe.to_excel(daily_201407_excel_writer,'3_4',index=False)
daily_201407_excel_writer.save()
daily_20140704 = pro.daily(start_date='',end_date='',trade_date='20140704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140704_tscode_list = list() 
for ts_code_sh in daily_20140704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140704_tscode_list.append(stock_name)
daily_20140704_addname_dataframe=pd.DataFrame()
daily_20140704_addname_dataframe['cname'] = daily_20140704_tscode_list
for table_name in daily_20140704.columns.values.tolist():
    daily_20140704_addname_dataframe[table_name] = daily_20140704[table_name]
print("daily_20140704 返回数据 row 行数 = "+str(daily_20140704.shape[0]))
daily_20140704_addname_dataframe.to_excel(daily_201407_excel_writer,'4_5',index=False)
daily_201407_excel_writer.save()
daily_20140705 = pro.daily(start_date='',end_date='',trade_date='20140705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140705_tscode_list = list() 
for ts_code_sh in daily_20140705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140705_tscode_list.append(stock_name)
daily_20140705_addname_dataframe=pd.DataFrame()
daily_20140705_addname_dataframe['cname'] = daily_20140705_tscode_list
for table_name in daily_20140705.columns.values.tolist():
    daily_20140705_addname_dataframe[table_name] = daily_20140705[table_name]
print("daily_20140705 返回数据 row 行数 = "+str(daily_20140705.shape[0]))
daily_20140705_addname_dataframe.to_excel(daily_201407_excel_writer,'5_6',index=False)
daily_201407_excel_writer.save()
daily_20140706 = pro.daily(start_date='',end_date='',trade_date='20140706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140706_tscode_list = list() 
for ts_code_sh in daily_20140706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140706_tscode_list.append(stock_name)
daily_20140706_addname_dataframe=pd.DataFrame()
daily_20140706_addname_dataframe['cname'] = daily_20140706_tscode_list
for table_name in daily_20140706.columns.values.tolist():
    daily_20140706_addname_dataframe[table_name] = daily_20140706[table_name]
print("daily_20140706 返回数据 row 行数 = "+str(daily_20140706.shape[0]))
daily_20140706_addname_dataframe.to_excel(daily_201407_excel_writer,'6_7',index=False)
daily_201407_excel_writer.save()
daily_20140707 = pro.daily(start_date='',end_date='',trade_date='20140707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140707_tscode_list = list() 
for ts_code_sh in daily_20140707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140707_tscode_list.append(stock_name)
daily_20140707_addname_dataframe=pd.DataFrame()
daily_20140707_addname_dataframe['cname'] = daily_20140707_tscode_list
for table_name in daily_20140707.columns.values.tolist():
    daily_20140707_addname_dataframe[table_name] = daily_20140707[table_name]
print("daily_20140707 返回数据 row 行数 = "+str(daily_20140707.shape[0]))
daily_20140707_addname_dataframe.to_excel(daily_201407_excel_writer,'7_1',index=False)
daily_201407_excel_writer.save()
daily_20140708 = pro.daily(start_date='',end_date='',trade_date='20140708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140708_tscode_list = list() 
for ts_code_sh in daily_20140708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140708_tscode_list.append(stock_name)
daily_20140708_addname_dataframe=pd.DataFrame()
daily_20140708_addname_dataframe['cname'] = daily_20140708_tscode_list
for table_name in daily_20140708.columns.values.tolist():
    daily_20140708_addname_dataframe[table_name] = daily_20140708[table_name]
print("daily_20140708 返回数据 row 行数 = "+str(daily_20140708.shape[0]))
daily_20140708_addname_dataframe.to_excel(daily_201407_excel_writer,'8_2',index=False)
daily_201407_excel_writer.save()
daily_20140709 = pro.daily(start_date='',end_date='',trade_date='20140709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140709_tscode_list = list() 
for ts_code_sh in daily_20140709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140709_tscode_list.append(stock_name)
daily_20140709_addname_dataframe=pd.DataFrame()
daily_20140709_addname_dataframe['cname'] = daily_20140709_tscode_list
for table_name in daily_20140709.columns.values.tolist():
    daily_20140709_addname_dataframe[table_name] = daily_20140709[table_name]
print("daily_20140709 返回数据 row 行数 = "+str(daily_20140709.shape[0]))
daily_20140709_addname_dataframe.to_excel(daily_201407_excel_writer,'9_3',index=False)
daily_201407_excel_writer.save()
daily_20140710 = pro.daily(start_date='',end_date='',trade_date='20140710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140710_tscode_list = list() 
for ts_code_sh in daily_20140710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140710_tscode_list.append(stock_name)
daily_20140710_addname_dataframe=pd.DataFrame()
daily_20140710_addname_dataframe['cname'] = daily_20140710_tscode_list
for table_name in daily_20140710.columns.values.tolist():
    daily_20140710_addname_dataframe[table_name] = daily_20140710[table_name]
print("daily_20140710 返回数据 row 行数 = "+str(daily_20140710.shape[0]))
daily_20140710_addname_dataframe.to_excel(daily_201407_excel_writer,'10_4',index=False)
daily_201407_excel_writer.save()
daily_20140711 = pro.daily(start_date='',end_date='',trade_date='20140711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140711_tscode_list = list() 
for ts_code_sh in daily_20140711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140711_tscode_list.append(stock_name)
daily_20140711_addname_dataframe=pd.DataFrame()
daily_20140711_addname_dataframe['cname'] = daily_20140711_tscode_list
for table_name in daily_20140711.columns.values.tolist():
    daily_20140711_addname_dataframe[table_name] = daily_20140711[table_name]
print("daily_20140711 返回数据 row 行数 = "+str(daily_20140711.shape[0]))
daily_20140711_addname_dataframe.to_excel(daily_201407_excel_writer,'11_5',index=False)
daily_201407_excel_writer.save()
daily_20140712 = pro.daily(start_date='',end_date='',trade_date='20140712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140712_tscode_list = list() 
for ts_code_sh in daily_20140712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140712_tscode_list.append(stock_name)
daily_20140712_addname_dataframe=pd.DataFrame()
daily_20140712_addname_dataframe['cname'] = daily_20140712_tscode_list
for table_name in daily_20140712.columns.values.tolist():
    daily_20140712_addname_dataframe[table_name] = daily_20140712[table_name]
print("daily_20140712 返回数据 row 行数 = "+str(daily_20140712.shape[0]))
daily_20140712_addname_dataframe.to_excel(daily_201407_excel_writer,'12_6',index=False)
daily_201407_excel_writer.save()
daily_20140713 = pro.daily(start_date='',end_date='',trade_date='20140713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140713_tscode_list = list() 
for ts_code_sh in daily_20140713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140713_tscode_list.append(stock_name)
daily_20140713_addname_dataframe=pd.DataFrame()
daily_20140713_addname_dataframe['cname'] = daily_20140713_tscode_list
for table_name in daily_20140713.columns.values.tolist():
    daily_20140713_addname_dataframe[table_name] = daily_20140713[table_name]
print("daily_20140713 返回数据 row 行数 = "+str(daily_20140713.shape[0]))
daily_20140713_addname_dataframe.to_excel(daily_201407_excel_writer,'13_7',index=False)
daily_201407_excel_writer.save()
daily_20140714 = pro.daily(start_date='',end_date='',trade_date='20140714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140714_tscode_list = list() 
for ts_code_sh in daily_20140714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140714_tscode_list.append(stock_name)
daily_20140714_addname_dataframe=pd.DataFrame()
daily_20140714_addname_dataframe['cname'] = daily_20140714_tscode_list
for table_name in daily_20140714.columns.values.tolist():
    daily_20140714_addname_dataframe[table_name] = daily_20140714[table_name]
print("daily_20140714 返回数据 row 行数 = "+str(daily_20140714.shape[0]))
daily_20140714_addname_dataframe.to_excel(daily_201407_excel_writer,'14_1',index=False)
daily_201407_excel_writer.save()
daily_20140715 = pro.daily(start_date='',end_date='',trade_date='20140715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140715_tscode_list = list() 
for ts_code_sh in daily_20140715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140715_tscode_list.append(stock_name)
daily_20140715_addname_dataframe=pd.DataFrame()
daily_20140715_addname_dataframe['cname'] = daily_20140715_tscode_list
for table_name in daily_20140715.columns.values.tolist():
    daily_20140715_addname_dataframe[table_name] = daily_20140715[table_name]
print("daily_20140715 返回数据 row 行数 = "+str(daily_20140715.shape[0]))
daily_20140715_addname_dataframe.to_excel(daily_201407_excel_writer,'15_2',index=False)
daily_201407_excel_writer.save()
daily_20140716 = pro.daily(start_date='',end_date='',trade_date='20140716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140716_tscode_list = list() 
for ts_code_sh in daily_20140716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140716_tscode_list.append(stock_name)
daily_20140716_addname_dataframe=pd.DataFrame()
daily_20140716_addname_dataframe['cname'] = daily_20140716_tscode_list
for table_name in daily_20140716.columns.values.tolist():
    daily_20140716_addname_dataframe[table_name] = daily_20140716[table_name]
print("daily_20140716 返回数据 row 行数 = "+str(daily_20140716.shape[0]))
daily_20140716_addname_dataframe.to_excel(daily_201407_excel_writer,'16_3',index=False)
daily_201407_excel_writer.save()
daily_20140717 = pro.daily(start_date='',end_date='',trade_date='20140717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140717_tscode_list = list() 
for ts_code_sh in daily_20140717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140717_tscode_list.append(stock_name)
daily_20140717_addname_dataframe=pd.DataFrame()
daily_20140717_addname_dataframe['cname'] = daily_20140717_tscode_list
for table_name in daily_20140717.columns.values.tolist():
    daily_20140717_addname_dataframe[table_name] = daily_20140717[table_name]
print("daily_20140717 返回数据 row 行数 = "+str(daily_20140717.shape[0]))
daily_20140717_addname_dataframe.to_excel(daily_201407_excel_writer,'17_4',index=False)
daily_201407_excel_writer.save()
daily_20140718 = pro.daily(start_date='',end_date='',trade_date='20140718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140718_tscode_list = list() 
for ts_code_sh in daily_20140718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140718_tscode_list.append(stock_name)
daily_20140718_addname_dataframe=pd.DataFrame()
daily_20140718_addname_dataframe['cname'] = daily_20140718_tscode_list
for table_name in daily_20140718.columns.values.tolist():
    daily_20140718_addname_dataframe[table_name] = daily_20140718[table_name]
print("daily_20140718 返回数据 row 行数 = "+str(daily_20140718.shape[0]))
daily_20140718_addname_dataframe.to_excel(daily_201407_excel_writer,'18_5',index=False)
daily_201407_excel_writer.save()
daily_20140719 = pro.daily(start_date='',end_date='',trade_date='20140719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140719_tscode_list = list() 
for ts_code_sh in daily_20140719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140719_tscode_list.append(stock_name)
daily_20140719_addname_dataframe=pd.DataFrame()
daily_20140719_addname_dataframe['cname'] = daily_20140719_tscode_list
for table_name in daily_20140719.columns.values.tolist():
    daily_20140719_addname_dataframe[table_name] = daily_20140719[table_name]
print("daily_20140719 返回数据 row 行数 = "+str(daily_20140719.shape[0]))
daily_20140719_addname_dataframe.to_excel(daily_201407_excel_writer,'19_6',index=False)
daily_201407_excel_writer.save()
daily_20140720 = pro.daily(start_date='',end_date='',trade_date='20140720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140720_tscode_list = list() 
for ts_code_sh in daily_20140720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140720_tscode_list.append(stock_name)
daily_20140720_addname_dataframe=pd.DataFrame()
daily_20140720_addname_dataframe['cname'] = daily_20140720_tscode_list
for table_name in daily_20140720.columns.values.tolist():
    daily_20140720_addname_dataframe[table_name] = daily_20140720[table_name]
print("daily_20140720 返回数据 row 行数 = "+str(daily_20140720.shape[0]))
daily_20140720_addname_dataframe.to_excel(daily_201407_excel_writer,'20_7',index=False)
daily_201407_excel_writer.save()
daily_20140721 = pro.daily(start_date='',end_date='',trade_date='20140721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140721_tscode_list = list() 
for ts_code_sh in daily_20140721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140721_tscode_list.append(stock_name)
daily_20140721_addname_dataframe=pd.DataFrame()
daily_20140721_addname_dataframe['cname'] = daily_20140721_tscode_list
for table_name in daily_20140721.columns.values.tolist():
    daily_20140721_addname_dataframe[table_name] = daily_20140721[table_name]
print("daily_20140721 返回数据 row 行数 = "+str(daily_20140721.shape[0]))
daily_20140721_addname_dataframe.to_excel(daily_201407_excel_writer,'21_1',index=False)
daily_201407_excel_writer.save()
daily_20140722 = pro.daily(start_date='',end_date='',trade_date='20140722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140722_tscode_list = list() 
for ts_code_sh in daily_20140722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140722_tscode_list.append(stock_name)
daily_20140722_addname_dataframe=pd.DataFrame()
daily_20140722_addname_dataframe['cname'] = daily_20140722_tscode_list
for table_name in daily_20140722.columns.values.tolist():
    daily_20140722_addname_dataframe[table_name] = daily_20140722[table_name]
print("daily_20140722 返回数据 row 行数 = "+str(daily_20140722.shape[0]))
daily_20140722_addname_dataframe.to_excel(daily_201407_excel_writer,'22_2',index=False)
daily_201407_excel_writer.save()
daily_20140723 = pro.daily(start_date='',end_date='',trade_date='20140723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140723_tscode_list = list() 
for ts_code_sh in daily_20140723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140723_tscode_list.append(stock_name)
daily_20140723_addname_dataframe=pd.DataFrame()
daily_20140723_addname_dataframe['cname'] = daily_20140723_tscode_list
for table_name in daily_20140723.columns.values.tolist():
    daily_20140723_addname_dataframe[table_name] = daily_20140723[table_name]
print("daily_20140723 返回数据 row 行数 = "+str(daily_20140723.shape[0]))
daily_20140723_addname_dataframe.to_excel(daily_201407_excel_writer,'23_3',index=False)
daily_201407_excel_writer.save()
daily_20140724 = pro.daily(start_date='',end_date='',trade_date='20140724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140724_tscode_list = list() 
for ts_code_sh in daily_20140724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140724_tscode_list.append(stock_name)
daily_20140724_addname_dataframe=pd.DataFrame()
daily_20140724_addname_dataframe['cname'] = daily_20140724_tscode_list
for table_name in daily_20140724.columns.values.tolist():
    daily_20140724_addname_dataframe[table_name] = daily_20140724[table_name]
print("daily_20140724 返回数据 row 行数 = "+str(daily_20140724.shape[0]))
daily_20140724_addname_dataframe.to_excel(daily_201407_excel_writer,'24_4',index=False)
daily_201407_excel_writer.save()
daily_20140725 = pro.daily(start_date='',end_date='',trade_date='20140725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140725_tscode_list = list() 
for ts_code_sh in daily_20140725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140725_tscode_list.append(stock_name)
daily_20140725_addname_dataframe=pd.DataFrame()
daily_20140725_addname_dataframe['cname'] = daily_20140725_tscode_list
for table_name in daily_20140725.columns.values.tolist():
    daily_20140725_addname_dataframe[table_name] = daily_20140725[table_name]
print("daily_20140725 返回数据 row 行数 = "+str(daily_20140725.shape[0]))
daily_20140725_addname_dataframe.to_excel(daily_201407_excel_writer,'25_5',index=False)
daily_201407_excel_writer.save()
daily_20140726 = pro.daily(start_date='',end_date='',trade_date='20140726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140726_tscode_list = list() 
for ts_code_sh in daily_20140726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140726_tscode_list.append(stock_name)
daily_20140726_addname_dataframe=pd.DataFrame()
daily_20140726_addname_dataframe['cname'] = daily_20140726_tscode_list
for table_name in daily_20140726.columns.values.tolist():
    daily_20140726_addname_dataframe[table_name] = daily_20140726[table_name]
print("daily_20140726 返回数据 row 行数 = "+str(daily_20140726.shape[0]))
daily_20140726_addname_dataframe.to_excel(daily_201407_excel_writer,'26_6',index=False)
daily_201407_excel_writer.save()
daily_20140727 = pro.daily(start_date='',end_date='',trade_date='20140727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140727_tscode_list = list() 
for ts_code_sh in daily_20140727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140727_tscode_list.append(stock_name)
daily_20140727_addname_dataframe=pd.DataFrame()
daily_20140727_addname_dataframe['cname'] = daily_20140727_tscode_list
for table_name in daily_20140727.columns.values.tolist():
    daily_20140727_addname_dataframe[table_name] = daily_20140727[table_name]
print("daily_20140727 返回数据 row 行数 = "+str(daily_20140727.shape[0]))
daily_20140727_addname_dataframe.to_excel(daily_201407_excel_writer,'27_7',index=False)
daily_201407_excel_writer.save()
daily_20140728 = pro.daily(start_date='',end_date='',trade_date='20140728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140728_tscode_list = list() 
for ts_code_sh in daily_20140728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140728_tscode_list.append(stock_name)
daily_20140728_addname_dataframe=pd.DataFrame()
daily_20140728_addname_dataframe['cname'] = daily_20140728_tscode_list
for table_name in daily_20140728.columns.values.tolist():
    daily_20140728_addname_dataframe[table_name] = daily_20140728[table_name]
print("daily_20140728 返回数据 row 行数 = "+str(daily_20140728.shape[0]))
daily_20140728_addname_dataframe.to_excel(daily_201407_excel_writer,'28_1',index=False)
daily_201407_excel_writer.save()
daily_20140729 = pro.daily(start_date='',end_date='',trade_date='20140729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140729_tscode_list = list() 
for ts_code_sh in daily_20140729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140729_tscode_list.append(stock_name)
daily_20140729_addname_dataframe=pd.DataFrame()
daily_20140729_addname_dataframe['cname'] = daily_20140729_tscode_list
for table_name in daily_20140729.columns.values.tolist():
    daily_20140729_addname_dataframe[table_name] = daily_20140729[table_name]
print("daily_20140729 返回数据 row 行数 = "+str(daily_20140729.shape[0]))
daily_20140729_addname_dataframe.to_excel(daily_201407_excel_writer,'29_2',index=False)
daily_201407_excel_writer.save()
daily_20140730 = pro.daily(start_date='',end_date='',trade_date='20140730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140730_tscode_list = list() 
for ts_code_sh in daily_20140730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140730_tscode_list.append(stock_name)
daily_20140730_addname_dataframe=pd.DataFrame()
daily_20140730_addname_dataframe['cname'] = daily_20140730_tscode_list
for table_name in daily_20140730.columns.values.tolist():
    daily_20140730_addname_dataframe[table_name] = daily_20140730[table_name]
print("daily_20140730 返回数据 row 行数 = "+str(daily_20140730.shape[0]))
daily_20140730_addname_dataframe.to_excel(daily_201407_excel_writer,'30_3',index=False)
daily_201407_excel_writer.save()
daily_20140731 = pro.daily(start_date='',end_date='',trade_date='20140731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140731_tscode_list = list() 
for ts_code_sh in daily_20140731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140731_tscode_list.append(stock_name)
daily_20140731_addname_dataframe=pd.DataFrame()
daily_20140731_addname_dataframe['cname'] = daily_20140731_tscode_list
for table_name in daily_20140731.columns.values.tolist():
    daily_20140731_addname_dataframe[table_name] = daily_20140731[table_name]
print("daily_20140731 返回数据 row 行数 = "+str(daily_20140731.shape[0]))
daily_20140731_addname_dataframe.to_excel(daily_201407_excel_writer,'31_4',index=False)
daily_201407_excel_writer.save()




createexcel('daily_201408.xlsx')
daily_201408_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201408.xlsx')
daily_201408_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201408.xlsx', engine='openpyxl')
daily_201408_excel_writer.book = daily_201408_book
daily_201408_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201408_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140801")       ###  更新 记录日期
daily_20140801 = pro.daily(start_date='',end_date='',trade_date='20140801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140801_tscode_list = list() 
for ts_code_sh in daily_20140801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140801_tscode_list.append(stock_name)
daily_20140801_addname_dataframe=pd.DataFrame()
daily_20140801_addname_dataframe['cname'] = daily_20140801_tscode_list
for table_name in daily_20140801.columns.values.tolist():
    daily_20140801_addname_dataframe[table_name] = daily_20140801[table_name]
print("daily_20140801 返回数据 row 行数 = "+str(daily_20140801.shape[0]))
daily_20140801_addname_dataframe.to_excel(daily_201408_excel_writer,'1_5',index=False)
daily_201408_excel_writer.save()
daily_20140802 = pro.daily(start_date='',end_date='',trade_date='20140802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140802_tscode_list = list() 
for ts_code_sh in daily_20140802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140802_tscode_list.append(stock_name)
daily_20140802_addname_dataframe=pd.DataFrame()
daily_20140802_addname_dataframe['cname'] = daily_20140802_tscode_list
for table_name in daily_20140802.columns.values.tolist():
    daily_20140802_addname_dataframe[table_name] = daily_20140802[table_name]
print("daily_20140802 返回数据 row 行数 = "+str(daily_20140802.shape[0]))
daily_20140802_addname_dataframe.to_excel(daily_201408_excel_writer,'2_6',index=False)
daily_201408_excel_writer.save()
daily_20140803 = pro.daily(start_date='',end_date='',trade_date='20140803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140803_tscode_list = list() 
for ts_code_sh in daily_20140803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140803_tscode_list.append(stock_name)
daily_20140803_addname_dataframe=pd.DataFrame()
daily_20140803_addname_dataframe['cname'] = daily_20140803_tscode_list
for table_name in daily_20140803.columns.values.tolist():
    daily_20140803_addname_dataframe[table_name] = daily_20140803[table_name]
print("daily_20140803 返回数据 row 行数 = "+str(daily_20140803.shape[0]))
daily_20140803_addname_dataframe.to_excel(daily_201408_excel_writer,'3_7',index=False)
daily_201408_excel_writer.save()
daily_20140804 = pro.daily(start_date='',end_date='',trade_date='20140804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140804_tscode_list = list() 
for ts_code_sh in daily_20140804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140804_tscode_list.append(stock_name)
daily_20140804_addname_dataframe=pd.DataFrame()
daily_20140804_addname_dataframe['cname'] = daily_20140804_tscode_list
for table_name in daily_20140804.columns.values.tolist():
    daily_20140804_addname_dataframe[table_name] = daily_20140804[table_name]
print("daily_20140804 返回数据 row 行数 = "+str(daily_20140804.shape[0]))
daily_20140804_addname_dataframe.to_excel(daily_201408_excel_writer,'4_1',index=False)
daily_201408_excel_writer.save()
daily_20140805 = pro.daily(start_date='',end_date='',trade_date='20140805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140805_tscode_list = list() 
for ts_code_sh in daily_20140805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140805_tscode_list.append(stock_name)
daily_20140805_addname_dataframe=pd.DataFrame()
daily_20140805_addname_dataframe['cname'] = daily_20140805_tscode_list
for table_name in daily_20140805.columns.values.tolist():
    daily_20140805_addname_dataframe[table_name] = daily_20140805[table_name]
print("daily_20140805 返回数据 row 行数 = "+str(daily_20140805.shape[0]))
daily_20140805_addname_dataframe.to_excel(daily_201408_excel_writer,'5_2',index=False)
daily_201408_excel_writer.save()
daily_20140806 = pro.daily(start_date='',end_date='',trade_date='20140806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140806_tscode_list = list() 
for ts_code_sh in daily_20140806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140806_tscode_list.append(stock_name)
daily_20140806_addname_dataframe=pd.DataFrame()
daily_20140806_addname_dataframe['cname'] = daily_20140806_tscode_list
for table_name in daily_20140806.columns.values.tolist():
    daily_20140806_addname_dataframe[table_name] = daily_20140806[table_name]
print("daily_20140806 返回数据 row 行数 = "+str(daily_20140806.shape[0]))
daily_20140806_addname_dataframe.to_excel(daily_201408_excel_writer,'6_3',index=False)
daily_201408_excel_writer.save()
daily_20140807 = pro.daily(start_date='',end_date='',trade_date='20140807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140807_tscode_list = list() 
for ts_code_sh in daily_20140807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140807_tscode_list.append(stock_name)
daily_20140807_addname_dataframe=pd.DataFrame()
daily_20140807_addname_dataframe['cname'] = daily_20140807_tscode_list
for table_name in daily_20140807.columns.values.tolist():
    daily_20140807_addname_dataframe[table_name] = daily_20140807[table_name]
print("daily_20140807 返回数据 row 行数 = "+str(daily_20140807.shape[0]))
daily_20140807_addname_dataframe.to_excel(daily_201408_excel_writer,'7_4',index=False)
daily_201408_excel_writer.save()
daily_20140808 = pro.daily(start_date='',end_date='',trade_date='20140808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140808_tscode_list = list() 
for ts_code_sh in daily_20140808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140808_tscode_list.append(stock_name)
daily_20140808_addname_dataframe=pd.DataFrame()
daily_20140808_addname_dataframe['cname'] = daily_20140808_tscode_list
for table_name in daily_20140808.columns.values.tolist():
    daily_20140808_addname_dataframe[table_name] = daily_20140808[table_name]
print("daily_20140808 返回数据 row 行数 = "+str(daily_20140808.shape[0]))
daily_20140808_addname_dataframe.to_excel(daily_201408_excel_writer,'8_5',index=False)
daily_201408_excel_writer.save()
daily_20140809 = pro.daily(start_date='',end_date='',trade_date='20140809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140809_tscode_list = list() 
for ts_code_sh in daily_20140809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140809_tscode_list.append(stock_name)
daily_20140809_addname_dataframe=pd.DataFrame()
daily_20140809_addname_dataframe['cname'] = daily_20140809_tscode_list
for table_name in daily_20140809.columns.values.tolist():
    daily_20140809_addname_dataframe[table_name] = daily_20140809[table_name]
print("daily_20140809 返回数据 row 行数 = "+str(daily_20140809.shape[0]))
daily_20140809_addname_dataframe.to_excel(daily_201408_excel_writer,'9_6',index=False)
daily_201408_excel_writer.save()
daily_20140810 = pro.daily(start_date='',end_date='',trade_date='20140810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140810_tscode_list = list() 
for ts_code_sh in daily_20140810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140810_tscode_list.append(stock_name)
daily_20140810_addname_dataframe=pd.DataFrame()
daily_20140810_addname_dataframe['cname'] = daily_20140810_tscode_list
for table_name in daily_20140810.columns.values.tolist():
    daily_20140810_addname_dataframe[table_name] = daily_20140810[table_name]
print("daily_20140810 返回数据 row 行数 = "+str(daily_20140810.shape[0]))
daily_20140810_addname_dataframe.to_excel(daily_201408_excel_writer,'10_7',index=False)
daily_201408_excel_writer.save()
daily_20140811 = pro.daily(start_date='',end_date='',trade_date='20140811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140811_tscode_list = list() 
for ts_code_sh in daily_20140811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140811_tscode_list.append(stock_name)
daily_20140811_addname_dataframe=pd.DataFrame()
daily_20140811_addname_dataframe['cname'] = daily_20140811_tscode_list
for table_name in daily_20140811.columns.values.tolist():
    daily_20140811_addname_dataframe[table_name] = daily_20140811[table_name]
print("daily_20140811 返回数据 row 行数 = "+str(daily_20140811.shape[0]))
daily_20140811_addname_dataframe.to_excel(daily_201408_excel_writer,'11_1',index=False)
daily_201408_excel_writer.save()
daily_20140812 = pro.daily(start_date='',end_date='',trade_date='20140812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140812_tscode_list = list() 
for ts_code_sh in daily_20140812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140812_tscode_list.append(stock_name)
daily_20140812_addname_dataframe=pd.DataFrame()
daily_20140812_addname_dataframe['cname'] = daily_20140812_tscode_list
for table_name in daily_20140812.columns.values.tolist():
    daily_20140812_addname_dataframe[table_name] = daily_20140812[table_name]
print("daily_20140812 返回数据 row 行数 = "+str(daily_20140812.shape[0]))
daily_20140812_addname_dataframe.to_excel(daily_201408_excel_writer,'12_2',index=False)
daily_201408_excel_writer.save()
daily_20140813 = pro.daily(start_date='',end_date='',trade_date='20140813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140813_tscode_list = list() 
for ts_code_sh in daily_20140813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140813_tscode_list.append(stock_name)
daily_20140813_addname_dataframe=pd.DataFrame()
daily_20140813_addname_dataframe['cname'] = daily_20140813_tscode_list
for table_name in daily_20140813.columns.values.tolist():
    daily_20140813_addname_dataframe[table_name] = daily_20140813[table_name]
print("daily_20140813 返回数据 row 行数 = "+str(daily_20140813.shape[0]))
daily_20140813_addname_dataframe.to_excel(daily_201408_excel_writer,'13_3',index=False)
daily_201408_excel_writer.save()
daily_20140814 = pro.daily(start_date='',end_date='',trade_date='20140814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140814_tscode_list = list() 
for ts_code_sh in daily_20140814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140814_tscode_list.append(stock_name)
daily_20140814_addname_dataframe=pd.DataFrame()
daily_20140814_addname_dataframe['cname'] = daily_20140814_tscode_list
for table_name in daily_20140814.columns.values.tolist():
    daily_20140814_addname_dataframe[table_name] = daily_20140814[table_name]
print("daily_20140814 返回数据 row 行数 = "+str(daily_20140814.shape[0]))
daily_20140814_addname_dataframe.to_excel(daily_201408_excel_writer,'14_4',index=False)
daily_201408_excel_writer.save()
daily_20140815 = pro.daily(start_date='',end_date='',trade_date='20140815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140815_tscode_list = list() 
for ts_code_sh in daily_20140815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140815_tscode_list.append(stock_name)
daily_20140815_addname_dataframe=pd.DataFrame()
daily_20140815_addname_dataframe['cname'] = daily_20140815_tscode_list
for table_name in daily_20140815.columns.values.tolist():
    daily_20140815_addname_dataframe[table_name] = daily_20140815[table_name]
print("daily_20140815 返回数据 row 行数 = "+str(daily_20140815.shape[0]))
daily_20140815_addname_dataframe.to_excel(daily_201408_excel_writer,'15_5',index=False)
daily_201408_excel_writer.save()
daily_20140816 = pro.daily(start_date='',end_date='',trade_date='20140816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140816_tscode_list = list() 
for ts_code_sh in daily_20140816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140816_tscode_list.append(stock_name)
daily_20140816_addname_dataframe=pd.DataFrame()
daily_20140816_addname_dataframe['cname'] = daily_20140816_tscode_list
for table_name in daily_20140816.columns.values.tolist():
    daily_20140816_addname_dataframe[table_name] = daily_20140816[table_name]
print("daily_20140816 返回数据 row 行数 = "+str(daily_20140816.shape[0]))
daily_20140816_addname_dataframe.to_excel(daily_201408_excel_writer,'16_6',index=False)
daily_201408_excel_writer.save()
daily_20140817 = pro.daily(start_date='',end_date='',trade_date='20140817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140817_tscode_list = list() 
for ts_code_sh in daily_20140817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140817_tscode_list.append(stock_name)
daily_20140817_addname_dataframe=pd.DataFrame()
daily_20140817_addname_dataframe['cname'] = daily_20140817_tscode_list
for table_name in daily_20140817.columns.values.tolist():
    daily_20140817_addname_dataframe[table_name] = daily_20140817[table_name]
print("daily_20140817 返回数据 row 行数 = "+str(daily_20140817.shape[0]))
daily_20140817_addname_dataframe.to_excel(daily_201408_excel_writer,'17_7',index=False)
daily_201408_excel_writer.save()
daily_20140818 = pro.daily(start_date='',end_date='',trade_date='20140818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140818_tscode_list = list() 
for ts_code_sh in daily_20140818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140818_tscode_list.append(stock_name)
daily_20140818_addname_dataframe=pd.DataFrame()
daily_20140818_addname_dataframe['cname'] = daily_20140818_tscode_list
for table_name in daily_20140818.columns.values.tolist():
    daily_20140818_addname_dataframe[table_name] = daily_20140818[table_name]
print("daily_20140818 返回数据 row 行数 = "+str(daily_20140818.shape[0]))
daily_20140818_addname_dataframe.to_excel(daily_201408_excel_writer,'18_1',index=False)
daily_201408_excel_writer.save()
daily_20140819 = pro.daily(start_date='',end_date='',trade_date='20140819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140819_tscode_list = list() 
for ts_code_sh in daily_20140819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140819_tscode_list.append(stock_name)
daily_20140819_addname_dataframe=pd.DataFrame()
daily_20140819_addname_dataframe['cname'] = daily_20140819_tscode_list
for table_name in daily_20140819.columns.values.tolist():
    daily_20140819_addname_dataframe[table_name] = daily_20140819[table_name]
print("daily_20140819 返回数据 row 行数 = "+str(daily_20140819.shape[0]))
daily_20140819_addname_dataframe.to_excel(daily_201408_excel_writer,'19_2',index=False)
daily_201408_excel_writer.save()
daily_20140820 = pro.daily(start_date='',end_date='',trade_date='20140820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140820_tscode_list = list() 
for ts_code_sh in daily_20140820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140820_tscode_list.append(stock_name)
daily_20140820_addname_dataframe=pd.DataFrame()
daily_20140820_addname_dataframe['cname'] = daily_20140820_tscode_list
for table_name in daily_20140820.columns.values.tolist():
    daily_20140820_addname_dataframe[table_name] = daily_20140820[table_name]
print("daily_20140820 返回数据 row 行数 = "+str(daily_20140820.shape[0]))
daily_20140820_addname_dataframe.to_excel(daily_201408_excel_writer,'20_3',index=False)
daily_201408_excel_writer.save()
daily_20140821 = pro.daily(start_date='',end_date='',trade_date='20140821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140821_tscode_list = list() 
for ts_code_sh in daily_20140821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140821_tscode_list.append(stock_name)
daily_20140821_addname_dataframe=pd.DataFrame()
daily_20140821_addname_dataframe['cname'] = daily_20140821_tscode_list
for table_name in daily_20140821.columns.values.tolist():
    daily_20140821_addname_dataframe[table_name] = daily_20140821[table_name]
print("daily_20140821 返回数据 row 行数 = "+str(daily_20140821.shape[0]))
daily_20140821_addname_dataframe.to_excel(daily_201408_excel_writer,'21_4',index=False)
daily_201408_excel_writer.save()
daily_20140822 = pro.daily(start_date='',end_date='',trade_date='20140822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140822_tscode_list = list() 
for ts_code_sh in daily_20140822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140822_tscode_list.append(stock_name)
daily_20140822_addname_dataframe=pd.DataFrame()
daily_20140822_addname_dataframe['cname'] = daily_20140822_tscode_list
for table_name in daily_20140822.columns.values.tolist():
    daily_20140822_addname_dataframe[table_name] = daily_20140822[table_name]
print("daily_20140822 返回数据 row 行数 = "+str(daily_20140822.shape[0]))
daily_20140822_addname_dataframe.to_excel(daily_201408_excel_writer,'22_5',index=False)
daily_201408_excel_writer.save()
daily_20140823 = pro.daily(start_date='',end_date='',trade_date='20140823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140823_tscode_list = list() 
for ts_code_sh in daily_20140823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140823_tscode_list.append(stock_name)
daily_20140823_addname_dataframe=pd.DataFrame()
daily_20140823_addname_dataframe['cname'] = daily_20140823_tscode_list
for table_name in daily_20140823.columns.values.tolist():
    daily_20140823_addname_dataframe[table_name] = daily_20140823[table_name]
print("daily_20140823 返回数据 row 行数 = "+str(daily_20140823.shape[0]))
daily_20140823_addname_dataframe.to_excel(daily_201408_excel_writer,'23_6',index=False)
daily_201408_excel_writer.save()
daily_20140824 = pro.daily(start_date='',end_date='',trade_date='20140824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140824_tscode_list = list() 
for ts_code_sh in daily_20140824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140824_tscode_list.append(stock_name)
daily_20140824_addname_dataframe=pd.DataFrame()
daily_20140824_addname_dataframe['cname'] = daily_20140824_tscode_list
for table_name in daily_20140824.columns.values.tolist():
    daily_20140824_addname_dataframe[table_name] = daily_20140824[table_name]
print("daily_20140824 返回数据 row 行数 = "+str(daily_20140824.shape[0]))
daily_20140824_addname_dataframe.to_excel(daily_201408_excel_writer,'24_7',index=False)
daily_201408_excel_writer.save()
daily_20140825 = pro.daily(start_date='',end_date='',trade_date='20140825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140825_tscode_list = list() 
for ts_code_sh in daily_20140825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140825_tscode_list.append(stock_name)
daily_20140825_addname_dataframe=pd.DataFrame()
daily_20140825_addname_dataframe['cname'] = daily_20140825_tscode_list
for table_name in daily_20140825.columns.values.tolist():
    daily_20140825_addname_dataframe[table_name] = daily_20140825[table_name]
print("daily_20140825 返回数据 row 行数 = "+str(daily_20140825.shape[0]))
daily_20140825_addname_dataframe.to_excel(daily_201408_excel_writer,'25_1',index=False)
daily_201408_excel_writer.save()
daily_20140826 = pro.daily(start_date='',end_date='',trade_date='20140826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140826_tscode_list = list() 
for ts_code_sh in daily_20140826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140826_tscode_list.append(stock_name)
daily_20140826_addname_dataframe=pd.DataFrame()
daily_20140826_addname_dataframe['cname'] = daily_20140826_tscode_list
for table_name in daily_20140826.columns.values.tolist():
    daily_20140826_addname_dataframe[table_name] = daily_20140826[table_name]
print("daily_20140826 返回数据 row 行数 = "+str(daily_20140826.shape[0]))
daily_20140826_addname_dataframe.to_excel(daily_201408_excel_writer,'26_2',index=False)
daily_201408_excel_writer.save()
daily_20140827 = pro.daily(start_date='',end_date='',trade_date='20140827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140827_tscode_list = list() 
for ts_code_sh in daily_20140827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140827_tscode_list.append(stock_name)
daily_20140827_addname_dataframe=pd.DataFrame()
daily_20140827_addname_dataframe['cname'] = daily_20140827_tscode_list
for table_name in daily_20140827.columns.values.tolist():
    daily_20140827_addname_dataframe[table_name] = daily_20140827[table_name]
print("daily_20140827 返回数据 row 行数 = "+str(daily_20140827.shape[0]))
daily_20140827_addname_dataframe.to_excel(daily_201408_excel_writer,'27_3',index=False)
daily_201408_excel_writer.save()
daily_20140828 = pro.daily(start_date='',end_date='',trade_date='20140828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140828_tscode_list = list() 
for ts_code_sh in daily_20140828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140828_tscode_list.append(stock_name)
daily_20140828_addname_dataframe=pd.DataFrame()
daily_20140828_addname_dataframe['cname'] = daily_20140828_tscode_list
for table_name in daily_20140828.columns.values.tolist():
    daily_20140828_addname_dataframe[table_name] = daily_20140828[table_name]
print("daily_20140828 返回数据 row 行数 = "+str(daily_20140828.shape[0]))
daily_20140828_addname_dataframe.to_excel(daily_201408_excel_writer,'28_4',index=False)
daily_201408_excel_writer.save()
daily_20140829 = pro.daily(start_date='',end_date='',trade_date='20140829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140829_tscode_list = list() 
for ts_code_sh in daily_20140829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140829_tscode_list.append(stock_name)
daily_20140829_addname_dataframe=pd.DataFrame()
daily_20140829_addname_dataframe['cname'] = daily_20140829_tscode_list
for table_name in daily_20140829.columns.values.tolist():
    daily_20140829_addname_dataframe[table_name] = daily_20140829[table_name]
print("daily_20140829 返回数据 row 行数 = "+str(daily_20140829.shape[0]))
daily_20140829_addname_dataframe.to_excel(daily_201408_excel_writer,'29_5',index=False)
daily_201408_excel_writer.save()
daily_20140830 = pro.daily(start_date='',end_date='',trade_date='20140830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140830_tscode_list = list() 
for ts_code_sh in daily_20140830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140830_tscode_list.append(stock_name)
daily_20140830_addname_dataframe=pd.DataFrame()
daily_20140830_addname_dataframe['cname'] = daily_20140830_tscode_list
for table_name in daily_20140830.columns.values.tolist():
    daily_20140830_addname_dataframe[table_name] = daily_20140830[table_name]
print("daily_20140830 返回数据 row 行数 = "+str(daily_20140830.shape[0]))
daily_20140830_addname_dataframe.to_excel(daily_201408_excel_writer,'30_6',index=False)
daily_201408_excel_writer.save()
daily_20140831 = pro.daily(start_date='',end_date='',trade_date='20140831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140831_tscode_list = list() 
for ts_code_sh in daily_20140831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140831_tscode_list.append(stock_name)
daily_20140831_addname_dataframe=pd.DataFrame()
daily_20140831_addname_dataframe['cname'] = daily_20140831_tscode_list
for table_name in daily_20140831.columns.values.tolist():
    daily_20140831_addname_dataframe[table_name] = daily_20140831[table_name]
print("daily_20140831 返回数据 row 行数 = "+str(daily_20140831.shape[0]))
daily_20140831_addname_dataframe.to_excel(daily_201408_excel_writer,'31_7',index=False)
daily_201408_excel_writer.save()




createexcel('daily_201409.xlsx')
daily_201409_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201409.xlsx')
daily_201409_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201409.xlsx', engine='openpyxl')
daily_201409_excel_writer.book = daily_201409_book
daily_201409_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201409_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140901")       ###  更新 记录日期
daily_20140901 = pro.daily(start_date='',end_date='',trade_date='20140901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140901_tscode_list = list() 
for ts_code_sh in daily_20140901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140901_tscode_list.append(stock_name)
daily_20140901_addname_dataframe=pd.DataFrame()
daily_20140901_addname_dataframe['cname'] = daily_20140901_tscode_list
for table_name in daily_20140901.columns.values.tolist():
    daily_20140901_addname_dataframe[table_name] = daily_20140901[table_name]
print("daily_20140901 返回数据 row 行数 = "+str(daily_20140901.shape[0]))
daily_20140901_addname_dataframe.to_excel(daily_201409_excel_writer,'1_1',index=False)
daily_201409_excel_writer.save()
daily_20140902 = pro.daily(start_date='',end_date='',trade_date='20140902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140902_tscode_list = list() 
for ts_code_sh in daily_20140902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140902_tscode_list.append(stock_name)
daily_20140902_addname_dataframe=pd.DataFrame()
daily_20140902_addname_dataframe['cname'] = daily_20140902_tscode_list
for table_name in daily_20140902.columns.values.tolist():
    daily_20140902_addname_dataframe[table_name] = daily_20140902[table_name]
print("daily_20140902 返回数据 row 行数 = "+str(daily_20140902.shape[0]))
daily_20140902_addname_dataframe.to_excel(daily_201409_excel_writer,'2_2',index=False)
daily_201409_excel_writer.save()
daily_20140903 = pro.daily(start_date='',end_date='',trade_date='20140903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140903_tscode_list = list() 
for ts_code_sh in daily_20140903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140903_tscode_list.append(stock_name)
daily_20140903_addname_dataframe=pd.DataFrame()
daily_20140903_addname_dataframe['cname'] = daily_20140903_tscode_list
for table_name in daily_20140903.columns.values.tolist():
    daily_20140903_addname_dataframe[table_name] = daily_20140903[table_name]
print("daily_20140903 返回数据 row 行数 = "+str(daily_20140903.shape[0]))
daily_20140903_addname_dataframe.to_excel(daily_201409_excel_writer,'3_3',index=False)
daily_201409_excel_writer.save()
daily_20140904 = pro.daily(start_date='',end_date='',trade_date='20140904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140904_tscode_list = list() 
for ts_code_sh in daily_20140904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140904_tscode_list.append(stock_name)
daily_20140904_addname_dataframe=pd.DataFrame()
daily_20140904_addname_dataframe['cname'] = daily_20140904_tscode_list
for table_name in daily_20140904.columns.values.tolist():
    daily_20140904_addname_dataframe[table_name] = daily_20140904[table_name]
print("daily_20140904 返回数据 row 行数 = "+str(daily_20140904.shape[0]))
daily_20140904_addname_dataframe.to_excel(daily_201409_excel_writer,'4_4',index=False)
daily_201409_excel_writer.save()
daily_20140905 = pro.daily(start_date='',end_date='',trade_date='20140905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140905_tscode_list = list() 
for ts_code_sh in daily_20140905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140905_tscode_list.append(stock_name)
daily_20140905_addname_dataframe=pd.DataFrame()
daily_20140905_addname_dataframe['cname'] = daily_20140905_tscode_list
for table_name in daily_20140905.columns.values.tolist():
    daily_20140905_addname_dataframe[table_name] = daily_20140905[table_name]
print("daily_20140905 返回数据 row 行数 = "+str(daily_20140905.shape[0]))
daily_20140905_addname_dataframe.to_excel(daily_201409_excel_writer,'5_5',index=False)
daily_201409_excel_writer.save()
daily_20140906 = pro.daily(start_date='',end_date='',trade_date='20140906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140906_tscode_list = list() 
for ts_code_sh in daily_20140906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140906_tscode_list.append(stock_name)
daily_20140906_addname_dataframe=pd.DataFrame()
daily_20140906_addname_dataframe['cname'] = daily_20140906_tscode_list
for table_name in daily_20140906.columns.values.tolist():
    daily_20140906_addname_dataframe[table_name] = daily_20140906[table_name]
print("daily_20140906 返回数据 row 行数 = "+str(daily_20140906.shape[0]))
daily_20140906_addname_dataframe.to_excel(daily_201409_excel_writer,'6_6',index=False)
daily_201409_excel_writer.save()
daily_20140907 = pro.daily(start_date='',end_date='',trade_date='20140907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140907_tscode_list = list() 
for ts_code_sh in daily_20140907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140907_tscode_list.append(stock_name)
daily_20140907_addname_dataframe=pd.DataFrame()
daily_20140907_addname_dataframe['cname'] = daily_20140907_tscode_list
for table_name in daily_20140907.columns.values.tolist():
    daily_20140907_addname_dataframe[table_name] = daily_20140907[table_name]
print("daily_20140907 返回数据 row 行数 = "+str(daily_20140907.shape[0]))
daily_20140907_addname_dataframe.to_excel(daily_201409_excel_writer,'7_7',index=False)
daily_201409_excel_writer.save()
daily_20140908 = pro.daily(start_date='',end_date='',trade_date='20140908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140908_tscode_list = list() 
for ts_code_sh in daily_20140908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140908_tscode_list.append(stock_name)
daily_20140908_addname_dataframe=pd.DataFrame()
daily_20140908_addname_dataframe['cname'] = daily_20140908_tscode_list
for table_name in daily_20140908.columns.values.tolist():
    daily_20140908_addname_dataframe[table_name] = daily_20140908[table_name]
print("daily_20140908 返回数据 row 行数 = "+str(daily_20140908.shape[0]))
daily_20140908_addname_dataframe.to_excel(daily_201409_excel_writer,'8_1',index=False)
daily_201409_excel_writer.save()
daily_20140909 = pro.daily(start_date='',end_date='',trade_date='20140909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140909_tscode_list = list() 
for ts_code_sh in daily_20140909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140909_tscode_list.append(stock_name)
daily_20140909_addname_dataframe=pd.DataFrame()
daily_20140909_addname_dataframe['cname'] = daily_20140909_tscode_list
for table_name in daily_20140909.columns.values.tolist():
    daily_20140909_addname_dataframe[table_name] = daily_20140909[table_name]
print("daily_20140909 返回数据 row 行数 = "+str(daily_20140909.shape[0]))
daily_20140909_addname_dataframe.to_excel(daily_201409_excel_writer,'9_2',index=False)
daily_201409_excel_writer.save()
daily_20140910 = pro.daily(start_date='',end_date='',trade_date='20140910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140910_tscode_list = list() 
for ts_code_sh in daily_20140910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140910_tscode_list.append(stock_name)
daily_20140910_addname_dataframe=pd.DataFrame()
daily_20140910_addname_dataframe['cname'] = daily_20140910_tscode_list
for table_name in daily_20140910.columns.values.tolist():
    daily_20140910_addname_dataframe[table_name] = daily_20140910[table_name]
print("daily_20140910 返回数据 row 行数 = "+str(daily_20140910.shape[0]))
daily_20140910_addname_dataframe.to_excel(daily_201409_excel_writer,'10_3',index=False)
daily_201409_excel_writer.save()
daily_20140911 = pro.daily(start_date='',end_date='',trade_date='20140911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140911_tscode_list = list() 
for ts_code_sh in daily_20140911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140911_tscode_list.append(stock_name)
daily_20140911_addname_dataframe=pd.DataFrame()
daily_20140911_addname_dataframe['cname'] = daily_20140911_tscode_list
for table_name in daily_20140911.columns.values.tolist():
    daily_20140911_addname_dataframe[table_name] = daily_20140911[table_name]
print("daily_20140911 返回数据 row 行数 = "+str(daily_20140911.shape[0]))
daily_20140911_addname_dataframe.to_excel(daily_201409_excel_writer,'11_4',index=False)
daily_201409_excel_writer.save()
daily_20140912 = pro.daily(start_date='',end_date='',trade_date='20140912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140912_tscode_list = list() 
for ts_code_sh in daily_20140912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140912_tscode_list.append(stock_name)
daily_20140912_addname_dataframe=pd.DataFrame()
daily_20140912_addname_dataframe['cname'] = daily_20140912_tscode_list
for table_name in daily_20140912.columns.values.tolist():
    daily_20140912_addname_dataframe[table_name] = daily_20140912[table_name]
print("daily_20140912 返回数据 row 行数 = "+str(daily_20140912.shape[0]))
daily_20140912_addname_dataframe.to_excel(daily_201409_excel_writer,'12_5',index=False)
daily_201409_excel_writer.save()
daily_20140913 = pro.daily(start_date='',end_date='',trade_date='20140913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140913_tscode_list = list() 
for ts_code_sh in daily_20140913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140913_tscode_list.append(stock_name)
daily_20140913_addname_dataframe=pd.DataFrame()
daily_20140913_addname_dataframe['cname'] = daily_20140913_tscode_list
for table_name in daily_20140913.columns.values.tolist():
    daily_20140913_addname_dataframe[table_name] = daily_20140913[table_name]
print("daily_20140913 返回数据 row 行数 = "+str(daily_20140913.shape[0]))
daily_20140913_addname_dataframe.to_excel(daily_201409_excel_writer,'13_6',index=False)
daily_201409_excel_writer.save()
daily_20140914 = pro.daily(start_date='',end_date='',trade_date='20140914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140914_tscode_list = list() 
for ts_code_sh in daily_20140914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140914_tscode_list.append(stock_name)
daily_20140914_addname_dataframe=pd.DataFrame()
daily_20140914_addname_dataframe['cname'] = daily_20140914_tscode_list
for table_name in daily_20140914.columns.values.tolist():
    daily_20140914_addname_dataframe[table_name] = daily_20140914[table_name]
print("daily_20140914 返回数据 row 行数 = "+str(daily_20140914.shape[0]))
daily_20140914_addname_dataframe.to_excel(daily_201409_excel_writer,'14_7',index=False)
daily_201409_excel_writer.save()
daily_20140915 = pro.daily(start_date='',end_date='',trade_date='20140915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140915_tscode_list = list() 
for ts_code_sh in daily_20140915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140915_tscode_list.append(stock_name)
daily_20140915_addname_dataframe=pd.DataFrame()
daily_20140915_addname_dataframe['cname'] = daily_20140915_tscode_list
for table_name in daily_20140915.columns.values.tolist():
    daily_20140915_addname_dataframe[table_name] = daily_20140915[table_name]
print("daily_20140915 返回数据 row 行数 = "+str(daily_20140915.shape[0]))
daily_20140915_addname_dataframe.to_excel(daily_201409_excel_writer,'15_1',index=False)
daily_201409_excel_writer.save()
daily_20140916 = pro.daily(start_date='',end_date='',trade_date='20140916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140916_tscode_list = list() 
for ts_code_sh in daily_20140916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140916_tscode_list.append(stock_name)
daily_20140916_addname_dataframe=pd.DataFrame()
daily_20140916_addname_dataframe['cname'] = daily_20140916_tscode_list
for table_name in daily_20140916.columns.values.tolist():
    daily_20140916_addname_dataframe[table_name] = daily_20140916[table_name]
print("daily_20140916 返回数据 row 行数 = "+str(daily_20140916.shape[0]))
daily_20140916_addname_dataframe.to_excel(daily_201409_excel_writer,'16_2',index=False)
daily_201409_excel_writer.save()
daily_20140917 = pro.daily(start_date='',end_date='',trade_date='20140917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140917_tscode_list = list() 
for ts_code_sh in daily_20140917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140917_tscode_list.append(stock_name)
daily_20140917_addname_dataframe=pd.DataFrame()
daily_20140917_addname_dataframe['cname'] = daily_20140917_tscode_list
for table_name in daily_20140917.columns.values.tolist():
    daily_20140917_addname_dataframe[table_name] = daily_20140917[table_name]
print("daily_20140917 返回数据 row 行数 = "+str(daily_20140917.shape[0]))
daily_20140917_addname_dataframe.to_excel(daily_201409_excel_writer,'17_3',index=False)
daily_201409_excel_writer.save()
daily_20140918 = pro.daily(start_date='',end_date='',trade_date='20140918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140918_tscode_list = list() 
for ts_code_sh in daily_20140918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140918_tscode_list.append(stock_name)
daily_20140918_addname_dataframe=pd.DataFrame()
daily_20140918_addname_dataframe['cname'] = daily_20140918_tscode_list
for table_name in daily_20140918.columns.values.tolist():
    daily_20140918_addname_dataframe[table_name] = daily_20140918[table_name]
print("daily_20140918 返回数据 row 行数 = "+str(daily_20140918.shape[0]))
daily_20140918_addname_dataframe.to_excel(daily_201409_excel_writer,'18_4',index=False)
daily_201409_excel_writer.save()
daily_20140919 = pro.daily(start_date='',end_date='',trade_date='20140919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140919_tscode_list = list() 
for ts_code_sh in daily_20140919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140919_tscode_list.append(stock_name)
daily_20140919_addname_dataframe=pd.DataFrame()
daily_20140919_addname_dataframe['cname'] = daily_20140919_tscode_list
for table_name in daily_20140919.columns.values.tolist():
    daily_20140919_addname_dataframe[table_name] = daily_20140919[table_name]
print("daily_20140919 返回数据 row 行数 = "+str(daily_20140919.shape[0]))
daily_20140919_addname_dataframe.to_excel(daily_201409_excel_writer,'19_5',index=False)
daily_201409_excel_writer.save()
daily_20140920 = pro.daily(start_date='',end_date='',trade_date='20140920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140920_tscode_list = list() 
for ts_code_sh in daily_20140920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140920_tscode_list.append(stock_name)
daily_20140920_addname_dataframe=pd.DataFrame()
daily_20140920_addname_dataframe['cname'] = daily_20140920_tscode_list
for table_name in daily_20140920.columns.values.tolist():
    daily_20140920_addname_dataframe[table_name] = daily_20140920[table_name]
print("daily_20140920 返回数据 row 行数 = "+str(daily_20140920.shape[0]))
daily_20140920_addname_dataframe.to_excel(daily_201409_excel_writer,'20_6',index=False)
daily_201409_excel_writer.save()
daily_20140921 = pro.daily(start_date='',end_date='',trade_date='20140921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140921_tscode_list = list() 
for ts_code_sh in daily_20140921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140921_tscode_list.append(stock_name)
daily_20140921_addname_dataframe=pd.DataFrame()
daily_20140921_addname_dataframe['cname'] = daily_20140921_tscode_list
for table_name in daily_20140921.columns.values.tolist():
    daily_20140921_addname_dataframe[table_name] = daily_20140921[table_name]
print("daily_20140921 返回数据 row 行数 = "+str(daily_20140921.shape[0]))
daily_20140921_addname_dataframe.to_excel(daily_201409_excel_writer,'21_7',index=False)
daily_201409_excel_writer.save()
daily_20140922 = pro.daily(start_date='',end_date='',trade_date='20140922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140922_tscode_list = list() 
for ts_code_sh in daily_20140922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140922_tscode_list.append(stock_name)
daily_20140922_addname_dataframe=pd.DataFrame()
daily_20140922_addname_dataframe['cname'] = daily_20140922_tscode_list
for table_name in daily_20140922.columns.values.tolist():
    daily_20140922_addname_dataframe[table_name] = daily_20140922[table_name]
print("daily_20140922 返回数据 row 行数 = "+str(daily_20140922.shape[0]))
daily_20140922_addname_dataframe.to_excel(daily_201409_excel_writer,'22_1',index=False)
daily_201409_excel_writer.save()
daily_20140923 = pro.daily(start_date='',end_date='',trade_date='20140923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140923_tscode_list = list() 
for ts_code_sh in daily_20140923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140923_tscode_list.append(stock_name)
daily_20140923_addname_dataframe=pd.DataFrame()
daily_20140923_addname_dataframe['cname'] = daily_20140923_tscode_list
for table_name in daily_20140923.columns.values.tolist():
    daily_20140923_addname_dataframe[table_name] = daily_20140923[table_name]
print("daily_20140923 返回数据 row 行数 = "+str(daily_20140923.shape[0]))
daily_20140923_addname_dataframe.to_excel(daily_201409_excel_writer,'23_2',index=False)
daily_201409_excel_writer.save()
daily_20140924 = pro.daily(start_date='',end_date='',trade_date='20140924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140924_tscode_list = list() 
for ts_code_sh in daily_20140924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140924_tscode_list.append(stock_name)
daily_20140924_addname_dataframe=pd.DataFrame()
daily_20140924_addname_dataframe['cname'] = daily_20140924_tscode_list
for table_name in daily_20140924.columns.values.tolist():
    daily_20140924_addname_dataframe[table_name] = daily_20140924[table_name]
print("daily_20140924 返回数据 row 行数 = "+str(daily_20140924.shape[0]))
daily_20140924_addname_dataframe.to_excel(daily_201409_excel_writer,'24_3',index=False)
daily_201409_excel_writer.save()
daily_20140925 = pro.daily(start_date='',end_date='',trade_date='20140925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140925_tscode_list = list() 
for ts_code_sh in daily_20140925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140925_tscode_list.append(stock_name)
daily_20140925_addname_dataframe=pd.DataFrame()
daily_20140925_addname_dataframe['cname'] = daily_20140925_tscode_list
for table_name in daily_20140925.columns.values.tolist():
    daily_20140925_addname_dataframe[table_name] = daily_20140925[table_name]
print("daily_20140925 返回数据 row 行数 = "+str(daily_20140925.shape[0]))
daily_20140925_addname_dataframe.to_excel(daily_201409_excel_writer,'25_4',index=False)
daily_201409_excel_writer.save()
daily_20140926 = pro.daily(start_date='',end_date='',trade_date='20140926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140926_tscode_list = list() 
for ts_code_sh in daily_20140926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140926_tscode_list.append(stock_name)
daily_20140926_addname_dataframe=pd.DataFrame()
daily_20140926_addname_dataframe['cname'] = daily_20140926_tscode_list
for table_name in daily_20140926.columns.values.tolist():
    daily_20140926_addname_dataframe[table_name] = daily_20140926[table_name]
print("daily_20140926 返回数据 row 行数 = "+str(daily_20140926.shape[0]))
daily_20140926_addname_dataframe.to_excel(daily_201409_excel_writer,'26_5',index=False)
daily_201409_excel_writer.save()
daily_20140927 = pro.daily(start_date='',end_date='',trade_date='20140927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140927_tscode_list = list() 
for ts_code_sh in daily_20140927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140927_tscode_list.append(stock_name)
daily_20140927_addname_dataframe=pd.DataFrame()
daily_20140927_addname_dataframe['cname'] = daily_20140927_tscode_list
for table_name in daily_20140927.columns.values.tolist():
    daily_20140927_addname_dataframe[table_name] = daily_20140927[table_name]
print("daily_20140927 返回数据 row 行数 = "+str(daily_20140927.shape[0]))
daily_20140927_addname_dataframe.to_excel(daily_201409_excel_writer,'27_6',index=False)
daily_201409_excel_writer.save()
daily_20140928 = pro.daily(start_date='',end_date='',trade_date='20140928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140928_tscode_list = list() 
for ts_code_sh in daily_20140928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140928_tscode_list.append(stock_name)
daily_20140928_addname_dataframe=pd.DataFrame()
daily_20140928_addname_dataframe['cname'] = daily_20140928_tscode_list
for table_name in daily_20140928.columns.values.tolist():
    daily_20140928_addname_dataframe[table_name] = daily_20140928[table_name]
print("daily_20140928 返回数据 row 行数 = "+str(daily_20140928.shape[0]))
daily_20140928_addname_dataframe.to_excel(daily_201409_excel_writer,'28_7',index=False)
daily_201409_excel_writer.save()
daily_20140929 = pro.daily(start_date='',end_date='',trade_date='20140929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140929_tscode_list = list() 
for ts_code_sh in daily_20140929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140929_tscode_list.append(stock_name)
daily_20140929_addname_dataframe=pd.DataFrame()
daily_20140929_addname_dataframe['cname'] = daily_20140929_tscode_list
for table_name in daily_20140929.columns.values.tolist():
    daily_20140929_addname_dataframe[table_name] = daily_20140929[table_name]
print("daily_20140929 返回数据 row 行数 = "+str(daily_20140929.shape[0]))
daily_20140929_addname_dataframe.to_excel(daily_201409_excel_writer,'29_1',index=False)
daily_201409_excel_writer.save()
daily_20140930 = pro.daily(start_date='',end_date='',trade_date='20140930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140930_tscode_list = list() 
for ts_code_sh in daily_20140930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140930_tscode_list.append(stock_name)
daily_20140930_addname_dataframe=pd.DataFrame()
daily_20140930_addname_dataframe['cname'] = daily_20140930_tscode_list
for table_name in daily_20140930.columns.values.tolist():
    daily_20140930_addname_dataframe[table_name] = daily_20140930[table_name]
print("daily_20140930 返回数据 row 行数 = "+str(daily_20140930.shape[0]))
daily_20140930_addname_dataframe.to_excel(daily_201409_excel_writer,'30_2',index=False)
daily_201409_excel_writer.save()




createexcel('daily_201410.xlsx')
daily_201410_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201410.xlsx')
daily_201410_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201410.xlsx', engine='openpyxl')
daily_201410_excel_writer.book = daily_201410_book
daily_201410_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201410_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20141001")       ###  更新 记录日期
daily_20141001 = pro.daily(start_date='',end_date='',trade_date='20141001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141001_tscode_list = list() 
for ts_code_sh in daily_20141001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141001_tscode_list.append(stock_name)
daily_20141001_addname_dataframe=pd.DataFrame()
daily_20141001_addname_dataframe['cname'] = daily_20141001_tscode_list
for table_name in daily_20141001.columns.values.tolist():
    daily_20141001_addname_dataframe[table_name] = daily_20141001[table_name]
print("daily_20141001 返回数据 row 行数 = "+str(daily_20141001.shape[0]))
daily_20141001_addname_dataframe.to_excel(daily_201410_excel_writer,'1_3',index=False)
daily_201410_excel_writer.save()
daily_20141002 = pro.daily(start_date='',end_date='',trade_date='20141002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141002_tscode_list = list() 
for ts_code_sh in daily_20141002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141002_tscode_list.append(stock_name)
daily_20141002_addname_dataframe=pd.DataFrame()
daily_20141002_addname_dataframe['cname'] = daily_20141002_tscode_list
for table_name in daily_20141002.columns.values.tolist():
    daily_20141002_addname_dataframe[table_name] = daily_20141002[table_name]
print("daily_20141002 返回数据 row 行数 = "+str(daily_20141002.shape[0]))
daily_20141002_addname_dataframe.to_excel(daily_201410_excel_writer,'2_4',index=False)
daily_201410_excel_writer.save()
daily_20141003 = pro.daily(start_date='',end_date='',trade_date='20141003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141003_tscode_list = list() 
for ts_code_sh in daily_20141003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141003_tscode_list.append(stock_name)
daily_20141003_addname_dataframe=pd.DataFrame()
daily_20141003_addname_dataframe['cname'] = daily_20141003_tscode_list
for table_name in daily_20141003.columns.values.tolist():
    daily_20141003_addname_dataframe[table_name] = daily_20141003[table_name]
print("daily_20141003 返回数据 row 行数 = "+str(daily_20141003.shape[0]))
daily_20141003_addname_dataframe.to_excel(daily_201410_excel_writer,'3_5',index=False)
daily_201410_excel_writer.save()
daily_20141004 = pro.daily(start_date='',end_date='',trade_date='20141004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141004_tscode_list = list() 
for ts_code_sh in daily_20141004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141004_tscode_list.append(stock_name)
daily_20141004_addname_dataframe=pd.DataFrame()
daily_20141004_addname_dataframe['cname'] = daily_20141004_tscode_list
for table_name in daily_20141004.columns.values.tolist():
    daily_20141004_addname_dataframe[table_name] = daily_20141004[table_name]
print("daily_20141004 返回数据 row 行数 = "+str(daily_20141004.shape[0]))
daily_20141004_addname_dataframe.to_excel(daily_201410_excel_writer,'4_6',index=False)
daily_201410_excel_writer.save()
daily_20141005 = pro.daily(start_date='',end_date='',trade_date='20141005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141005_tscode_list = list() 
for ts_code_sh in daily_20141005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141005_tscode_list.append(stock_name)
daily_20141005_addname_dataframe=pd.DataFrame()
daily_20141005_addname_dataframe['cname'] = daily_20141005_tscode_list
for table_name in daily_20141005.columns.values.tolist():
    daily_20141005_addname_dataframe[table_name] = daily_20141005[table_name]
print("daily_20141005 返回数据 row 行数 = "+str(daily_20141005.shape[0]))
daily_20141005_addname_dataframe.to_excel(daily_201410_excel_writer,'5_7',index=False)
daily_201410_excel_writer.save()
daily_20141006 = pro.daily(start_date='',end_date='',trade_date='20141006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141006_tscode_list = list() 
for ts_code_sh in daily_20141006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141006_tscode_list.append(stock_name)
daily_20141006_addname_dataframe=pd.DataFrame()
daily_20141006_addname_dataframe['cname'] = daily_20141006_tscode_list
for table_name in daily_20141006.columns.values.tolist():
    daily_20141006_addname_dataframe[table_name] = daily_20141006[table_name]
print("daily_20141006 返回数据 row 行数 = "+str(daily_20141006.shape[0]))
daily_20141006_addname_dataframe.to_excel(daily_201410_excel_writer,'6_1',index=False)
daily_201410_excel_writer.save()
daily_20141007 = pro.daily(start_date='',end_date='',trade_date='20141007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141007_tscode_list = list() 
for ts_code_sh in daily_20141007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141007_tscode_list.append(stock_name)
daily_20141007_addname_dataframe=pd.DataFrame()
daily_20141007_addname_dataframe['cname'] = daily_20141007_tscode_list
for table_name in daily_20141007.columns.values.tolist():
    daily_20141007_addname_dataframe[table_name] = daily_20141007[table_name]
print("daily_20141007 返回数据 row 行数 = "+str(daily_20141007.shape[0]))
daily_20141007_addname_dataframe.to_excel(daily_201410_excel_writer,'7_2',index=False)
daily_201410_excel_writer.save()
daily_20141008 = pro.daily(start_date='',end_date='',trade_date='20141008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141008_tscode_list = list() 
for ts_code_sh in daily_20141008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141008_tscode_list.append(stock_name)
daily_20141008_addname_dataframe=pd.DataFrame()
daily_20141008_addname_dataframe['cname'] = daily_20141008_tscode_list
for table_name in daily_20141008.columns.values.tolist():
    daily_20141008_addname_dataframe[table_name] = daily_20141008[table_name]
print("daily_20141008 返回数据 row 行数 = "+str(daily_20141008.shape[0]))
daily_20141008_addname_dataframe.to_excel(daily_201410_excel_writer,'8_3',index=False)
daily_201410_excel_writer.save()
daily_20141009 = pro.daily(start_date='',end_date='',trade_date='20141009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141009_tscode_list = list() 
for ts_code_sh in daily_20141009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141009_tscode_list.append(stock_name)
daily_20141009_addname_dataframe=pd.DataFrame()
daily_20141009_addname_dataframe['cname'] = daily_20141009_tscode_list
for table_name in daily_20141009.columns.values.tolist():
    daily_20141009_addname_dataframe[table_name] = daily_20141009[table_name]
print("daily_20141009 返回数据 row 行数 = "+str(daily_20141009.shape[0]))
daily_20141009_addname_dataframe.to_excel(daily_201410_excel_writer,'9_4',index=False)
daily_201410_excel_writer.save()
daily_20141010 = pro.daily(start_date='',end_date='',trade_date='20141010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141010_tscode_list = list() 
for ts_code_sh in daily_20141010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141010_tscode_list.append(stock_name)
daily_20141010_addname_dataframe=pd.DataFrame()
daily_20141010_addname_dataframe['cname'] = daily_20141010_tscode_list
for table_name in daily_20141010.columns.values.tolist():
    daily_20141010_addname_dataframe[table_name] = daily_20141010[table_name]
print("daily_20141010 返回数据 row 行数 = "+str(daily_20141010.shape[0]))
daily_20141010_addname_dataframe.to_excel(daily_201410_excel_writer,'10_5',index=False)
daily_201410_excel_writer.save()
daily_20141011 = pro.daily(start_date='',end_date='',trade_date='20141011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141011_tscode_list = list() 
for ts_code_sh in daily_20141011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141011_tscode_list.append(stock_name)
daily_20141011_addname_dataframe=pd.DataFrame()
daily_20141011_addname_dataframe['cname'] = daily_20141011_tscode_list
for table_name in daily_20141011.columns.values.tolist():
    daily_20141011_addname_dataframe[table_name] = daily_20141011[table_name]
print("daily_20141011 返回数据 row 行数 = "+str(daily_20141011.shape[0]))
daily_20141011_addname_dataframe.to_excel(daily_201410_excel_writer,'11_6',index=False)
daily_201410_excel_writer.save()
daily_20141012 = pro.daily(start_date='',end_date='',trade_date='20141012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141012_tscode_list = list() 
for ts_code_sh in daily_20141012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141012_tscode_list.append(stock_name)
daily_20141012_addname_dataframe=pd.DataFrame()
daily_20141012_addname_dataframe['cname'] = daily_20141012_tscode_list
for table_name in daily_20141012.columns.values.tolist():
    daily_20141012_addname_dataframe[table_name] = daily_20141012[table_name]
print("daily_20141012 返回数据 row 行数 = "+str(daily_20141012.shape[0]))
daily_20141012_addname_dataframe.to_excel(daily_201410_excel_writer,'12_7',index=False)
daily_201410_excel_writer.save()
daily_20141013 = pro.daily(start_date='',end_date='',trade_date='20141013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141013_tscode_list = list() 
for ts_code_sh in daily_20141013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141013_tscode_list.append(stock_name)
daily_20141013_addname_dataframe=pd.DataFrame()
daily_20141013_addname_dataframe['cname'] = daily_20141013_tscode_list
for table_name in daily_20141013.columns.values.tolist():
    daily_20141013_addname_dataframe[table_name] = daily_20141013[table_name]
print("daily_20141013 返回数据 row 行数 = "+str(daily_20141013.shape[0]))
daily_20141013_addname_dataframe.to_excel(daily_201410_excel_writer,'13_1',index=False)
daily_201410_excel_writer.save()
daily_20141014 = pro.daily(start_date='',end_date='',trade_date='20141014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141014_tscode_list = list() 
for ts_code_sh in daily_20141014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141014_tscode_list.append(stock_name)
daily_20141014_addname_dataframe=pd.DataFrame()
daily_20141014_addname_dataframe['cname'] = daily_20141014_tscode_list
for table_name in daily_20141014.columns.values.tolist():
    daily_20141014_addname_dataframe[table_name] = daily_20141014[table_name]
print("daily_20141014 返回数据 row 行数 = "+str(daily_20141014.shape[0]))
daily_20141014_addname_dataframe.to_excel(daily_201410_excel_writer,'14_2',index=False)
daily_201410_excel_writer.save()
daily_20141015 = pro.daily(start_date='',end_date='',trade_date='20141015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141015_tscode_list = list() 
for ts_code_sh in daily_20141015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141015_tscode_list.append(stock_name)
daily_20141015_addname_dataframe=pd.DataFrame()
daily_20141015_addname_dataframe['cname'] = daily_20141015_tscode_list
for table_name in daily_20141015.columns.values.tolist():
    daily_20141015_addname_dataframe[table_name] = daily_20141015[table_name]
print("daily_20141015 返回数据 row 行数 = "+str(daily_20141015.shape[0]))
daily_20141015_addname_dataframe.to_excel(daily_201410_excel_writer,'15_3',index=False)
daily_201410_excel_writer.save()
daily_20141016 = pro.daily(start_date='',end_date='',trade_date='20141016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141016_tscode_list = list() 
for ts_code_sh in daily_20141016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141016_tscode_list.append(stock_name)
daily_20141016_addname_dataframe=pd.DataFrame()
daily_20141016_addname_dataframe['cname'] = daily_20141016_tscode_list
for table_name in daily_20141016.columns.values.tolist():
    daily_20141016_addname_dataframe[table_name] = daily_20141016[table_name]
print("daily_20141016 返回数据 row 行数 = "+str(daily_20141016.shape[0]))
daily_20141016_addname_dataframe.to_excel(daily_201410_excel_writer,'16_4',index=False)
daily_201410_excel_writer.save()
daily_20141017 = pro.daily(start_date='',end_date='',trade_date='20141017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141017_tscode_list = list() 
for ts_code_sh in daily_20141017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141017_tscode_list.append(stock_name)
daily_20141017_addname_dataframe=pd.DataFrame()
daily_20141017_addname_dataframe['cname'] = daily_20141017_tscode_list
for table_name in daily_20141017.columns.values.tolist():
    daily_20141017_addname_dataframe[table_name] = daily_20141017[table_name]
print("daily_20141017 返回数据 row 行数 = "+str(daily_20141017.shape[0]))
daily_20141017_addname_dataframe.to_excel(daily_201410_excel_writer,'17_5',index=False)
daily_201410_excel_writer.save()
daily_20141018 = pro.daily(start_date='',end_date='',trade_date='20141018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141018_tscode_list = list() 
for ts_code_sh in daily_20141018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141018_tscode_list.append(stock_name)
daily_20141018_addname_dataframe=pd.DataFrame()
daily_20141018_addname_dataframe['cname'] = daily_20141018_tscode_list
for table_name in daily_20141018.columns.values.tolist():
    daily_20141018_addname_dataframe[table_name] = daily_20141018[table_name]
print("daily_20141018 返回数据 row 行数 = "+str(daily_20141018.shape[0]))
daily_20141018_addname_dataframe.to_excel(daily_201410_excel_writer,'18_6',index=False)
daily_201410_excel_writer.save()
daily_20141019 = pro.daily(start_date='',end_date='',trade_date='20141019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141019_tscode_list = list() 
for ts_code_sh in daily_20141019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141019_tscode_list.append(stock_name)
daily_20141019_addname_dataframe=pd.DataFrame()
daily_20141019_addname_dataframe['cname'] = daily_20141019_tscode_list
for table_name in daily_20141019.columns.values.tolist():
    daily_20141019_addname_dataframe[table_name] = daily_20141019[table_name]
print("daily_20141019 返回数据 row 行数 = "+str(daily_20141019.shape[0]))
daily_20141019_addname_dataframe.to_excel(daily_201410_excel_writer,'19_7',index=False)
daily_201410_excel_writer.save()
daily_20141020 = pro.daily(start_date='',end_date='',trade_date='20141020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141020_tscode_list = list() 
for ts_code_sh in daily_20141020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141020_tscode_list.append(stock_name)
daily_20141020_addname_dataframe=pd.DataFrame()
daily_20141020_addname_dataframe['cname'] = daily_20141020_tscode_list
for table_name in daily_20141020.columns.values.tolist():
    daily_20141020_addname_dataframe[table_name] = daily_20141020[table_name]
print("daily_20141020 返回数据 row 行数 = "+str(daily_20141020.shape[0]))
daily_20141020_addname_dataframe.to_excel(daily_201410_excel_writer,'20_1',index=False)
daily_201410_excel_writer.save()
daily_20141021 = pro.daily(start_date='',end_date='',trade_date='20141021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141021_tscode_list = list() 
for ts_code_sh in daily_20141021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141021_tscode_list.append(stock_name)
daily_20141021_addname_dataframe=pd.DataFrame()
daily_20141021_addname_dataframe['cname'] = daily_20141021_tscode_list
for table_name in daily_20141021.columns.values.tolist():
    daily_20141021_addname_dataframe[table_name] = daily_20141021[table_name]
print("daily_20141021 返回数据 row 行数 = "+str(daily_20141021.shape[0]))
daily_20141021_addname_dataframe.to_excel(daily_201410_excel_writer,'21_2',index=False)
daily_201410_excel_writer.save()
daily_20141022 = pro.daily(start_date='',end_date='',trade_date='20141022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141022_tscode_list = list() 
for ts_code_sh in daily_20141022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141022_tscode_list.append(stock_name)
daily_20141022_addname_dataframe=pd.DataFrame()
daily_20141022_addname_dataframe['cname'] = daily_20141022_tscode_list
for table_name in daily_20141022.columns.values.tolist():
    daily_20141022_addname_dataframe[table_name] = daily_20141022[table_name]
print("daily_20141022 返回数据 row 行数 = "+str(daily_20141022.shape[0]))
daily_20141022_addname_dataframe.to_excel(daily_201410_excel_writer,'22_3',index=False)
daily_201410_excel_writer.save()
daily_20141023 = pro.daily(start_date='',end_date='',trade_date='20141023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141023_tscode_list = list() 
for ts_code_sh in daily_20141023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141023_tscode_list.append(stock_name)
daily_20141023_addname_dataframe=pd.DataFrame()
daily_20141023_addname_dataframe['cname'] = daily_20141023_tscode_list
for table_name in daily_20141023.columns.values.tolist():
    daily_20141023_addname_dataframe[table_name] = daily_20141023[table_name]
print("daily_20141023 返回数据 row 行数 = "+str(daily_20141023.shape[0]))
daily_20141023_addname_dataframe.to_excel(daily_201410_excel_writer,'23_4',index=False)
daily_201410_excel_writer.save()
daily_20141024 = pro.daily(start_date='',end_date='',trade_date='20141024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141024_tscode_list = list() 
for ts_code_sh in daily_20141024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141024_tscode_list.append(stock_name)
daily_20141024_addname_dataframe=pd.DataFrame()
daily_20141024_addname_dataframe['cname'] = daily_20141024_tscode_list
for table_name in daily_20141024.columns.values.tolist():
    daily_20141024_addname_dataframe[table_name] = daily_20141024[table_name]
print("daily_20141024 返回数据 row 行数 = "+str(daily_20141024.shape[0]))
daily_20141024_addname_dataframe.to_excel(daily_201410_excel_writer,'24_5',index=False)
daily_201410_excel_writer.save()
daily_20141025 = pro.daily(start_date='',end_date='',trade_date='20141025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141025_tscode_list = list() 
for ts_code_sh in daily_20141025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141025_tscode_list.append(stock_name)
daily_20141025_addname_dataframe=pd.DataFrame()
daily_20141025_addname_dataframe['cname'] = daily_20141025_tscode_list
for table_name in daily_20141025.columns.values.tolist():
    daily_20141025_addname_dataframe[table_name] = daily_20141025[table_name]
print("daily_20141025 返回数据 row 行数 = "+str(daily_20141025.shape[0]))
daily_20141025_addname_dataframe.to_excel(daily_201410_excel_writer,'25_6',index=False)
daily_201410_excel_writer.save()
daily_20141026 = pro.daily(start_date='',end_date='',trade_date='20141026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141026_tscode_list = list() 
for ts_code_sh in daily_20141026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141026_tscode_list.append(stock_name)
daily_20141026_addname_dataframe=pd.DataFrame()
daily_20141026_addname_dataframe['cname'] = daily_20141026_tscode_list
for table_name in daily_20141026.columns.values.tolist():
    daily_20141026_addname_dataframe[table_name] = daily_20141026[table_name]
print("daily_20141026 返回数据 row 行数 = "+str(daily_20141026.shape[0]))
daily_20141026_addname_dataframe.to_excel(daily_201410_excel_writer,'26_7',index=False)
daily_201410_excel_writer.save()
daily_20141027 = pro.daily(start_date='',end_date='',trade_date='20141027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141027_tscode_list = list() 
for ts_code_sh in daily_20141027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141027_tscode_list.append(stock_name)
daily_20141027_addname_dataframe=pd.DataFrame()
daily_20141027_addname_dataframe['cname'] = daily_20141027_tscode_list
for table_name in daily_20141027.columns.values.tolist():
    daily_20141027_addname_dataframe[table_name] = daily_20141027[table_name]
print("daily_20141027 返回数据 row 行数 = "+str(daily_20141027.shape[0]))
daily_20141027_addname_dataframe.to_excel(daily_201410_excel_writer,'27_1',index=False)
daily_201410_excel_writer.save()
daily_20141028 = pro.daily(start_date='',end_date='',trade_date='20141028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141028_tscode_list = list() 
for ts_code_sh in daily_20141028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141028_tscode_list.append(stock_name)
daily_20141028_addname_dataframe=pd.DataFrame()
daily_20141028_addname_dataframe['cname'] = daily_20141028_tscode_list
for table_name in daily_20141028.columns.values.tolist():
    daily_20141028_addname_dataframe[table_name] = daily_20141028[table_name]
print("daily_20141028 返回数据 row 行数 = "+str(daily_20141028.shape[0]))
daily_20141028_addname_dataframe.to_excel(daily_201410_excel_writer,'28_2',index=False)
daily_201410_excel_writer.save()
daily_20141029 = pro.daily(start_date='',end_date='',trade_date='20141029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141029_tscode_list = list() 
for ts_code_sh in daily_20141029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141029_tscode_list.append(stock_name)
daily_20141029_addname_dataframe=pd.DataFrame()
daily_20141029_addname_dataframe['cname'] = daily_20141029_tscode_list
for table_name in daily_20141029.columns.values.tolist():
    daily_20141029_addname_dataframe[table_name] = daily_20141029[table_name]
print("daily_20141029 返回数据 row 行数 = "+str(daily_20141029.shape[0]))
daily_20141029_addname_dataframe.to_excel(daily_201410_excel_writer,'29_3',index=False)
daily_201410_excel_writer.save()
daily_20141030 = pro.daily(start_date='',end_date='',trade_date='20141030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141030_tscode_list = list() 
for ts_code_sh in daily_20141030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141030_tscode_list.append(stock_name)
daily_20141030_addname_dataframe=pd.DataFrame()
daily_20141030_addname_dataframe['cname'] = daily_20141030_tscode_list
for table_name in daily_20141030.columns.values.tolist():
    daily_20141030_addname_dataframe[table_name] = daily_20141030[table_name]
print("daily_20141030 返回数据 row 行数 = "+str(daily_20141030.shape[0]))
daily_20141030_addname_dataframe.to_excel(daily_201410_excel_writer,'30_4',index=False)
daily_201410_excel_writer.save()
daily_20141031 = pro.daily(start_date='',end_date='',trade_date='20141031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141031_tscode_list = list() 
for ts_code_sh in daily_20141031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141031_tscode_list.append(stock_name)
daily_20141031_addname_dataframe=pd.DataFrame()
daily_20141031_addname_dataframe['cname'] = daily_20141031_tscode_list
for table_name in daily_20141031.columns.values.tolist():
    daily_20141031_addname_dataframe[table_name] = daily_20141031[table_name]
print("daily_20141031 返回数据 row 行数 = "+str(daily_20141031.shape[0]))
daily_20141031_addname_dataframe.to_excel(daily_201410_excel_writer,'31_5',index=False)
daily_201410_excel_writer.save()




createexcel('daily_201411.xlsx')
daily_201411_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201411.xlsx')
daily_201411_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201411.xlsx', engine='openpyxl')
daily_201411_excel_writer.book = daily_201411_book
daily_201411_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201411_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20141101")       ###  更新 记录日期
daily_20141101 = pro.daily(start_date='',end_date='',trade_date='20141101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141101_tscode_list = list() 
for ts_code_sh in daily_20141101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141101_tscode_list.append(stock_name)
daily_20141101_addname_dataframe=pd.DataFrame()
daily_20141101_addname_dataframe['cname'] = daily_20141101_tscode_list
for table_name in daily_20141101.columns.values.tolist():
    daily_20141101_addname_dataframe[table_name] = daily_20141101[table_name]
print("daily_20141101 返回数据 row 行数 = "+str(daily_20141101.shape[0]))
daily_20141101_addname_dataframe.to_excel(daily_201411_excel_writer,'1_6',index=False)
daily_201411_excel_writer.save()
daily_20141102 = pro.daily(start_date='',end_date='',trade_date='20141102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141102_tscode_list = list() 
for ts_code_sh in daily_20141102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141102_tscode_list.append(stock_name)
daily_20141102_addname_dataframe=pd.DataFrame()
daily_20141102_addname_dataframe['cname'] = daily_20141102_tscode_list
for table_name in daily_20141102.columns.values.tolist():
    daily_20141102_addname_dataframe[table_name] = daily_20141102[table_name]
print("daily_20141102 返回数据 row 行数 = "+str(daily_20141102.shape[0]))
daily_20141102_addname_dataframe.to_excel(daily_201411_excel_writer,'2_7',index=False)
daily_201411_excel_writer.save()
daily_20141103 = pro.daily(start_date='',end_date='',trade_date='20141103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141103_tscode_list = list() 
for ts_code_sh in daily_20141103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141103_tscode_list.append(stock_name)
daily_20141103_addname_dataframe=pd.DataFrame()
daily_20141103_addname_dataframe['cname'] = daily_20141103_tscode_list
for table_name in daily_20141103.columns.values.tolist():
    daily_20141103_addname_dataframe[table_name] = daily_20141103[table_name]
print("daily_20141103 返回数据 row 行数 = "+str(daily_20141103.shape[0]))
daily_20141103_addname_dataframe.to_excel(daily_201411_excel_writer,'3_1',index=False)
daily_201411_excel_writer.save()
daily_20141104 = pro.daily(start_date='',end_date='',trade_date='20141104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141104_tscode_list = list() 
for ts_code_sh in daily_20141104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141104_tscode_list.append(stock_name)
daily_20141104_addname_dataframe=pd.DataFrame()
daily_20141104_addname_dataframe['cname'] = daily_20141104_tscode_list
for table_name in daily_20141104.columns.values.tolist():
    daily_20141104_addname_dataframe[table_name] = daily_20141104[table_name]
print("daily_20141104 返回数据 row 行数 = "+str(daily_20141104.shape[0]))
daily_20141104_addname_dataframe.to_excel(daily_201411_excel_writer,'4_2',index=False)
daily_201411_excel_writer.save()
daily_20141105 = pro.daily(start_date='',end_date='',trade_date='20141105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141105_tscode_list = list() 
for ts_code_sh in daily_20141105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141105_tscode_list.append(stock_name)
daily_20141105_addname_dataframe=pd.DataFrame()
daily_20141105_addname_dataframe['cname'] = daily_20141105_tscode_list
for table_name in daily_20141105.columns.values.tolist():
    daily_20141105_addname_dataframe[table_name] = daily_20141105[table_name]
print("daily_20141105 返回数据 row 行数 = "+str(daily_20141105.shape[0]))
daily_20141105_addname_dataframe.to_excel(daily_201411_excel_writer,'5_3',index=False)
daily_201411_excel_writer.save()
daily_20141106 = pro.daily(start_date='',end_date='',trade_date='20141106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141106_tscode_list = list() 
for ts_code_sh in daily_20141106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141106_tscode_list.append(stock_name)
daily_20141106_addname_dataframe=pd.DataFrame()
daily_20141106_addname_dataframe['cname'] = daily_20141106_tscode_list
for table_name in daily_20141106.columns.values.tolist():
    daily_20141106_addname_dataframe[table_name] = daily_20141106[table_name]
print("daily_20141106 返回数据 row 行数 = "+str(daily_20141106.shape[0]))
daily_20141106_addname_dataframe.to_excel(daily_201411_excel_writer,'6_4',index=False)
daily_201411_excel_writer.save()
daily_20141107 = pro.daily(start_date='',end_date='',trade_date='20141107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141107_tscode_list = list() 
for ts_code_sh in daily_20141107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141107_tscode_list.append(stock_name)
daily_20141107_addname_dataframe=pd.DataFrame()
daily_20141107_addname_dataframe['cname'] = daily_20141107_tscode_list
for table_name in daily_20141107.columns.values.tolist():
    daily_20141107_addname_dataframe[table_name] = daily_20141107[table_name]
print("daily_20141107 返回数据 row 行数 = "+str(daily_20141107.shape[0]))
daily_20141107_addname_dataframe.to_excel(daily_201411_excel_writer,'7_5',index=False)
daily_201411_excel_writer.save()
daily_20141108 = pro.daily(start_date='',end_date='',trade_date='20141108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141108_tscode_list = list() 
for ts_code_sh in daily_20141108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141108_tscode_list.append(stock_name)
daily_20141108_addname_dataframe=pd.DataFrame()
daily_20141108_addname_dataframe['cname'] = daily_20141108_tscode_list
for table_name in daily_20141108.columns.values.tolist():
    daily_20141108_addname_dataframe[table_name] = daily_20141108[table_name]
print("daily_20141108 返回数据 row 行数 = "+str(daily_20141108.shape[0]))
daily_20141108_addname_dataframe.to_excel(daily_201411_excel_writer,'8_6',index=False)
daily_201411_excel_writer.save()
daily_20141109 = pro.daily(start_date='',end_date='',trade_date='20141109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141109_tscode_list = list() 
for ts_code_sh in daily_20141109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141109_tscode_list.append(stock_name)
daily_20141109_addname_dataframe=pd.DataFrame()
daily_20141109_addname_dataframe['cname'] = daily_20141109_tscode_list
for table_name in daily_20141109.columns.values.tolist():
    daily_20141109_addname_dataframe[table_name] = daily_20141109[table_name]
print("daily_20141109 返回数据 row 行数 = "+str(daily_20141109.shape[0]))
daily_20141109_addname_dataframe.to_excel(daily_201411_excel_writer,'9_7',index=False)
daily_201411_excel_writer.save()
daily_20141110 = pro.daily(start_date='',end_date='',trade_date='20141110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141110_tscode_list = list() 
for ts_code_sh in daily_20141110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141110_tscode_list.append(stock_name)
daily_20141110_addname_dataframe=pd.DataFrame()
daily_20141110_addname_dataframe['cname'] = daily_20141110_tscode_list
for table_name in daily_20141110.columns.values.tolist():
    daily_20141110_addname_dataframe[table_name] = daily_20141110[table_name]
print("daily_20141110 返回数据 row 行数 = "+str(daily_20141110.shape[0]))
daily_20141110_addname_dataframe.to_excel(daily_201411_excel_writer,'10_1',index=False)
daily_201411_excel_writer.save()
daily_20141111 = pro.daily(start_date='',end_date='',trade_date='20141111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141111_tscode_list = list() 
for ts_code_sh in daily_20141111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141111_tscode_list.append(stock_name)
daily_20141111_addname_dataframe=pd.DataFrame()
daily_20141111_addname_dataframe['cname'] = daily_20141111_tscode_list
for table_name in daily_20141111.columns.values.tolist():
    daily_20141111_addname_dataframe[table_name] = daily_20141111[table_name]
print("daily_20141111 返回数据 row 行数 = "+str(daily_20141111.shape[0]))
daily_20141111_addname_dataframe.to_excel(daily_201411_excel_writer,'11_2',index=False)
daily_201411_excel_writer.save()
daily_20141112 = pro.daily(start_date='',end_date='',trade_date='20141112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141112_tscode_list = list() 
for ts_code_sh in daily_20141112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141112_tscode_list.append(stock_name)
daily_20141112_addname_dataframe=pd.DataFrame()
daily_20141112_addname_dataframe['cname'] = daily_20141112_tscode_list
for table_name in daily_20141112.columns.values.tolist():
    daily_20141112_addname_dataframe[table_name] = daily_20141112[table_name]
print("daily_20141112 返回数据 row 行数 = "+str(daily_20141112.shape[0]))
daily_20141112_addname_dataframe.to_excel(daily_201411_excel_writer,'12_3',index=False)
daily_201411_excel_writer.save()
daily_20141113 = pro.daily(start_date='',end_date='',trade_date='20141113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141113_tscode_list = list() 
for ts_code_sh in daily_20141113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141113_tscode_list.append(stock_name)
daily_20141113_addname_dataframe=pd.DataFrame()
daily_20141113_addname_dataframe['cname'] = daily_20141113_tscode_list
for table_name in daily_20141113.columns.values.tolist():
    daily_20141113_addname_dataframe[table_name] = daily_20141113[table_name]
print("daily_20141113 返回数据 row 行数 = "+str(daily_20141113.shape[0]))
daily_20141113_addname_dataframe.to_excel(daily_201411_excel_writer,'13_4',index=False)
daily_201411_excel_writer.save()
daily_20141114 = pro.daily(start_date='',end_date='',trade_date='20141114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141114_tscode_list = list() 
for ts_code_sh in daily_20141114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141114_tscode_list.append(stock_name)
daily_20141114_addname_dataframe=pd.DataFrame()
daily_20141114_addname_dataframe['cname'] = daily_20141114_tscode_list
for table_name in daily_20141114.columns.values.tolist():
    daily_20141114_addname_dataframe[table_name] = daily_20141114[table_name]
print("daily_20141114 返回数据 row 行数 = "+str(daily_20141114.shape[0]))
daily_20141114_addname_dataframe.to_excel(daily_201411_excel_writer,'14_5',index=False)
daily_201411_excel_writer.save()
daily_20141115 = pro.daily(start_date='',end_date='',trade_date='20141115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141115_tscode_list = list() 
for ts_code_sh in daily_20141115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141115_tscode_list.append(stock_name)
daily_20141115_addname_dataframe=pd.DataFrame()
daily_20141115_addname_dataframe['cname'] = daily_20141115_tscode_list
for table_name in daily_20141115.columns.values.tolist():
    daily_20141115_addname_dataframe[table_name] = daily_20141115[table_name]
print("daily_20141115 返回数据 row 行数 = "+str(daily_20141115.shape[0]))
daily_20141115_addname_dataframe.to_excel(daily_201411_excel_writer,'15_6',index=False)
daily_201411_excel_writer.save()
daily_20141116 = pro.daily(start_date='',end_date='',trade_date='20141116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141116_tscode_list = list() 
for ts_code_sh in daily_20141116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141116_tscode_list.append(stock_name)
daily_20141116_addname_dataframe=pd.DataFrame()
daily_20141116_addname_dataframe['cname'] = daily_20141116_tscode_list
for table_name in daily_20141116.columns.values.tolist():
    daily_20141116_addname_dataframe[table_name] = daily_20141116[table_name]
print("daily_20141116 返回数据 row 行数 = "+str(daily_20141116.shape[0]))
daily_20141116_addname_dataframe.to_excel(daily_201411_excel_writer,'16_7',index=False)
daily_201411_excel_writer.save()
daily_20141117 = pro.daily(start_date='',end_date='',trade_date='20141117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141117_tscode_list = list() 
for ts_code_sh in daily_20141117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141117_tscode_list.append(stock_name)
daily_20141117_addname_dataframe=pd.DataFrame()
daily_20141117_addname_dataframe['cname'] = daily_20141117_tscode_list
for table_name in daily_20141117.columns.values.tolist():
    daily_20141117_addname_dataframe[table_name] = daily_20141117[table_name]
print("daily_20141117 返回数据 row 行数 = "+str(daily_20141117.shape[0]))
daily_20141117_addname_dataframe.to_excel(daily_201411_excel_writer,'17_1',index=False)
daily_201411_excel_writer.save()
daily_20141118 = pro.daily(start_date='',end_date='',trade_date='20141118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141118_tscode_list = list() 
for ts_code_sh in daily_20141118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141118_tscode_list.append(stock_name)
daily_20141118_addname_dataframe=pd.DataFrame()
daily_20141118_addname_dataframe['cname'] = daily_20141118_tscode_list
for table_name in daily_20141118.columns.values.tolist():
    daily_20141118_addname_dataframe[table_name] = daily_20141118[table_name]
print("daily_20141118 返回数据 row 行数 = "+str(daily_20141118.shape[0]))
daily_20141118_addname_dataframe.to_excel(daily_201411_excel_writer,'18_2',index=False)
daily_201411_excel_writer.save()
daily_20141119 = pro.daily(start_date='',end_date='',trade_date='20141119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141119_tscode_list = list() 
for ts_code_sh in daily_20141119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141119_tscode_list.append(stock_name)
daily_20141119_addname_dataframe=pd.DataFrame()
daily_20141119_addname_dataframe['cname'] = daily_20141119_tscode_list
for table_name in daily_20141119.columns.values.tolist():
    daily_20141119_addname_dataframe[table_name] = daily_20141119[table_name]
print("daily_20141119 返回数据 row 行数 = "+str(daily_20141119.shape[0]))
daily_20141119_addname_dataframe.to_excel(daily_201411_excel_writer,'19_3',index=False)
daily_201411_excel_writer.save()
daily_20141120 = pro.daily(start_date='',end_date='',trade_date='20141120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141120_tscode_list = list() 
for ts_code_sh in daily_20141120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141120_tscode_list.append(stock_name)
daily_20141120_addname_dataframe=pd.DataFrame()
daily_20141120_addname_dataframe['cname'] = daily_20141120_tscode_list
for table_name in daily_20141120.columns.values.tolist():
    daily_20141120_addname_dataframe[table_name] = daily_20141120[table_name]
print("daily_20141120 返回数据 row 行数 = "+str(daily_20141120.shape[0]))
daily_20141120_addname_dataframe.to_excel(daily_201411_excel_writer,'20_4',index=False)
daily_201411_excel_writer.save()
daily_20141121 = pro.daily(start_date='',end_date='',trade_date='20141121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141121_tscode_list = list() 
for ts_code_sh in daily_20141121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141121_tscode_list.append(stock_name)
daily_20141121_addname_dataframe=pd.DataFrame()
daily_20141121_addname_dataframe['cname'] = daily_20141121_tscode_list
for table_name in daily_20141121.columns.values.tolist():
    daily_20141121_addname_dataframe[table_name] = daily_20141121[table_name]
print("daily_20141121 返回数据 row 行数 = "+str(daily_20141121.shape[0]))
daily_20141121_addname_dataframe.to_excel(daily_201411_excel_writer,'21_5',index=False)
daily_201411_excel_writer.save()
daily_20141122 = pro.daily(start_date='',end_date='',trade_date='20141122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141122_tscode_list = list() 
for ts_code_sh in daily_20141122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141122_tscode_list.append(stock_name)
daily_20141122_addname_dataframe=pd.DataFrame()
daily_20141122_addname_dataframe['cname'] = daily_20141122_tscode_list
for table_name in daily_20141122.columns.values.tolist():
    daily_20141122_addname_dataframe[table_name] = daily_20141122[table_name]
print("daily_20141122 返回数据 row 行数 = "+str(daily_20141122.shape[0]))
daily_20141122_addname_dataframe.to_excel(daily_201411_excel_writer,'22_6',index=False)
daily_201411_excel_writer.save()
daily_20141123 = pro.daily(start_date='',end_date='',trade_date='20141123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141123_tscode_list = list() 
for ts_code_sh in daily_20141123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141123_tscode_list.append(stock_name)
daily_20141123_addname_dataframe=pd.DataFrame()
daily_20141123_addname_dataframe['cname'] = daily_20141123_tscode_list
for table_name in daily_20141123.columns.values.tolist():
    daily_20141123_addname_dataframe[table_name] = daily_20141123[table_name]
print("daily_20141123 返回数据 row 行数 = "+str(daily_20141123.shape[0]))
daily_20141123_addname_dataframe.to_excel(daily_201411_excel_writer,'23_7',index=False)
daily_201411_excel_writer.save()
daily_20141124 = pro.daily(start_date='',end_date='',trade_date='20141124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141124_tscode_list = list() 
for ts_code_sh in daily_20141124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141124_tscode_list.append(stock_name)
daily_20141124_addname_dataframe=pd.DataFrame()
daily_20141124_addname_dataframe['cname'] = daily_20141124_tscode_list
for table_name in daily_20141124.columns.values.tolist():
    daily_20141124_addname_dataframe[table_name] = daily_20141124[table_name]
print("daily_20141124 返回数据 row 行数 = "+str(daily_20141124.shape[0]))
daily_20141124_addname_dataframe.to_excel(daily_201411_excel_writer,'24_1',index=False)
daily_201411_excel_writer.save()
daily_20141125 = pro.daily(start_date='',end_date='',trade_date='20141125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141125_tscode_list = list() 
for ts_code_sh in daily_20141125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141125_tscode_list.append(stock_name)
daily_20141125_addname_dataframe=pd.DataFrame()
daily_20141125_addname_dataframe['cname'] = daily_20141125_tscode_list
for table_name in daily_20141125.columns.values.tolist():
    daily_20141125_addname_dataframe[table_name] = daily_20141125[table_name]
print("daily_20141125 返回数据 row 行数 = "+str(daily_20141125.shape[0]))
daily_20141125_addname_dataframe.to_excel(daily_201411_excel_writer,'25_2',index=False)
daily_201411_excel_writer.save()
daily_20141126 = pro.daily(start_date='',end_date='',trade_date='20141126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141126_tscode_list = list() 
for ts_code_sh in daily_20141126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141126_tscode_list.append(stock_name)
daily_20141126_addname_dataframe=pd.DataFrame()
daily_20141126_addname_dataframe['cname'] = daily_20141126_tscode_list
for table_name in daily_20141126.columns.values.tolist():
    daily_20141126_addname_dataframe[table_name] = daily_20141126[table_name]
print("daily_20141126 返回数据 row 行数 = "+str(daily_20141126.shape[0]))
daily_20141126_addname_dataframe.to_excel(daily_201411_excel_writer,'26_3',index=False)
daily_201411_excel_writer.save()
daily_20141127 = pro.daily(start_date='',end_date='',trade_date='20141127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141127_tscode_list = list() 
for ts_code_sh in daily_20141127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141127_tscode_list.append(stock_name)
daily_20141127_addname_dataframe=pd.DataFrame()
daily_20141127_addname_dataframe['cname'] = daily_20141127_tscode_list
for table_name in daily_20141127.columns.values.tolist():
    daily_20141127_addname_dataframe[table_name] = daily_20141127[table_name]
print("daily_20141127 返回数据 row 行数 = "+str(daily_20141127.shape[0]))
daily_20141127_addname_dataframe.to_excel(daily_201411_excel_writer,'27_4',index=False)
daily_201411_excel_writer.save()
daily_20141128 = pro.daily(start_date='',end_date='',trade_date='20141128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141128_tscode_list = list() 
for ts_code_sh in daily_20141128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141128_tscode_list.append(stock_name)
daily_20141128_addname_dataframe=pd.DataFrame()
daily_20141128_addname_dataframe['cname'] = daily_20141128_tscode_list
for table_name in daily_20141128.columns.values.tolist():
    daily_20141128_addname_dataframe[table_name] = daily_20141128[table_name]
print("daily_20141128 返回数据 row 行数 = "+str(daily_20141128.shape[0]))
daily_20141128_addname_dataframe.to_excel(daily_201411_excel_writer,'28_5',index=False)
daily_201411_excel_writer.save()
daily_20141129 = pro.daily(start_date='',end_date='',trade_date='20141129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141129_tscode_list = list() 
for ts_code_sh in daily_20141129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141129_tscode_list.append(stock_name)
daily_20141129_addname_dataframe=pd.DataFrame()
daily_20141129_addname_dataframe['cname'] = daily_20141129_tscode_list
for table_name in daily_20141129.columns.values.tolist():
    daily_20141129_addname_dataframe[table_name] = daily_20141129[table_name]
print("daily_20141129 返回数据 row 行数 = "+str(daily_20141129.shape[0]))
daily_20141129_addname_dataframe.to_excel(daily_201411_excel_writer,'29_6',index=False)
daily_201411_excel_writer.save()
daily_20141130 = pro.daily(start_date='',end_date='',trade_date='20141130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141130_tscode_list = list() 
for ts_code_sh in daily_20141130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141130_tscode_list.append(stock_name)
daily_20141130_addname_dataframe=pd.DataFrame()
daily_20141130_addname_dataframe['cname'] = daily_20141130_tscode_list
for table_name in daily_20141130.columns.values.tolist():
    daily_20141130_addname_dataframe[table_name] = daily_20141130[table_name]
print("daily_20141130 返回数据 row 行数 = "+str(daily_20141130.shape[0]))
daily_20141130_addname_dataframe.to_excel(daily_201411_excel_writer,'30_7',index=False)
daily_201411_excel_writer.save()




createexcel('daily_201412.xlsx')
daily_201412_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201412.xlsx')
daily_201412_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201412.xlsx', engine='openpyxl')
daily_201412_excel_writer.book = daily_201412_book
daily_201412_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201412_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20141201")       ###  更新 记录日期
daily_20141201 = pro.daily(start_date='',end_date='',trade_date='20141201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141201_tscode_list = list() 
for ts_code_sh in daily_20141201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141201_tscode_list.append(stock_name)
daily_20141201_addname_dataframe=pd.DataFrame()
daily_20141201_addname_dataframe['cname'] = daily_20141201_tscode_list
for table_name in daily_20141201.columns.values.tolist():
    daily_20141201_addname_dataframe[table_name] = daily_20141201[table_name]
print("daily_20141201 返回数据 row 行数 = "+str(daily_20141201.shape[0]))
daily_20141201_addname_dataframe.to_excel(daily_201412_excel_writer,'1_1',index=False)
daily_201412_excel_writer.save()
daily_20141202 = pro.daily(start_date='',end_date='',trade_date='20141202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141202_tscode_list = list() 
for ts_code_sh in daily_20141202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141202_tscode_list.append(stock_name)
daily_20141202_addname_dataframe=pd.DataFrame()
daily_20141202_addname_dataframe['cname'] = daily_20141202_tscode_list
for table_name in daily_20141202.columns.values.tolist():
    daily_20141202_addname_dataframe[table_name] = daily_20141202[table_name]
print("daily_20141202 返回数据 row 行数 = "+str(daily_20141202.shape[0]))
daily_20141202_addname_dataframe.to_excel(daily_201412_excel_writer,'2_2',index=False)
daily_201412_excel_writer.save()
daily_20141203 = pro.daily(start_date='',end_date='',trade_date='20141203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141203_tscode_list = list() 
for ts_code_sh in daily_20141203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141203_tscode_list.append(stock_name)
daily_20141203_addname_dataframe=pd.DataFrame()
daily_20141203_addname_dataframe['cname'] = daily_20141203_tscode_list
for table_name in daily_20141203.columns.values.tolist():
    daily_20141203_addname_dataframe[table_name] = daily_20141203[table_name]
print("daily_20141203 返回数据 row 行数 = "+str(daily_20141203.shape[0]))
daily_20141203_addname_dataframe.to_excel(daily_201412_excel_writer,'3_3',index=False)
daily_201412_excel_writer.save()
daily_20141204 = pro.daily(start_date='',end_date='',trade_date='20141204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141204_tscode_list = list() 
for ts_code_sh in daily_20141204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141204_tscode_list.append(stock_name)
daily_20141204_addname_dataframe=pd.DataFrame()
daily_20141204_addname_dataframe['cname'] = daily_20141204_tscode_list
for table_name in daily_20141204.columns.values.tolist():
    daily_20141204_addname_dataframe[table_name] = daily_20141204[table_name]
print("daily_20141204 返回数据 row 行数 = "+str(daily_20141204.shape[0]))
daily_20141204_addname_dataframe.to_excel(daily_201412_excel_writer,'4_4',index=False)
daily_201412_excel_writer.save()
daily_20141205 = pro.daily(start_date='',end_date='',trade_date='20141205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141205_tscode_list = list() 
for ts_code_sh in daily_20141205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141205_tscode_list.append(stock_name)
daily_20141205_addname_dataframe=pd.DataFrame()
daily_20141205_addname_dataframe['cname'] = daily_20141205_tscode_list
for table_name in daily_20141205.columns.values.tolist():
    daily_20141205_addname_dataframe[table_name] = daily_20141205[table_name]
print("daily_20141205 返回数据 row 行数 = "+str(daily_20141205.shape[0]))
daily_20141205_addname_dataframe.to_excel(daily_201412_excel_writer,'5_5',index=False)
daily_201412_excel_writer.save()
daily_20141206 = pro.daily(start_date='',end_date='',trade_date='20141206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141206_tscode_list = list() 
for ts_code_sh in daily_20141206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141206_tscode_list.append(stock_name)
daily_20141206_addname_dataframe=pd.DataFrame()
daily_20141206_addname_dataframe['cname'] = daily_20141206_tscode_list
for table_name in daily_20141206.columns.values.tolist():
    daily_20141206_addname_dataframe[table_name] = daily_20141206[table_name]
print("daily_20141206 返回数据 row 行数 = "+str(daily_20141206.shape[0]))
daily_20141206_addname_dataframe.to_excel(daily_201412_excel_writer,'6_6',index=False)
daily_201412_excel_writer.save()
daily_20141207 = pro.daily(start_date='',end_date='',trade_date='20141207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141207_tscode_list = list() 
for ts_code_sh in daily_20141207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141207_tscode_list.append(stock_name)
daily_20141207_addname_dataframe=pd.DataFrame()
daily_20141207_addname_dataframe['cname'] = daily_20141207_tscode_list
for table_name in daily_20141207.columns.values.tolist():
    daily_20141207_addname_dataframe[table_name] = daily_20141207[table_name]
print("daily_20141207 返回数据 row 行数 = "+str(daily_20141207.shape[0]))
daily_20141207_addname_dataframe.to_excel(daily_201412_excel_writer,'7_7',index=False)
daily_201412_excel_writer.save()
daily_20141208 = pro.daily(start_date='',end_date='',trade_date='20141208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141208_tscode_list = list() 
for ts_code_sh in daily_20141208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141208_tscode_list.append(stock_name)
daily_20141208_addname_dataframe=pd.DataFrame()
daily_20141208_addname_dataframe['cname'] = daily_20141208_tscode_list
for table_name in daily_20141208.columns.values.tolist():
    daily_20141208_addname_dataframe[table_name] = daily_20141208[table_name]
print("daily_20141208 返回数据 row 行数 = "+str(daily_20141208.shape[0]))
daily_20141208_addname_dataframe.to_excel(daily_201412_excel_writer,'8_1',index=False)
daily_201412_excel_writer.save()
daily_20141209 = pro.daily(start_date='',end_date='',trade_date='20141209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141209_tscode_list = list() 
for ts_code_sh in daily_20141209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141209_tscode_list.append(stock_name)
daily_20141209_addname_dataframe=pd.DataFrame()
daily_20141209_addname_dataframe['cname'] = daily_20141209_tscode_list
for table_name in daily_20141209.columns.values.tolist():
    daily_20141209_addname_dataframe[table_name] = daily_20141209[table_name]
print("daily_20141209 返回数据 row 行数 = "+str(daily_20141209.shape[0]))
daily_20141209_addname_dataframe.to_excel(daily_201412_excel_writer,'9_2',index=False)
daily_201412_excel_writer.save()
daily_20141210 = pro.daily(start_date='',end_date='',trade_date='20141210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141210_tscode_list = list() 
for ts_code_sh in daily_20141210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141210_tscode_list.append(stock_name)
daily_20141210_addname_dataframe=pd.DataFrame()
daily_20141210_addname_dataframe['cname'] = daily_20141210_tscode_list
for table_name in daily_20141210.columns.values.tolist():
    daily_20141210_addname_dataframe[table_name] = daily_20141210[table_name]
print("daily_20141210 返回数据 row 行数 = "+str(daily_20141210.shape[0]))
daily_20141210_addname_dataframe.to_excel(daily_201412_excel_writer,'10_3',index=False)
daily_201412_excel_writer.save()
daily_20141211 = pro.daily(start_date='',end_date='',trade_date='20141211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141211_tscode_list = list() 
for ts_code_sh in daily_20141211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141211_tscode_list.append(stock_name)
daily_20141211_addname_dataframe=pd.DataFrame()
daily_20141211_addname_dataframe['cname'] = daily_20141211_tscode_list
for table_name in daily_20141211.columns.values.tolist():
    daily_20141211_addname_dataframe[table_name] = daily_20141211[table_name]
print("daily_20141211 返回数据 row 行数 = "+str(daily_20141211.shape[0]))
daily_20141211_addname_dataframe.to_excel(daily_201412_excel_writer,'11_4',index=False)
daily_201412_excel_writer.save()
daily_20141212 = pro.daily(start_date='',end_date='',trade_date='20141212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141212_tscode_list = list() 
for ts_code_sh in daily_20141212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141212_tscode_list.append(stock_name)
daily_20141212_addname_dataframe=pd.DataFrame()
daily_20141212_addname_dataframe['cname'] = daily_20141212_tscode_list
for table_name in daily_20141212.columns.values.tolist():
    daily_20141212_addname_dataframe[table_name] = daily_20141212[table_name]
print("daily_20141212 返回数据 row 行数 = "+str(daily_20141212.shape[0]))
daily_20141212_addname_dataframe.to_excel(daily_201412_excel_writer,'12_5',index=False)
daily_201412_excel_writer.save()
daily_20141213 = pro.daily(start_date='',end_date='',trade_date='20141213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141213_tscode_list = list() 
for ts_code_sh in daily_20141213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141213_tscode_list.append(stock_name)
daily_20141213_addname_dataframe=pd.DataFrame()
daily_20141213_addname_dataframe['cname'] = daily_20141213_tscode_list
for table_name in daily_20141213.columns.values.tolist():
    daily_20141213_addname_dataframe[table_name] = daily_20141213[table_name]
print("daily_20141213 返回数据 row 行数 = "+str(daily_20141213.shape[0]))
daily_20141213_addname_dataframe.to_excel(daily_201412_excel_writer,'13_6',index=False)
daily_201412_excel_writer.save()
daily_20141214 = pro.daily(start_date='',end_date='',trade_date='20141214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141214_tscode_list = list() 
for ts_code_sh in daily_20141214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141214_tscode_list.append(stock_name)
daily_20141214_addname_dataframe=pd.DataFrame()
daily_20141214_addname_dataframe['cname'] = daily_20141214_tscode_list
for table_name in daily_20141214.columns.values.tolist():
    daily_20141214_addname_dataframe[table_name] = daily_20141214[table_name]
print("daily_20141214 返回数据 row 行数 = "+str(daily_20141214.shape[0]))
daily_20141214_addname_dataframe.to_excel(daily_201412_excel_writer,'14_7',index=False)
daily_201412_excel_writer.save()
daily_20141215 = pro.daily(start_date='',end_date='',trade_date='20141215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141215_tscode_list = list() 
for ts_code_sh in daily_20141215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141215_tscode_list.append(stock_name)
daily_20141215_addname_dataframe=pd.DataFrame()
daily_20141215_addname_dataframe['cname'] = daily_20141215_tscode_list
for table_name in daily_20141215.columns.values.tolist():
    daily_20141215_addname_dataframe[table_name] = daily_20141215[table_name]
print("daily_20141215 返回数据 row 行数 = "+str(daily_20141215.shape[0]))
daily_20141215_addname_dataframe.to_excel(daily_201412_excel_writer,'15_1',index=False)
daily_201412_excel_writer.save()
daily_20141216 = pro.daily(start_date='',end_date='',trade_date='20141216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141216_tscode_list = list() 
for ts_code_sh in daily_20141216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141216_tscode_list.append(stock_name)
daily_20141216_addname_dataframe=pd.DataFrame()
daily_20141216_addname_dataframe['cname'] = daily_20141216_tscode_list
for table_name in daily_20141216.columns.values.tolist():
    daily_20141216_addname_dataframe[table_name] = daily_20141216[table_name]
print("daily_20141216 返回数据 row 行数 = "+str(daily_20141216.shape[0]))
daily_20141216_addname_dataframe.to_excel(daily_201412_excel_writer,'16_2',index=False)
daily_201412_excel_writer.save()
daily_20141217 = pro.daily(start_date='',end_date='',trade_date='20141217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141217_tscode_list = list() 
for ts_code_sh in daily_20141217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141217_tscode_list.append(stock_name)
daily_20141217_addname_dataframe=pd.DataFrame()
daily_20141217_addname_dataframe['cname'] = daily_20141217_tscode_list
for table_name in daily_20141217.columns.values.tolist():
    daily_20141217_addname_dataframe[table_name] = daily_20141217[table_name]
print("daily_20141217 返回数据 row 行数 = "+str(daily_20141217.shape[0]))
daily_20141217_addname_dataframe.to_excel(daily_201412_excel_writer,'17_3',index=False)
daily_201412_excel_writer.save()
daily_20141218 = pro.daily(start_date='',end_date='',trade_date='20141218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141218_tscode_list = list() 
for ts_code_sh in daily_20141218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141218_tscode_list.append(stock_name)
daily_20141218_addname_dataframe=pd.DataFrame()
daily_20141218_addname_dataframe['cname'] = daily_20141218_tscode_list
for table_name in daily_20141218.columns.values.tolist():
    daily_20141218_addname_dataframe[table_name] = daily_20141218[table_name]
print("daily_20141218 返回数据 row 行数 = "+str(daily_20141218.shape[0]))
daily_20141218_addname_dataframe.to_excel(daily_201412_excel_writer,'18_4',index=False)
daily_201412_excel_writer.save()
daily_20141219 = pro.daily(start_date='',end_date='',trade_date='20141219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141219_tscode_list = list() 
for ts_code_sh in daily_20141219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141219_tscode_list.append(stock_name)
daily_20141219_addname_dataframe=pd.DataFrame()
daily_20141219_addname_dataframe['cname'] = daily_20141219_tscode_list
for table_name in daily_20141219.columns.values.tolist():
    daily_20141219_addname_dataframe[table_name] = daily_20141219[table_name]
print("daily_20141219 返回数据 row 行数 = "+str(daily_20141219.shape[0]))
daily_20141219_addname_dataframe.to_excel(daily_201412_excel_writer,'19_5',index=False)
daily_201412_excel_writer.save()
daily_20141220 = pro.daily(start_date='',end_date='',trade_date='20141220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141220_tscode_list = list() 
for ts_code_sh in daily_20141220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141220_tscode_list.append(stock_name)
daily_20141220_addname_dataframe=pd.DataFrame()
daily_20141220_addname_dataframe['cname'] = daily_20141220_tscode_list
for table_name in daily_20141220.columns.values.tolist():
    daily_20141220_addname_dataframe[table_name] = daily_20141220[table_name]
print("daily_20141220 返回数据 row 行数 = "+str(daily_20141220.shape[0]))
daily_20141220_addname_dataframe.to_excel(daily_201412_excel_writer,'20_6',index=False)
daily_201412_excel_writer.save()
daily_20141221 = pro.daily(start_date='',end_date='',trade_date='20141221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141221_tscode_list = list() 
for ts_code_sh in daily_20141221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141221_tscode_list.append(stock_name)
daily_20141221_addname_dataframe=pd.DataFrame()
daily_20141221_addname_dataframe['cname'] = daily_20141221_tscode_list
for table_name in daily_20141221.columns.values.tolist():
    daily_20141221_addname_dataframe[table_name] = daily_20141221[table_name]
print("daily_20141221 返回数据 row 行数 = "+str(daily_20141221.shape[0]))
daily_20141221_addname_dataframe.to_excel(daily_201412_excel_writer,'21_7',index=False)
daily_201412_excel_writer.save()
daily_20141222 = pro.daily(start_date='',end_date='',trade_date='20141222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141222_tscode_list = list() 
for ts_code_sh in daily_20141222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141222_tscode_list.append(stock_name)
daily_20141222_addname_dataframe=pd.DataFrame()
daily_20141222_addname_dataframe['cname'] = daily_20141222_tscode_list
for table_name in daily_20141222.columns.values.tolist():
    daily_20141222_addname_dataframe[table_name] = daily_20141222[table_name]
print("daily_20141222 返回数据 row 行数 = "+str(daily_20141222.shape[0]))
daily_20141222_addname_dataframe.to_excel(daily_201412_excel_writer,'22_1',index=False)
daily_201412_excel_writer.save()
daily_20141223 = pro.daily(start_date='',end_date='',trade_date='20141223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141223_tscode_list = list() 
for ts_code_sh in daily_20141223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141223_tscode_list.append(stock_name)
daily_20141223_addname_dataframe=pd.DataFrame()
daily_20141223_addname_dataframe['cname'] = daily_20141223_tscode_list
for table_name in daily_20141223.columns.values.tolist():
    daily_20141223_addname_dataframe[table_name] = daily_20141223[table_name]
print("daily_20141223 返回数据 row 行数 = "+str(daily_20141223.shape[0]))
daily_20141223_addname_dataframe.to_excel(daily_201412_excel_writer,'23_2',index=False)
daily_201412_excel_writer.save()
daily_20141224 = pro.daily(start_date='',end_date='',trade_date='20141224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141224_tscode_list = list() 
for ts_code_sh in daily_20141224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141224_tscode_list.append(stock_name)
daily_20141224_addname_dataframe=pd.DataFrame()
daily_20141224_addname_dataframe['cname'] = daily_20141224_tscode_list
for table_name in daily_20141224.columns.values.tolist():
    daily_20141224_addname_dataframe[table_name] = daily_20141224[table_name]
print("daily_20141224 返回数据 row 行数 = "+str(daily_20141224.shape[0]))
daily_20141224_addname_dataframe.to_excel(daily_201412_excel_writer,'24_3',index=False)
daily_201412_excel_writer.save()
daily_20141225 = pro.daily(start_date='',end_date='',trade_date='20141225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141225_tscode_list = list() 
for ts_code_sh in daily_20141225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141225_tscode_list.append(stock_name)
daily_20141225_addname_dataframe=pd.DataFrame()
daily_20141225_addname_dataframe['cname'] = daily_20141225_tscode_list
for table_name in daily_20141225.columns.values.tolist():
    daily_20141225_addname_dataframe[table_name] = daily_20141225[table_name]
print("daily_20141225 返回数据 row 行数 = "+str(daily_20141225.shape[0]))
daily_20141225_addname_dataframe.to_excel(daily_201412_excel_writer,'25_4',index=False)
daily_201412_excel_writer.save()
daily_20141226 = pro.daily(start_date='',end_date='',trade_date='20141226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141226_tscode_list = list() 
for ts_code_sh in daily_20141226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141226_tscode_list.append(stock_name)
daily_20141226_addname_dataframe=pd.DataFrame()
daily_20141226_addname_dataframe['cname'] = daily_20141226_tscode_list
for table_name in daily_20141226.columns.values.tolist():
    daily_20141226_addname_dataframe[table_name] = daily_20141226[table_name]
print("daily_20141226 返回数据 row 行数 = "+str(daily_20141226.shape[0]))
daily_20141226_addname_dataframe.to_excel(daily_201412_excel_writer,'26_5',index=False)
daily_201412_excel_writer.save()
daily_20141227 = pro.daily(start_date='',end_date='',trade_date='20141227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141227_tscode_list = list() 
for ts_code_sh in daily_20141227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141227_tscode_list.append(stock_name)
daily_20141227_addname_dataframe=pd.DataFrame()
daily_20141227_addname_dataframe['cname'] = daily_20141227_tscode_list
for table_name in daily_20141227.columns.values.tolist():
    daily_20141227_addname_dataframe[table_name] = daily_20141227[table_name]
print("daily_20141227 返回数据 row 行数 = "+str(daily_20141227.shape[0]))
daily_20141227_addname_dataframe.to_excel(daily_201412_excel_writer,'27_6',index=False)
daily_201412_excel_writer.save()
daily_20141228 = pro.daily(start_date='',end_date='',trade_date='20141228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141228_tscode_list = list() 
for ts_code_sh in daily_20141228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141228_tscode_list.append(stock_name)
daily_20141228_addname_dataframe=pd.DataFrame()
daily_20141228_addname_dataframe['cname'] = daily_20141228_tscode_list
for table_name in daily_20141228.columns.values.tolist():
    daily_20141228_addname_dataframe[table_name] = daily_20141228[table_name]
print("daily_20141228 返回数据 row 行数 = "+str(daily_20141228.shape[0]))
daily_20141228_addname_dataframe.to_excel(daily_201412_excel_writer,'28_7',index=False)
daily_201412_excel_writer.save()
daily_20141229 = pro.daily(start_date='',end_date='',trade_date='20141229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141229_tscode_list = list() 
for ts_code_sh in daily_20141229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141229_tscode_list.append(stock_name)
daily_20141229_addname_dataframe=pd.DataFrame()
daily_20141229_addname_dataframe['cname'] = daily_20141229_tscode_list
for table_name in daily_20141229.columns.values.tolist():
    daily_20141229_addname_dataframe[table_name] = daily_20141229[table_name]
print("daily_20141229 返回数据 row 行数 = "+str(daily_20141229.shape[0]))
daily_20141229_addname_dataframe.to_excel(daily_201412_excel_writer,'29_1',index=False)
daily_201412_excel_writer.save()
daily_20141230 = pro.daily(start_date='',end_date='',trade_date='20141230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141230_tscode_list = list() 
for ts_code_sh in daily_20141230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141230_tscode_list.append(stock_name)
daily_20141230_addname_dataframe=pd.DataFrame()
daily_20141230_addname_dataframe['cname'] = daily_20141230_tscode_list
for table_name in daily_20141230.columns.values.tolist():
    daily_20141230_addname_dataframe[table_name] = daily_20141230[table_name]
print("daily_20141230 返回数据 row 行数 = "+str(daily_20141230.shape[0]))
daily_20141230_addname_dataframe.to_excel(daily_201412_excel_writer,'30_2',index=False)
daily_201412_excel_writer.save()
daily_20141231 = pro.daily(start_date='',end_date='',trade_date='20141231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141231_tscode_list = list() 
for ts_code_sh in daily_20141231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141231_tscode_list.append(stock_name)
daily_20141231_addname_dataframe=pd.DataFrame()
daily_20141231_addname_dataframe['cname'] = daily_20141231_tscode_list
for table_name in daily_20141231.columns.values.tolist():
    daily_20141231_addname_dataframe[table_name] = daily_20141231[table_name]
print("daily_20141231 返回数据 row 行数 = "+str(daily_20141231.shape[0]))
daily_20141231_addname_dataframe.to_excel(daily_201412_excel_writer,'31_3',index=False)
daily_201412_excel_writer.save()




createexcel('daily_201501.xlsx')
daily_201501_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201501.xlsx')
daily_201501_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201501.xlsx', engine='openpyxl')
daily_201501_excel_writer.book = daily_201501_book
daily_201501_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201501_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150101")       ###  更新 记录日期
daily_20150101 = pro.daily(start_date='',end_date='',trade_date='20150101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150101_tscode_list = list() 
for ts_code_sh in daily_20150101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150101_tscode_list.append(stock_name)
daily_20150101_addname_dataframe=pd.DataFrame()
daily_20150101_addname_dataframe['cname'] = daily_20150101_tscode_list
for table_name in daily_20150101.columns.values.tolist():
    daily_20150101_addname_dataframe[table_name] = daily_20150101[table_name]
print("daily_20150101 返回数据 row 行数 = "+str(daily_20150101.shape[0]))
daily_20150101_addname_dataframe.to_excel(daily_201501_excel_writer,'1_4',index=False)
daily_201501_excel_writer.save()
daily_20150102 = pro.daily(start_date='',end_date='',trade_date='20150102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150102_tscode_list = list() 
for ts_code_sh in daily_20150102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150102_tscode_list.append(stock_name)
daily_20150102_addname_dataframe=pd.DataFrame()
daily_20150102_addname_dataframe['cname'] = daily_20150102_tscode_list
for table_name in daily_20150102.columns.values.tolist():
    daily_20150102_addname_dataframe[table_name] = daily_20150102[table_name]
print("daily_20150102 返回数据 row 行数 = "+str(daily_20150102.shape[0]))
daily_20150102_addname_dataframe.to_excel(daily_201501_excel_writer,'2_5',index=False)
daily_201501_excel_writer.save()
daily_20150103 = pro.daily(start_date='',end_date='',trade_date='20150103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150103_tscode_list = list() 
for ts_code_sh in daily_20150103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150103_tscode_list.append(stock_name)
daily_20150103_addname_dataframe=pd.DataFrame()
daily_20150103_addname_dataframe['cname'] = daily_20150103_tscode_list
for table_name in daily_20150103.columns.values.tolist():
    daily_20150103_addname_dataframe[table_name] = daily_20150103[table_name]
print("daily_20150103 返回数据 row 行数 = "+str(daily_20150103.shape[0]))
daily_20150103_addname_dataframe.to_excel(daily_201501_excel_writer,'3_6',index=False)
daily_201501_excel_writer.save()
daily_20150104 = pro.daily(start_date='',end_date='',trade_date='20150104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150104_tscode_list = list() 
for ts_code_sh in daily_20150104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150104_tscode_list.append(stock_name)
daily_20150104_addname_dataframe=pd.DataFrame()
daily_20150104_addname_dataframe['cname'] = daily_20150104_tscode_list
for table_name in daily_20150104.columns.values.tolist():
    daily_20150104_addname_dataframe[table_name] = daily_20150104[table_name]
print("daily_20150104 返回数据 row 行数 = "+str(daily_20150104.shape[0]))
daily_20150104_addname_dataframe.to_excel(daily_201501_excel_writer,'4_7',index=False)
daily_201501_excel_writer.save()
daily_20150105 = pro.daily(start_date='',end_date='',trade_date='20150105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150105_tscode_list = list() 
for ts_code_sh in daily_20150105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150105_tscode_list.append(stock_name)
daily_20150105_addname_dataframe=pd.DataFrame()
daily_20150105_addname_dataframe['cname'] = daily_20150105_tscode_list
for table_name in daily_20150105.columns.values.tolist():
    daily_20150105_addname_dataframe[table_name] = daily_20150105[table_name]
print("daily_20150105 返回数据 row 行数 = "+str(daily_20150105.shape[0]))
daily_20150105_addname_dataframe.to_excel(daily_201501_excel_writer,'5_1',index=False)
daily_201501_excel_writer.save()
daily_20150106 = pro.daily(start_date='',end_date='',trade_date='20150106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150106_tscode_list = list() 
for ts_code_sh in daily_20150106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150106_tscode_list.append(stock_name)
daily_20150106_addname_dataframe=pd.DataFrame()
daily_20150106_addname_dataframe['cname'] = daily_20150106_tscode_list
for table_name in daily_20150106.columns.values.tolist():
    daily_20150106_addname_dataframe[table_name] = daily_20150106[table_name]
print("daily_20150106 返回数据 row 行数 = "+str(daily_20150106.shape[0]))
daily_20150106_addname_dataframe.to_excel(daily_201501_excel_writer,'6_2',index=False)
daily_201501_excel_writer.save()
daily_20150107 = pro.daily(start_date='',end_date='',trade_date='20150107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150107_tscode_list = list() 
for ts_code_sh in daily_20150107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150107_tscode_list.append(stock_name)
daily_20150107_addname_dataframe=pd.DataFrame()
daily_20150107_addname_dataframe['cname'] = daily_20150107_tscode_list
for table_name in daily_20150107.columns.values.tolist():
    daily_20150107_addname_dataframe[table_name] = daily_20150107[table_name]
print("daily_20150107 返回数据 row 行数 = "+str(daily_20150107.shape[0]))
daily_20150107_addname_dataframe.to_excel(daily_201501_excel_writer,'7_3',index=False)
daily_201501_excel_writer.save()
daily_20150108 = pro.daily(start_date='',end_date='',trade_date='20150108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150108_tscode_list = list() 
for ts_code_sh in daily_20150108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150108_tscode_list.append(stock_name)
daily_20150108_addname_dataframe=pd.DataFrame()
daily_20150108_addname_dataframe['cname'] = daily_20150108_tscode_list
for table_name in daily_20150108.columns.values.tolist():
    daily_20150108_addname_dataframe[table_name] = daily_20150108[table_name]
print("daily_20150108 返回数据 row 行数 = "+str(daily_20150108.shape[0]))
daily_20150108_addname_dataframe.to_excel(daily_201501_excel_writer,'8_4',index=False)
daily_201501_excel_writer.save()
daily_20150109 = pro.daily(start_date='',end_date='',trade_date='20150109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150109_tscode_list = list() 
for ts_code_sh in daily_20150109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150109_tscode_list.append(stock_name)
daily_20150109_addname_dataframe=pd.DataFrame()
daily_20150109_addname_dataframe['cname'] = daily_20150109_tscode_list
for table_name in daily_20150109.columns.values.tolist():
    daily_20150109_addname_dataframe[table_name] = daily_20150109[table_name]
print("daily_20150109 返回数据 row 行数 = "+str(daily_20150109.shape[0]))
daily_20150109_addname_dataframe.to_excel(daily_201501_excel_writer,'9_5',index=False)
daily_201501_excel_writer.save()
daily_20150110 = pro.daily(start_date='',end_date='',trade_date='20150110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150110_tscode_list = list() 
for ts_code_sh in daily_20150110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150110_tscode_list.append(stock_name)
daily_20150110_addname_dataframe=pd.DataFrame()
daily_20150110_addname_dataframe['cname'] = daily_20150110_tscode_list
for table_name in daily_20150110.columns.values.tolist():
    daily_20150110_addname_dataframe[table_name] = daily_20150110[table_name]
print("daily_20150110 返回数据 row 行数 = "+str(daily_20150110.shape[0]))
daily_20150110_addname_dataframe.to_excel(daily_201501_excel_writer,'10_6',index=False)
daily_201501_excel_writer.save()
daily_20150111 = pro.daily(start_date='',end_date='',trade_date='20150111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150111_tscode_list = list() 
for ts_code_sh in daily_20150111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150111_tscode_list.append(stock_name)
daily_20150111_addname_dataframe=pd.DataFrame()
daily_20150111_addname_dataframe['cname'] = daily_20150111_tscode_list
for table_name in daily_20150111.columns.values.tolist():
    daily_20150111_addname_dataframe[table_name] = daily_20150111[table_name]
print("daily_20150111 返回数据 row 行数 = "+str(daily_20150111.shape[0]))
daily_20150111_addname_dataframe.to_excel(daily_201501_excel_writer,'11_7',index=False)
daily_201501_excel_writer.save()
daily_20150112 = pro.daily(start_date='',end_date='',trade_date='20150112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150112_tscode_list = list() 
for ts_code_sh in daily_20150112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150112_tscode_list.append(stock_name)
daily_20150112_addname_dataframe=pd.DataFrame()
daily_20150112_addname_dataframe['cname'] = daily_20150112_tscode_list
for table_name in daily_20150112.columns.values.tolist():
    daily_20150112_addname_dataframe[table_name] = daily_20150112[table_name]
print("daily_20150112 返回数据 row 行数 = "+str(daily_20150112.shape[0]))
daily_20150112_addname_dataframe.to_excel(daily_201501_excel_writer,'12_1',index=False)
daily_201501_excel_writer.save()
daily_20150113 = pro.daily(start_date='',end_date='',trade_date='20150113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150113_tscode_list = list() 
for ts_code_sh in daily_20150113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150113_tscode_list.append(stock_name)
daily_20150113_addname_dataframe=pd.DataFrame()
daily_20150113_addname_dataframe['cname'] = daily_20150113_tscode_list
for table_name in daily_20150113.columns.values.tolist():
    daily_20150113_addname_dataframe[table_name] = daily_20150113[table_name]
print("daily_20150113 返回数据 row 行数 = "+str(daily_20150113.shape[0]))
daily_20150113_addname_dataframe.to_excel(daily_201501_excel_writer,'13_2',index=False)
daily_201501_excel_writer.save()
daily_20150114 = pro.daily(start_date='',end_date='',trade_date='20150114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150114_tscode_list = list() 
for ts_code_sh in daily_20150114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150114_tscode_list.append(stock_name)
daily_20150114_addname_dataframe=pd.DataFrame()
daily_20150114_addname_dataframe['cname'] = daily_20150114_tscode_list
for table_name in daily_20150114.columns.values.tolist():
    daily_20150114_addname_dataframe[table_name] = daily_20150114[table_name]
print("daily_20150114 返回数据 row 行数 = "+str(daily_20150114.shape[0]))
daily_20150114_addname_dataframe.to_excel(daily_201501_excel_writer,'14_3',index=False)
daily_201501_excel_writer.save()
daily_20150115 = pro.daily(start_date='',end_date='',trade_date='20150115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150115_tscode_list = list() 
for ts_code_sh in daily_20150115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150115_tscode_list.append(stock_name)
daily_20150115_addname_dataframe=pd.DataFrame()
daily_20150115_addname_dataframe['cname'] = daily_20150115_tscode_list
for table_name in daily_20150115.columns.values.tolist():
    daily_20150115_addname_dataframe[table_name] = daily_20150115[table_name]
print("daily_20150115 返回数据 row 行数 = "+str(daily_20150115.shape[0]))
daily_20150115_addname_dataframe.to_excel(daily_201501_excel_writer,'15_4',index=False)
daily_201501_excel_writer.save()
daily_20150116 = pro.daily(start_date='',end_date='',trade_date='20150116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150116_tscode_list = list() 
for ts_code_sh in daily_20150116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150116_tscode_list.append(stock_name)
daily_20150116_addname_dataframe=pd.DataFrame()
daily_20150116_addname_dataframe['cname'] = daily_20150116_tscode_list
for table_name in daily_20150116.columns.values.tolist():
    daily_20150116_addname_dataframe[table_name] = daily_20150116[table_name]
print("daily_20150116 返回数据 row 行数 = "+str(daily_20150116.shape[0]))
daily_20150116_addname_dataframe.to_excel(daily_201501_excel_writer,'16_5',index=False)
daily_201501_excel_writer.save()
daily_20150117 = pro.daily(start_date='',end_date='',trade_date='20150117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150117_tscode_list = list() 
for ts_code_sh in daily_20150117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150117_tscode_list.append(stock_name)
daily_20150117_addname_dataframe=pd.DataFrame()
daily_20150117_addname_dataframe['cname'] = daily_20150117_tscode_list
for table_name in daily_20150117.columns.values.tolist():
    daily_20150117_addname_dataframe[table_name] = daily_20150117[table_name]
print("daily_20150117 返回数据 row 行数 = "+str(daily_20150117.shape[0]))
daily_20150117_addname_dataframe.to_excel(daily_201501_excel_writer,'17_6',index=False)
daily_201501_excel_writer.save()
daily_20150118 = pro.daily(start_date='',end_date='',trade_date='20150118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150118_tscode_list = list() 
for ts_code_sh in daily_20150118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150118_tscode_list.append(stock_name)
daily_20150118_addname_dataframe=pd.DataFrame()
daily_20150118_addname_dataframe['cname'] = daily_20150118_tscode_list
for table_name in daily_20150118.columns.values.tolist():
    daily_20150118_addname_dataframe[table_name] = daily_20150118[table_name]
print("daily_20150118 返回数据 row 行数 = "+str(daily_20150118.shape[0]))
daily_20150118_addname_dataframe.to_excel(daily_201501_excel_writer,'18_7',index=False)
daily_201501_excel_writer.save()
daily_20150119 = pro.daily(start_date='',end_date='',trade_date='20150119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150119_tscode_list = list() 
for ts_code_sh in daily_20150119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150119_tscode_list.append(stock_name)
daily_20150119_addname_dataframe=pd.DataFrame()
daily_20150119_addname_dataframe['cname'] = daily_20150119_tscode_list
for table_name in daily_20150119.columns.values.tolist():
    daily_20150119_addname_dataframe[table_name] = daily_20150119[table_name]
print("daily_20150119 返回数据 row 行数 = "+str(daily_20150119.shape[0]))
daily_20150119_addname_dataframe.to_excel(daily_201501_excel_writer,'19_1',index=False)
daily_201501_excel_writer.save()
daily_20150120 = pro.daily(start_date='',end_date='',trade_date='20150120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150120_tscode_list = list() 
for ts_code_sh in daily_20150120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150120_tscode_list.append(stock_name)
daily_20150120_addname_dataframe=pd.DataFrame()
daily_20150120_addname_dataframe['cname'] = daily_20150120_tscode_list
for table_name in daily_20150120.columns.values.tolist():
    daily_20150120_addname_dataframe[table_name] = daily_20150120[table_name]
print("daily_20150120 返回数据 row 行数 = "+str(daily_20150120.shape[0]))
daily_20150120_addname_dataframe.to_excel(daily_201501_excel_writer,'20_2',index=False)
daily_201501_excel_writer.save()
daily_20150121 = pro.daily(start_date='',end_date='',trade_date='20150121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150121_tscode_list = list() 
for ts_code_sh in daily_20150121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150121_tscode_list.append(stock_name)
daily_20150121_addname_dataframe=pd.DataFrame()
daily_20150121_addname_dataframe['cname'] = daily_20150121_tscode_list
for table_name in daily_20150121.columns.values.tolist():
    daily_20150121_addname_dataframe[table_name] = daily_20150121[table_name]
print("daily_20150121 返回数据 row 行数 = "+str(daily_20150121.shape[0]))
daily_20150121_addname_dataframe.to_excel(daily_201501_excel_writer,'21_3',index=False)
daily_201501_excel_writer.save()
daily_20150122 = pro.daily(start_date='',end_date='',trade_date='20150122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150122_tscode_list = list() 
for ts_code_sh in daily_20150122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150122_tscode_list.append(stock_name)
daily_20150122_addname_dataframe=pd.DataFrame()
daily_20150122_addname_dataframe['cname'] = daily_20150122_tscode_list
for table_name in daily_20150122.columns.values.tolist():
    daily_20150122_addname_dataframe[table_name] = daily_20150122[table_name]
print("daily_20150122 返回数据 row 行数 = "+str(daily_20150122.shape[0]))
daily_20150122_addname_dataframe.to_excel(daily_201501_excel_writer,'22_4',index=False)
daily_201501_excel_writer.save()
daily_20150123 = pro.daily(start_date='',end_date='',trade_date='20150123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150123_tscode_list = list() 
for ts_code_sh in daily_20150123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150123_tscode_list.append(stock_name)
daily_20150123_addname_dataframe=pd.DataFrame()
daily_20150123_addname_dataframe['cname'] = daily_20150123_tscode_list
for table_name in daily_20150123.columns.values.tolist():
    daily_20150123_addname_dataframe[table_name] = daily_20150123[table_name]
print("daily_20150123 返回数据 row 行数 = "+str(daily_20150123.shape[0]))
daily_20150123_addname_dataframe.to_excel(daily_201501_excel_writer,'23_5',index=False)
daily_201501_excel_writer.save()
daily_20150124 = pro.daily(start_date='',end_date='',trade_date='20150124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150124_tscode_list = list() 
for ts_code_sh in daily_20150124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150124_tscode_list.append(stock_name)
daily_20150124_addname_dataframe=pd.DataFrame()
daily_20150124_addname_dataframe['cname'] = daily_20150124_tscode_list
for table_name in daily_20150124.columns.values.tolist():
    daily_20150124_addname_dataframe[table_name] = daily_20150124[table_name]
print("daily_20150124 返回数据 row 行数 = "+str(daily_20150124.shape[0]))
daily_20150124_addname_dataframe.to_excel(daily_201501_excel_writer,'24_6',index=False)
daily_201501_excel_writer.save()
daily_20150125 = pro.daily(start_date='',end_date='',trade_date='20150125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150125_tscode_list = list() 
for ts_code_sh in daily_20150125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150125_tscode_list.append(stock_name)
daily_20150125_addname_dataframe=pd.DataFrame()
daily_20150125_addname_dataframe['cname'] = daily_20150125_tscode_list
for table_name in daily_20150125.columns.values.tolist():
    daily_20150125_addname_dataframe[table_name] = daily_20150125[table_name]
print("daily_20150125 返回数据 row 行数 = "+str(daily_20150125.shape[0]))
daily_20150125_addname_dataframe.to_excel(daily_201501_excel_writer,'25_7',index=False)
daily_201501_excel_writer.save()
daily_20150126 = pro.daily(start_date='',end_date='',trade_date='20150126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150126_tscode_list = list() 
for ts_code_sh in daily_20150126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150126_tscode_list.append(stock_name)
daily_20150126_addname_dataframe=pd.DataFrame()
daily_20150126_addname_dataframe['cname'] = daily_20150126_tscode_list
for table_name in daily_20150126.columns.values.tolist():
    daily_20150126_addname_dataframe[table_name] = daily_20150126[table_name]
print("daily_20150126 返回数据 row 行数 = "+str(daily_20150126.shape[0]))
daily_20150126_addname_dataframe.to_excel(daily_201501_excel_writer,'26_1',index=False)
daily_201501_excel_writer.save()
daily_20150127 = pro.daily(start_date='',end_date='',trade_date='20150127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150127_tscode_list = list() 
for ts_code_sh in daily_20150127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150127_tscode_list.append(stock_name)
daily_20150127_addname_dataframe=pd.DataFrame()
daily_20150127_addname_dataframe['cname'] = daily_20150127_tscode_list
for table_name in daily_20150127.columns.values.tolist():
    daily_20150127_addname_dataframe[table_name] = daily_20150127[table_name]
print("daily_20150127 返回数据 row 行数 = "+str(daily_20150127.shape[0]))
daily_20150127_addname_dataframe.to_excel(daily_201501_excel_writer,'27_2',index=False)
daily_201501_excel_writer.save()
daily_20150128 = pro.daily(start_date='',end_date='',trade_date='20150128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150128_tscode_list = list() 
for ts_code_sh in daily_20150128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150128_tscode_list.append(stock_name)
daily_20150128_addname_dataframe=pd.DataFrame()
daily_20150128_addname_dataframe['cname'] = daily_20150128_tscode_list
for table_name in daily_20150128.columns.values.tolist():
    daily_20150128_addname_dataframe[table_name] = daily_20150128[table_name]
print("daily_20150128 返回数据 row 行数 = "+str(daily_20150128.shape[0]))
daily_20150128_addname_dataframe.to_excel(daily_201501_excel_writer,'28_3',index=False)
daily_201501_excel_writer.save()
daily_20150129 = pro.daily(start_date='',end_date='',trade_date='20150129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150129_tscode_list = list() 
for ts_code_sh in daily_20150129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150129_tscode_list.append(stock_name)
daily_20150129_addname_dataframe=pd.DataFrame()
daily_20150129_addname_dataframe['cname'] = daily_20150129_tscode_list
for table_name in daily_20150129.columns.values.tolist():
    daily_20150129_addname_dataframe[table_name] = daily_20150129[table_name]
print("daily_20150129 返回数据 row 行数 = "+str(daily_20150129.shape[0]))
daily_20150129_addname_dataframe.to_excel(daily_201501_excel_writer,'29_4',index=False)
daily_201501_excel_writer.save()
daily_20150130 = pro.daily(start_date='',end_date='',trade_date='20150130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150130_tscode_list = list() 
for ts_code_sh in daily_20150130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150130_tscode_list.append(stock_name)
daily_20150130_addname_dataframe=pd.DataFrame()
daily_20150130_addname_dataframe['cname'] = daily_20150130_tscode_list
for table_name in daily_20150130.columns.values.tolist():
    daily_20150130_addname_dataframe[table_name] = daily_20150130[table_name]
print("daily_20150130 返回数据 row 行数 = "+str(daily_20150130.shape[0]))
daily_20150130_addname_dataframe.to_excel(daily_201501_excel_writer,'30_5',index=False)
daily_201501_excel_writer.save()
daily_20150131 = pro.daily(start_date='',end_date='',trade_date='20150131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150131_tscode_list = list() 
for ts_code_sh in daily_20150131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150131_tscode_list.append(stock_name)
daily_20150131_addname_dataframe=pd.DataFrame()
daily_20150131_addname_dataframe['cname'] = daily_20150131_tscode_list
for table_name in daily_20150131.columns.values.tolist():
    daily_20150131_addname_dataframe[table_name] = daily_20150131[table_name]
print("daily_20150131 返回数据 row 行数 = "+str(daily_20150131.shape[0]))
daily_20150131_addname_dataframe.to_excel(daily_201501_excel_writer,'31_6',index=False)
daily_201501_excel_writer.save()




createexcel('daily_201502.xlsx')
daily_201502_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201502.xlsx')
daily_201502_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201502.xlsx', engine='openpyxl')
daily_201502_excel_writer.book = daily_201502_book
daily_201502_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201502_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150201")       ###  更新 记录日期
daily_20150201 = pro.daily(start_date='',end_date='',trade_date='20150201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150201_tscode_list = list() 
for ts_code_sh in daily_20150201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150201_tscode_list.append(stock_name)
daily_20150201_addname_dataframe=pd.DataFrame()
daily_20150201_addname_dataframe['cname'] = daily_20150201_tscode_list
for table_name in daily_20150201.columns.values.tolist():
    daily_20150201_addname_dataframe[table_name] = daily_20150201[table_name]
print("daily_20150201 返回数据 row 行数 = "+str(daily_20150201.shape[0]))
daily_20150201_addname_dataframe.to_excel(daily_201502_excel_writer,'1_7',index=False)
daily_201502_excel_writer.save()
daily_20150202 = pro.daily(start_date='',end_date='',trade_date='20150202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150202_tscode_list = list() 
for ts_code_sh in daily_20150202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150202_tscode_list.append(stock_name)
daily_20150202_addname_dataframe=pd.DataFrame()
daily_20150202_addname_dataframe['cname'] = daily_20150202_tscode_list
for table_name in daily_20150202.columns.values.tolist():
    daily_20150202_addname_dataframe[table_name] = daily_20150202[table_name]
print("daily_20150202 返回数据 row 行数 = "+str(daily_20150202.shape[0]))
daily_20150202_addname_dataframe.to_excel(daily_201502_excel_writer,'2_1',index=False)
daily_201502_excel_writer.save()
daily_20150203 = pro.daily(start_date='',end_date='',trade_date='20150203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150203_tscode_list = list() 
for ts_code_sh in daily_20150203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150203_tscode_list.append(stock_name)
daily_20150203_addname_dataframe=pd.DataFrame()
daily_20150203_addname_dataframe['cname'] = daily_20150203_tscode_list
for table_name in daily_20150203.columns.values.tolist():
    daily_20150203_addname_dataframe[table_name] = daily_20150203[table_name]
print("daily_20150203 返回数据 row 行数 = "+str(daily_20150203.shape[0]))
daily_20150203_addname_dataframe.to_excel(daily_201502_excel_writer,'3_2',index=False)
daily_201502_excel_writer.save()
daily_20150204 = pro.daily(start_date='',end_date='',trade_date='20150204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150204_tscode_list = list() 
for ts_code_sh in daily_20150204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150204_tscode_list.append(stock_name)
daily_20150204_addname_dataframe=pd.DataFrame()
daily_20150204_addname_dataframe['cname'] = daily_20150204_tscode_list
for table_name in daily_20150204.columns.values.tolist():
    daily_20150204_addname_dataframe[table_name] = daily_20150204[table_name]
print("daily_20150204 返回数据 row 行数 = "+str(daily_20150204.shape[0]))
daily_20150204_addname_dataframe.to_excel(daily_201502_excel_writer,'4_3',index=False)
daily_201502_excel_writer.save()
daily_20150205 = pro.daily(start_date='',end_date='',trade_date='20150205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150205_tscode_list = list() 
for ts_code_sh in daily_20150205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150205_tscode_list.append(stock_name)
daily_20150205_addname_dataframe=pd.DataFrame()
daily_20150205_addname_dataframe['cname'] = daily_20150205_tscode_list
for table_name in daily_20150205.columns.values.tolist():
    daily_20150205_addname_dataframe[table_name] = daily_20150205[table_name]
print("daily_20150205 返回数据 row 行数 = "+str(daily_20150205.shape[0]))
daily_20150205_addname_dataframe.to_excel(daily_201502_excel_writer,'5_4',index=False)
daily_201502_excel_writer.save()
daily_20150206 = pro.daily(start_date='',end_date='',trade_date='20150206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150206_tscode_list = list() 
for ts_code_sh in daily_20150206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150206_tscode_list.append(stock_name)
daily_20150206_addname_dataframe=pd.DataFrame()
daily_20150206_addname_dataframe['cname'] = daily_20150206_tscode_list
for table_name in daily_20150206.columns.values.tolist():
    daily_20150206_addname_dataframe[table_name] = daily_20150206[table_name]
print("daily_20150206 返回数据 row 行数 = "+str(daily_20150206.shape[0]))
daily_20150206_addname_dataframe.to_excel(daily_201502_excel_writer,'6_5',index=False)
daily_201502_excel_writer.save()
daily_20150207 = pro.daily(start_date='',end_date='',trade_date='20150207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150207_tscode_list = list() 
for ts_code_sh in daily_20150207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150207_tscode_list.append(stock_name)
daily_20150207_addname_dataframe=pd.DataFrame()
daily_20150207_addname_dataframe['cname'] = daily_20150207_tscode_list
for table_name in daily_20150207.columns.values.tolist():
    daily_20150207_addname_dataframe[table_name] = daily_20150207[table_name]
print("daily_20150207 返回数据 row 行数 = "+str(daily_20150207.shape[0]))
daily_20150207_addname_dataframe.to_excel(daily_201502_excel_writer,'7_6',index=False)
daily_201502_excel_writer.save()
daily_20150208 = pro.daily(start_date='',end_date='',trade_date='20150208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150208_tscode_list = list() 
for ts_code_sh in daily_20150208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150208_tscode_list.append(stock_name)
daily_20150208_addname_dataframe=pd.DataFrame()
daily_20150208_addname_dataframe['cname'] = daily_20150208_tscode_list
for table_name in daily_20150208.columns.values.tolist():
    daily_20150208_addname_dataframe[table_name] = daily_20150208[table_name]
print("daily_20150208 返回数据 row 行数 = "+str(daily_20150208.shape[0]))
daily_20150208_addname_dataframe.to_excel(daily_201502_excel_writer,'8_7',index=False)
daily_201502_excel_writer.save()
daily_20150209 = pro.daily(start_date='',end_date='',trade_date='20150209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150209_tscode_list = list() 
for ts_code_sh in daily_20150209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150209_tscode_list.append(stock_name)
daily_20150209_addname_dataframe=pd.DataFrame()
daily_20150209_addname_dataframe['cname'] = daily_20150209_tscode_list
for table_name in daily_20150209.columns.values.tolist():
    daily_20150209_addname_dataframe[table_name] = daily_20150209[table_name]
print("daily_20150209 返回数据 row 行数 = "+str(daily_20150209.shape[0]))
daily_20150209_addname_dataframe.to_excel(daily_201502_excel_writer,'9_1',index=False)
daily_201502_excel_writer.save()
daily_20150210 = pro.daily(start_date='',end_date='',trade_date='20150210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150210_tscode_list = list() 
for ts_code_sh in daily_20150210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150210_tscode_list.append(stock_name)
daily_20150210_addname_dataframe=pd.DataFrame()
daily_20150210_addname_dataframe['cname'] = daily_20150210_tscode_list
for table_name in daily_20150210.columns.values.tolist():
    daily_20150210_addname_dataframe[table_name] = daily_20150210[table_name]
print("daily_20150210 返回数据 row 行数 = "+str(daily_20150210.shape[0]))
daily_20150210_addname_dataframe.to_excel(daily_201502_excel_writer,'10_2',index=False)
daily_201502_excel_writer.save()
daily_20150211 = pro.daily(start_date='',end_date='',trade_date='20150211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150211_tscode_list = list() 
for ts_code_sh in daily_20150211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150211_tscode_list.append(stock_name)
daily_20150211_addname_dataframe=pd.DataFrame()
daily_20150211_addname_dataframe['cname'] = daily_20150211_tscode_list
for table_name in daily_20150211.columns.values.tolist():
    daily_20150211_addname_dataframe[table_name] = daily_20150211[table_name]
print("daily_20150211 返回数据 row 行数 = "+str(daily_20150211.shape[0]))
daily_20150211_addname_dataframe.to_excel(daily_201502_excel_writer,'11_3',index=False)
daily_201502_excel_writer.save()
daily_20150212 = pro.daily(start_date='',end_date='',trade_date='20150212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150212_tscode_list = list() 
for ts_code_sh in daily_20150212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150212_tscode_list.append(stock_name)
daily_20150212_addname_dataframe=pd.DataFrame()
daily_20150212_addname_dataframe['cname'] = daily_20150212_tscode_list
for table_name in daily_20150212.columns.values.tolist():
    daily_20150212_addname_dataframe[table_name] = daily_20150212[table_name]
print("daily_20150212 返回数据 row 行数 = "+str(daily_20150212.shape[0]))
daily_20150212_addname_dataframe.to_excel(daily_201502_excel_writer,'12_4',index=False)
daily_201502_excel_writer.save()
daily_20150213 = pro.daily(start_date='',end_date='',trade_date='20150213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150213_tscode_list = list() 
for ts_code_sh in daily_20150213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150213_tscode_list.append(stock_name)
daily_20150213_addname_dataframe=pd.DataFrame()
daily_20150213_addname_dataframe['cname'] = daily_20150213_tscode_list
for table_name in daily_20150213.columns.values.tolist():
    daily_20150213_addname_dataframe[table_name] = daily_20150213[table_name]
print("daily_20150213 返回数据 row 行数 = "+str(daily_20150213.shape[0]))
daily_20150213_addname_dataframe.to_excel(daily_201502_excel_writer,'13_5',index=False)
daily_201502_excel_writer.save()
daily_20150214 = pro.daily(start_date='',end_date='',trade_date='20150214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150214_tscode_list = list() 
for ts_code_sh in daily_20150214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150214_tscode_list.append(stock_name)
daily_20150214_addname_dataframe=pd.DataFrame()
daily_20150214_addname_dataframe['cname'] = daily_20150214_tscode_list
for table_name in daily_20150214.columns.values.tolist():
    daily_20150214_addname_dataframe[table_name] = daily_20150214[table_name]
print("daily_20150214 返回数据 row 行数 = "+str(daily_20150214.shape[0]))
daily_20150214_addname_dataframe.to_excel(daily_201502_excel_writer,'14_6',index=False)
daily_201502_excel_writer.save()
daily_20150215 = pro.daily(start_date='',end_date='',trade_date='20150215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150215_tscode_list = list() 
for ts_code_sh in daily_20150215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150215_tscode_list.append(stock_name)
daily_20150215_addname_dataframe=pd.DataFrame()
daily_20150215_addname_dataframe['cname'] = daily_20150215_tscode_list
for table_name in daily_20150215.columns.values.tolist():
    daily_20150215_addname_dataframe[table_name] = daily_20150215[table_name]
print("daily_20150215 返回数据 row 行数 = "+str(daily_20150215.shape[0]))
daily_20150215_addname_dataframe.to_excel(daily_201502_excel_writer,'15_7',index=False)
daily_201502_excel_writer.save()
daily_20150216 = pro.daily(start_date='',end_date='',trade_date='20150216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150216_tscode_list = list() 
for ts_code_sh in daily_20150216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150216_tscode_list.append(stock_name)
daily_20150216_addname_dataframe=pd.DataFrame()
daily_20150216_addname_dataframe['cname'] = daily_20150216_tscode_list
for table_name in daily_20150216.columns.values.tolist():
    daily_20150216_addname_dataframe[table_name] = daily_20150216[table_name]
print("daily_20150216 返回数据 row 行数 = "+str(daily_20150216.shape[0]))
daily_20150216_addname_dataframe.to_excel(daily_201502_excel_writer,'16_1',index=False)
daily_201502_excel_writer.save()
daily_20150217 = pro.daily(start_date='',end_date='',trade_date='20150217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150217_tscode_list = list() 
for ts_code_sh in daily_20150217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150217_tscode_list.append(stock_name)
daily_20150217_addname_dataframe=pd.DataFrame()
daily_20150217_addname_dataframe['cname'] = daily_20150217_tscode_list
for table_name in daily_20150217.columns.values.tolist():
    daily_20150217_addname_dataframe[table_name] = daily_20150217[table_name]
print("daily_20150217 返回数据 row 行数 = "+str(daily_20150217.shape[0]))
daily_20150217_addname_dataframe.to_excel(daily_201502_excel_writer,'17_2',index=False)
daily_201502_excel_writer.save()
daily_20150218 = pro.daily(start_date='',end_date='',trade_date='20150218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150218_tscode_list = list() 
for ts_code_sh in daily_20150218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150218_tscode_list.append(stock_name)
daily_20150218_addname_dataframe=pd.DataFrame()
daily_20150218_addname_dataframe['cname'] = daily_20150218_tscode_list
for table_name in daily_20150218.columns.values.tolist():
    daily_20150218_addname_dataframe[table_name] = daily_20150218[table_name]
print("daily_20150218 返回数据 row 行数 = "+str(daily_20150218.shape[0]))
daily_20150218_addname_dataframe.to_excel(daily_201502_excel_writer,'18_3',index=False)
daily_201502_excel_writer.save()
daily_20150219 = pro.daily(start_date='',end_date='',trade_date='20150219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150219_tscode_list = list() 
for ts_code_sh in daily_20150219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150219_tscode_list.append(stock_name)
daily_20150219_addname_dataframe=pd.DataFrame()
daily_20150219_addname_dataframe['cname'] = daily_20150219_tscode_list
for table_name in daily_20150219.columns.values.tolist():
    daily_20150219_addname_dataframe[table_name] = daily_20150219[table_name]
print("daily_20150219 返回数据 row 行数 = "+str(daily_20150219.shape[0]))
daily_20150219_addname_dataframe.to_excel(daily_201502_excel_writer,'19_4',index=False)
daily_201502_excel_writer.save()
daily_20150220 = pro.daily(start_date='',end_date='',trade_date='20150220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150220_tscode_list = list() 
for ts_code_sh in daily_20150220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150220_tscode_list.append(stock_name)
daily_20150220_addname_dataframe=pd.DataFrame()
daily_20150220_addname_dataframe['cname'] = daily_20150220_tscode_list
for table_name in daily_20150220.columns.values.tolist():
    daily_20150220_addname_dataframe[table_name] = daily_20150220[table_name]
print("daily_20150220 返回数据 row 行数 = "+str(daily_20150220.shape[0]))
daily_20150220_addname_dataframe.to_excel(daily_201502_excel_writer,'20_5',index=False)
daily_201502_excel_writer.save()
daily_20150221 = pro.daily(start_date='',end_date='',trade_date='20150221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150221_tscode_list = list() 
for ts_code_sh in daily_20150221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150221_tscode_list.append(stock_name)
daily_20150221_addname_dataframe=pd.DataFrame()
daily_20150221_addname_dataframe['cname'] = daily_20150221_tscode_list
for table_name in daily_20150221.columns.values.tolist():
    daily_20150221_addname_dataframe[table_name] = daily_20150221[table_name]
print("daily_20150221 返回数据 row 行数 = "+str(daily_20150221.shape[0]))
daily_20150221_addname_dataframe.to_excel(daily_201502_excel_writer,'21_6',index=False)
daily_201502_excel_writer.save()
daily_20150222 = pro.daily(start_date='',end_date='',trade_date='20150222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150222_tscode_list = list() 
for ts_code_sh in daily_20150222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150222_tscode_list.append(stock_name)
daily_20150222_addname_dataframe=pd.DataFrame()
daily_20150222_addname_dataframe['cname'] = daily_20150222_tscode_list
for table_name in daily_20150222.columns.values.tolist():
    daily_20150222_addname_dataframe[table_name] = daily_20150222[table_name]
print("daily_20150222 返回数据 row 行数 = "+str(daily_20150222.shape[0]))
daily_20150222_addname_dataframe.to_excel(daily_201502_excel_writer,'22_7',index=False)
daily_201502_excel_writer.save()
daily_20150223 = pro.daily(start_date='',end_date='',trade_date='20150223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150223_tscode_list = list() 
for ts_code_sh in daily_20150223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150223_tscode_list.append(stock_name)
daily_20150223_addname_dataframe=pd.DataFrame()
daily_20150223_addname_dataframe['cname'] = daily_20150223_tscode_list
for table_name in daily_20150223.columns.values.tolist():
    daily_20150223_addname_dataframe[table_name] = daily_20150223[table_name]
print("daily_20150223 返回数据 row 行数 = "+str(daily_20150223.shape[0]))
daily_20150223_addname_dataframe.to_excel(daily_201502_excel_writer,'23_1',index=False)
daily_201502_excel_writer.save()
daily_20150224 = pro.daily(start_date='',end_date='',trade_date='20150224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150224_tscode_list = list() 
for ts_code_sh in daily_20150224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150224_tscode_list.append(stock_name)
daily_20150224_addname_dataframe=pd.DataFrame()
daily_20150224_addname_dataframe['cname'] = daily_20150224_tscode_list
for table_name in daily_20150224.columns.values.tolist():
    daily_20150224_addname_dataframe[table_name] = daily_20150224[table_name]
print("daily_20150224 返回数据 row 行数 = "+str(daily_20150224.shape[0]))
daily_20150224_addname_dataframe.to_excel(daily_201502_excel_writer,'24_2',index=False)
daily_201502_excel_writer.save()
daily_20150225 = pro.daily(start_date='',end_date='',trade_date='20150225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150225_tscode_list = list() 
for ts_code_sh in daily_20150225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150225_tscode_list.append(stock_name)
daily_20150225_addname_dataframe=pd.DataFrame()
daily_20150225_addname_dataframe['cname'] = daily_20150225_tscode_list
for table_name in daily_20150225.columns.values.tolist():
    daily_20150225_addname_dataframe[table_name] = daily_20150225[table_name]
print("daily_20150225 返回数据 row 行数 = "+str(daily_20150225.shape[0]))
daily_20150225_addname_dataframe.to_excel(daily_201502_excel_writer,'25_3',index=False)
daily_201502_excel_writer.save()
daily_20150226 = pro.daily(start_date='',end_date='',trade_date='20150226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150226_tscode_list = list() 
for ts_code_sh in daily_20150226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150226_tscode_list.append(stock_name)
daily_20150226_addname_dataframe=pd.DataFrame()
daily_20150226_addname_dataframe['cname'] = daily_20150226_tscode_list
for table_name in daily_20150226.columns.values.tolist():
    daily_20150226_addname_dataframe[table_name] = daily_20150226[table_name]
print("daily_20150226 返回数据 row 行数 = "+str(daily_20150226.shape[0]))
daily_20150226_addname_dataframe.to_excel(daily_201502_excel_writer,'26_4',index=False)
daily_201502_excel_writer.save()
daily_20150227 = pro.daily(start_date='',end_date='',trade_date='20150227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150227_tscode_list = list() 
for ts_code_sh in daily_20150227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150227_tscode_list.append(stock_name)
daily_20150227_addname_dataframe=pd.DataFrame()
daily_20150227_addname_dataframe['cname'] = daily_20150227_tscode_list
for table_name in daily_20150227.columns.values.tolist():
    daily_20150227_addname_dataframe[table_name] = daily_20150227[table_name]
print("daily_20150227 返回数据 row 行数 = "+str(daily_20150227.shape[0]))
daily_20150227_addname_dataframe.to_excel(daily_201502_excel_writer,'27_5',index=False)
daily_201502_excel_writer.save()
daily_20150228 = pro.daily(start_date='',end_date='',trade_date='20150228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150228_tscode_list = list() 
for ts_code_sh in daily_20150228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150228_tscode_list.append(stock_name)
daily_20150228_addname_dataframe=pd.DataFrame()
daily_20150228_addname_dataframe['cname'] = daily_20150228_tscode_list
for table_name in daily_20150228.columns.values.tolist():
    daily_20150228_addname_dataframe[table_name] = daily_20150228[table_name]
print("daily_20150228 返回数据 row 行数 = "+str(daily_20150228.shape[0]))
daily_20150228_addname_dataframe.to_excel(daily_201502_excel_writer,'28_6',index=False)
daily_201502_excel_writer.save()




createexcel('daily_201503.xlsx')
daily_201503_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201503.xlsx')
daily_201503_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201503.xlsx', engine='openpyxl')
daily_201503_excel_writer.book = daily_201503_book
daily_201503_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201503_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150301")       ###  更新 记录日期
daily_20150301 = pro.daily(start_date='',end_date='',trade_date='20150301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150301_tscode_list = list() 
for ts_code_sh in daily_20150301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150301_tscode_list.append(stock_name)
daily_20150301_addname_dataframe=pd.DataFrame()
daily_20150301_addname_dataframe['cname'] = daily_20150301_tscode_list
for table_name in daily_20150301.columns.values.tolist():
    daily_20150301_addname_dataframe[table_name] = daily_20150301[table_name]
print("daily_20150301 返回数据 row 行数 = "+str(daily_20150301.shape[0]))
daily_20150301_addname_dataframe.to_excel(daily_201503_excel_writer,'1_7',index=False)
daily_201503_excel_writer.save()
daily_20150302 = pro.daily(start_date='',end_date='',trade_date='20150302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150302_tscode_list = list() 
for ts_code_sh in daily_20150302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150302_tscode_list.append(stock_name)
daily_20150302_addname_dataframe=pd.DataFrame()
daily_20150302_addname_dataframe['cname'] = daily_20150302_tscode_list
for table_name in daily_20150302.columns.values.tolist():
    daily_20150302_addname_dataframe[table_name] = daily_20150302[table_name]
print("daily_20150302 返回数据 row 行数 = "+str(daily_20150302.shape[0]))
daily_20150302_addname_dataframe.to_excel(daily_201503_excel_writer,'2_1',index=False)
daily_201503_excel_writer.save()
daily_20150303 = pro.daily(start_date='',end_date='',trade_date='20150303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150303_tscode_list = list() 
for ts_code_sh in daily_20150303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150303_tscode_list.append(stock_name)
daily_20150303_addname_dataframe=pd.DataFrame()
daily_20150303_addname_dataframe['cname'] = daily_20150303_tscode_list
for table_name in daily_20150303.columns.values.tolist():
    daily_20150303_addname_dataframe[table_name] = daily_20150303[table_name]
print("daily_20150303 返回数据 row 行数 = "+str(daily_20150303.shape[0]))
daily_20150303_addname_dataframe.to_excel(daily_201503_excel_writer,'3_2',index=False)
daily_201503_excel_writer.save()
daily_20150304 = pro.daily(start_date='',end_date='',trade_date='20150304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150304_tscode_list = list() 
for ts_code_sh in daily_20150304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150304_tscode_list.append(stock_name)
daily_20150304_addname_dataframe=pd.DataFrame()
daily_20150304_addname_dataframe['cname'] = daily_20150304_tscode_list
for table_name in daily_20150304.columns.values.tolist():
    daily_20150304_addname_dataframe[table_name] = daily_20150304[table_name]
print("daily_20150304 返回数据 row 行数 = "+str(daily_20150304.shape[0]))
daily_20150304_addname_dataframe.to_excel(daily_201503_excel_writer,'4_3',index=False)
daily_201503_excel_writer.save()
daily_20150305 = pro.daily(start_date='',end_date='',trade_date='20150305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150305_tscode_list = list() 
for ts_code_sh in daily_20150305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150305_tscode_list.append(stock_name)
daily_20150305_addname_dataframe=pd.DataFrame()
daily_20150305_addname_dataframe['cname'] = daily_20150305_tscode_list
for table_name in daily_20150305.columns.values.tolist():
    daily_20150305_addname_dataframe[table_name] = daily_20150305[table_name]
print("daily_20150305 返回数据 row 行数 = "+str(daily_20150305.shape[0]))
daily_20150305_addname_dataframe.to_excel(daily_201503_excel_writer,'5_4',index=False)
daily_201503_excel_writer.save()
daily_20150306 = pro.daily(start_date='',end_date='',trade_date='20150306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150306_tscode_list = list() 
for ts_code_sh in daily_20150306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150306_tscode_list.append(stock_name)
daily_20150306_addname_dataframe=pd.DataFrame()
daily_20150306_addname_dataframe['cname'] = daily_20150306_tscode_list
for table_name in daily_20150306.columns.values.tolist():
    daily_20150306_addname_dataframe[table_name] = daily_20150306[table_name]
print("daily_20150306 返回数据 row 行数 = "+str(daily_20150306.shape[0]))
daily_20150306_addname_dataframe.to_excel(daily_201503_excel_writer,'6_5',index=False)
daily_201503_excel_writer.save()
daily_20150307 = pro.daily(start_date='',end_date='',trade_date='20150307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150307_tscode_list = list() 
for ts_code_sh in daily_20150307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150307_tscode_list.append(stock_name)
daily_20150307_addname_dataframe=pd.DataFrame()
daily_20150307_addname_dataframe['cname'] = daily_20150307_tscode_list
for table_name in daily_20150307.columns.values.tolist():
    daily_20150307_addname_dataframe[table_name] = daily_20150307[table_name]
print("daily_20150307 返回数据 row 行数 = "+str(daily_20150307.shape[0]))
daily_20150307_addname_dataframe.to_excel(daily_201503_excel_writer,'7_6',index=False)
daily_201503_excel_writer.save()
daily_20150308 = pro.daily(start_date='',end_date='',trade_date='20150308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150308_tscode_list = list() 
for ts_code_sh in daily_20150308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150308_tscode_list.append(stock_name)
daily_20150308_addname_dataframe=pd.DataFrame()
daily_20150308_addname_dataframe['cname'] = daily_20150308_tscode_list
for table_name in daily_20150308.columns.values.tolist():
    daily_20150308_addname_dataframe[table_name] = daily_20150308[table_name]
print("daily_20150308 返回数据 row 行数 = "+str(daily_20150308.shape[0]))
daily_20150308_addname_dataframe.to_excel(daily_201503_excel_writer,'8_7',index=False)
daily_201503_excel_writer.save()
daily_20150309 = pro.daily(start_date='',end_date='',trade_date='20150309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150309_tscode_list = list() 
for ts_code_sh in daily_20150309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150309_tscode_list.append(stock_name)
daily_20150309_addname_dataframe=pd.DataFrame()
daily_20150309_addname_dataframe['cname'] = daily_20150309_tscode_list
for table_name in daily_20150309.columns.values.tolist():
    daily_20150309_addname_dataframe[table_name] = daily_20150309[table_name]
print("daily_20150309 返回数据 row 行数 = "+str(daily_20150309.shape[0]))
daily_20150309_addname_dataframe.to_excel(daily_201503_excel_writer,'9_1',index=False)
daily_201503_excel_writer.save()
daily_20150310 = pro.daily(start_date='',end_date='',trade_date='20150310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150310_tscode_list = list() 
for ts_code_sh in daily_20150310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150310_tscode_list.append(stock_name)
daily_20150310_addname_dataframe=pd.DataFrame()
daily_20150310_addname_dataframe['cname'] = daily_20150310_tscode_list
for table_name in daily_20150310.columns.values.tolist():
    daily_20150310_addname_dataframe[table_name] = daily_20150310[table_name]
print("daily_20150310 返回数据 row 行数 = "+str(daily_20150310.shape[0]))
daily_20150310_addname_dataframe.to_excel(daily_201503_excel_writer,'10_2',index=False)
daily_201503_excel_writer.save()
daily_20150311 = pro.daily(start_date='',end_date='',trade_date='20150311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150311_tscode_list = list() 
for ts_code_sh in daily_20150311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150311_tscode_list.append(stock_name)
daily_20150311_addname_dataframe=pd.DataFrame()
daily_20150311_addname_dataframe['cname'] = daily_20150311_tscode_list
for table_name in daily_20150311.columns.values.tolist():
    daily_20150311_addname_dataframe[table_name] = daily_20150311[table_name]
print("daily_20150311 返回数据 row 行数 = "+str(daily_20150311.shape[0]))
daily_20150311_addname_dataframe.to_excel(daily_201503_excel_writer,'11_3',index=False)
daily_201503_excel_writer.save()
daily_20150312 = pro.daily(start_date='',end_date='',trade_date='20150312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150312_tscode_list = list() 
for ts_code_sh in daily_20150312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150312_tscode_list.append(stock_name)
daily_20150312_addname_dataframe=pd.DataFrame()
daily_20150312_addname_dataframe['cname'] = daily_20150312_tscode_list
for table_name in daily_20150312.columns.values.tolist():
    daily_20150312_addname_dataframe[table_name] = daily_20150312[table_name]
print("daily_20150312 返回数据 row 行数 = "+str(daily_20150312.shape[0]))
daily_20150312_addname_dataframe.to_excel(daily_201503_excel_writer,'12_4',index=False)
daily_201503_excel_writer.save()
daily_20150313 = pro.daily(start_date='',end_date='',trade_date='20150313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150313_tscode_list = list() 
for ts_code_sh in daily_20150313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150313_tscode_list.append(stock_name)
daily_20150313_addname_dataframe=pd.DataFrame()
daily_20150313_addname_dataframe['cname'] = daily_20150313_tscode_list
for table_name in daily_20150313.columns.values.tolist():
    daily_20150313_addname_dataframe[table_name] = daily_20150313[table_name]
print("daily_20150313 返回数据 row 行数 = "+str(daily_20150313.shape[0]))
daily_20150313_addname_dataframe.to_excel(daily_201503_excel_writer,'13_5',index=False)
daily_201503_excel_writer.save()
daily_20150314 = pro.daily(start_date='',end_date='',trade_date='20150314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150314_tscode_list = list() 
for ts_code_sh in daily_20150314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150314_tscode_list.append(stock_name)
daily_20150314_addname_dataframe=pd.DataFrame()
daily_20150314_addname_dataframe['cname'] = daily_20150314_tscode_list
for table_name in daily_20150314.columns.values.tolist():
    daily_20150314_addname_dataframe[table_name] = daily_20150314[table_name]
print("daily_20150314 返回数据 row 行数 = "+str(daily_20150314.shape[0]))
daily_20150314_addname_dataframe.to_excel(daily_201503_excel_writer,'14_6',index=False)
daily_201503_excel_writer.save()
daily_20150315 = pro.daily(start_date='',end_date='',trade_date='20150315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150315_tscode_list = list() 
for ts_code_sh in daily_20150315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150315_tscode_list.append(stock_name)
daily_20150315_addname_dataframe=pd.DataFrame()
daily_20150315_addname_dataframe['cname'] = daily_20150315_tscode_list
for table_name in daily_20150315.columns.values.tolist():
    daily_20150315_addname_dataframe[table_name] = daily_20150315[table_name]
print("daily_20150315 返回数据 row 行数 = "+str(daily_20150315.shape[0]))
daily_20150315_addname_dataframe.to_excel(daily_201503_excel_writer,'15_7',index=False)
daily_201503_excel_writer.save()
daily_20150316 = pro.daily(start_date='',end_date='',trade_date='20150316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150316_tscode_list = list() 
for ts_code_sh in daily_20150316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150316_tscode_list.append(stock_name)
daily_20150316_addname_dataframe=pd.DataFrame()
daily_20150316_addname_dataframe['cname'] = daily_20150316_tscode_list
for table_name in daily_20150316.columns.values.tolist():
    daily_20150316_addname_dataframe[table_name] = daily_20150316[table_name]
print("daily_20150316 返回数据 row 行数 = "+str(daily_20150316.shape[0]))
daily_20150316_addname_dataframe.to_excel(daily_201503_excel_writer,'16_1',index=False)
daily_201503_excel_writer.save()
daily_20150317 = pro.daily(start_date='',end_date='',trade_date='20150317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150317_tscode_list = list() 
for ts_code_sh in daily_20150317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150317_tscode_list.append(stock_name)
daily_20150317_addname_dataframe=pd.DataFrame()
daily_20150317_addname_dataframe['cname'] = daily_20150317_tscode_list
for table_name in daily_20150317.columns.values.tolist():
    daily_20150317_addname_dataframe[table_name] = daily_20150317[table_name]
print("daily_20150317 返回数据 row 行数 = "+str(daily_20150317.shape[0]))
daily_20150317_addname_dataframe.to_excel(daily_201503_excel_writer,'17_2',index=False)
daily_201503_excel_writer.save()
daily_20150318 = pro.daily(start_date='',end_date='',trade_date='20150318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150318_tscode_list = list() 
for ts_code_sh in daily_20150318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150318_tscode_list.append(stock_name)
daily_20150318_addname_dataframe=pd.DataFrame()
daily_20150318_addname_dataframe['cname'] = daily_20150318_tscode_list
for table_name in daily_20150318.columns.values.tolist():
    daily_20150318_addname_dataframe[table_name] = daily_20150318[table_name]
print("daily_20150318 返回数据 row 行数 = "+str(daily_20150318.shape[0]))
daily_20150318_addname_dataframe.to_excel(daily_201503_excel_writer,'18_3',index=False)
daily_201503_excel_writer.save()
daily_20150319 = pro.daily(start_date='',end_date='',trade_date='20150319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150319_tscode_list = list() 
for ts_code_sh in daily_20150319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150319_tscode_list.append(stock_name)
daily_20150319_addname_dataframe=pd.DataFrame()
daily_20150319_addname_dataframe['cname'] = daily_20150319_tscode_list
for table_name in daily_20150319.columns.values.tolist():
    daily_20150319_addname_dataframe[table_name] = daily_20150319[table_name]
print("daily_20150319 返回数据 row 行数 = "+str(daily_20150319.shape[0]))
daily_20150319_addname_dataframe.to_excel(daily_201503_excel_writer,'19_4',index=False)
daily_201503_excel_writer.save()
daily_20150320 = pro.daily(start_date='',end_date='',trade_date='20150320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150320_tscode_list = list() 
for ts_code_sh in daily_20150320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150320_tscode_list.append(stock_name)
daily_20150320_addname_dataframe=pd.DataFrame()
daily_20150320_addname_dataframe['cname'] = daily_20150320_tscode_list
for table_name in daily_20150320.columns.values.tolist():
    daily_20150320_addname_dataframe[table_name] = daily_20150320[table_name]
print("daily_20150320 返回数据 row 行数 = "+str(daily_20150320.shape[0]))
daily_20150320_addname_dataframe.to_excel(daily_201503_excel_writer,'20_5',index=False)
daily_201503_excel_writer.save()
daily_20150321 = pro.daily(start_date='',end_date='',trade_date='20150321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150321_tscode_list = list() 
for ts_code_sh in daily_20150321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150321_tscode_list.append(stock_name)
daily_20150321_addname_dataframe=pd.DataFrame()
daily_20150321_addname_dataframe['cname'] = daily_20150321_tscode_list
for table_name in daily_20150321.columns.values.tolist():
    daily_20150321_addname_dataframe[table_name] = daily_20150321[table_name]
print("daily_20150321 返回数据 row 行数 = "+str(daily_20150321.shape[0]))
daily_20150321_addname_dataframe.to_excel(daily_201503_excel_writer,'21_6',index=False)
daily_201503_excel_writer.save()
daily_20150322 = pro.daily(start_date='',end_date='',trade_date='20150322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150322_tscode_list = list() 
for ts_code_sh in daily_20150322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150322_tscode_list.append(stock_name)
daily_20150322_addname_dataframe=pd.DataFrame()
daily_20150322_addname_dataframe['cname'] = daily_20150322_tscode_list
for table_name in daily_20150322.columns.values.tolist():
    daily_20150322_addname_dataframe[table_name] = daily_20150322[table_name]
print("daily_20150322 返回数据 row 行数 = "+str(daily_20150322.shape[0]))
daily_20150322_addname_dataframe.to_excel(daily_201503_excel_writer,'22_7',index=False)
daily_201503_excel_writer.save()
daily_20150323 = pro.daily(start_date='',end_date='',trade_date='20150323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150323_tscode_list = list() 
for ts_code_sh in daily_20150323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150323_tscode_list.append(stock_name)
daily_20150323_addname_dataframe=pd.DataFrame()
daily_20150323_addname_dataframe['cname'] = daily_20150323_tscode_list
for table_name in daily_20150323.columns.values.tolist():
    daily_20150323_addname_dataframe[table_name] = daily_20150323[table_name]
print("daily_20150323 返回数据 row 行数 = "+str(daily_20150323.shape[0]))
daily_20150323_addname_dataframe.to_excel(daily_201503_excel_writer,'23_1',index=False)
daily_201503_excel_writer.save()
daily_20150324 = pro.daily(start_date='',end_date='',trade_date='20150324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150324_tscode_list = list() 
for ts_code_sh in daily_20150324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150324_tscode_list.append(stock_name)
daily_20150324_addname_dataframe=pd.DataFrame()
daily_20150324_addname_dataframe['cname'] = daily_20150324_tscode_list
for table_name in daily_20150324.columns.values.tolist():
    daily_20150324_addname_dataframe[table_name] = daily_20150324[table_name]
print("daily_20150324 返回数据 row 行数 = "+str(daily_20150324.shape[0]))
daily_20150324_addname_dataframe.to_excel(daily_201503_excel_writer,'24_2',index=False)
daily_201503_excel_writer.save()
daily_20150325 = pro.daily(start_date='',end_date='',trade_date='20150325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150325_tscode_list = list() 
for ts_code_sh in daily_20150325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150325_tscode_list.append(stock_name)
daily_20150325_addname_dataframe=pd.DataFrame()
daily_20150325_addname_dataframe['cname'] = daily_20150325_tscode_list
for table_name in daily_20150325.columns.values.tolist():
    daily_20150325_addname_dataframe[table_name] = daily_20150325[table_name]
print("daily_20150325 返回数据 row 行数 = "+str(daily_20150325.shape[0]))
daily_20150325_addname_dataframe.to_excel(daily_201503_excel_writer,'25_3',index=False)
daily_201503_excel_writer.save()
daily_20150326 = pro.daily(start_date='',end_date='',trade_date='20150326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150326_tscode_list = list() 
for ts_code_sh in daily_20150326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150326_tscode_list.append(stock_name)
daily_20150326_addname_dataframe=pd.DataFrame()
daily_20150326_addname_dataframe['cname'] = daily_20150326_tscode_list
for table_name in daily_20150326.columns.values.tolist():
    daily_20150326_addname_dataframe[table_name] = daily_20150326[table_name]
print("daily_20150326 返回数据 row 行数 = "+str(daily_20150326.shape[0]))
daily_20150326_addname_dataframe.to_excel(daily_201503_excel_writer,'26_4',index=False)
daily_201503_excel_writer.save()
daily_20150327 = pro.daily(start_date='',end_date='',trade_date='20150327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150327_tscode_list = list() 
for ts_code_sh in daily_20150327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150327_tscode_list.append(stock_name)
daily_20150327_addname_dataframe=pd.DataFrame()
daily_20150327_addname_dataframe['cname'] = daily_20150327_tscode_list
for table_name in daily_20150327.columns.values.tolist():
    daily_20150327_addname_dataframe[table_name] = daily_20150327[table_name]
print("daily_20150327 返回数据 row 行数 = "+str(daily_20150327.shape[0]))
daily_20150327_addname_dataframe.to_excel(daily_201503_excel_writer,'27_5',index=False)
daily_201503_excel_writer.save()
daily_20150328 = pro.daily(start_date='',end_date='',trade_date='20150328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150328_tscode_list = list() 
for ts_code_sh in daily_20150328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150328_tscode_list.append(stock_name)
daily_20150328_addname_dataframe=pd.DataFrame()
daily_20150328_addname_dataframe['cname'] = daily_20150328_tscode_list
for table_name in daily_20150328.columns.values.tolist():
    daily_20150328_addname_dataframe[table_name] = daily_20150328[table_name]
print("daily_20150328 返回数据 row 行数 = "+str(daily_20150328.shape[0]))
daily_20150328_addname_dataframe.to_excel(daily_201503_excel_writer,'28_6',index=False)
daily_201503_excel_writer.save()
daily_20150329 = pro.daily(start_date='',end_date='',trade_date='20150329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150329_tscode_list = list() 
for ts_code_sh in daily_20150329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150329_tscode_list.append(stock_name)
daily_20150329_addname_dataframe=pd.DataFrame()
daily_20150329_addname_dataframe['cname'] = daily_20150329_tscode_list
for table_name in daily_20150329.columns.values.tolist():
    daily_20150329_addname_dataframe[table_name] = daily_20150329[table_name]
print("daily_20150329 返回数据 row 行数 = "+str(daily_20150329.shape[0]))
daily_20150329_addname_dataframe.to_excel(daily_201503_excel_writer,'29_7',index=False)
daily_201503_excel_writer.save()
daily_20150330 = pro.daily(start_date='',end_date='',trade_date='20150330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150330_tscode_list = list() 
for ts_code_sh in daily_20150330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150330_tscode_list.append(stock_name)
daily_20150330_addname_dataframe=pd.DataFrame()
daily_20150330_addname_dataframe['cname'] = daily_20150330_tscode_list
for table_name in daily_20150330.columns.values.tolist():
    daily_20150330_addname_dataframe[table_name] = daily_20150330[table_name]
print("daily_20150330 返回数据 row 行数 = "+str(daily_20150330.shape[0]))
daily_20150330_addname_dataframe.to_excel(daily_201503_excel_writer,'30_1',index=False)
daily_201503_excel_writer.save()
daily_20150331 = pro.daily(start_date='',end_date='',trade_date='20150331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150331_tscode_list = list() 
for ts_code_sh in daily_20150331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150331_tscode_list.append(stock_name)
daily_20150331_addname_dataframe=pd.DataFrame()
daily_20150331_addname_dataframe['cname'] = daily_20150331_tscode_list
for table_name in daily_20150331.columns.values.tolist():
    daily_20150331_addname_dataframe[table_name] = daily_20150331[table_name]
print("daily_20150331 返回数据 row 行数 = "+str(daily_20150331.shape[0]))
daily_20150331_addname_dataframe.to_excel(daily_201503_excel_writer,'31_2',index=False)
daily_201503_excel_writer.save()




createexcel('daily_201504.xlsx')
daily_201504_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201504.xlsx')
daily_201504_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201504.xlsx', engine='openpyxl')
daily_201504_excel_writer.book = daily_201504_book
daily_201504_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201504_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150401")       ###  更新 记录日期
daily_20150401 = pro.daily(start_date='',end_date='',trade_date='20150401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150401_tscode_list = list() 
for ts_code_sh in daily_20150401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150401_tscode_list.append(stock_name)
daily_20150401_addname_dataframe=pd.DataFrame()
daily_20150401_addname_dataframe['cname'] = daily_20150401_tscode_list
for table_name in daily_20150401.columns.values.tolist():
    daily_20150401_addname_dataframe[table_name] = daily_20150401[table_name]
print("daily_20150401 返回数据 row 行数 = "+str(daily_20150401.shape[0]))
daily_20150401_addname_dataframe.to_excel(daily_201504_excel_writer,'1_3',index=False)
daily_201504_excel_writer.save()
daily_20150402 = pro.daily(start_date='',end_date='',trade_date='20150402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150402_tscode_list = list() 
for ts_code_sh in daily_20150402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150402_tscode_list.append(stock_name)
daily_20150402_addname_dataframe=pd.DataFrame()
daily_20150402_addname_dataframe['cname'] = daily_20150402_tscode_list
for table_name in daily_20150402.columns.values.tolist():
    daily_20150402_addname_dataframe[table_name] = daily_20150402[table_name]
print("daily_20150402 返回数据 row 行数 = "+str(daily_20150402.shape[0]))
daily_20150402_addname_dataframe.to_excel(daily_201504_excel_writer,'2_4',index=False)
daily_201504_excel_writer.save()
daily_20150403 = pro.daily(start_date='',end_date='',trade_date='20150403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150403_tscode_list = list() 
for ts_code_sh in daily_20150403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150403_tscode_list.append(stock_name)
daily_20150403_addname_dataframe=pd.DataFrame()
daily_20150403_addname_dataframe['cname'] = daily_20150403_tscode_list
for table_name in daily_20150403.columns.values.tolist():
    daily_20150403_addname_dataframe[table_name] = daily_20150403[table_name]
print("daily_20150403 返回数据 row 行数 = "+str(daily_20150403.shape[0]))
daily_20150403_addname_dataframe.to_excel(daily_201504_excel_writer,'3_5',index=False)
daily_201504_excel_writer.save()
daily_20150404 = pro.daily(start_date='',end_date='',trade_date='20150404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150404_tscode_list = list() 
for ts_code_sh in daily_20150404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150404_tscode_list.append(stock_name)
daily_20150404_addname_dataframe=pd.DataFrame()
daily_20150404_addname_dataframe['cname'] = daily_20150404_tscode_list
for table_name in daily_20150404.columns.values.tolist():
    daily_20150404_addname_dataframe[table_name] = daily_20150404[table_name]
print("daily_20150404 返回数据 row 行数 = "+str(daily_20150404.shape[0]))
daily_20150404_addname_dataframe.to_excel(daily_201504_excel_writer,'4_6',index=False)
daily_201504_excel_writer.save()
daily_20150405 = pro.daily(start_date='',end_date='',trade_date='20150405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150405_tscode_list = list() 
for ts_code_sh in daily_20150405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150405_tscode_list.append(stock_name)
daily_20150405_addname_dataframe=pd.DataFrame()
daily_20150405_addname_dataframe['cname'] = daily_20150405_tscode_list
for table_name in daily_20150405.columns.values.tolist():
    daily_20150405_addname_dataframe[table_name] = daily_20150405[table_name]
print("daily_20150405 返回数据 row 行数 = "+str(daily_20150405.shape[0]))
daily_20150405_addname_dataframe.to_excel(daily_201504_excel_writer,'5_7',index=False)
daily_201504_excel_writer.save()
daily_20150406 = pro.daily(start_date='',end_date='',trade_date='20150406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150406_tscode_list = list() 
for ts_code_sh in daily_20150406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150406_tscode_list.append(stock_name)
daily_20150406_addname_dataframe=pd.DataFrame()
daily_20150406_addname_dataframe['cname'] = daily_20150406_tscode_list
for table_name in daily_20150406.columns.values.tolist():
    daily_20150406_addname_dataframe[table_name] = daily_20150406[table_name]
print("daily_20150406 返回数据 row 行数 = "+str(daily_20150406.shape[0]))
daily_20150406_addname_dataframe.to_excel(daily_201504_excel_writer,'6_1',index=False)
daily_201504_excel_writer.save()
daily_20150407 = pro.daily(start_date='',end_date='',trade_date='20150407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150407_tscode_list = list() 
for ts_code_sh in daily_20150407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150407_tscode_list.append(stock_name)
daily_20150407_addname_dataframe=pd.DataFrame()
daily_20150407_addname_dataframe['cname'] = daily_20150407_tscode_list
for table_name in daily_20150407.columns.values.tolist():
    daily_20150407_addname_dataframe[table_name] = daily_20150407[table_name]
print("daily_20150407 返回数据 row 行数 = "+str(daily_20150407.shape[0]))
daily_20150407_addname_dataframe.to_excel(daily_201504_excel_writer,'7_2',index=False)
daily_201504_excel_writer.save()
daily_20150408 = pro.daily(start_date='',end_date='',trade_date='20150408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150408_tscode_list = list() 
for ts_code_sh in daily_20150408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150408_tscode_list.append(stock_name)
daily_20150408_addname_dataframe=pd.DataFrame()
daily_20150408_addname_dataframe['cname'] = daily_20150408_tscode_list
for table_name in daily_20150408.columns.values.tolist():
    daily_20150408_addname_dataframe[table_name] = daily_20150408[table_name]
print("daily_20150408 返回数据 row 行数 = "+str(daily_20150408.shape[0]))
daily_20150408_addname_dataframe.to_excel(daily_201504_excel_writer,'8_3',index=False)
daily_201504_excel_writer.save()
daily_20150409 = pro.daily(start_date='',end_date='',trade_date='20150409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150409_tscode_list = list() 
for ts_code_sh in daily_20150409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150409_tscode_list.append(stock_name)
daily_20150409_addname_dataframe=pd.DataFrame()
daily_20150409_addname_dataframe['cname'] = daily_20150409_tscode_list
for table_name in daily_20150409.columns.values.tolist():
    daily_20150409_addname_dataframe[table_name] = daily_20150409[table_name]
print("daily_20150409 返回数据 row 行数 = "+str(daily_20150409.shape[0]))
daily_20150409_addname_dataframe.to_excel(daily_201504_excel_writer,'9_4',index=False)
daily_201504_excel_writer.save()
daily_20150410 = pro.daily(start_date='',end_date='',trade_date='20150410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150410_tscode_list = list() 
for ts_code_sh in daily_20150410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150410_tscode_list.append(stock_name)
daily_20150410_addname_dataframe=pd.DataFrame()
daily_20150410_addname_dataframe['cname'] = daily_20150410_tscode_list
for table_name in daily_20150410.columns.values.tolist():
    daily_20150410_addname_dataframe[table_name] = daily_20150410[table_name]
print("daily_20150410 返回数据 row 行数 = "+str(daily_20150410.shape[0]))
daily_20150410_addname_dataframe.to_excel(daily_201504_excel_writer,'10_5',index=False)
daily_201504_excel_writer.save()
daily_20150411 = pro.daily(start_date='',end_date='',trade_date='20150411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150411_tscode_list = list() 
for ts_code_sh in daily_20150411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150411_tscode_list.append(stock_name)
daily_20150411_addname_dataframe=pd.DataFrame()
daily_20150411_addname_dataframe['cname'] = daily_20150411_tscode_list
for table_name in daily_20150411.columns.values.tolist():
    daily_20150411_addname_dataframe[table_name] = daily_20150411[table_name]
print("daily_20150411 返回数据 row 行数 = "+str(daily_20150411.shape[0]))
daily_20150411_addname_dataframe.to_excel(daily_201504_excel_writer,'11_6',index=False)
daily_201504_excel_writer.save()
daily_20150412 = pro.daily(start_date='',end_date='',trade_date='20150412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150412_tscode_list = list() 
for ts_code_sh in daily_20150412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150412_tscode_list.append(stock_name)
daily_20150412_addname_dataframe=pd.DataFrame()
daily_20150412_addname_dataframe['cname'] = daily_20150412_tscode_list
for table_name in daily_20150412.columns.values.tolist():
    daily_20150412_addname_dataframe[table_name] = daily_20150412[table_name]
print("daily_20150412 返回数据 row 行数 = "+str(daily_20150412.shape[0]))
daily_20150412_addname_dataframe.to_excel(daily_201504_excel_writer,'12_7',index=False)
daily_201504_excel_writer.save()
daily_20150413 = pro.daily(start_date='',end_date='',trade_date='20150413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150413_tscode_list = list() 
for ts_code_sh in daily_20150413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150413_tscode_list.append(stock_name)
daily_20150413_addname_dataframe=pd.DataFrame()
daily_20150413_addname_dataframe['cname'] = daily_20150413_tscode_list
for table_name in daily_20150413.columns.values.tolist():
    daily_20150413_addname_dataframe[table_name] = daily_20150413[table_name]
print("daily_20150413 返回数据 row 行数 = "+str(daily_20150413.shape[0]))
daily_20150413_addname_dataframe.to_excel(daily_201504_excel_writer,'13_1',index=False)
daily_201504_excel_writer.save()
daily_20150414 = pro.daily(start_date='',end_date='',trade_date='20150414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150414_tscode_list = list() 
for ts_code_sh in daily_20150414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150414_tscode_list.append(stock_name)
daily_20150414_addname_dataframe=pd.DataFrame()
daily_20150414_addname_dataframe['cname'] = daily_20150414_tscode_list
for table_name in daily_20150414.columns.values.tolist():
    daily_20150414_addname_dataframe[table_name] = daily_20150414[table_name]
print("daily_20150414 返回数据 row 行数 = "+str(daily_20150414.shape[0]))
daily_20150414_addname_dataframe.to_excel(daily_201504_excel_writer,'14_2',index=False)
daily_201504_excel_writer.save()
daily_20150415 = pro.daily(start_date='',end_date='',trade_date='20150415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150415_tscode_list = list() 
for ts_code_sh in daily_20150415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150415_tscode_list.append(stock_name)
daily_20150415_addname_dataframe=pd.DataFrame()
daily_20150415_addname_dataframe['cname'] = daily_20150415_tscode_list
for table_name in daily_20150415.columns.values.tolist():
    daily_20150415_addname_dataframe[table_name] = daily_20150415[table_name]
print("daily_20150415 返回数据 row 行数 = "+str(daily_20150415.shape[0]))
daily_20150415_addname_dataframe.to_excel(daily_201504_excel_writer,'15_3',index=False)
daily_201504_excel_writer.save()
daily_20150416 = pro.daily(start_date='',end_date='',trade_date='20150416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150416_tscode_list = list() 
for ts_code_sh in daily_20150416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150416_tscode_list.append(stock_name)
daily_20150416_addname_dataframe=pd.DataFrame()
daily_20150416_addname_dataframe['cname'] = daily_20150416_tscode_list
for table_name in daily_20150416.columns.values.tolist():
    daily_20150416_addname_dataframe[table_name] = daily_20150416[table_name]
print("daily_20150416 返回数据 row 行数 = "+str(daily_20150416.shape[0]))
daily_20150416_addname_dataframe.to_excel(daily_201504_excel_writer,'16_4',index=False)
daily_201504_excel_writer.save()
daily_20150417 = pro.daily(start_date='',end_date='',trade_date='20150417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150417_tscode_list = list() 
for ts_code_sh in daily_20150417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150417_tscode_list.append(stock_name)
daily_20150417_addname_dataframe=pd.DataFrame()
daily_20150417_addname_dataframe['cname'] = daily_20150417_tscode_list
for table_name in daily_20150417.columns.values.tolist():
    daily_20150417_addname_dataframe[table_name] = daily_20150417[table_name]
print("daily_20150417 返回数据 row 行数 = "+str(daily_20150417.shape[0]))
daily_20150417_addname_dataframe.to_excel(daily_201504_excel_writer,'17_5',index=False)
daily_201504_excel_writer.save()
daily_20150418 = pro.daily(start_date='',end_date='',trade_date='20150418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150418_tscode_list = list() 
for ts_code_sh in daily_20150418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150418_tscode_list.append(stock_name)
daily_20150418_addname_dataframe=pd.DataFrame()
daily_20150418_addname_dataframe['cname'] = daily_20150418_tscode_list
for table_name in daily_20150418.columns.values.tolist():
    daily_20150418_addname_dataframe[table_name] = daily_20150418[table_name]
print("daily_20150418 返回数据 row 行数 = "+str(daily_20150418.shape[0]))
daily_20150418_addname_dataframe.to_excel(daily_201504_excel_writer,'18_6',index=False)
daily_201504_excel_writer.save()
daily_20150419 = pro.daily(start_date='',end_date='',trade_date='20150419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150419_tscode_list = list() 
for ts_code_sh in daily_20150419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150419_tscode_list.append(stock_name)
daily_20150419_addname_dataframe=pd.DataFrame()
daily_20150419_addname_dataframe['cname'] = daily_20150419_tscode_list
for table_name in daily_20150419.columns.values.tolist():
    daily_20150419_addname_dataframe[table_name] = daily_20150419[table_name]
print("daily_20150419 返回数据 row 行数 = "+str(daily_20150419.shape[0]))
daily_20150419_addname_dataframe.to_excel(daily_201504_excel_writer,'19_7',index=False)
daily_201504_excel_writer.save()
daily_20150420 = pro.daily(start_date='',end_date='',trade_date='20150420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150420_tscode_list = list() 
for ts_code_sh in daily_20150420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150420_tscode_list.append(stock_name)
daily_20150420_addname_dataframe=pd.DataFrame()
daily_20150420_addname_dataframe['cname'] = daily_20150420_tscode_list
for table_name in daily_20150420.columns.values.tolist():
    daily_20150420_addname_dataframe[table_name] = daily_20150420[table_name]
print("daily_20150420 返回数据 row 行数 = "+str(daily_20150420.shape[0]))
daily_20150420_addname_dataframe.to_excel(daily_201504_excel_writer,'20_1',index=False)
daily_201504_excel_writer.save()
daily_20150421 = pro.daily(start_date='',end_date='',trade_date='20150421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150421_tscode_list = list() 
for ts_code_sh in daily_20150421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150421_tscode_list.append(stock_name)
daily_20150421_addname_dataframe=pd.DataFrame()
daily_20150421_addname_dataframe['cname'] = daily_20150421_tscode_list
for table_name in daily_20150421.columns.values.tolist():
    daily_20150421_addname_dataframe[table_name] = daily_20150421[table_name]
print("daily_20150421 返回数据 row 行数 = "+str(daily_20150421.shape[0]))
daily_20150421_addname_dataframe.to_excel(daily_201504_excel_writer,'21_2',index=False)
daily_201504_excel_writer.save()
daily_20150422 = pro.daily(start_date='',end_date='',trade_date='20150422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150422_tscode_list = list() 
for ts_code_sh in daily_20150422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150422_tscode_list.append(stock_name)
daily_20150422_addname_dataframe=pd.DataFrame()
daily_20150422_addname_dataframe['cname'] = daily_20150422_tscode_list
for table_name in daily_20150422.columns.values.tolist():
    daily_20150422_addname_dataframe[table_name] = daily_20150422[table_name]
print("daily_20150422 返回数据 row 行数 = "+str(daily_20150422.shape[0]))
daily_20150422_addname_dataframe.to_excel(daily_201504_excel_writer,'22_3',index=False)
daily_201504_excel_writer.save()
daily_20150423 = pro.daily(start_date='',end_date='',trade_date='20150423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150423_tscode_list = list() 
for ts_code_sh in daily_20150423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150423_tscode_list.append(stock_name)
daily_20150423_addname_dataframe=pd.DataFrame()
daily_20150423_addname_dataframe['cname'] = daily_20150423_tscode_list
for table_name in daily_20150423.columns.values.tolist():
    daily_20150423_addname_dataframe[table_name] = daily_20150423[table_name]
print("daily_20150423 返回数据 row 行数 = "+str(daily_20150423.shape[0]))
daily_20150423_addname_dataframe.to_excel(daily_201504_excel_writer,'23_4',index=False)
daily_201504_excel_writer.save()
daily_20150424 = pro.daily(start_date='',end_date='',trade_date='20150424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150424_tscode_list = list() 
for ts_code_sh in daily_20150424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150424_tscode_list.append(stock_name)
daily_20150424_addname_dataframe=pd.DataFrame()
daily_20150424_addname_dataframe['cname'] = daily_20150424_tscode_list
for table_name in daily_20150424.columns.values.tolist():
    daily_20150424_addname_dataframe[table_name] = daily_20150424[table_name]
print("daily_20150424 返回数据 row 行数 = "+str(daily_20150424.shape[0]))
daily_20150424_addname_dataframe.to_excel(daily_201504_excel_writer,'24_5',index=False)
daily_201504_excel_writer.save()
daily_20150425 = pro.daily(start_date='',end_date='',trade_date='20150425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150425_tscode_list = list() 
for ts_code_sh in daily_20150425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150425_tscode_list.append(stock_name)
daily_20150425_addname_dataframe=pd.DataFrame()
daily_20150425_addname_dataframe['cname'] = daily_20150425_tscode_list
for table_name in daily_20150425.columns.values.tolist():
    daily_20150425_addname_dataframe[table_name] = daily_20150425[table_name]
print("daily_20150425 返回数据 row 行数 = "+str(daily_20150425.shape[0]))
daily_20150425_addname_dataframe.to_excel(daily_201504_excel_writer,'25_6',index=False)
daily_201504_excel_writer.save()
daily_20150426 = pro.daily(start_date='',end_date='',trade_date='20150426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150426_tscode_list = list() 
for ts_code_sh in daily_20150426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150426_tscode_list.append(stock_name)
daily_20150426_addname_dataframe=pd.DataFrame()
daily_20150426_addname_dataframe['cname'] = daily_20150426_tscode_list
for table_name in daily_20150426.columns.values.tolist():
    daily_20150426_addname_dataframe[table_name] = daily_20150426[table_name]
print("daily_20150426 返回数据 row 行数 = "+str(daily_20150426.shape[0]))
daily_20150426_addname_dataframe.to_excel(daily_201504_excel_writer,'26_7',index=False)
daily_201504_excel_writer.save()
daily_20150427 = pro.daily(start_date='',end_date='',trade_date='20150427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150427_tscode_list = list() 
for ts_code_sh in daily_20150427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150427_tscode_list.append(stock_name)
daily_20150427_addname_dataframe=pd.DataFrame()
daily_20150427_addname_dataframe['cname'] = daily_20150427_tscode_list
for table_name in daily_20150427.columns.values.tolist():
    daily_20150427_addname_dataframe[table_name] = daily_20150427[table_name]
print("daily_20150427 返回数据 row 行数 = "+str(daily_20150427.shape[0]))
daily_20150427_addname_dataframe.to_excel(daily_201504_excel_writer,'27_1',index=False)
daily_201504_excel_writer.save()
daily_20150428 = pro.daily(start_date='',end_date='',trade_date='20150428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150428_tscode_list = list() 
for ts_code_sh in daily_20150428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150428_tscode_list.append(stock_name)
daily_20150428_addname_dataframe=pd.DataFrame()
daily_20150428_addname_dataframe['cname'] = daily_20150428_tscode_list
for table_name in daily_20150428.columns.values.tolist():
    daily_20150428_addname_dataframe[table_name] = daily_20150428[table_name]
print("daily_20150428 返回数据 row 行数 = "+str(daily_20150428.shape[0]))
daily_20150428_addname_dataframe.to_excel(daily_201504_excel_writer,'28_2',index=False)
daily_201504_excel_writer.save()
daily_20150429 = pro.daily(start_date='',end_date='',trade_date='20150429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150429_tscode_list = list() 
for ts_code_sh in daily_20150429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150429_tscode_list.append(stock_name)
daily_20150429_addname_dataframe=pd.DataFrame()
daily_20150429_addname_dataframe['cname'] = daily_20150429_tscode_list
for table_name in daily_20150429.columns.values.tolist():
    daily_20150429_addname_dataframe[table_name] = daily_20150429[table_name]
print("daily_20150429 返回数据 row 行数 = "+str(daily_20150429.shape[0]))
daily_20150429_addname_dataframe.to_excel(daily_201504_excel_writer,'29_3',index=False)
daily_201504_excel_writer.save()
daily_20150430 = pro.daily(start_date='',end_date='',trade_date='20150430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150430_tscode_list = list() 
for ts_code_sh in daily_20150430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150430_tscode_list.append(stock_name)
daily_20150430_addname_dataframe=pd.DataFrame()
daily_20150430_addname_dataframe['cname'] = daily_20150430_tscode_list
for table_name in daily_20150430.columns.values.tolist():
    daily_20150430_addname_dataframe[table_name] = daily_20150430[table_name]
print("daily_20150430 返回数据 row 行数 = "+str(daily_20150430.shape[0]))
daily_20150430_addname_dataframe.to_excel(daily_201504_excel_writer,'30_4',index=False)
daily_201504_excel_writer.save()




createexcel('daily_201505.xlsx')
daily_201505_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201505.xlsx')
daily_201505_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201505.xlsx', engine='openpyxl')
daily_201505_excel_writer.book = daily_201505_book
daily_201505_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201505_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150501")       ###  更新 记录日期
daily_20150501 = pro.daily(start_date='',end_date='',trade_date='20150501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150501_tscode_list = list() 
for ts_code_sh in daily_20150501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150501_tscode_list.append(stock_name)
daily_20150501_addname_dataframe=pd.DataFrame()
daily_20150501_addname_dataframe['cname'] = daily_20150501_tscode_list
for table_name in daily_20150501.columns.values.tolist():
    daily_20150501_addname_dataframe[table_name] = daily_20150501[table_name]
print("daily_20150501 返回数据 row 行数 = "+str(daily_20150501.shape[0]))
daily_20150501_addname_dataframe.to_excel(daily_201505_excel_writer,'1_5',index=False)
daily_201505_excel_writer.save()
daily_20150502 = pro.daily(start_date='',end_date='',trade_date='20150502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150502_tscode_list = list() 
for ts_code_sh in daily_20150502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150502_tscode_list.append(stock_name)
daily_20150502_addname_dataframe=pd.DataFrame()
daily_20150502_addname_dataframe['cname'] = daily_20150502_tscode_list
for table_name in daily_20150502.columns.values.tolist():
    daily_20150502_addname_dataframe[table_name] = daily_20150502[table_name]
print("daily_20150502 返回数据 row 行数 = "+str(daily_20150502.shape[0]))
daily_20150502_addname_dataframe.to_excel(daily_201505_excel_writer,'2_6',index=False)
daily_201505_excel_writer.save()
daily_20150503 = pro.daily(start_date='',end_date='',trade_date='20150503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150503_tscode_list = list() 
for ts_code_sh in daily_20150503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150503_tscode_list.append(stock_name)
daily_20150503_addname_dataframe=pd.DataFrame()
daily_20150503_addname_dataframe['cname'] = daily_20150503_tscode_list
for table_name in daily_20150503.columns.values.tolist():
    daily_20150503_addname_dataframe[table_name] = daily_20150503[table_name]
print("daily_20150503 返回数据 row 行数 = "+str(daily_20150503.shape[0]))
daily_20150503_addname_dataframe.to_excel(daily_201505_excel_writer,'3_7',index=False)
daily_201505_excel_writer.save()
daily_20150504 = pro.daily(start_date='',end_date='',trade_date='20150504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150504_tscode_list = list() 
for ts_code_sh in daily_20150504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150504_tscode_list.append(stock_name)
daily_20150504_addname_dataframe=pd.DataFrame()
daily_20150504_addname_dataframe['cname'] = daily_20150504_tscode_list
for table_name in daily_20150504.columns.values.tolist():
    daily_20150504_addname_dataframe[table_name] = daily_20150504[table_name]
print("daily_20150504 返回数据 row 行数 = "+str(daily_20150504.shape[0]))
daily_20150504_addname_dataframe.to_excel(daily_201505_excel_writer,'4_1',index=False)
daily_201505_excel_writer.save()
daily_20150505 = pro.daily(start_date='',end_date='',trade_date='20150505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150505_tscode_list = list() 
for ts_code_sh in daily_20150505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150505_tscode_list.append(stock_name)
daily_20150505_addname_dataframe=pd.DataFrame()
daily_20150505_addname_dataframe['cname'] = daily_20150505_tscode_list
for table_name in daily_20150505.columns.values.tolist():
    daily_20150505_addname_dataframe[table_name] = daily_20150505[table_name]
print("daily_20150505 返回数据 row 行数 = "+str(daily_20150505.shape[0]))
daily_20150505_addname_dataframe.to_excel(daily_201505_excel_writer,'5_2',index=False)
daily_201505_excel_writer.save()
daily_20150506 = pro.daily(start_date='',end_date='',trade_date='20150506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150506_tscode_list = list() 
for ts_code_sh in daily_20150506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150506_tscode_list.append(stock_name)
daily_20150506_addname_dataframe=pd.DataFrame()
daily_20150506_addname_dataframe['cname'] = daily_20150506_tscode_list
for table_name in daily_20150506.columns.values.tolist():
    daily_20150506_addname_dataframe[table_name] = daily_20150506[table_name]
print("daily_20150506 返回数据 row 行数 = "+str(daily_20150506.shape[0]))
daily_20150506_addname_dataframe.to_excel(daily_201505_excel_writer,'6_3',index=False)
daily_201505_excel_writer.save()
daily_20150507 = pro.daily(start_date='',end_date='',trade_date='20150507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150507_tscode_list = list() 
for ts_code_sh in daily_20150507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150507_tscode_list.append(stock_name)
daily_20150507_addname_dataframe=pd.DataFrame()
daily_20150507_addname_dataframe['cname'] = daily_20150507_tscode_list
for table_name in daily_20150507.columns.values.tolist():
    daily_20150507_addname_dataframe[table_name] = daily_20150507[table_name]
print("daily_20150507 返回数据 row 行数 = "+str(daily_20150507.shape[0]))
daily_20150507_addname_dataframe.to_excel(daily_201505_excel_writer,'7_4',index=False)
daily_201505_excel_writer.save()
daily_20150508 = pro.daily(start_date='',end_date='',trade_date='20150508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150508_tscode_list = list() 
for ts_code_sh in daily_20150508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150508_tscode_list.append(stock_name)
daily_20150508_addname_dataframe=pd.DataFrame()
daily_20150508_addname_dataframe['cname'] = daily_20150508_tscode_list
for table_name in daily_20150508.columns.values.tolist():
    daily_20150508_addname_dataframe[table_name] = daily_20150508[table_name]
print("daily_20150508 返回数据 row 行数 = "+str(daily_20150508.shape[0]))
daily_20150508_addname_dataframe.to_excel(daily_201505_excel_writer,'8_5',index=False)
daily_201505_excel_writer.save()
daily_20150509 = pro.daily(start_date='',end_date='',trade_date='20150509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150509_tscode_list = list() 
for ts_code_sh in daily_20150509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150509_tscode_list.append(stock_name)
daily_20150509_addname_dataframe=pd.DataFrame()
daily_20150509_addname_dataframe['cname'] = daily_20150509_tscode_list
for table_name in daily_20150509.columns.values.tolist():
    daily_20150509_addname_dataframe[table_name] = daily_20150509[table_name]
print("daily_20150509 返回数据 row 行数 = "+str(daily_20150509.shape[0]))
daily_20150509_addname_dataframe.to_excel(daily_201505_excel_writer,'9_6',index=False)
daily_201505_excel_writer.save()
daily_20150510 = pro.daily(start_date='',end_date='',trade_date='20150510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150510_tscode_list = list() 
for ts_code_sh in daily_20150510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150510_tscode_list.append(stock_name)
daily_20150510_addname_dataframe=pd.DataFrame()
daily_20150510_addname_dataframe['cname'] = daily_20150510_tscode_list
for table_name in daily_20150510.columns.values.tolist():
    daily_20150510_addname_dataframe[table_name] = daily_20150510[table_name]
print("daily_20150510 返回数据 row 行数 = "+str(daily_20150510.shape[0]))
daily_20150510_addname_dataframe.to_excel(daily_201505_excel_writer,'10_7',index=False)
daily_201505_excel_writer.save()
daily_20150511 = pro.daily(start_date='',end_date='',trade_date='20150511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150511_tscode_list = list() 
for ts_code_sh in daily_20150511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150511_tscode_list.append(stock_name)
daily_20150511_addname_dataframe=pd.DataFrame()
daily_20150511_addname_dataframe['cname'] = daily_20150511_tscode_list
for table_name in daily_20150511.columns.values.tolist():
    daily_20150511_addname_dataframe[table_name] = daily_20150511[table_name]
print("daily_20150511 返回数据 row 行数 = "+str(daily_20150511.shape[0]))
daily_20150511_addname_dataframe.to_excel(daily_201505_excel_writer,'11_1',index=False)
daily_201505_excel_writer.save()
daily_20150512 = pro.daily(start_date='',end_date='',trade_date='20150512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150512_tscode_list = list() 
for ts_code_sh in daily_20150512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150512_tscode_list.append(stock_name)
daily_20150512_addname_dataframe=pd.DataFrame()
daily_20150512_addname_dataframe['cname'] = daily_20150512_tscode_list
for table_name in daily_20150512.columns.values.tolist():
    daily_20150512_addname_dataframe[table_name] = daily_20150512[table_name]
print("daily_20150512 返回数据 row 行数 = "+str(daily_20150512.shape[0]))
daily_20150512_addname_dataframe.to_excel(daily_201505_excel_writer,'12_2',index=False)
daily_201505_excel_writer.save()
daily_20150513 = pro.daily(start_date='',end_date='',trade_date='20150513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150513_tscode_list = list() 
for ts_code_sh in daily_20150513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150513_tscode_list.append(stock_name)
daily_20150513_addname_dataframe=pd.DataFrame()
daily_20150513_addname_dataframe['cname'] = daily_20150513_tscode_list
for table_name in daily_20150513.columns.values.tolist():
    daily_20150513_addname_dataframe[table_name] = daily_20150513[table_name]
print("daily_20150513 返回数据 row 行数 = "+str(daily_20150513.shape[0]))
daily_20150513_addname_dataframe.to_excel(daily_201505_excel_writer,'13_3',index=False)
daily_201505_excel_writer.save()
daily_20150514 = pro.daily(start_date='',end_date='',trade_date='20150514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150514_tscode_list = list() 
for ts_code_sh in daily_20150514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150514_tscode_list.append(stock_name)
daily_20150514_addname_dataframe=pd.DataFrame()
daily_20150514_addname_dataframe['cname'] = daily_20150514_tscode_list
for table_name in daily_20150514.columns.values.tolist():
    daily_20150514_addname_dataframe[table_name] = daily_20150514[table_name]
print("daily_20150514 返回数据 row 行数 = "+str(daily_20150514.shape[0]))
daily_20150514_addname_dataframe.to_excel(daily_201505_excel_writer,'14_4',index=False)
daily_201505_excel_writer.save()
daily_20150515 = pro.daily(start_date='',end_date='',trade_date='20150515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150515_tscode_list = list() 
for ts_code_sh in daily_20150515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150515_tscode_list.append(stock_name)
daily_20150515_addname_dataframe=pd.DataFrame()
daily_20150515_addname_dataframe['cname'] = daily_20150515_tscode_list
for table_name in daily_20150515.columns.values.tolist():
    daily_20150515_addname_dataframe[table_name] = daily_20150515[table_name]
print("daily_20150515 返回数据 row 行数 = "+str(daily_20150515.shape[0]))
daily_20150515_addname_dataframe.to_excel(daily_201505_excel_writer,'15_5',index=False)
daily_201505_excel_writer.save()
daily_20150516 = pro.daily(start_date='',end_date='',trade_date='20150516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150516_tscode_list = list() 
for ts_code_sh in daily_20150516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150516_tscode_list.append(stock_name)
daily_20150516_addname_dataframe=pd.DataFrame()
daily_20150516_addname_dataframe['cname'] = daily_20150516_tscode_list
for table_name in daily_20150516.columns.values.tolist():
    daily_20150516_addname_dataframe[table_name] = daily_20150516[table_name]
print("daily_20150516 返回数据 row 行数 = "+str(daily_20150516.shape[0]))
daily_20150516_addname_dataframe.to_excel(daily_201505_excel_writer,'16_6',index=False)
daily_201505_excel_writer.save()
daily_20150517 = pro.daily(start_date='',end_date='',trade_date='20150517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150517_tscode_list = list() 
for ts_code_sh in daily_20150517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150517_tscode_list.append(stock_name)
daily_20150517_addname_dataframe=pd.DataFrame()
daily_20150517_addname_dataframe['cname'] = daily_20150517_tscode_list
for table_name in daily_20150517.columns.values.tolist():
    daily_20150517_addname_dataframe[table_name] = daily_20150517[table_name]
print("daily_20150517 返回数据 row 行数 = "+str(daily_20150517.shape[0]))
daily_20150517_addname_dataframe.to_excel(daily_201505_excel_writer,'17_7',index=False)
daily_201505_excel_writer.save()
daily_20150518 = pro.daily(start_date='',end_date='',trade_date='20150518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150518_tscode_list = list() 
for ts_code_sh in daily_20150518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150518_tscode_list.append(stock_name)
daily_20150518_addname_dataframe=pd.DataFrame()
daily_20150518_addname_dataframe['cname'] = daily_20150518_tscode_list
for table_name in daily_20150518.columns.values.tolist():
    daily_20150518_addname_dataframe[table_name] = daily_20150518[table_name]
print("daily_20150518 返回数据 row 行数 = "+str(daily_20150518.shape[0]))
daily_20150518_addname_dataframe.to_excel(daily_201505_excel_writer,'18_1',index=False)
daily_201505_excel_writer.save()
daily_20150519 = pro.daily(start_date='',end_date='',trade_date='20150519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150519_tscode_list = list() 
for ts_code_sh in daily_20150519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150519_tscode_list.append(stock_name)
daily_20150519_addname_dataframe=pd.DataFrame()
daily_20150519_addname_dataframe['cname'] = daily_20150519_tscode_list
for table_name in daily_20150519.columns.values.tolist():
    daily_20150519_addname_dataframe[table_name] = daily_20150519[table_name]
print("daily_20150519 返回数据 row 行数 = "+str(daily_20150519.shape[0]))
daily_20150519_addname_dataframe.to_excel(daily_201505_excel_writer,'19_2',index=False)
daily_201505_excel_writer.save()
daily_20150520 = pro.daily(start_date='',end_date='',trade_date='20150520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150520_tscode_list = list() 
for ts_code_sh in daily_20150520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150520_tscode_list.append(stock_name)
daily_20150520_addname_dataframe=pd.DataFrame()
daily_20150520_addname_dataframe['cname'] = daily_20150520_tscode_list
for table_name in daily_20150520.columns.values.tolist():
    daily_20150520_addname_dataframe[table_name] = daily_20150520[table_name]
print("daily_20150520 返回数据 row 行数 = "+str(daily_20150520.shape[0]))
daily_20150520_addname_dataframe.to_excel(daily_201505_excel_writer,'20_3',index=False)
daily_201505_excel_writer.save()
daily_20150521 = pro.daily(start_date='',end_date='',trade_date='20150521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150521_tscode_list = list() 
for ts_code_sh in daily_20150521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150521_tscode_list.append(stock_name)
daily_20150521_addname_dataframe=pd.DataFrame()
daily_20150521_addname_dataframe['cname'] = daily_20150521_tscode_list
for table_name in daily_20150521.columns.values.tolist():
    daily_20150521_addname_dataframe[table_name] = daily_20150521[table_name]
print("daily_20150521 返回数据 row 行数 = "+str(daily_20150521.shape[0]))
daily_20150521_addname_dataframe.to_excel(daily_201505_excel_writer,'21_4',index=False)
daily_201505_excel_writer.save()
daily_20150522 = pro.daily(start_date='',end_date='',trade_date='20150522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150522_tscode_list = list() 
for ts_code_sh in daily_20150522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150522_tscode_list.append(stock_name)
daily_20150522_addname_dataframe=pd.DataFrame()
daily_20150522_addname_dataframe['cname'] = daily_20150522_tscode_list
for table_name in daily_20150522.columns.values.tolist():
    daily_20150522_addname_dataframe[table_name] = daily_20150522[table_name]
print("daily_20150522 返回数据 row 行数 = "+str(daily_20150522.shape[0]))
daily_20150522_addname_dataframe.to_excel(daily_201505_excel_writer,'22_5',index=False)
daily_201505_excel_writer.save()
daily_20150523 = pro.daily(start_date='',end_date='',trade_date='20150523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150523_tscode_list = list() 
for ts_code_sh in daily_20150523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150523_tscode_list.append(stock_name)
daily_20150523_addname_dataframe=pd.DataFrame()
daily_20150523_addname_dataframe['cname'] = daily_20150523_tscode_list
for table_name in daily_20150523.columns.values.tolist():
    daily_20150523_addname_dataframe[table_name] = daily_20150523[table_name]
print("daily_20150523 返回数据 row 行数 = "+str(daily_20150523.shape[0]))
daily_20150523_addname_dataframe.to_excel(daily_201505_excel_writer,'23_6',index=False)
daily_201505_excel_writer.save()
daily_20150524 = pro.daily(start_date='',end_date='',trade_date='20150524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150524_tscode_list = list() 
for ts_code_sh in daily_20150524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150524_tscode_list.append(stock_name)
daily_20150524_addname_dataframe=pd.DataFrame()
daily_20150524_addname_dataframe['cname'] = daily_20150524_tscode_list
for table_name in daily_20150524.columns.values.tolist():
    daily_20150524_addname_dataframe[table_name] = daily_20150524[table_name]
print("daily_20150524 返回数据 row 行数 = "+str(daily_20150524.shape[0]))
daily_20150524_addname_dataframe.to_excel(daily_201505_excel_writer,'24_7',index=False)
daily_201505_excel_writer.save()
daily_20150525 = pro.daily(start_date='',end_date='',trade_date='20150525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150525_tscode_list = list() 
for ts_code_sh in daily_20150525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150525_tscode_list.append(stock_name)
daily_20150525_addname_dataframe=pd.DataFrame()
daily_20150525_addname_dataframe['cname'] = daily_20150525_tscode_list
for table_name in daily_20150525.columns.values.tolist():
    daily_20150525_addname_dataframe[table_name] = daily_20150525[table_name]
print("daily_20150525 返回数据 row 行数 = "+str(daily_20150525.shape[0]))
daily_20150525_addname_dataframe.to_excel(daily_201505_excel_writer,'25_1',index=False)
daily_201505_excel_writer.save()
daily_20150526 = pro.daily(start_date='',end_date='',trade_date='20150526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150526_tscode_list = list() 
for ts_code_sh in daily_20150526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150526_tscode_list.append(stock_name)
daily_20150526_addname_dataframe=pd.DataFrame()
daily_20150526_addname_dataframe['cname'] = daily_20150526_tscode_list
for table_name in daily_20150526.columns.values.tolist():
    daily_20150526_addname_dataframe[table_name] = daily_20150526[table_name]
print("daily_20150526 返回数据 row 行数 = "+str(daily_20150526.shape[0]))
daily_20150526_addname_dataframe.to_excel(daily_201505_excel_writer,'26_2',index=False)
daily_201505_excel_writer.save()
daily_20150527 = pro.daily(start_date='',end_date='',trade_date='20150527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150527_tscode_list = list() 
for ts_code_sh in daily_20150527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150527_tscode_list.append(stock_name)
daily_20150527_addname_dataframe=pd.DataFrame()
daily_20150527_addname_dataframe['cname'] = daily_20150527_tscode_list
for table_name in daily_20150527.columns.values.tolist():
    daily_20150527_addname_dataframe[table_name] = daily_20150527[table_name]
print("daily_20150527 返回数据 row 行数 = "+str(daily_20150527.shape[0]))
daily_20150527_addname_dataframe.to_excel(daily_201505_excel_writer,'27_3',index=False)
daily_201505_excel_writer.save()
daily_20150528 = pro.daily(start_date='',end_date='',trade_date='20150528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150528_tscode_list = list() 
for ts_code_sh in daily_20150528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150528_tscode_list.append(stock_name)
daily_20150528_addname_dataframe=pd.DataFrame()
daily_20150528_addname_dataframe['cname'] = daily_20150528_tscode_list
for table_name in daily_20150528.columns.values.tolist():
    daily_20150528_addname_dataframe[table_name] = daily_20150528[table_name]
print("daily_20150528 返回数据 row 行数 = "+str(daily_20150528.shape[0]))
daily_20150528_addname_dataframe.to_excel(daily_201505_excel_writer,'28_4',index=False)
daily_201505_excel_writer.save()
daily_20150529 = pro.daily(start_date='',end_date='',trade_date='20150529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150529_tscode_list = list() 
for ts_code_sh in daily_20150529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150529_tscode_list.append(stock_name)
daily_20150529_addname_dataframe=pd.DataFrame()
daily_20150529_addname_dataframe['cname'] = daily_20150529_tscode_list
for table_name in daily_20150529.columns.values.tolist():
    daily_20150529_addname_dataframe[table_name] = daily_20150529[table_name]
print("daily_20150529 返回数据 row 行数 = "+str(daily_20150529.shape[0]))
daily_20150529_addname_dataframe.to_excel(daily_201505_excel_writer,'29_5',index=False)
daily_201505_excel_writer.save()
daily_20150530 = pro.daily(start_date='',end_date='',trade_date='20150530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150530_tscode_list = list() 
for ts_code_sh in daily_20150530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150530_tscode_list.append(stock_name)
daily_20150530_addname_dataframe=pd.DataFrame()
daily_20150530_addname_dataframe['cname'] = daily_20150530_tscode_list
for table_name in daily_20150530.columns.values.tolist():
    daily_20150530_addname_dataframe[table_name] = daily_20150530[table_name]
print("daily_20150530 返回数据 row 行数 = "+str(daily_20150530.shape[0]))
daily_20150530_addname_dataframe.to_excel(daily_201505_excel_writer,'30_6',index=False)
daily_201505_excel_writer.save()
daily_20150531 = pro.daily(start_date='',end_date='',trade_date='20150531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150531_tscode_list = list() 
for ts_code_sh in daily_20150531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150531_tscode_list.append(stock_name)
daily_20150531_addname_dataframe=pd.DataFrame()
daily_20150531_addname_dataframe['cname'] = daily_20150531_tscode_list
for table_name in daily_20150531.columns.values.tolist():
    daily_20150531_addname_dataframe[table_name] = daily_20150531[table_name]
print("daily_20150531 返回数据 row 行数 = "+str(daily_20150531.shape[0]))
daily_20150531_addname_dataframe.to_excel(daily_201505_excel_writer,'31_7',index=False)
daily_201505_excel_writer.save()




createexcel('daily_201506.xlsx')
daily_201506_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201506.xlsx')
daily_201506_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201506.xlsx', engine='openpyxl')
daily_201506_excel_writer.book = daily_201506_book
daily_201506_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201506_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150601")       ###  更新 记录日期
daily_20150601 = pro.daily(start_date='',end_date='',trade_date='20150601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150601_tscode_list = list() 
for ts_code_sh in daily_20150601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150601_tscode_list.append(stock_name)
daily_20150601_addname_dataframe=pd.DataFrame()
daily_20150601_addname_dataframe['cname'] = daily_20150601_tscode_list
for table_name in daily_20150601.columns.values.tolist():
    daily_20150601_addname_dataframe[table_name] = daily_20150601[table_name]
print("daily_20150601 返回数据 row 行数 = "+str(daily_20150601.shape[0]))
daily_20150601_addname_dataframe.to_excel(daily_201506_excel_writer,'1_1',index=False)
daily_201506_excel_writer.save()
daily_20150602 = pro.daily(start_date='',end_date='',trade_date='20150602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150602_tscode_list = list() 
for ts_code_sh in daily_20150602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150602_tscode_list.append(stock_name)
daily_20150602_addname_dataframe=pd.DataFrame()
daily_20150602_addname_dataframe['cname'] = daily_20150602_tscode_list
for table_name in daily_20150602.columns.values.tolist():
    daily_20150602_addname_dataframe[table_name] = daily_20150602[table_name]
print("daily_20150602 返回数据 row 行数 = "+str(daily_20150602.shape[0]))
daily_20150602_addname_dataframe.to_excel(daily_201506_excel_writer,'2_2',index=False)
daily_201506_excel_writer.save()
daily_20150603 = pro.daily(start_date='',end_date='',trade_date='20150603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150603_tscode_list = list() 
for ts_code_sh in daily_20150603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150603_tscode_list.append(stock_name)
daily_20150603_addname_dataframe=pd.DataFrame()
daily_20150603_addname_dataframe['cname'] = daily_20150603_tscode_list
for table_name in daily_20150603.columns.values.tolist():
    daily_20150603_addname_dataframe[table_name] = daily_20150603[table_name]
print("daily_20150603 返回数据 row 行数 = "+str(daily_20150603.shape[0]))
daily_20150603_addname_dataframe.to_excel(daily_201506_excel_writer,'3_3',index=False)
daily_201506_excel_writer.save()
daily_20150604 = pro.daily(start_date='',end_date='',trade_date='20150604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150604_tscode_list = list() 
for ts_code_sh in daily_20150604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150604_tscode_list.append(stock_name)
daily_20150604_addname_dataframe=pd.DataFrame()
daily_20150604_addname_dataframe['cname'] = daily_20150604_tscode_list
for table_name in daily_20150604.columns.values.tolist():
    daily_20150604_addname_dataframe[table_name] = daily_20150604[table_name]
print("daily_20150604 返回数据 row 行数 = "+str(daily_20150604.shape[0]))
daily_20150604_addname_dataframe.to_excel(daily_201506_excel_writer,'4_4',index=False)
daily_201506_excel_writer.save()
daily_20150605 = pro.daily(start_date='',end_date='',trade_date='20150605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150605_tscode_list = list() 
for ts_code_sh in daily_20150605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150605_tscode_list.append(stock_name)
daily_20150605_addname_dataframe=pd.DataFrame()
daily_20150605_addname_dataframe['cname'] = daily_20150605_tscode_list
for table_name in daily_20150605.columns.values.tolist():
    daily_20150605_addname_dataframe[table_name] = daily_20150605[table_name]
print("daily_20150605 返回数据 row 行数 = "+str(daily_20150605.shape[0]))
daily_20150605_addname_dataframe.to_excel(daily_201506_excel_writer,'5_5',index=False)
daily_201506_excel_writer.save()
daily_20150606 = pro.daily(start_date='',end_date='',trade_date='20150606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150606_tscode_list = list() 
for ts_code_sh in daily_20150606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150606_tscode_list.append(stock_name)
daily_20150606_addname_dataframe=pd.DataFrame()
daily_20150606_addname_dataframe['cname'] = daily_20150606_tscode_list
for table_name in daily_20150606.columns.values.tolist():
    daily_20150606_addname_dataframe[table_name] = daily_20150606[table_name]
print("daily_20150606 返回数据 row 行数 = "+str(daily_20150606.shape[0]))
daily_20150606_addname_dataframe.to_excel(daily_201506_excel_writer,'6_6',index=False)
daily_201506_excel_writer.save()
daily_20150607 = pro.daily(start_date='',end_date='',trade_date='20150607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150607_tscode_list = list() 
for ts_code_sh in daily_20150607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150607_tscode_list.append(stock_name)
daily_20150607_addname_dataframe=pd.DataFrame()
daily_20150607_addname_dataframe['cname'] = daily_20150607_tscode_list
for table_name in daily_20150607.columns.values.tolist():
    daily_20150607_addname_dataframe[table_name] = daily_20150607[table_name]
print("daily_20150607 返回数据 row 行数 = "+str(daily_20150607.shape[0]))
daily_20150607_addname_dataframe.to_excel(daily_201506_excel_writer,'7_7',index=False)
daily_201506_excel_writer.save()
daily_20150608 = pro.daily(start_date='',end_date='',trade_date='20150608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150608_tscode_list = list() 
for ts_code_sh in daily_20150608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150608_tscode_list.append(stock_name)
daily_20150608_addname_dataframe=pd.DataFrame()
daily_20150608_addname_dataframe['cname'] = daily_20150608_tscode_list
for table_name in daily_20150608.columns.values.tolist():
    daily_20150608_addname_dataframe[table_name] = daily_20150608[table_name]
print("daily_20150608 返回数据 row 行数 = "+str(daily_20150608.shape[0]))
daily_20150608_addname_dataframe.to_excel(daily_201506_excel_writer,'8_1',index=False)
daily_201506_excel_writer.save()
daily_20150609 = pro.daily(start_date='',end_date='',trade_date='20150609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150609_tscode_list = list() 
for ts_code_sh in daily_20150609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150609_tscode_list.append(stock_name)
daily_20150609_addname_dataframe=pd.DataFrame()
daily_20150609_addname_dataframe['cname'] = daily_20150609_tscode_list
for table_name in daily_20150609.columns.values.tolist():
    daily_20150609_addname_dataframe[table_name] = daily_20150609[table_name]
print("daily_20150609 返回数据 row 行数 = "+str(daily_20150609.shape[0]))
daily_20150609_addname_dataframe.to_excel(daily_201506_excel_writer,'9_2',index=False)
daily_201506_excel_writer.save()
daily_20150610 = pro.daily(start_date='',end_date='',trade_date='20150610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150610_tscode_list = list() 
for ts_code_sh in daily_20150610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150610_tscode_list.append(stock_name)
daily_20150610_addname_dataframe=pd.DataFrame()
daily_20150610_addname_dataframe['cname'] = daily_20150610_tscode_list
for table_name in daily_20150610.columns.values.tolist():
    daily_20150610_addname_dataframe[table_name] = daily_20150610[table_name]
print("daily_20150610 返回数据 row 行数 = "+str(daily_20150610.shape[0]))
daily_20150610_addname_dataframe.to_excel(daily_201506_excel_writer,'10_3',index=False)
daily_201506_excel_writer.save()
daily_20150611 = pro.daily(start_date='',end_date='',trade_date='20150611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150611_tscode_list = list() 
for ts_code_sh in daily_20150611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150611_tscode_list.append(stock_name)
daily_20150611_addname_dataframe=pd.DataFrame()
daily_20150611_addname_dataframe['cname'] = daily_20150611_tscode_list
for table_name in daily_20150611.columns.values.tolist():
    daily_20150611_addname_dataframe[table_name] = daily_20150611[table_name]
print("daily_20150611 返回数据 row 行数 = "+str(daily_20150611.shape[0]))
daily_20150611_addname_dataframe.to_excel(daily_201506_excel_writer,'11_4',index=False)
daily_201506_excel_writer.save()
daily_20150612 = pro.daily(start_date='',end_date='',trade_date='20150612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150612_tscode_list = list() 
for ts_code_sh in daily_20150612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150612_tscode_list.append(stock_name)
daily_20150612_addname_dataframe=pd.DataFrame()
daily_20150612_addname_dataframe['cname'] = daily_20150612_tscode_list
for table_name in daily_20150612.columns.values.tolist():
    daily_20150612_addname_dataframe[table_name] = daily_20150612[table_name]
print("daily_20150612 返回数据 row 行数 = "+str(daily_20150612.shape[0]))
daily_20150612_addname_dataframe.to_excel(daily_201506_excel_writer,'12_5',index=False)
daily_201506_excel_writer.save()
daily_20150613 = pro.daily(start_date='',end_date='',trade_date='20150613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150613_tscode_list = list() 
for ts_code_sh in daily_20150613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150613_tscode_list.append(stock_name)
daily_20150613_addname_dataframe=pd.DataFrame()
daily_20150613_addname_dataframe['cname'] = daily_20150613_tscode_list
for table_name in daily_20150613.columns.values.tolist():
    daily_20150613_addname_dataframe[table_name] = daily_20150613[table_name]
print("daily_20150613 返回数据 row 行数 = "+str(daily_20150613.shape[0]))
daily_20150613_addname_dataframe.to_excel(daily_201506_excel_writer,'13_6',index=False)
daily_201506_excel_writer.save()
daily_20150614 = pro.daily(start_date='',end_date='',trade_date='20150614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150614_tscode_list = list() 
for ts_code_sh in daily_20150614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150614_tscode_list.append(stock_name)
daily_20150614_addname_dataframe=pd.DataFrame()
daily_20150614_addname_dataframe['cname'] = daily_20150614_tscode_list
for table_name in daily_20150614.columns.values.tolist():
    daily_20150614_addname_dataframe[table_name] = daily_20150614[table_name]
print("daily_20150614 返回数据 row 行数 = "+str(daily_20150614.shape[0]))
daily_20150614_addname_dataframe.to_excel(daily_201506_excel_writer,'14_7',index=False)
daily_201506_excel_writer.save()
daily_20150615 = pro.daily(start_date='',end_date='',trade_date='20150615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150615_tscode_list = list() 
for ts_code_sh in daily_20150615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150615_tscode_list.append(stock_name)
daily_20150615_addname_dataframe=pd.DataFrame()
daily_20150615_addname_dataframe['cname'] = daily_20150615_tscode_list
for table_name in daily_20150615.columns.values.tolist():
    daily_20150615_addname_dataframe[table_name] = daily_20150615[table_name]
print("daily_20150615 返回数据 row 行数 = "+str(daily_20150615.shape[0]))
daily_20150615_addname_dataframe.to_excel(daily_201506_excel_writer,'15_1',index=False)
daily_201506_excel_writer.save()
daily_20150616 = pro.daily(start_date='',end_date='',trade_date='20150616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150616_tscode_list = list() 
for ts_code_sh in daily_20150616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150616_tscode_list.append(stock_name)
daily_20150616_addname_dataframe=pd.DataFrame()
daily_20150616_addname_dataframe['cname'] = daily_20150616_tscode_list
for table_name in daily_20150616.columns.values.tolist():
    daily_20150616_addname_dataframe[table_name] = daily_20150616[table_name]
print("daily_20150616 返回数据 row 行数 = "+str(daily_20150616.shape[0]))
daily_20150616_addname_dataframe.to_excel(daily_201506_excel_writer,'16_2',index=False)
daily_201506_excel_writer.save()
daily_20150617 = pro.daily(start_date='',end_date='',trade_date='20150617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150617_tscode_list = list() 
for ts_code_sh in daily_20150617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150617_tscode_list.append(stock_name)
daily_20150617_addname_dataframe=pd.DataFrame()
daily_20150617_addname_dataframe['cname'] = daily_20150617_tscode_list
for table_name in daily_20150617.columns.values.tolist():
    daily_20150617_addname_dataframe[table_name] = daily_20150617[table_name]
print("daily_20150617 返回数据 row 行数 = "+str(daily_20150617.shape[0]))
daily_20150617_addname_dataframe.to_excel(daily_201506_excel_writer,'17_3',index=False)
daily_201506_excel_writer.save()
daily_20150618 = pro.daily(start_date='',end_date='',trade_date='20150618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150618_tscode_list = list() 
for ts_code_sh in daily_20150618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150618_tscode_list.append(stock_name)
daily_20150618_addname_dataframe=pd.DataFrame()
daily_20150618_addname_dataframe['cname'] = daily_20150618_tscode_list
for table_name in daily_20150618.columns.values.tolist():
    daily_20150618_addname_dataframe[table_name] = daily_20150618[table_name]
print("daily_20150618 返回数据 row 行数 = "+str(daily_20150618.shape[0]))
daily_20150618_addname_dataframe.to_excel(daily_201506_excel_writer,'18_4',index=False)
daily_201506_excel_writer.save()
daily_20150619 = pro.daily(start_date='',end_date='',trade_date='20150619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150619_tscode_list = list() 
for ts_code_sh in daily_20150619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150619_tscode_list.append(stock_name)
daily_20150619_addname_dataframe=pd.DataFrame()
daily_20150619_addname_dataframe['cname'] = daily_20150619_tscode_list
for table_name in daily_20150619.columns.values.tolist():
    daily_20150619_addname_dataframe[table_name] = daily_20150619[table_name]
print("daily_20150619 返回数据 row 行数 = "+str(daily_20150619.shape[0]))
daily_20150619_addname_dataframe.to_excel(daily_201506_excel_writer,'19_5',index=False)
daily_201506_excel_writer.save()
daily_20150620 = pro.daily(start_date='',end_date='',trade_date='20150620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150620_tscode_list = list() 
for ts_code_sh in daily_20150620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150620_tscode_list.append(stock_name)
daily_20150620_addname_dataframe=pd.DataFrame()
daily_20150620_addname_dataframe['cname'] = daily_20150620_tscode_list
for table_name in daily_20150620.columns.values.tolist():
    daily_20150620_addname_dataframe[table_name] = daily_20150620[table_name]
print("daily_20150620 返回数据 row 行数 = "+str(daily_20150620.shape[0]))
daily_20150620_addname_dataframe.to_excel(daily_201506_excel_writer,'20_6',index=False)
daily_201506_excel_writer.save()
daily_20150621 = pro.daily(start_date='',end_date='',trade_date='20150621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150621_tscode_list = list() 
for ts_code_sh in daily_20150621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150621_tscode_list.append(stock_name)
daily_20150621_addname_dataframe=pd.DataFrame()
daily_20150621_addname_dataframe['cname'] = daily_20150621_tscode_list
for table_name in daily_20150621.columns.values.tolist():
    daily_20150621_addname_dataframe[table_name] = daily_20150621[table_name]
print("daily_20150621 返回数据 row 行数 = "+str(daily_20150621.shape[0]))
daily_20150621_addname_dataframe.to_excel(daily_201506_excel_writer,'21_7',index=False)
daily_201506_excel_writer.save()
daily_20150622 = pro.daily(start_date='',end_date='',trade_date='20150622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150622_tscode_list = list() 
for ts_code_sh in daily_20150622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150622_tscode_list.append(stock_name)
daily_20150622_addname_dataframe=pd.DataFrame()
daily_20150622_addname_dataframe['cname'] = daily_20150622_tscode_list
for table_name in daily_20150622.columns.values.tolist():
    daily_20150622_addname_dataframe[table_name] = daily_20150622[table_name]
print("daily_20150622 返回数据 row 行数 = "+str(daily_20150622.shape[0]))
daily_20150622_addname_dataframe.to_excel(daily_201506_excel_writer,'22_1',index=False)
daily_201506_excel_writer.save()
daily_20150623 = pro.daily(start_date='',end_date='',trade_date='20150623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150623_tscode_list = list() 
for ts_code_sh in daily_20150623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150623_tscode_list.append(stock_name)
daily_20150623_addname_dataframe=pd.DataFrame()
daily_20150623_addname_dataframe['cname'] = daily_20150623_tscode_list
for table_name in daily_20150623.columns.values.tolist():
    daily_20150623_addname_dataframe[table_name] = daily_20150623[table_name]
print("daily_20150623 返回数据 row 行数 = "+str(daily_20150623.shape[0]))
daily_20150623_addname_dataframe.to_excel(daily_201506_excel_writer,'23_2',index=False)
daily_201506_excel_writer.save()
daily_20150624 = pro.daily(start_date='',end_date='',trade_date='20150624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150624_tscode_list = list() 
for ts_code_sh in daily_20150624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150624_tscode_list.append(stock_name)
daily_20150624_addname_dataframe=pd.DataFrame()
daily_20150624_addname_dataframe['cname'] = daily_20150624_tscode_list
for table_name in daily_20150624.columns.values.tolist():
    daily_20150624_addname_dataframe[table_name] = daily_20150624[table_name]
print("daily_20150624 返回数据 row 行数 = "+str(daily_20150624.shape[0]))
daily_20150624_addname_dataframe.to_excel(daily_201506_excel_writer,'24_3',index=False)
daily_201506_excel_writer.save()
daily_20150625 = pro.daily(start_date='',end_date='',trade_date='20150625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150625_tscode_list = list() 
for ts_code_sh in daily_20150625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150625_tscode_list.append(stock_name)
daily_20150625_addname_dataframe=pd.DataFrame()
daily_20150625_addname_dataframe['cname'] = daily_20150625_tscode_list
for table_name in daily_20150625.columns.values.tolist():
    daily_20150625_addname_dataframe[table_name] = daily_20150625[table_name]
print("daily_20150625 返回数据 row 行数 = "+str(daily_20150625.shape[0]))
daily_20150625_addname_dataframe.to_excel(daily_201506_excel_writer,'25_4',index=False)
daily_201506_excel_writer.save()
daily_20150626 = pro.daily(start_date='',end_date='',trade_date='20150626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150626_tscode_list = list() 
for ts_code_sh in daily_20150626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150626_tscode_list.append(stock_name)
daily_20150626_addname_dataframe=pd.DataFrame()
daily_20150626_addname_dataframe['cname'] = daily_20150626_tscode_list
for table_name in daily_20150626.columns.values.tolist():
    daily_20150626_addname_dataframe[table_name] = daily_20150626[table_name]
print("daily_20150626 返回数据 row 行数 = "+str(daily_20150626.shape[0]))
daily_20150626_addname_dataframe.to_excel(daily_201506_excel_writer,'26_5',index=False)
daily_201506_excel_writer.save()
daily_20150627 = pro.daily(start_date='',end_date='',trade_date='20150627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150627_tscode_list = list() 
for ts_code_sh in daily_20150627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150627_tscode_list.append(stock_name)
daily_20150627_addname_dataframe=pd.DataFrame()
daily_20150627_addname_dataframe['cname'] = daily_20150627_tscode_list
for table_name in daily_20150627.columns.values.tolist():
    daily_20150627_addname_dataframe[table_name] = daily_20150627[table_name]
print("daily_20150627 返回数据 row 行数 = "+str(daily_20150627.shape[0]))
daily_20150627_addname_dataframe.to_excel(daily_201506_excel_writer,'27_6',index=False)
daily_201506_excel_writer.save()
daily_20150628 = pro.daily(start_date='',end_date='',trade_date='20150628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150628_tscode_list = list() 
for ts_code_sh in daily_20150628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150628_tscode_list.append(stock_name)
daily_20150628_addname_dataframe=pd.DataFrame()
daily_20150628_addname_dataframe['cname'] = daily_20150628_tscode_list
for table_name in daily_20150628.columns.values.tolist():
    daily_20150628_addname_dataframe[table_name] = daily_20150628[table_name]
print("daily_20150628 返回数据 row 行数 = "+str(daily_20150628.shape[0]))
daily_20150628_addname_dataframe.to_excel(daily_201506_excel_writer,'28_7',index=False)
daily_201506_excel_writer.save()
daily_20150629 = pro.daily(start_date='',end_date='',trade_date='20150629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150629_tscode_list = list() 
for ts_code_sh in daily_20150629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150629_tscode_list.append(stock_name)
daily_20150629_addname_dataframe=pd.DataFrame()
daily_20150629_addname_dataframe['cname'] = daily_20150629_tscode_list
for table_name in daily_20150629.columns.values.tolist():
    daily_20150629_addname_dataframe[table_name] = daily_20150629[table_name]
print("daily_20150629 返回数据 row 行数 = "+str(daily_20150629.shape[0]))
daily_20150629_addname_dataframe.to_excel(daily_201506_excel_writer,'29_1',index=False)
daily_201506_excel_writer.save()
daily_20150630 = pro.daily(start_date='',end_date='',trade_date='20150630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150630_tscode_list = list() 
for ts_code_sh in daily_20150630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150630_tscode_list.append(stock_name)
daily_20150630_addname_dataframe=pd.DataFrame()
daily_20150630_addname_dataframe['cname'] = daily_20150630_tscode_list
for table_name in daily_20150630.columns.values.tolist():
    daily_20150630_addname_dataframe[table_name] = daily_20150630[table_name]
print("daily_20150630 返回数据 row 行数 = "+str(daily_20150630.shape[0]))
daily_20150630_addname_dataframe.to_excel(daily_201506_excel_writer,'30_2',index=False)
daily_201506_excel_writer.save()




createexcel('daily_201507.xlsx')
daily_201507_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201507.xlsx')
daily_201507_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201507.xlsx', engine='openpyxl')
daily_201507_excel_writer.book = daily_201507_book
daily_201507_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201507_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150701")       ###  更新 记录日期
daily_20150701 = pro.daily(start_date='',end_date='',trade_date='20150701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150701_tscode_list = list() 
for ts_code_sh in daily_20150701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150701_tscode_list.append(stock_name)
daily_20150701_addname_dataframe=pd.DataFrame()
daily_20150701_addname_dataframe['cname'] = daily_20150701_tscode_list
for table_name in daily_20150701.columns.values.tolist():
    daily_20150701_addname_dataframe[table_name] = daily_20150701[table_name]
print("daily_20150701 返回数据 row 行数 = "+str(daily_20150701.shape[0]))
daily_20150701_addname_dataframe.to_excel(daily_201507_excel_writer,'1_3',index=False)
daily_201507_excel_writer.save()
daily_20150702 = pro.daily(start_date='',end_date='',trade_date='20150702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150702_tscode_list = list() 
for ts_code_sh in daily_20150702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150702_tscode_list.append(stock_name)
daily_20150702_addname_dataframe=pd.DataFrame()
daily_20150702_addname_dataframe['cname'] = daily_20150702_tscode_list
for table_name in daily_20150702.columns.values.tolist():
    daily_20150702_addname_dataframe[table_name] = daily_20150702[table_name]
print("daily_20150702 返回数据 row 行数 = "+str(daily_20150702.shape[0]))
daily_20150702_addname_dataframe.to_excel(daily_201507_excel_writer,'2_4',index=False)
daily_201507_excel_writer.save()
daily_20150703 = pro.daily(start_date='',end_date='',trade_date='20150703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150703_tscode_list = list() 
for ts_code_sh in daily_20150703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150703_tscode_list.append(stock_name)
daily_20150703_addname_dataframe=pd.DataFrame()
daily_20150703_addname_dataframe['cname'] = daily_20150703_tscode_list
for table_name in daily_20150703.columns.values.tolist():
    daily_20150703_addname_dataframe[table_name] = daily_20150703[table_name]
print("daily_20150703 返回数据 row 行数 = "+str(daily_20150703.shape[0]))
daily_20150703_addname_dataframe.to_excel(daily_201507_excel_writer,'3_5',index=False)
daily_201507_excel_writer.save()
daily_20150704 = pro.daily(start_date='',end_date='',trade_date='20150704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150704_tscode_list = list() 
for ts_code_sh in daily_20150704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150704_tscode_list.append(stock_name)
daily_20150704_addname_dataframe=pd.DataFrame()
daily_20150704_addname_dataframe['cname'] = daily_20150704_tscode_list
for table_name in daily_20150704.columns.values.tolist():
    daily_20150704_addname_dataframe[table_name] = daily_20150704[table_name]
print("daily_20150704 返回数据 row 行数 = "+str(daily_20150704.shape[0]))
daily_20150704_addname_dataframe.to_excel(daily_201507_excel_writer,'4_6',index=False)
daily_201507_excel_writer.save()
daily_20150705 = pro.daily(start_date='',end_date='',trade_date='20150705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150705_tscode_list = list() 
for ts_code_sh in daily_20150705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150705_tscode_list.append(stock_name)
daily_20150705_addname_dataframe=pd.DataFrame()
daily_20150705_addname_dataframe['cname'] = daily_20150705_tscode_list
for table_name in daily_20150705.columns.values.tolist():
    daily_20150705_addname_dataframe[table_name] = daily_20150705[table_name]
print("daily_20150705 返回数据 row 行数 = "+str(daily_20150705.shape[0]))
daily_20150705_addname_dataframe.to_excel(daily_201507_excel_writer,'5_7',index=False)
daily_201507_excel_writer.save()
daily_20150706 = pro.daily(start_date='',end_date='',trade_date='20150706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150706_tscode_list = list() 
for ts_code_sh in daily_20150706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150706_tscode_list.append(stock_name)
daily_20150706_addname_dataframe=pd.DataFrame()
daily_20150706_addname_dataframe['cname'] = daily_20150706_tscode_list
for table_name in daily_20150706.columns.values.tolist():
    daily_20150706_addname_dataframe[table_name] = daily_20150706[table_name]
print("daily_20150706 返回数据 row 行数 = "+str(daily_20150706.shape[0]))
daily_20150706_addname_dataframe.to_excel(daily_201507_excel_writer,'6_1',index=False)
daily_201507_excel_writer.save()
daily_20150707 = pro.daily(start_date='',end_date='',trade_date='20150707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150707_tscode_list = list() 
for ts_code_sh in daily_20150707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150707_tscode_list.append(stock_name)
daily_20150707_addname_dataframe=pd.DataFrame()
daily_20150707_addname_dataframe['cname'] = daily_20150707_tscode_list
for table_name in daily_20150707.columns.values.tolist():
    daily_20150707_addname_dataframe[table_name] = daily_20150707[table_name]
print("daily_20150707 返回数据 row 行数 = "+str(daily_20150707.shape[0]))
daily_20150707_addname_dataframe.to_excel(daily_201507_excel_writer,'7_2',index=False)
daily_201507_excel_writer.save()
daily_20150708 = pro.daily(start_date='',end_date='',trade_date='20150708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150708_tscode_list = list() 
for ts_code_sh in daily_20150708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150708_tscode_list.append(stock_name)
daily_20150708_addname_dataframe=pd.DataFrame()
daily_20150708_addname_dataframe['cname'] = daily_20150708_tscode_list
for table_name in daily_20150708.columns.values.tolist():
    daily_20150708_addname_dataframe[table_name] = daily_20150708[table_name]
print("daily_20150708 返回数据 row 行数 = "+str(daily_20150708.shape[0]))
daily_20150708_addname_dataframe.to_excel(daily_201507_excel_writer,'8_3',index=False)
daily_201507_excel_writer.save()
daily_20150709 = pro.daily(start_date='',end_date='',trade_date='20150709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150709_tscode_list = list() 
for ts_code_sh in daily_20150709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150709_tscode_list.append(stock_name)
daily_20150709_addname_dataframe=pd.DataFrame()
daily_20150709_addname_dataframe['cname'] = daily_20150709_tscode_list
for table_name in daily_20150709.columns.values.tolist():
    daily_20150709_addname_dataframe[table_name] = daily_20150709[table_name]
print("daily_20150709 返回数据 row 行数 = "+str(daily_20150709.shape[0]))
daily_20150709_addname_dataframe.to_excel(daily_201507_excel_writer,'9_4',index=False)
daily_201507_excel_writer.save()
daily_20150710 = pro.daily(start_date='',end_date='',trade_date='20150710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150710_tscode_list = list() 
for ts_code_sh in daily_20150710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150710_tscode_list.append(stock_name)
daily_20150710_addname_dataframe=pd.DataFrame()
daily_20150710_addname_dataframe['cname'] = daily_20150710_tscode_list
for table_name in daily_20150710.columns.values.tolist():
    daily_20150710_addname_dataframe[table_name] = daily_20150710[table_name]
print("daily_20150710 返回数据 row 行数 = "+str(daily_20150710.shape[0]))
daily_20150710_addname_dataframe.to_excel(daily_201507_excel_writer,'10_5',index=False)
daily_201507_excel_writer.save()
daily_20150711 = pro.daily(start_date='',end_date='',trade_date='20150711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150711_tscode_list = list() 
for ts_code_sh in daily_20150711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150711_tscode_list.append(stock_name)
daily_20150711_addname_dataframe=pd.DataFrame()
daily_20150711_addname_dataframe['cname'] = daily_20150711_tscode_list
for table_name in daily_20150711.columns.values.tolist():
    daily_20150711_addname_dataframe[table_name] = daily_20150711[table_name]
print("daily_20150711 返回数据 row 行数 = "+str(daily_20150711.shape[0]))
daily_20150711_addname_dataframe.to_excel(daily_201507_excel_writer,'11_6',index=False)
daily_201507_excel_writer.save()
daily_20150712 = pro.daily(start_date='',end_date='',trade_date='20150712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150712_tscode_list = list() 
for ts_code_sh in daily_20150712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150712_tscode_list.append(stock_name)
daily_20150712_addname_dataframe=pd.DataFrame()
daily_20150712_addname_dataframe['cname'] = daily_20150712_tscode_list
for table_name in daily_20150712.columns.values.tolist():
    daily_20150712_addname_dataframe[table_name] = daily_20150712[table_name]
print("daily_20150712 返回数据 row 行数 = "+str(daily_20150712.shape[0]))
daily_20150712_addname_dataframe.to_excel(daily_201507_excel_writer,'12_7',index=False)
daily_201507_excel_writer.save()
daily_20150713 = pro.daily(start_date='',end_date='',trade_date='20150713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150713_tscode_list = list() 
for ts_code_sh in daily_20150713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150713_tscode_list.append(stock_name)
daily_20150713_addname_dataframe=pd.DataFrame()
daily_20150713_addname_dataframe['cname'] = daily_20150713_tscode_list
for table_name in daily_20150713.columns.values.tolist():
    daily_20150713_addname_dataframe[table_name] = daily_20150713[table_name]
print("daily_20150713 返回数据 row 行数 = "+str(daily_20150713.shape[0]))
daily_20150713_addname_dataframe.to_excel(daily_201507_excel_writer,'13_1',index=False)
daily_201507_excel_writer.save()
daily_20150714 = pro.daily(start_date='',end_date='',trade_date='20150714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150714_tscode_list = list() 
for ts_code_sh in daily_20150714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150714_tscode_list.append(stock_name)
daily_20150714_addname_dataframe=pd.DataFrame()
daily_20150714_addname_dataframe['cname'] = daily_20150714_tscode_list
for table_name in daily_20150714.columns.values.tolist():
    daily_20150714_addname_dataframe[table_name] = daily_20150714[table_name]
print("daily_20150714 返回数据 row 行数 = "+str(daily_20150714.shape[0]))
daily_20150714_addname_dataframe.to_excel(daily_201507_excel_writer,'14_2',index=False)
daily_201507_excel_writer.save()
daily_20150715 = pro.daily(start_date='',end_date='',trade_date='20150715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150715_tscode_list = list() 
for ts_code_sh in daily_20150715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150715_tscode_list.append(stock_name)
daily_20150715_addname_dataframe=pd.DataFrame()
daily_20150715_addname_dataframe['cname'] = daily_20150715_tscode_list
for table_name in daily_20150715.columns.values.tolist():
    daily_20150715_addname_dataframe[table_name] = daily_20150715[table_name]
print("daily_20150715 返回数据 row 行数 = "+str(daily_20150715.shape[0]))
daily_20150715_addname_dataframe.to_excel(daily_201507_excel_writer,'15_3',index=False)
daily_201507_excel_writer.save()
daily_20150716 = pro.daily(start_date='',end_date='',trade_date='20150716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150716_tscode_list = list() 
for ts_code_sh in daily_20150716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150716_tscode_list.append(stock_name)
daily_20150716_addname_dataframe=pd.DataFrame()
daily_20150716_addname_dataframe['cname'] = daily_20150716_tscode_list
for table_name in daily_20150716.columns.values.tolist():
    daily_20150716_addname_dataframe[table_name] = daily_20150716[table_name]
print("daily_20150716 返回数据 row 行数 = "+str(daily_20150716.shape[0]))
daily_20150716_addname_dataframe.to_excel(daily_201507_excel_writer,'16_4',index=False)
daily_201507_excel_writer.save()
daily_20150717 = pro.daily(start_date='',end_date='',trade_date='20150717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150717_tscode_list = list() 
for ts_code_sh in daily_20150717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150717_tscode_list.append(stock_name)
daily_20150717_addname_dataframe=pd.DataFrame()
daily_20150717_addname_dataframe['cname'] = daily_20150717_tscode_list
for table_name in daily_20150717.columns.values.tolist():
    daily_20150717_addname_dataframe[table_name] = daily_20150717[table_name]
print("daily_20150717 返回数据 row 行数 = "+str(daily_20150717.shape[0]))
daily_20150717_addname_dataframe.to_excel(daily_201507_excel_writer,'17_5',index=False)
daily_201507_excel_writer.save()
daily_20150718 = pro.daily(start_date='',end_date='',trade_date='20150718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150718_tscode_list = list() 
for ts_code_sh in daily_20150718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150718_tscode_list.append(stock_name)
daily_20150718_addname_dataframe=pd.DataFrame()
daily_20150718_addname_dataframe['cname'] = daily_20150718_tscode_list
for table_name in daily_20150718.columns.values.tolist():
    daily_20150718_addname_dataframe[table_name] = daily_20150718[table_name]
print("daily_20150718 返回数据 row 行数 = "+str(daily_20150718.shape[0]))
daily_20150718_addname_dataframe.to_excel(daily_201507_excel_writer,'18_6',index=False)
daily_201507_excel_writer.save()
daily_20150719 = pro.daily(start_date='',end_date='',trade_date='20150719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150719_tscode_list = list() 
for ts_code_sh in daily_20150719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150719_tscode_list.append(stock_name)
daily_20150719_addname_dataframe=pd.DataFrame()
daily_20150719_addname_dataframe['cname'] = daily_20150719_tscode_list
for table_name in daily_20150719.columns.values.tolist():
    daily_20150719_addname_dataframe[table_name] = daily_20150719[table_name]
print("daily_20150719 返回数据 row 行数 = "+str(daily_20150719.shape[0]))
daily_20150719_addname_dataframe.to_excel(daily_201507_excel_writer,'19_7',index=False)
daily_201507_excel_writer.save()
daily_20150720 = pro.daily(start_date='',end_date='',trade_date='20150720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150720_tscode_list = list() 
for ts_code_sh in daily_20150720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150720_tscode_list.append(stock_name)
daily_20150720_addname_dataframe=pd.DataFrame()
daily_20150720_addname_dataframe['cname'] = daily_20150720_tscode_list
for table_name in daily_20150720.columns.values.tolist():
    daily_20150720_addname_dataframe[table_name] = daily_20150720[table_name]
print("daily_20150720 返回数据 row 行数 = "+str(daily_20150720.shape[0]))
daily_20150720_addname_dataframe.to_excel(daily_201507_excel_writer,'20_1',index=False)
daily_201507_excel_writer.save()
daily_20150721 = pro.daily(start_date='',end_date='',trade_date='20150721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150721_tscode_list = list() 
for ts_code_sh in daily_20150721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150721_tscode_list.append(stock_name)
daily_20150721_addname_dataframe=pd.DataFrame()
daily_20150721_addname_dataframe['cname'] = daily_20150721_tscode_list
for table_name in daily_20150721.columns.values.tolist():
    daily_20150721_addname_dataframe[table_name] = daily_20150721[table_name]
print("daily_20150721 返回数据 row 行数 = "+str(daily_20150721.shape[0]))
daily_20150721_addname_dataframe.to_excel(daily_201507_excel_writer,'21_2',index=False)
daily_201507_excel_writer.save()
daily_20150722 = pro.daily(start_date='',end_date='',trade_date='20150722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150722_tscode_list = list() 
for ts_code_sh in daily_20150722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150722_tscode_list.append(stock_name)
daily_20150722_addname_dataframe=pd.DataFrame()
daily_20150722_addname_dataframe['cname'] = daily_20150722_tscode_list
for table_name in daily_20150722.columns.values.tolist():
    daily_20150722_addname_dataframe[table_name] = daily_20150722[table_name]
print("daily_20150722 返回数据 row 行数 = "+str(daily_20150722.shape[0]))
daily_20150722_addname_dataframe.to_excel(daily_201507_excel_writer,'22_3',index=False)
daily_201507_excel_writer.save()
daily_20150723 = pro.daily(start_date='',end_date='',trade_date='20150723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150723_tscode_list = list() 
for ts_code_sh in daily_20150723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150723_tscode_list.append(stock_name)
daily_20150723_addname_dataframe=pd.DataFrame()
daily_20150723_addname_dataframe['cname'] = daily_20150723_tscode_list
for table_name in daily_20150723.columns.values.tolist():
    daily_20150723_addname_dataframe[table_name] = daily_20150723[table_name]
print("daily_20150723 返回数据 row 行数 = "+str(daily_20150723.shape[0]))
daily_20150723_addname_dataframe.to_excel(daily_201507_excel_writer,'23_4',index=False)
daily_201507_excel_writer.save()
daily_20150724 = pro.daily(start_date='',end_date='',trade_date='20150724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150724_tscode_list = list() 
for ts_code_sh in daily_20150724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150724_tscode_list.append(stock_name)
daily_20150724_addname_dataframe=pd.DataFrame()
daily_20150724_addname_dataframe['cname'] = daily_20150724_tscode_list
for table_name in daily_20150724.columns.values.tolist():
    daily_20150724_addname_dataframe[table_name] = daily_20150724[table_name]
print("daily_20150724 返回数据 row 行数 = "+str(daily_20150724.shape[0]))
daily_20150724_addname_dataframe.to_excel(daily_201507_excel_writer,'24_5',index=False)
daily_201507_excel_writer.save()
daily_20150725 = pro.daily(start_date='',end_date='',trade_date='20150725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150725_tscode_list = list() 
for ts_code_sh in daily_20150725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150725_tscode_list.append(stock_name)
daily_20150725_addname_dataframe=pd.DataFrame()
daily_20150725_addname_dataframe['cname'] = daily_20150725_tscode_list
for table_name in daily_20150725.columns.values.tolist():
    daily_20150725_addname_dataframe[table_name] = daily_20150725[table_name]
print("daily_20150725 返回数据 row 行数 = "+str(daily_20150725.shape[0]))
daily_20150725_addname_dataframe.to_excel(daily_201507_excel_writer,'25_6',index=False)
daily_201507_excel_writer.save()
daily_20150726 = pro.daily(start_date='',end_date='',trade_date='20150726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150726_tscode_list = list() 
for ts_code_sh in daily_20150726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150726_tscode_list.append(stock_name)
daily_20150726_addname_dataframe=pd.DataFrame()
daily_20150726_addname_dataframe['cname'] = daily_20150726_tscode_list
for table_name in daily_20150726.columns.values.tolist():
    daily_20150726_addname_dataframe[table_name] = daily_20150726[table_name]
print("daily_20150726 返回数据 row 行数 = "+str(daily_20150726.shape[0]))
daily_20150726_addname_dataframe.to_excel(daily_201507_excel_writer,'26_7',index=False)
daily_201507_excel_writer.save()
daily_20150727 = pro.daily(start_date='',end_date='',trade_date='20150727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150727_tscode_list = list() 
for ts_code_sh in daily_20150727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150727_tscode_list.append(stock_name)
daily_20150727_addname_dataframe=pd.DataFrame()
daily_20150727_addname_dataframe['cname'] = daily_20150727_tscode_list
for table_name in daily_20150727.columns.values.tolist():
    daily_20150727_addname_dataframe[table_name] = daily_20150727[table_name]
print("daily_20150727 返回数据 row 行数 = "+str(daily_20150727.shape[0]))
daily_20150727_addname_dataframe.to_excel(daily_201507_excel_writer,'27_1',index=False)
daily_201507_excel_writer.save()
daily_20150728 = pro.daily(start_date='',end_date='',trade_date='20150728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150728_tscode_list = list() 
for ts_code_sh in daily_20150728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150728_tscode_list.append(stock_name)
daily_20150728_addname_dataframe=pd.DataFrame()
daily_20150728_addname_dataframe['cname'] = daily_20150728_tscode_list
for table_name in daily_20150728.columns.values.tolist():
    daily_20150728_addname_dataframe[table_name] = daily_20150728[table_name]
print("daily_20150728 返回数据 row 行数 = "+str(daily_20150728.shape[0]))
daily_20150728_addname_dataframe.to_excel(daily_201507_excel_writer,'28_2',index=False)
daily_201507_excel_writer.save()
daily_20150729 = pro.daily(start_date='',end_date='',trade_date='20150729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150729_tscode_list = list() 
for ts_code_sh in daily_20150729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150729_tscode_list.append(stock_name)
daily_20150729_addname_dataframe=pd.DataFrame()
daily_20150729_addname_dataframe['cname'] = daily_20150729_tscode_list
for table_name in daily_20150729.columns.values.tolist():
    daily_20150729_addname_dataframe[table_name] = daily_20150729[table_name]
print("daily_20150729 返回数据 row 行数 = "+str(daily_20150729.shape[0]))
daily_20150729_addname_dataframe.to_excel(daily_201507_excel_writer,'29_3',index=False)
daily_201507_excel_writer.save()
daily_20150730 = pro.daily(start_date='',end_date='',trade_date='20150730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150730_tscode_list = list() 
for ts_code_sh in daily_20150730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150730_tscode_list.append(stock_name)
daily_20150730_addname_dataframe=pd.DataFrame()
daily_20150730_addname_dataframe['cname'] = daily_20150730_tscode_list
for table_name in daily_20150730.columns.values.tolist():
    daily_20150730_addname_dataframe[table_name] = daily_20150730[table_name]
print("daily_20150730 返回数据 row 行数 = "+str(daily_20150730.shape[0]))
daily_20150730_addname_dataframe.to_excel(daily_201507_excel_writer,'30_4',index=False)
daily_201507_excel_writer.save()
daily_20150731 = pro.daily(start_date='',end_date='',trade_date='20150731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150731_tscode_list = list() 
for ts_code_sh in daily_20150731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150731_tscode_list.append(stock_name)
daily_20150731_addname_dataframe=pd.DataFrame()
daily_20150731_addname_dataframe['cname'] = daily_20150731_tscode_list
for table_name in daily_20150731.columns.values.tolist():
    daily_20150731_addname_dataframe[table_name] = daily_20150731[table_name]
print("daily_20150731 返回数据 row 行数 = "+str(daily_20150731.shape[0]))
daily_20150731_addname_dataframe.to_excel(daily_201507_excel_writer,'31_5',index=False)
daily_201507_excel_writer.save()




createexcel('daily_201508.xlsx')
daily_201508_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201508.xlsx')
daily_201508_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201508.xlsx', engine='openpyxl')
daily_201508_excel_writer.book = daily_201508_book
daily_201508_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201508_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150801")       ###  更新 记录日期
daily_20150801 = pro.daily(start_date='',end_date='',trade_date='20150801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150801_tscode_list = list() 
for ts_code_sh in daily_20150801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150801_tscode_list.append(stock_name)
daily_20150801_addname_dataframe=pd.DataFrame()
daily_20150801_addname_dataframe['cname'] = daily_20150801_tscode_list
for table_name in daily_20150801.columns.values.tolist():
    daily_20150801_addname_dataframe[table_name] = daily_20150801[table_name]
print("daily_20150801 返回数据 row 行数 = "+str(daily_20150801.shape[0]))
daily_20150801_addname_dataframe.to_excel(daily_201508_excel_writer,'1_6',index=False)
daily_201508_excel_writer.save()
daily_20150802 = pro.daily(start_date='',end_date='',trade_date='20150802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150802_tscode_list = list() 
for ts_code_sh in daily_20150802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150802_tscode_list.append(stock_name)
daily_20150802_addname_dataframe=pd.DataFrame()
daily_20150802_addname_dataframe['cname'] = daily_20150802_tscode_list
for table_name in daily_20150802.columns.values.tolist():
    daily_20150802_addname_dataframe[table_name] = daily_20150802[table_name]
print("daily_20150802 返回数据 row 行数 = "+str(daily_20150802.shape[0]))
daily_20150802_addname_dataframe.to_excel(daily_201508_excel_writer,'2_7',index=False)
daily_201508_excel_writer.save()
daily_20150803 = pro.daily(start_date='',end_date='',trade_date='20150803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150803_tscode_list = list() 
for ts_code_sh in daily_20150803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150803_tscode_list.append(stock_name)
daily_20150803_addname_dataframe=pd.DataFrame()
daily_20150803_addname_dataframe['cname'] = daily_20150803_tscode_list
for table_name in daily_20150803.columns.values.tolist():
    daily_20150803_addname_dataframe[table_name] = daily_20150803[table_name]
print("daily_20150803 返回数据 row 行数 = "+str(daily_20150803.shape[0]))
daily_20150803_addname_dataframe.to_excel(daily_201508_excel_writer,'3_1',index=False)
daily_201508_excel_writer.save()
daily_20150804 = pro.daily(start_date='',end_date='',trade_date='20150804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150804_tscode_list = list() 
for ts_code_sh in daily_20150804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150804_tscode_list.append(stock_name)
daily_20150804_addname_dataframe=pd.DataFrame()
daily_20150804_addname_dataframe['cname'] = daily_20150804_tscode_list
for table_name in daily_20150804.columns.values.tolist():
    daily_20150804_addname_dataframe[table_name] = daily_20150804[table_name]
print("daily_20150804 返回数据 row 行数 = "+str(daily_20150804.shape[0]))
daily_20150804_addname_dataframe.to_excel(daily_201508_excel_writer,'4_2',index=False)
daily_201508_excel_writer.save()
daily_20150805 = pro.daily(start_date='',end_date='',trade_date='20150805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150805_tscode_list = list() 
for ts_code_sh in daily_20150805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150805_tscode_list.append(stock_name)
daily_20150805_addname_dataframe=pd.DataFrame()
daily_20150805_addname_dataframe['cname'] = daily_20150805_tscode_list
for table_name in daily_20150805.columns.values.tolist():
    daily_20150805_addname_dataframe[table_name] = daily_20150805[table_name]
print("daily_20150805 返回数据 row 行数 = "+str(daily_20150805.shape[0]))
daily_20150805_addname_dataframe.to_excel(daily_201508_excel_writer,'5_3',index=False)
daily_201508_excel_writer.save()
daily_20150806 = pro.daily(start_date='',end_date='',trade_date='20150806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150806_tscode_list = list() 
for ts_code_sh in daily_20150806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150806_tscode_list.append(stock_name)
daily_20150806_addname_dataframe=pd.DataFrame()
daily_20150806_addname_dataframe['cname'] = daily_20150806_tscode_list
for table_name in daily_20150806.columns.values.tolist():
    daily_20150806_addname_dataframe[table_name] = daily_20150806[table_name]
print("daily_20150806 返回数据 row 行数 = "+str(daily_20150806.shape[0]))
daily_20150806_addname_dataframe.to_excel(daily_201508_excel_writer,'6_4',index=False)
daily_201508_excel_writer.save()
daily_20150807 = pro.daily(start_date='',end_date='',trade_date='20150807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150807_tscode_list = list() 
for ts_code_sh in daily_20150807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150807_tscode_list.append(stock_name)
daily_20150807_addname_dataframe=pd.DataFrame()
daily_20150807_addname_dataframe['cname'] = daily_20150807_tscode_list
for table_name in daily_20150807.columns.values.tolist():
    daily_20150807_addname_dataframe[table_name] = daily_20150807[table_name]
print("daily_20150807 返回数据 row 行数 = "+str(daily_20150807.shape[0]))
daily_20150807_addname_dataframe.to_excel(daily_201508_excel_writer,'7_5',index=False)
daily_201508_excel_writer.save()
daily_20150808 = pro.daily(start_date='',end_date='',trade_date='20150808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150808_tscode_list = list() 
for ts_code_sh in daily_20150808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150808_tscode_list.append(stock_name)
daily_20150808_addname_dataframe=pd.DataFrame()
daily_20150808_addname_dataframe['cname'] = daily_20150808_tscode_list
for table_name in daily_20150808.columns.values.tolist():
    daily_20150808_addname_dataframe[table_name] = daily_20150808[table_name]
print("daily_20150808 返回数据 row 行数 = "+str(daily_20150808.shape[0]))
daily_20150808_addname_dataframe.to_excel(daily_201508_excel_writer,'8_6',index=False)
daily_201508_excel_writer.save()
daily_20150809 = pro.daily(start_date='',end_date='',trade_date='20150809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150809_tscode_list = list() 
for ts_code_sh in daily_20150809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150809_tscode_list.append(stock_name)
daily_20150809_addname_dataframe=pd.DataFrame()
daily_20150809_addname_dataframe['cname'] = daily_20150809_tscode_list
for table_name in daily_20150809.columns.values.tolist():
    daily_20150809_addname_dataframe[table_name] = daily_20150809[table_name]
print("daily_20150809 返回数据 row 行数 = "+str(daily_20150809.shape[0]))
daily_20150809_addname_dataframe.to_excel(daily_201508_excel_writer,'9_7',index=False)
daily_201508_excel_writer.save()
daily_20150810 = pro.daily(start_date='',end_date='',trade_date='20150810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150810_tscode_list = list() 
for ts_code_sh in daily_20150810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150810_tscode_list.append(stock_name)
daily_20150810_addname_dataframe=pd.DataFrame()
daily_20150810_addname_dataframe['cname'] = daily_20150810_tscode_list
for table_name in daily_20150810.columns.values.tolist():
    daily_20150810_addname_dataframe[table_name] = daily_20150810[table_name]
print("daily_20150810 返回数据 row 行数 = "+str(daily_20150810.shape[0]))
daily_20150810_addname_dataframe.to_excel(daily_201508_excel_writer,'10_1',index=False)
daily_201508_excel_writer.save()
daily_20150811 = pro.daily(start_date='',end_date='',trade_date='20150811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150811_tscode_list = list() 
for ts_code_sh in daily_20150811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150811_tscode_list.append(stock_name)
daily_20150811_addname_dataframe=pd.DataFrame()
daily_20150811_addname_dataframe['cname'] = daily_20150811_tscode_list
for table_name in daily_20150811.columns.values.tolist():
    daily_20150811_addname_dataframe[table_name] = daily_20150811[table_name]
print("daily_20150811 返回数据 row 行数 = "+str(daily_20150811.shape[0]))
daily_20150811_addname_dataframe.to_excel(daily_201508_excel_writer,'11_2',index=False)
daily_201508_excel_writer.save()
daily_20150812 = pro.daily(start_date='',end_date='',trade_date='20150812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150812_tscode_list = list() 
for ts_code_sh in daily_20150812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150812_tscode_list.append(stock_name)
daily_20150812_addname_dataframe=pd.DataFrame()
daily_20150812_addname_dataframe['cname'] = daily_20150812_tscode_list
for table_name in daily_20150812.columns.values.tolist():
    daily_20150812_addname_dataframe[table_name] = daily_20150812[table_name]
print("daily_20150812 返回数据 row 行数 = "+str(daily_20150812.shape[0]))
daily_20150812_addname_dataframe.to_excel(daily_201508_excel_writer,'12_3',index=False)
daily_201508_excel_writer.save()
daily_20150813 = pro.daily(start_date='',end_date='',trade_date='20150813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150813_tscode_list = list() 
for ts_code_sh in daily_20150813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150813_tscode_list.append(stock_name)
daily_20150813_addname_dataframe=pd.DataFrame()
daily_20150813_addname_dataframe['cname'] = daily_20150813_tscode_list
for table_name in daily_20150813.columns.values.tolist():
    daily_20150813_addname_dataframe[table_name] = daily_20150813[table_name]
print("daily_20150813 返回数据 row 行数 = "+str(daily_20150813.shape[0]))
daily_20150813_addname_dataframe.to_excel(daily_201508_excel_writer,'13_4',index=False)
daily_201508_excel_writer.save()
daily_20150814 = pro.daily(start_date='',end_date='',trade_date='20150814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150814_tscode_list = list() 
for ts_code_sh in daily_20150814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150814_tscode_list.append(stock_name)
daily_20150814_addname_dataframe=pd.DataFrame()
daily_20150814_addname_dataframe['cname'] = daily_20150814_tscode_list
for table_name in daily_20150814.columns.values.tolist():
    daily_20150814_addname_dataframe[table_name] = daily_20150814[table_name]
print("daily_20150814 返回数据 row 行数 = "+str(daily_20150814.shape[0]))
daily_20150814_addname_dataframe.to_excel(daily_201508_excel_writer,'14_5',index=False)
daily_201508_excel_writer.save()
daily_20150815 = pro.daily(start_date='',end_date='',trade_date='20150815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150815_tscode_list = list() 
for ts_code_sh in daily_20150815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150815_tscode_list.append(stock_name)
daily_20150815_addname_dataframe=pd.DataFrame()
daily_20150815_addname_dataframe['cname'] = daily_20150815_tscode_list
for table_name in daily_20150815.columns.values.tolist():
    daily_20150815_addname_dataframe[table_name] = daily_20150815[table_name]
print("daily_20150815 返回数据 row 行数 = "+str(daily_20150815.shape[0]))
daily_20150815_addname_dataframe.to_excel(daily_201508_excel_writer,'15_6',index=False)
daily_201508_excel_writer.save()
daily_20150816 = pro.daily(start_date='',end_date='',trade_date='20150816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150816_tscode_list = list() 
for ts_code_sh in daily_20150816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150816_tscode_list.append(stock_name)
daily_20150816_addname_dataframe=pd.DataFrame()
daily_20150816_addname_dataframe['cname'] = daily_20150816_tscode_list
for table_name in daily_20150816.columns.values.tolist():
    daily_20150816_addname_dataframe[table_name] = daily_20150816[table_name]
print("daily_20150816 返回数据 row 行数 = "+str(daily_20150816.shape[0]))
daily_20150816_addname_dataframe.to_excel(daily_201508_excel_writer,'16_7',index=False)
daily_201508_excel_writer.save()
daily_20150817 = pro.daily(start_date='',end_date='',trade_date='20150817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150817_tscode_list = list() 
for ts_code_sh in daily_20150817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150817_tscode_list.append(stock_name)
daily_20150817_addname_dataframe=pd.DataFrame()
daily_20150817_addname_dataframe['cname'] = daily_20150817_tscode_list
for table_name in daily_20150817.columns.values.tolist():
    daily_20150817_addname_dataframe[table_name] = daily_20150817[table_name]
print("daily_20150817 返回数据 row 行数 = "+str(daily_20150817.shape[0]))
daily_20150817_addname_dataframe.to_excel(daily_201508_excel_writer,'17_1',index=False)
daily_201508_excel_writer.save()
daily_20150818 = pro.daily(start_date='',end_date='',trade_date='20150818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150818_tscode_list = list() 
for ts_code_sh in daily_20150818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150818_tscode_list.append(stock_name)
daily_20150818_addname_dataframe=pd.DataFrame()
daily_20150818_addname_dataframe['cname'] = daily_20150818_tscode_list
for table_name in daily_20150818.columns.values.tolist():
    daily_20150818_addname_dataframe[table_name] = daily_20150818[table_name]
print("daily_20150818 返回数据 row 行数 = "+str(daily_20150818.shape[0]))
daily_20150818_addname_dataframe.to_excel(daily_201508_excel_writer,'18_2',index=False)
daily_201508_excel_writer.save()
daily_20150819 = pro.daily(start_date='',end_date='',trade_date='20150819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150819_tscode_list = list() 
for ts_code_sh in daily_20150819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150819_tscode_list.append(stock_name)
daily_20150819_addname_dataframe=pd.DataFrame()
daily_20150819_addname_dataframe['cname'] = daily_20150819_tscode_list
for table_name in daily_20150819.columns.values.tolist():
    daily_20150819_addname_dataframe[table_name] = daily_20150819[table_name]
print("daily_20150819 返回数据 row 行数 = "+str(daily_20150819.shape[0]))
daily_20150819_addname_dataframe.to_excel(daily_201508_excel_writer,'19_3',index=False)
daily_201508_excel_writer.save()
daily_20150820 = pro.daily(start_date='',end_date='',trade_date='20150820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150820_tscode_list = list() 
for ts_code_sh in daily_20150820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150820_tscode_list.append(stock_name)
daily_20150820_addname_dataframe=pd.DataFrame()
daily_20150820_addname_dataframe['cname'] = daily_20150820_tscode_list
for table_name in daily_20150820.columns.values.tolist():
    daily_20150820_addname_dataframe[table_name] = daily_20150820[table_name]
print("daily_20150820 返回数据 row 行数 = "+str(daily_20150820.shape[0]))
daily_20150820_addname_dataframe.to_excel(daily_201508_excel_writer,'20_4',index=False)
daily_201508_excel_writer.save()
daily_20150821 = pro.daily(start_date='',end_date='',trade_date='20150821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150821_tscode_list = list() 
for ts_code_sh in daily_20150821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150821_tscode_list.append(stock_name)
daily_20150821_addname_dataframe=pd.DataFrame()
daily_20150821_addname_dataframe['cname'] = daily_20150821_tscode_list
for table_name in daily_20150821.columns.values.tolist():
    daily_20150821_addname_dataframe[table_name] = daily_20150821[table_name]
print("daily_20150821 返回数据 row 行数 = "+str(daily_20150821.shape[0]))
daily_20150821_addname_dataframe.to_excel(daily_201508_excel_writer,'21_5',index=False)
daily_201508_excel_writer.save()
daily_20150822 = pro.daily(start_date='',end_date='',trade_date='20150822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150822_tscode_list = list() 
for ts_code_sh in daily_20150822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150822_tscode_list.append(stock_name)
daily_20150822_addname_dataframe=pd.DataFrame()
daily_20150822_addname_dataframe['cname'] = daily_20150822_tscode_list
for table_name in daily_20150822.columns.values.tolist():
    daily_20150822_addname_dataframe[table_name] = daily_20150822[table_name]
print("daily_20150822 返回数据 row 行数 = "+str(daily_20150822.shape[0]))
daily_20150822_addname_dataframe.to_excel(daily_201508_excel_writer,'22_6',index=False)
daily_201508_excel_writer.save()
daily_20150823 = pro.daily(start_date='',end_date='',trade_date='20150823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150823_tscode_list = list() 
for ts_code_sh in daily_20150823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150823_tscode_list.append(stock_name)
daily_20150823_addname_dataframe=pd.DataFrame()
daily_20150823_addname_dataframe['cname'] = daily_20150823_tscode_list
for table_name in daily_20150823.columns.values.tolist():
    daily_20150823_addname_dataframe[table_name] = daily_20150823[table_name]
print("daily_20150823 返回数据 row 行数 = "+str(daily_20150823.shape[0]))
daily_20150823_addname_dataframe.to_excel(daily_201508_excel_writer,'23_7',index=False)
daily_201508_excel_writer.save()
daily_20150824 = pro.daily(start_date='',end_date='',trade_date='20150824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150824_tscode_list = list() 
for ts_code_sh in daily_20150824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150824_tscode_list.append(stock_name)
daily_20150824_addname_dataframe=pd.DataFrame()
daily_20150824_addname_dataframe['cname'] = daily_20150824_tscode_list
for table_name in daily_20150824.columns.values.tolist():
    daily_20150824_addname_dataframe[table_name] = daily_20150824[table_name]
print("daily_20150824 返回数据 row 行数 = "+str(daily_20150824.shape[0]))
daily_20150824_addname_dataframe.to_excel(daily_201508_excel_writer,'24_1',index=False)
daily_201508_excel_writer.save()
daily_20150825 = pro.daily(start_date='',end_date='',trade_date='20150825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150825_tscode_list = list() 
for ts_code_sh in daily_20150825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150825_tscode_list.append(stock_name)
daily_20150825_addname_dataframe=pd.DataFrame()
daily_20150825_addname_dataframe['cname'] = daily_20150825_tscode_list
for table_name in daily_20150825.columns.values.tolist():
    daily_20150825_addname_dataframe[table_name] = daily_20150825[table_name]
print("daily_20150825 返回数据 row 行数 = "+str(daily_20150825.shape[0]))
daily_20150825_addname_dataframe.to_excel(daily_201508_excel_writer,'25_2',index=False)
daily_201508_excel_writer.save()
daily_20150826 = pro.daily(start_date='',end_date='',trade_date='20150826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150826_tscode_list = list() 
for ts_code_sh in daily_20150826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150826_tscode_list.append(stock_name)
daily_20150826_addname_dataframe=pd.DataFrame()
daily_20150826_addname_dataframe['cname'] = daily_20150826_tscode_list
for table_name in daily_20150826.columns.values.tolist():
    daily_20150826_addname_dataframe[table_name] = daily_20150826[table_name]
print("daily_20150826 返回数据 row 行数 = "+str(daily_20150826.shape[0]))
daily_20150826_addname_dataframe.to_excel(daily_201508_excel_writer,'26_3',index=False)
daily_201508_excel_writer.save()
daily_20150827 = pro.daily(start_date='',end_date='',trade_date='20150827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150827_tscode_list = list() 
for ts_code_sh in daily_20150827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150827_tscode_list.append(stock_name)
daily_20150827_addname_dataframe=pd.DataFrame()
daily_20150827_addname_dataframe['cname'] = daily_20150827_tscode_list
for table_name in daily_20150827.columns.values.tolist():
    daily_20150827_addname_dataframe[table_name] = daily_20150827[table_name]
print("daily_20150827 返回数据 row 行数 = "+str(daily_20150827.shape[0]))
daily_20150827_addname_dataframe.to_excel(daily_201508_excel_writer,'27_4',index=False)
daily_201508_excel_writer.save()
daily_20150828 = pro.daily(start_date='',end_date='',trade_date='20150828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150828_tscode_list = list() 
for ts_code_sh in daily_20150828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150828_tscode_list.append(stock_name)
daily_20150828_addname_dataframe=pd.DataFrame()
daily_20150828_addname_dataframe['cname'] = daily_20150828_tscode_list
for table_name in daily_20150828.columns.values.tolist():
    daily_20150828_addname_dataframe[table_name] = daily_20150828[table_name]
print("daily_20150828 返回数据 row 行数 = "+str(daily_20150828.shape[0]))
daily_20150828_addname_dataframe.to_excel(daily_201508_excel_writer,'28_5',index=False)
daily_201508_excel_writer.save()
daily_20150829 = pro.daily(start_date='',end_date='',trade_date='20150829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150829_tscode_list = list() 
for ts_code_sh in daily_20150829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150829_tscode_list.append(stock_name)
daily_20150829_addname_dataframe=pd.DataFrame()
daily_20150829_addname_dataframe['cname'] = daily_20150829_tscode_list
for table_name in daily_20150829.columns.values.tolist():
    daily_20150829_addname_dataframe[table_name] = daily_20150829[table_name]
print("daily_20150829 返回数据 row 行数 = "+str(daily_20150829.shape[0]))
daily_20150829_addname_dataframe.to_excel(daily_201508_excel_writer,'29_6',index=False)
daily_201508_excel_writer.save()
daily_20150830 = pro.daily(start_date='',end_date='',trade_date='20150830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150830_tscode_list = list() 
for ts_code_sh in daily_20150830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150830_tscode_list.append(stock_name)
daily_20150830_addname_dataframe=pd.DataFrame()
daily_20150830_addname_dataframe['cname'] = daily_20150830_tscode_list
for table_name in daily_20150830.columns.values.tolist():
    daily_20150830_addname_dataframe[table_name] = daily_20150830[table_name]
print("daily_20150830 返回数据 row 行数 = "+str(daily_20150830.shape[0]))
daily_20150830_addname_dataframe.to_excel(daily_201508_excel_writer,'30_7',index=False)
daily_201508_excel_writer.save()
daily_20150831 = pro.daily(start_date='',end_date='',trade_date='20150831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150831_tscode_list = list() 
for ts_code_sh in daily_20150831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150831_tscode_list.append(stock_name)
daily_20150831_addname_dataframe=pd.DataFrame()
daily_20150831_addname_dataframe['cname'] = daily_20150831_tscode_list
for table_name in daily_20150831.columns.values.tolist():
    daily_20150831_addname_dataframe[table_name] = daily_20150831[table_name]
print("daily_20150831 返回数据 row 行数 = "+str(daily_20150831.shape[0]))
daily_20150831_addname_dataframe.to_excel(daily_201508_excel_writer,'31_1',index=False)
daily_201508_excel_writer.save()




createexcel('daily_201509.xlsx')
daily_201509_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201509.xlsx')
daily_201509_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201509.xlsx', engine='openpyxl')
daily_201509_excel_writer.book = daily_201509_book
daily_201509_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201509_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150901")       ###  更新 记录日期
daily_20150901 = pro.daily(start_date='',end_date='',trade_date='20150901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150901_tscode_list = list() 
for ts_code_sh in daily_20150901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150901_tscode_list.append(stock_name)
daily_20150901_addname_dataframe=pd.DataFrame()
daily_20150901_addname_dataframe['cname'] = daily_20150901_tscode_list
for table_name in daily_20150901.columns.values.tolist():
    daily_20150901_addname_dataframe[table_name] = daily_20150901[table_name]
print("daily_20150901 返回数据 row 行数 = "+str(daily_20150901.shape[0]))
daily_20150901_addname_dataframe.to_excel(daily_201509_excel_writer,'1_2',index=False)
daily_201509_excel_writer.save()
daily_20150902 = pro.daily(start_date='',end_date='',trade_date='20150902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150902_tscode_list = list() 
for ts_code_sh in daily_20150902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150902_tscode_list.append(stock_name)
daily_20150902_addname_dataframe=pd.DataFrame()
daily_20150902_addname_dataframe['cname'] = daily_20150902_tscode_list
for table_name in daily_20150902.columns.values.tolist():
    daily_20150902_addname_dataframe[table_name] = daily_20150902[table_name]
print("daily_20150902 返回数据 row 行数 = "+str(daily_20150902.shape[0]))
daily_20150902_addname_dataframe.to_excel(daily_201509_excel_writer,'2_3',index=False)
daily_201509_excel_writer.save()
daily_20150903 = pro.daily(start_date='',end_date='',trade_date='20150903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150903_tscode_list = list() 
for ts_code_sh in daily_20150903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150903_tscode_list.append(stock_name)
daily_20150903_addname_dataframe=pd.DataFrame()
daily_20150903_addname_dataframe['cname'] = daily_20150903_tscode_list
for table_name in daily_20150903.columns.values.tolist():
    daily_20150903_addname_dataframe[table_name] = daily_20150903[table_name]
print("daily_20150903 返回数据 row 行数 = "+str(daily_20150903.shape[0]))
daily_20150903_addname_dataframe.to_excel(daily_201509_excel_writer,'3_4',index=False)
daily_201509_excel_writer.save()
daily_20150904 = pro.daily(start_date='',end_date='',trade_date='20150904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150904_tscode_list = list() 
for ts_code_sh in daily_20150904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150904_tscode_list.append(stock_name)
daily_20150904_addname_dataframe=pd.DataFrame()
daily_20150904_addname_dataframe['cname'] = daily_20150904_tscode_list
for table_name in daily_20150904.columns.values.tolist():
    daily_20150904_addname_dataframe[table_name] = daily_20150904[table_name]
print("daily_20150904 返回数据 row 行数 = "+str(daily_20150904.shape[0]))
daily_20150904_addname_dataframe.to_excel(daily_201509_excel_writer,'4_5',index=False)
daily_201509_excel_writer.save()
daily_20150905 = pro.daily(start_date='',end_date='',trade_date='20150905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150905_tscode_list = list() 
for ts_code_sh in daily_20150905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150905_tscode_list.append(stock_name)
daily_20150905_addname_dataframe=pd.DataFrame()
daily_20150905_addname_dataframe['cname'] = daily_20150905_tscode_list
for table_name in daily_20150905.columns.values.tolist():
    daily_20150905_addname_dataframe[table_name] = daily_20150905[table_name]
print("daily_20150905 返回数据 row 行数 = "+str(daily_20150905.shape[0]))
daily_20150905_addname_dataframe.to_excel(daily_201509_excel_writer,'5_6',index=False)
daily_201509_excel_writer.save()
daily_20150906 = pro.daily(start_date='',end_date='',trade_date='20150906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150906_tscode_list = list() 
for ts_code_sh in daily_20150906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150906_tscode_list.append(stock_name)
daily_20150906_addname_dataframe=pd.DataFrame()
daily_20150906_addname_dataframe['cname'] = daily_20150906_tscode_list
for table_name in daily_20150906.columns.values.tolist():
    daily_20150906_addname_dataframe[table_name] = daily_20150906[table_name]
print("daily_20150906 返回数据 row 行数 = "+str(daily_20150906.shape[0]))
daily_20150906_addname_dataframe.to_excel(daily_201509_excel_writer,'6_7',index=False)
daily_201509_excel_writer.save()
daily_20150907 = pro.daily(start_date='',end_date='',trade_date='20150907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150907_tscode_list = list() 
for ts_code_sh in daily_20150907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150907_tscode_list.append(stock_name)
daily_20150907_addname_dataframe=pd.DataFrame()
daily_20150907_addname_dataframe['cname'] = daily_20150907_tscode_list
for table_name in daily_20150907.columns.values.tolist():
    daily_20150907_addname_dataframe[table_name] = daily_20150907[table_name]
print("daily_20150907 返回数据 row 行数 = "+str(daily_20150907.shape[0]))
daily_20150907_addname_dataframe.to_excel(daily_201509_excel_writer,'7_1',index=False)
daily_201509_excel_writer.save()
daily_20150908 = pro.daily(start_date='',end_date='',trade_date='20150908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150908_tscode_list = list() 
for ts_code_sh in daily_20150908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150908_tscode_list.append(stock_name)
daily_20150908_addname_dataframe=pd.DataFrame()
daily_20150908_addname_dataframe['cname'] = daily_20150908_tscode_list
for table_name in daily_20150908.columns.values.tolist():
    daily_20150908_addname_dataframe[table_name] = daily_20150908[table_name]
print("daily_20150908 返回数据 row 行数 = "+str(daily_20150908.shape[0]))
daily_20150908_addname_dataframe.to_excel(daily_201509_excel_writer,'8_2',index=False)
daily_201509_excel_writer.save()
daily_20150909 = pro.daily(start_date='',end_date='',trade_date='20150909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150909_tscode_list = list() 
for ts_code_sh in daily_20150909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150909_tscode_list.append(stock_name)
daily_20150909_addname_dataframe=pd.DataFrame()
daily_20150909_addname_dataframe['cname'] = daily_20150909_tscode_list
for table_name in daily_20150909.columns.values.tolist():
    daily_20150909_addname_dataframe[table_name] = daily_20150909[table_name]
print("daily_20150909 返回数据 row 行数 = "+str(daily_20150909.shape[0]))
daily_20150909_addname_dataframe.to_excel(daily_201509_excel_writer,'9_3',index=False)
daily_201509_excel_writer.save()
daily_20150910 = pro.daily(start_date='',end_date='',trade_date='20150910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150910_tscode_list = list() 
for ts_code_sh in daily_20150910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150910_tscode_list.append(stock_name)
daily_20150910_addname_dataframe=pd.DataFrame()
daily_20150910_addname_dataframe['cname'] = daily_20150910_tscode_list
for table_name in daily_20150910.columns.values.tolist():
    daily_20150910_addname_dataframe[table_name] = daily_20150910[table_name]
print("daily_20150910 返回数据 row 行数 = "+str(daily_20150910.shape[0]))
daily_20150910_addname_dataframe.to_excel(daily_201509_excel_writer,'10_4',index=False)
daily_201509_excel_writer.save()
daily_20150911 = pro.daily(start_date='',end_date='',trade_date='20150911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150911_tscode_list = list() 
for ts_code_sh in daily_20150911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150911_tscode_list.append(stock_name)
daily_20150911_addname_dataframe=pd.DataFrame()
daily_20150911_addname_dataframe['cname'] = daily_20150911_tscode_list
for table_name in daily_20150911.columns.values.tolist():
    daily_20150911_addname_dataframe[table_name] = daily_20150911[table_name]
print("daily_20150911 返回数据 row 行数 = "+str(daily_20150911.shape[0]))
daily_20150911_addname_dataframe.to_excel(daily_201509_excel_writer,'11_5',index=False)
daily_201509_excel_writer.save()
daily_20150912 = pro.daily(start_date='',end_date='',trade_date='20150912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150912_tscode_list = list() 
for ts_code_sh in daily_20150912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150912_tscode_list.append(stock_name)
daily_20150912_addname_dataframe=pd.DataFrame()
daily_20150912_addname_dataframe['cname'] = daily_20150912_tscode_list
for table_name in daily_20150912.columns.values.tolist():
    daily_20150912_addname_dataframe[table_name] = daily_20150912[table_name]
print("daily_20150912 返回数据 row 行数 = "+str(daily_20150912.shape[0]))
daily_20150912_addname_dataframe.to_excel(daily_201509_excel_writer,'12_6',index=False)
daily_201509_excel_writer.save()
daily_20150913 = pro.daily(start_date='',end_date='',trade_date='20150913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150913_tscode_list = list() 
for ts_code_sh in daily_20150913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150913_tscode_list.append(stock_name)
daily_20150913_addname_dataframe=pd.DataFrame()
daily_20150913_addname_dataframe['cname'] = daily_20150913_tscode_list
for table_name in daily_20150913.columns.values.tolist():
    daily_20150913_addname_dataframe[table_name] = daily_20150913[table_name]
print("daily_20150913 返回数据 row 行数 = "+str(daily_20150913.shape[0]))
daily_20150913_addname_dataframe.to_excel(daily_201509_excel_writer,'13_7',index=False)
daily_201509_excel_writer.save()
daily_20150914 = pro.daily(start_date='',end_date='',trade_date='20150914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150914_tscode_list = list() 
for ts_code_sh in daily_20150914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150914_tscode_list.append(stock_name)
daily_20150914_addname_dataframe=pd.DataFrame()
daily_20150914_addname_dataframe['cname'] = daily_20150914_tscode_list
for table_name in daily_20150914.columns.values.tolist():
    daily_20150914_addname_dataframe[table_name] = daily_20150914[table_name]
print("daily_20150914 返回数据 row 行数 = "+str(daily_20150914.shape[0]))
daily_20150914_addname_dataframe.to_excel(daily_201509_excel_writer,'14_1',index=False)
daily_201509_excel_writer.save()
daily_20150915 = pro.daily(start_date='',end_date='',trade_date='20150915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150915_tscode_list = list() 
for ts_code_sh in daily_20150915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150915_tscode_list.append(stock_name)
daily_20150915_addname_dataframe=pd.DataFrame()
daily_20150915_addname_dataframe['cname'] = daily_20150915_tscode_list
for table_name in daily_20150915.columns.values.tolist():
    daily_20150915_addname_dataframe[table_name] = daily_20150915[table_name]
print("daily_20150915 返回数据 row 行数 = "+str(daily_20150915.shape[0]))
daily_20150915_addname_dataframe.to_excel(daily_201509_excel_writer,'15_2',index=False)
daily_201509_excel_writer.save()
daily_20150916 = pro.daily(start_date='',end_date='',trade_date='20150916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150916_tscode_list = list() 
for ts_code_sh in daily_20150916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150916_tscode_list.append(stock_name)
daily_20150916_addname_dataframe=pd.DataFrame()
daily_20150916_addname_dataframe['cname'] = daily_20150916_tscode_list
for table_name in daily_20150916.columns.values.tolist():
    daily_20150916_addname_dataframe[table_name] = daily_20150916[table_name]
print("daily_20150916 返回数据 row 行数 = "+str(daily_20150916.shape[0]))
daily_20150916_addname_dataframe.to_excel(daily_201509_excel_writer,'16_3',index=False)
daily_201509_excel_writer.save()
daily_20150917 = pro.daily(start_date='',end_date='',trade_date='20150917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150917_tscode_list = list() 
for ts_code_sh in daily_20150917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150917_tscode_list.append(stock_name)
daily_20150917_addname_dataframe=pd.DataFrame()
daily_20150917_addname_dataframe['cname'] = daily_20150917_tscode_list
for table_name in daily_20150917.columns.values.tolist():
    daily_20150917_addname_dataframe[table_name] = daily_20150917[table_name]
print("daily_20150917 返回数据 row 行数 = "+str(daily_20150917.shape[0]))
daily_20150917_addname_dataframe.to_excel(daily_201509_excel_writer,'17_4',index=False)
daily_201509_excel_writer.save()
daily_20150918 = pro.daily(start_date='',end_date='',trade_date='20150918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150918_tscode_list = list() 
for ts_code_sh in daily_20150918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150918_tscode_list.append(stock_name)
daily_20150918_addname_dataframe=pd.DataFrame()
daily_20150918_addname_dataframe['cname'] = daily_20150918_tscode_list
for table_name in daily_20150918.columns.values.tolist():
    daily_20150918_addname_dataframe[table_name] = daily_20150918[table_name]
print("daily_20150918 返回数据 row 行数 = "+str(daily_20150918.shape[0]))
daily_20150918_addname_dataframe.to_excel(daily_201509_excel_writer,'18_5',index=False)
daily_201509_excel_writer.save()
daily_20150919 = pro.daily(start_date='',end_date='',trade_date='20150919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150919_tscode_list = list() 
for ts_code_sh in daily_20150919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150919_tscode_list.append(stock_name)
daily_20150919_addname_dataframe=pd.DataFrame()
daily_20150919_addname_dataframe['cname'] = daily_20150919_tscode_list
for table_name in daily_20150919.columns.values.tolist():
    daily_20150919_addname_dataframe[table_name] = daily_20150919[table_name]
print("daily_20150919 返回数据 row 行数 = "+str(daily_20150919.shape[0]))
daily_20150919_addname_dataframe.to_excel(daily_201509_excel_writer,'19_6',index=False)
daily_201509_excel_writer.save()
daily_20150920 = pro.daily(start_date='',end_date='',trade_date='20150920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150920_tscode_list = list() 
for ts_code_sh in daily_20150920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150920_tscode_list.append(stock_name)
daily_20150920_addname_dataframe=pd.DataFrame()
daily_20150920_addname_dataframe['cname'] = daily_20150920_tscode_list
for table_name in daily_20150920.columns.values.tolist():
    daily_20150920_addname_dataframe[table_name] = daily_20150920[table_name]
print("daily_20150920 返回数据 row 行数 = "+str(daily_20150920.shape[0]))
daily_20150920_addname_dataframe.to_excel(daily_201509_excel_writer,'20_7',index=False)
daily_201509_excel_writer.save()
daily_20150921 = pro.daily(start_date='',end_date='',trade_date='20150921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150921_tscode_list = list() 
for ts_code_sh in daily_20150921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150921_tscode_list.append(stock_name)
daily_20150921_addname_dataframe=pd.DataFrame()
daily_20150921_addname_dataframe['cname'] = daily_20150921_tscode_list
for table_name in daily_20150921.columns.values.tolist():
    daily_20150921_addname_dataframe[table_name] = daily_20150921[table_name]
print("daily_20150921 返回数据 row 行数 = "+str(daily_20150921.shape[0]))
daily_20150921_addname_dataframe.to_excel(daily_201509_excel_writer,'21_1',index=False)
daily_201509_excel_writer.save()
daily_20150922 = pro.daily(start_date='',end_date='',trade_date='20150922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150922_tscode_list = list() 
for ts_code_sh in daily_20150922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150922_tscode_list.append(stock_name)
daily_20150922_addname_dataframe=pd.DataFrame()
daily_20150922_addname_dataframe['cname'] = daily_20150922_tscode_list
for table_name in daily_20150922.columns.values.tolist():
    daily_20150922_addname_dataframe[table_name] = daily_20150922[table_name]
print("daily_20150922 返回数据 row 行数 = "+str(daily_20150922.shape[0]))
daily_20150922_addname_dataframe.to_excel(daily_201509_excel_writer,'22_2',index=False)
daily_201509_excel_writer.save()
daily_20150923 = pro.daily(start_date='',end_date='',trade_date='20150923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150923_tscode_list = list() 
for ts_code_sh in daily_20150923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150923_tscode_list.append(stock_name)
daily_20150923_addname_dataframe=pd.DataFrame()
daily_20150923_addname_dataframe['cname'] = daily_20150923_tscode_list
for table_name in daily_20150923.columns.values.tolist():
    daily_20150923_addname_dataframe[table_name] = daily_20150923[table_name]
print("daily_20150923 返回数据 row 行数 = "+str(daily_20150923.shape[0]))
daily_20150923_addname_dataframe.to_excel(daily_201509_excel_writer,'23_3',index=False)
daily_201509_excel_writer.save()
daily_20150924 = pro.daily(start_date='',end_date='',trade_date='20150924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150924_tscode_list = list() 
for ts_code_sh in daily_20150924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150924_tscode_list.append(stock_name)
daily_20150924_addname_dataframe=pd.DataFrame()
daily_20150924_addname_dataframe['cname'] = daily_20150924_tscode_list
for table_name in daily_20150924.columns.values.tolist():
    daily_20150924_addname_dataframe[table_name] = daily_20150924[table_name]
print("daily_20150924 返回数据 row 行数 = "+str(daily_20150924.shape[0]))
daily_20150924_addname_dataframe.to_excel(daily_201509_excel_writer,'24_4',index=False)
daily_201509_excel_writer.save()
daily_20150925 = pro.daily(start_date='',end_date='',trade_date='20150925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150925_tscode_list = list() 
for ts_code_sh in daily_20150925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150925_tscode_list.append(stock_name)
daily_20150925_addname_dataframe=pd.DataFrame()
daily_20150925_addname_dataframe['cname'] = daily_20150925_tscode_list
for table_name in daily_20150925.columns.values.tolist():
    daily_20150925_addname_dataframe[table_name] = daily_20150925[table_name]
print("daily_20150925 返回数据 row 行数 = "+str(daily_20150925.shape[0]))
daily_20150925_addname_dataframe.to_excel(daily_201509_excel_writer,'25_5',index=False)
daily_201509_excel_writer.save()
daily_20150926 = pro.daily(start_date='',end_date='',trade_date='20150926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150926_tscode_list = list() 
for ts_code_sh in daily_20150926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150926_tscode_list.append(stock_name)
daily_20150926_addname_dataframe=pd.DataFrame()
daily_20150926_addname_dataframe['cname'] = daily_20150926_tscode_list
for table_name in daily_20150926.columns.values.tolist():
    daily_20150926_addname_dataframe[table_name] = daily_20150926[table_name]
print("daily_20150926 返回数据 row 行数 = "+str(daily_20150926.shape[0]))
daily_20150926_addname_dataframe.to_excel(daily_201509_excel_writer,'26_6',index=False)
daily_201509_excel_writer.save()
daily_20150927 = pro.daily(start_date='',end_date='',trade_date='20150927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150927_tscode_list = list() 
for ts_code_sh in daily_20150927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150927_tscode_list.append(stock_name)
daily_20150927_addname_dataframe=pd.DataFrame()
daily_20150927_addname_dataframe['cname'] = daily_20150927_tscode_list
for table_name in daily_20150927.columns.values.tolist():
    daily_20150927_addname_dataframe[table_name] = daily_20150927[table_name]
print("daily_20150927 返回数据 row 行数 = "+str(daily_20150927.shape[0]))
daily_20150927_addname_dataframe.to_excel(daily_201509_excel_writer,'27_7',index=False)
daily_201509_excel_writer.save()
daily_20150928 = pro.daily(start_date='',end_date='',trade_date='20150928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150928_tscode_list = list() 
for ts_code_sh in daily_20150928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150928_tscode_list.append(stock_name)
daily_20150928_addname_dataframe=pd.DataFrame()
daily_20150928_addname_dataframe['cname'] = daily_20150928_tscode_list
for table_name in daily_20150928.columns.values.tolist():
    daily_20150928_addname_dataframe[table_name] = daily_20150928[table_name]
print("daily_20150928 返回数据 row 行数 = "+str(daily_20150928.shape[0]))
daily_20150928_addname_dataframe.to_excel(daily_201509_excel_writer,'28_1',index=False)
daily_201509_excel_writer.save()
daily_20150929 = pro.daily(start_date='',end_date='',trade_date='20150929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150929_tscode_list = list() 
for ts_code_sh in daily_20150929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150929_tscode_list.append(stock_name)
daily_20150929_addname_dataframe=pd.DataFrame()
daily_20150929_addname_dataframe['cname'] = daily_20150929_tscode_list
for table_name in daily_20150929.columns.values.tolist():
    daily_20150929_addname_dataframe[table_name] = daily_20150929[table_name]
print("daily_20150929 返回数据 row 行数 = "+str(daily_20150929.shape[0]))
daily_20150929_addname_dataframe.to_excel(daily_201509_excel_writer,'29_2',index=False)
daily_201509_excel_writer.save()
daily_20150930 = pro.daily(start_date='',end_date='',trade_date='20150930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150930_tscode_list = list() 
for ts_code_sh in daily_20150930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150930_tscode_list.append(stock_name)
daily_20150930_addname_dataframe=pd.DataFrame()
daily_20150930_addname_dataframe['cname'] = daily_20150930_tscode_list
for table_name in daily_20150930.columns.values.tolist():
    daily_20150930_addname_dataframe[table_name] = daily_20150930[table_name]
print("daily_20150930 返回数据 row 行数 = "+str(daily_20150930.shape[0]))
daily_20150930_addname_dataframe.to_excel(daily_201509_excel_writer,'30_3',index=False)
daily_201509_excel_writer.save()




createexcel('daily_201510.xlsx')
daily_201510_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201510.xlsx')
daily_201510_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201510.xlsx', engine='openpyxl')
daily_201510_excel_writer.book = daily_201510_book
daily_201510_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201510_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20151001")       ###  更新 记录日期
daily_20151001 = pro.daily(start_date='',end_date='',trade_date='20151001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151001_tscode_list = list() 
for ts_code_sh in daily_20151001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151001_tscode_list.append(stock_name)
daily_20151001_addname_dataframe=pd.DataFrame()
daily_20151001_addname_dataframe['cname'] = daily_20151001_tscode_list
for table_name in daily_20151001.columns.values.tolist():
    daily_20151001_addname_dataframe[table_name] = daily_20151001[table_name]
print("daily_20151001 返回数据 row 行数 = "+str(daily_20151001.shape[0]))
daily_20151001_addname_dataframe.to_excel(daily_201510_excel_writer,'1_4',index=False)
daily_201510_excel_writer.save()
daily_20151002 = pro.daily(start_date='',end_date='',trade_date='20151002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151002_tscode_list = list() 
for ts_code_sh in daily_20151002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151002_tscode_list.append(stock_name)
daily_20151002_addname_dataframe=pd.DataFrame()
daily_20151002_addname_dataframe['cname'] = daily_20151002_tscode_list
for table_name in daily_20151002.columns.values.tolist():
    daily_20151002_addname_dataframe[table_name] = daily_20151002[table_name]
print("daily_20151002 返回数据 row 行数 = "+str(daily_20151002.shape[0]))
daily_20151002_addname_dataframe.to_excel(daily_201510_excel_writer,'2_5',index=False)
daily_201510_excel_writer.save()
daily_20151003 = pro.daily(start_date='',end_date='',trade_date='20151003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151003_tscode_list = list() 
for ts_code_sh in daily_20151003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151003_tscode_list.append(stock_name)
daily_20151003_addname_dataframe=pd.DataFrame()
daily_20151003_addname_dataframe['cname'] = daily_20151003_tscode_list
for table_name in daily_20151003.columns.values.tolist():
    daily_20151003_addname_dataframe[table_name] = daily_20151003[table_name]
print("daily_20151003 返回数据 row 行数 = "+str(daily_20151003.shape[0]))
daily_20151003_addname_dataframe.to_excel(daily_201510_excel_writer,'3_6',index=False)
daily_201510_excel_writer.save()
daily_20151004 = pro.daily(start_date='',end_date='',trade_date='20151004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151004_tscode_list = list() 
for ts_code_sh in daily_20151004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151004_tscode_list.append(stock_name)
daily_20151004_addname_dataframe=pd.DataFrame()
daily_20151004_addname_dataframe['cname'] = daily_20151004_tscode_list
for table_name in daily_20151004.columns.values.tolist():
    daily_20151004_addname_dataframe[table_name] = daily_20151004[table_name]
print("daily_20151004 返回数据 row 行数 = "+str(daily_20151004.shape[0]))
daily_20151004_addname_dataframe.to_excel(daily_201510_excel_writer,'4_7',index=False)
daily_201510_excel_writer.save()
daily_20151005 = pro.daily(start_date='',end_date='',trade_date='20151005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151005_tscode_list = list() 
for ts_code_sh in daily_20151005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151005_tscode_list.append(stock_name)
daily_20151005_addname_dataframe=pd.DataFrame()
daily_20151005_addname_dataframe['cname'] = daily_20151005_tscode_list
for table_name in daily_20151005.columns.values.tolist():
    daily_20151005_addname_dataframe[table_name] = daily_20151005[table_name]
print("daily_20151005 返回数据 row 行数 = "+str(daily_20151005.shape[0]))
daily_20151005_addname_dataframe.to_excel(daily_201510_excel_writer,'5_1',index=False)
daily_201510_excel_writer.save()
daily_20151006 = pro.daily(start_date='',end_date='',trade_date='20151006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151006_tscode_list = list() 
for ts_code_sh in daily_20151006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151006_tscode_list.append(stock_name)
daily_20151006_addname_dataframe=pd.DataFrame()
daily_20151006_addname_dataframe['cname'] = daily_20151006_tscode_list
for table_name in daily_20151006.columns.values.tolist():
    daily_20151006_addname_dataframe[table_name] = daily_20151006[table_name]
print("daily_20151006 返回数据 row 行数 = "+str(daily_20151006.shape[0]))
daily_20151006_addname_dataframe.to_excel(daily_201510_excel_writer,'6_2',index=False)
daily_201510_excel_writer.save()
daily_20151007 = pro.daily(start_date='',end_date='',trade_date='20151007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151007_tscode_list = list() 
for ts_code_sh in daily_20151007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151007_tscode_list.append(stock_name)
daily_20151007_addname_dataframe=pd.DataFrame()
daily_20151007_addname_dataframe['cname'] = daily_20151007_tscode_list
for table_name in daily_20151007.columns.values.tolist():
    daily_20151007_addname_dataframe[table_name] = daily_20151007[table_name]
print("daily_20151007 返回数据 row 行数 = "+str(daily_20151007.shape[0]))
daily_20151007_addname_dataframe.to_excel(daily_201510_excel_writer,'7_3',index=False)
daily_201510_excel_writer.save()
daily_20151008 = pro.daily(start_date='',end_date='',trade_date='20151008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151008_tscode_list = list() 
for ts_code_sh in daily_20151008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151008_tscode_list.append(stock_name)
daily_20151008_addname_dataframe=pd.DataFrame()
daily_20151008_addname_dataframe['cname'] = daily_20151008_tscode_list
for table_name in daily_20151008.columns.values.tolist():
    daily_20151008_addname_dataframe[table_name] = daily_20151008[table_name]
print("daily_20151008 返回数据 row 行数 = "+str(daily_20151008.shape[0]))
daily_20151008_addname_dataframe.to_excel(daily_201510_excel_writer,'8_4',index=False)
daily_201510_excel_writer.save()
daily_20151009 = pro.daily(start_date='',end_date='',trade_date='20151009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151009_tscode_list = list() 
for ts_code_sh in daily_20151009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151009_tscode_list.append(stock_name)
daily_20151009_addname_dataframe=pd.DataFrame()
daily_20151009_addname_dataframe['cname'] = daily_20151009_tscode_list
for table_name in daily_20151009.columns.values.tolist():
    daily_20151009_addname_dataframe[table_name] = daily_20151009[table_name]
print("daily_20151009 返回数据 row 行数 = "+str(daily_20151009.shape[0]))
daily_20151009_addname_dataframe.to_excel(daily_201510_excel_writer,'9_5',index=False)
daily_201510_excel_writer.save()
daily_20151010 = pro.daily(start_date='',end_date='',trade_date='20151010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151010_tscode_list = list() 
for ts_code_sh in daily_20151010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151010_tscode_list.append(stock_name)
daily_20151010_addname_dataframe=pd.DataFrame()
daily_20151010_addname_dataframe['cname'] = daily_20151010_tscode_list
for table_name in daily_20151010.columns.values.tolist():
    daily_20151010_addname_dataframe[table_name] = daily_20151010[table_name]
print("daily_20151010 返回数据 row 行数 = "+str(daily_20151010.shape[0]))
daily_20151010_addname_dataframe.to_excel(daily_201510_excel_writer,'10_6',index=False)
daily_201510_excel_writer.save()
daily_20151011 = pro.daily(start_date='',end_date='',trade_date='20151011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151011_tscode_list = list() 
for ts_code_sh in daily_20151011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151011_tscode_list.append(stock_name)
daily_20151011_addname_dataframe=pd.DataFrame()
daily_20151011_addname_dataframe['cname'] = daily_20151011_tscode_list
for table_name in daily_20151011.columns.values.tolist():
    daily_20151011_addname_dataframe[table_name] = daily_20151011[table_name]
print("daily_20151011 返回数据 row 行数 = "+str(daily_20151011.shape[0]))
daily_20151011_addname_dataframe.to_excel(daily_201510_excel_writer,'11_7',index=False)
daily_201510_excel_writer.save()
daily_20151012 = pro.daily(start_date='',end_date='',trade_date='20151012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151012_tscode_list = list() 
for ts_code_sh in daily_20151012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151012_tscode_list.append(stock_name)
daily_20151012_addname_dataframe=pd.DataFrame()
daily_20151012_addname_dataframe['cname'] = daily_20151012_tscode_list
for table_name in daily_20151012.columns.values.tolist():
    daily_20151012_addname_dataframe[table_name] = daily_20151012[table_name]
print("daily_20151012 返回数据 row 行数 = "+str(daily_20151012.shape[0]))
daily_20151012_addname_dataframe.to_excel(daily_201510_excel_writer,'12_1',index=False)
daily_201510_excel_writer.save()
daily_20151013 = pro.daily(start_date='',end_date='',trade_date='20151013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151013_tscode_list = list() 
for ts_code_sh in daily_20151013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151013_tscode_list.append(stock_name)
daily_20151013_addname_dataframe=pd.DataFrame()
daily_20151013_addname_dataframe['cname'] = daily_20151013_tscode_list
for table_name in daily_20151013.columns.values.tolist():
    daily_20151013_addname_dataframe[table_name] = daily_20151013[table_name]
print("daily_20151013 返回数据 row 行数 = "+str(daily_20151013.shape[0]))
daily_20151013_addname_dataframe.to_excel(daily_201510_excel_writer,'13_2',index=False)
daily_201510_excel_writer.save()
daily_20151014 = pro.daily(start_date='',end_date='',trade_date='20151014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151014_tscode_list = list() 
for ts_code_sh in daily_20151014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151014_tscode_list.append(stock_name)
daily_20151014_addname_dataframe=pd.DataFrame()
daily_20151014_addname_dataframe['cname'] = daily_20151014_tscode_list
for table_name in daily_20151014.columns.values.tolist():
    daily_20151014_addname_dataframe[table_name] = daily_20151014[table_name]
print("daily_20151014 返回数据 row 行数 = "+str(daily_20151014.shape[0]))
daily_20151014_addname_dataframe.to_excel(daily_201510_excel_writer,'14_3',index=False)
daily_201510_excel_writer.save()
daily_20151015 = pro.daily(start_date='',end_date='',trade_date='20151015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151015_tscode_list = list() 
for ts_code_sh in daily_20151015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151015_tscode_list.append(stock_name)
daily_20151015_addname_dataframe=pd.DataFrame()
daily_20151015_addname_dataframe['cname'] = daily_20151015_tscode_list
for table_name in daily_20151015.columns.values.tolist():
    daily_20151015_addname_dataframe[table_name] = daily_20151015[table_name]
print("daily_20151015 返回数据 row 行数 = "+str(daily_20151015.shape[0]))
daily_20151015_addname_dataframe.to_excel(daily_201510_excel_writer,'15_4',index=False)
daily_201510_excel_writer.save()
daily_20151016 = pro.daily(start_date='',end_date='',trade_date='20151016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151016_tscode_list = list() 
for ts_code_sh in daily_20151016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151016_tscode_list.append(stock_name)
daily_20151016_addname_dataframe=pd.DataFrame()
daily_20151016_addname_dataframe['cname'] = daily_20151016_tscode_list
for table_name in daily_20151016.columns.values.tolist():
    daily_20151016_addname_dataframe[table_name] = daily_20151016[table_name]
print("daily_20151016 返回数据 row 行数 = "+str(daily_20151016.shape[0]))
daily_20151016_addname_dataframe.to_excel(daily_201510_excel_writer,'16_5',index=False)
daily_201510_excel_writer.save()
daily_20151017 = pro.daily(start_date='',end_date='',trade_date='20151017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151017_tscode_list = list() 
for ts_code_sh in daily_20151017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151017_tscode_list.append(stock_name)
daily_20151017_addname_dataframe=pd.DataFrame()
daily_20151017_addname_dataframe['cname'] = daily_20151017_tscode_list
for table_name in daily_20151017.columns.values.tolist():
    daily_20151017_addname_dataframe[table_name] = daily_20151017[table_name]
print("daily_20151017 返回数据 row 行数 = "+str(daily_20151017.shape[0]))
daily_20151017_addname_dataframe.to_excel(daily_201510_excel_writer,'17_6',index=False)
daily_201510_excel_writer.save()
daily_20151018 = pro.daily(start_date='',end_date='',trade_date='20151018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151018_tscode_list = list() 
for ts_code_sh in daily_20151018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151018_tscode_list.append(stock_name)
daily_20151018_addname_dataframe=pd.DataFrame()
daily_20151018_addname_dataframe['cname'] = daily_20151018_tscode_list
for table_name in daily_20151018.columns.values.tolist():
    daily_20151018_addname_dataframe[table_name] = daily_20151018[table_name]
print("daily_20151018 返回数据 row 行数 = "+str(daily_20151018.shape[0]))
daily_20151018_addname_dataframe.to_excel(daily_201510_excel_writer,'18_7',index=False)
daily_201510_excel_writer.save()
daily_20151019 = pro.daily(start_date='',end_date='',trade_date='20151019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151019_tscode_list = list() 
for ts_code_sh in daily_20151019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151019_tscode_list.append(stock_name)
daily_20151019_addname_dataframe=pd.DataFrame()
daily_20151019_addname_dataframe['cname'] = daily_20151019_tscode_list
for table_name in daily_20151019.columns.values.tolist():
    daily_20151019_addname_dataframe[table_name] = daily_20151019[table_name]
print("daily_20151019 返回数据 row 行数 = "+str(daily_20151019.shape[0]))
daily_20151019_addname_dataframe.to_excel(daily_201510_excel_writer,'19_1',index=False)
daily_201510_excel_writer.save()
daily_20151020 = pro.daily(start_date='',end_date='',trade_date='20151020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151020_tscode_list = list() 
for ts_code_sh in daily_20151020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151020_tscode_list.append(stock_name)
daily_20151020_addname_dataframe=pd.DataFrame()
daily_20151020_addname_dataframe['cname'] = daily_20151020_tscode_list
for table_name in daily_20151020.columns.values.tolist():
    daily_20151020_addname_dataframe[table_name] = daily_20151020[table_name]
print("daily_20151020 返回数据 row 行数 = "+str(daily_20151020.shape[0]))
daily_20151020_addname_dataframe.to_excel(daily_201510_excel_writer,'20_2',index=False)
daily_201510_excel_writer.save()
daily_20151021 = pro.daily(start_date='',end_date='',trade_date='20151021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151021_tscode_list = list() 
for ts_code_sh in daily_20151021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151021_tscode_list.append(stock_name)
daily_20151021_addname_dataframe=pd.DataFrame()
daily_20151021_addname_dataframe['cname'] = daily_20151021_tscode_list
for table_name in daily_20151021.columns.values.tolist():
    daily_20151021_addname_dataframe[table_name] = daily_20151021[table_name]
print("daily_20151021 返回数据 row 行数 = "+str(daily_20151021.shape[0]))
daily_20151021_addname_dataframe.to_excel(daily_201510_excel_writer,'21_3',index=False)
daily_201510_excel_writer.save()
daily_20151022 = pro.daily(start_date='',end_date='',trade_date='20151022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151022_tscode_list = list() 
for ts_code_sh in daily_20151022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151022_tscode_list.append(stock_name)
daily_20151022_addname_dataframe=pd.DataFrame()
daily_20151022_addname_dataframe['cname'] = daily_20151022_tscode_list
for table_name in daily_20151022.columns.values.tolist():
    daily_20151022_addname_dataframe[table_name] = daily_20151022[table_name]
print("daily_20151022 返回数据 row 行数 = "+str(daily_20151022.shape[0]))
daily_20151022_addname_dataframe.to_excel(daily_201510_excel_writer,'22_4',index=False)
daily_201510_excel_writer.save()
daily_20151023 = pro.daily(start_date='',end_date='',trade_date='20151023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151023_tscode_list = list() 
for ts_code_sh in daily_20151023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151023_tscode_list.append(stock_name)
daily_20151023_addname_dataframe=pd.DataFrame()
daily_20151023_addname_dataframe['cname'] = daily_20151023_tscode_list
for table_name in daily_20151023.columns.values.tolist():
    daily_20151023_addname_dataframe[table_name] = daily_20151023[table_name]
print("daily_20151023 返回数据 row 行数 = "+str(daily_20151023.shape[0]))
daily_20151023_addname_dataframe.to_excel(daily_201510_excel_writer,'23_5',index=False)
daily_201510_excel_writer.save()
daily_20151024 = pro.daily(start_date='',end_date='',trade_date='20151024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151024_tscode_list = list() 
for ts_code_sh in daily_20151024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151024_tscode_list.append(stock_name)
daily_20151024_addname_dataframe=pd.DataFrame()
daily_20151024_addname_dataframe['cname'] = daily_20151024_tscode_list
for table_name in daily_20151024.columns.values.tolist():
    daily_20151024_addname_dataframe[table_name] = daily_20151024[table_name]
print("daily_20151024 返回数据 row 行数 = "+str(daily_20151024.shape[0]))
daily_20151024_addname_dataframe.to_excel(daily_201510_excel_writer,'24_6',index=False)
daily_201510_excel_writer.save()
daily_20151025 = pro.daily(start_date='',end_date='',trade_date='20151025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151025_tscode_list = list() 
for ts_code_sh in daily_20151025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151025_tscode_list.append(stock_name)
daily_20151025_addname_dataframe=pd.DataFrame()
daily_20151025_addname_dataframe['cname'] = daily_20151025_tscode_list
for table_name in daily_20151025.columns.values.tolist():
    daily_20151025_addname_dataframe[table_name] = daily_20151025[table_name]
print("daily_20151025 返回数据 row 行数 = "+str(daily_20151025.shape[0]))
daily_20151025_addname_dataframe.to_excel(daily_201510_excel_writer,'25_7',index=False)
daily_201510_excel_writer.save()
daily_20151026 = pro.daily(start_date='',end_date='',trade_date='20151026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151026_tscode_list = list() 
for ts_code_sh in daily_20151026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151026_tscode_list.append(stock_name)
daily_20151026_addname_dataframe=pd.DataFrame()
daily_20151026_addname_dataframe['cname'] = daily_20151026_tscode_list
for table_name in daily_20151026.columns.values.tolist():
    daily_20151026_addname_dataframe[table_name] = daily_20151026[table_name]
print("daily_20151026 返回数据 row 行数 = "+str(daily_20151026.shape[0]))
daily_20151026_addname_dataframe.to_excel(daily_201510_excel_writer,'26_1',index=False)
daily_201510_excel_writer.save()
daily_20151027 = pro.daily(start_date='',end_date='',trade_date='20151027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151027_tscode_list = list() 
for ts_code_sh in daily_20151027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151027_tscode_list.append(stock_name)
daily_20151027_addname_dataframe=pd.DataFrame()
daily_20151027_addname_dataframe['cname'] = daily_20151027_tscode_list
for table_name in daily_20151027.columns.values.tolist():
    daily_20151027_addname_dataframe[table_name] = daily_20151027[table_name]
print("daily_20151027 返回数据 row 行数 = "+str(daily_20151027.shape[0]))
daily_20151027_addname_dataframe.to_excel(daily_201510_excel_writer,'27_2',index=False)
daily_201510_excel_writer.save()
daily_20151028 = pro.daily(start_date='',end_date='',trade_date='20151028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151028_tscode_list = list() 
for ts_code_sh in daily_20151028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151028_tscode_list.append(stock_name)
daily_20151028_addname_dataframe=pd.DataFrame()
daily_20151028_addname_dataframe['cname'] = daily_20151028_tscode_list
for table_name in daily_20151028.columns.values.tolist():
    daily_20151028_addname_dataframe[table_name] = daily_20151028[table_name]
print("daily_20151028 返回数据 row 行数 = "+str(daily_20151028.shape[0]))
daily_20151028_addname_dataframe.to_excel(daily_201510_excel_writer,'28_3',index=False)
daily_201510_excel_writer.save()
daily_20151029 = pro.daily(start_date='',end_date='',trade_date='20151029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151029_tscode_list = list() 
for ts_code_sh in daily_20151029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151029_tscode_list.append(stock_name)
daily_20151029_addname_dataframe=pd.DataFrame()
daily_20151029_addname_dataframe['cname'] = daily_20151029_tscode_list
for table_name in daily_20151029.columns.values.tolist():
    daily_20151029_addname_dataframe[table_name] = daily_20151029[table_name]
print("daily_20151029 返回数据 row 行数 = "+str(daily_20151029.shape[0]))
daily_20151029_addname_dataframe.to_excel(daily_201510_excel_writer,'29_4',index=False)
daily_201510_excel_writer.save()
daily_20151030 = pro.daily(start_date='',end_date='',trade_date='20151030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151030_tscode_list = list() 
for ts_code_sh in daily_20151030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151030_tscode_list.append(stock_name)
daily_20151030_addname_dataframe=pd.DataFrame()
daily_20151030_addname_dataframe['cname'] = daily_20151030_tscode_list
for table_name in daily_20151030.columns.values.tolist():
    daily_20151030_addname_dataframe[table_name] = daily_20151030[table_name]
print("daily_20151030 返回数据 row 行数 = "+str(daily_20151030.shape[0]))
daily_20151030_addname_dataframe.to_excel(daily_201510_excel_writer,'30_5',index=False)
daily_201510_excel_writer.save()
daily_20151031 = pro.daily(start_date='',end_date='',trade_date='20151031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151031_tscode_list = list() 
for ts_code_sh in daily_20151031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151031_tscode_list.append(stock_name)
daily_20151031_addname_dataframe=pd.DataFrame()
daily_20151031_addname_dataframe['cname'] = daily_20151031_tscode_list
for table_name in daily_20151031.columns.values.tolist():
    daily_20151031_addname_dataframe[table_name] = daily_20151031[table_name]
print("daily_20151031 返回数据 row 行数 = "+str(daily_20151031.shape[0]))
daily_20151031_addname_dataframe.to_excel(daily_201510_excel_writer,'31_6',index=False)
daily_201510_excel_writer.save()




createexcel('daily_201511.xlsx')
daily_201511_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201511.xlsx')
daily_201511_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201511.xlsx', engine='openpyxl')
daily_201511_excel_writer.book = daily_201511_book
daily_201511_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201511_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20151101")       ###  更新 记录日期
daily_20151101 = pro.daily(start_date='',end_date='',trade_date='20151101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151101_tscode_list = list() 
for ts_code_sh in daily_20151101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151101_tscode_list.append(stock_name)
daily_20151101_addname_dataframe=pd.DataFrame()
daily_20151101_addname_dataframe['cname'] = daily_20151101_tscode_list
for table_name in daily_20151101.columns.values.tolist():
    daily_20151101_addname_dataframe[table_name] = daily_20151101[table_name]
print("daily_20151101 返回数据 row 行数 = "+str(daily_20151101.shape[0]))
daily_20151101_addname_dataframe.to_excel(daily_201511_excel_writer,'1_7',index=False)
daily_201511_excel_writer.save()
daily_20151102 = pro.daily(start_date='',end_date='',trade_date='20151102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151102_tscode_list = list() 
for ts_code_sh in daily_20151102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151102_tscode_list.append(stock_name)
daily_20151102_addname_dataframe=pd.DataFrame()
daily_20151102_addname_dataframe['cname'] = daily_20151102_tscode_list
for table_name in daily_20151102.columns.values.tolist():
    daily_20151102_addname_dataframe[table_name] = daily_20151102[table_name]
print("daily_20151102 返回数据 row 行数 = "+str(daily_20151102.shape[0]))
daily_20151102_addname_dataframe.to_excel(daily_201511_excel_writer,'2_1',index=False)
daily_201511_excel_writer.save()
daily_20151103 = pro.daily(start_date='',end_date='',trade_date='20151103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151103_tscode_list = list() 
for ts_code_sh in daily_20151103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151103_tscode_list.append(stock_name)
daily_20151103_addname_dataframe=pd.DataFrame()
daily_20151103_addname_dataframe['cname'] = daily_20151103_tscode_list
for table_name in daily_20151103.columns.values.tolist():
    daily_20151103_addname_dataframe[table_name] = daily_20151103[table_name]
print("daily_20151103 返回数据 row 行数 = "+str(daily_20151103.shape[0]))
daily_20151103_addname_dataframe.to_excel(daily_201511_excel_writer,'3_2',index=False)
daily_201511_excel_writer.save()
daily_20151104 = pro.daily(start_date='',end_date='',trade_date='20151104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151104_tscode_list = list() 
for ts_code_sh in daily_20151104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151104_tscode_list.append(stock_name)
daily_20151104_addname_dataframe=pd.DataFrame()
daily_20151104_addname_dataframe['cname'] = daily_20151104_tscode_list
for table_name in daily_20151104.columns.values.tolist():
    daily_20151104_addname_dataframe[table_name] = daily_20151104[table_name]
print("daily_20151104 返回数据 row 行数 = "+str(daily_20151104.shape[0]))
daily_20151104_addname_dataframe.to_excel(daily_201511_excel_writer,'4_3',index=False)
daily_201511_excel_writer.save()
daily_20151105 = pro.daily(start_date='',end_date='',trade_date='20151105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151105_tscode_list = list() 
for ts_code_sh in daily_20151105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151105_tscode_list.append(stock_name)
daily_20151105_addname_dataframe=pd.DataFrame()
daily_20151105_addname_dataframe['cname'] = daily_20151105_tscode_list
for table_name in daily_20151105.columns.values.tolist():
    daily_20151105_addname_dataframe[table_name] = daily_20151105[table_name]
print("daily_20151105 返回数据 row 行数 = "+str(daily_20151105.shape[0]))
daily_20151105_addname_dataframe.to_excel(daily_201511_excel_writer,'5_4',index=False)
daily_201511_excel_writer.save()
daily_20151106 = pro.daily(start_date='',end_date='',trade_date='20151106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151106_tscode_list = list() 
for ts_code_sh in daily_20151106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151106_tscode_list.append(stock_name)
daily_20151106_addname_dataframe=pd.DataFrame()
daily_20151106_addname_dataframe['cname'] = daily_20151106_tscode_list
for table_name in daily_20151106.columns.values.tolist():
    daily_20151106_addname_dataframe[table_name] = daily_20151106[table_name]
print("daily_20151106 返回数据 row 行数 = "+str(daily_20151106.shape[0]))
daily_20151106_addname_dataframe.to_excel(daily_201511_excel_writer,'6_5',index=False)
daily_201511_excel_writer.save()
daily_20151107 = pro.daily(start_date='',end_date='',trade_date='20151107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151107_tscode_list = list() 
for ts_code_sh in daily_20151107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151107_tscode_list.append(stock_name)
daily_20151107_addname_dataframe=pd.DataFrame()
daily_20151107_addname_dataframe['cname'] = daily_20151107_tscode_list
for table_name in daily_20151107.columns.values.tolist():
    daily_20151107_addname_dataframe[table_name] = daily_20151107[table_name]
print("daily_20151107 返回数据 row 行数 = "+str(daily_20151107.shape[0]))
daily_20151107_addname_dataframe.to_excel(daily_201511_excel_writer,'7_6',index=False)
daily_201511_excel_writer.save()
daily_20151108 = pro.daily(start_date='',end_date='',trade_date='20151108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151108_tscode_list = list() 
for ts_code_sh in daily_20151108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151108_tscode_list.append(stock_name)
daily_20151108_addname_dataframe=pd.DataFrame()
daily_20151108_addname_dataframe['cname'] = daily_20151108_tscode_list
for table_name in daily_20151108.columns.values.tolist():
    daily_20151108_addname_dataframe[table_name] = daily_20151108[table_name]
print("daily_20151108 返回数据 row 行数 = "+str(daily_20151108.shape[0]))
daily_20151108_addname_dataframe.to_excel(daily_201511_excel_writer,'8_7',index=False)
daily_201511_excel_writer.save()
daily_20151109 = pro.daily(start_date='',end_date='',trade_date='20151109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151109_tscode_list = list() 
for ts_code_sh in daily_20151109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151109_tscode_list.append(stock_name)
daily_20151109_addname_dataframe=pd.DataFrame()
daily_20151109_addname_dataframe['cname'] = daily_20151109_tscode_list
for table_name in daily_20151109.columns.values.tolist():
    daily_20151109_addname_dataframe[table_name] = daily_20151109[table_name]
print("daily_20151109 返回数据 row 行数 = "+str(daily_20151109.shape[0]))
daily_20151109_addname_dataframe.to_excel(daily_201511_excel_writer,'9_1',index=False)
daily_201511_excel_writer.save()
daily_20151110 = pro.daily(start_date='',end_date='',trade_date='20151110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151110_tscode_list = list() 
for ts_code_sh in daily_20151110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151110_tscode_list.append(stock_name)
daily_20151110_addname_dataframe=pd.DataFrame()
daily_20151110_addname_dataframe['cname'] = daily_20151110_tscode_list
for table_name in daily_20151110.columns.values.tolist():
    daily_20151110_addname_dataframe[table_name] = daily_20151110[table_name]
print("daily_20151110 返回数据 row 行数 = "+str(daily_20151110.shape[0]))
daily_20151110_addname_dataframe.to_excel(daily_201511_excel_writer,'10_2',index=False)
daily_201511_excel_writer.save()
daily_20151111 = pro.daily(start_date='',end_date='',trade_date='20151111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151111_tscode_list = list() 
for ts_code_sh in daily_20151111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151111_tscode_list.append(stock_name)
daily_20151111_addname_dataframe=pd.DataFrame()
daily_20151111_addname_dataframe['cname'] = daily_20151111_tscode_list
for table_name in daily_20151111.columns.values.tolist():
    daily_20151111_addname_dataframe[table_name] = daily_20151111[table_name]
print("daily_20151111 返回数据 row 行数 = "+str(daily_20151111.shape[0]))
daily_20151111_addname_dataframe.to_excel(daily_201511_excel_writer,'11_3',index=False)
daily_201511_excel_writer.save()
daily_20151112 = pro.daily(start_date='',end_date='',trade_date='20151112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151112_tscode_list = list() 
for ts_code_sh in daily_20151112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151112_tscode_list.append(stock_name)
daily_20151112_addname_dataframe=pd.DataFrame()
daily_20151112_addname_dataframe['cname'] = daily_20151112_tscode_list
for table_name in daily_20151112.columns.values.tolist():
    daily_20151112_addname_dataframe[table_name] = daily_20151112[table_name]
print("daily_20151112 返回数据 row 行数 = "+str(daily_20151112.shape[0]))
daily_20151112_addname_dataframe.to_excel(daily_201511_excel_writer,'12_4',index=False)
daily_201511_excel_writer.save()
daily_20151113 = pro.daily(start_date='',end_date='',trade_date='20151113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151113_tscode_list = list() 
for ts_code_sh in daily_20151113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151113_tscode_list.append(stock_name)
daily_20151113_addname_dataframe=pd.DataFrame()
daily_20151113_addname_dataframe['cname'] = daily_20151113_tscode_list
for table_name in daily_20151113.columns.values.tolist():
    daily_20151113_addname_dataframe[table_name] = daily_20151113[table_name]
print("daily_20151113 返回数据 row 行数 = "+str(daily_20151113.shape[0]))
daily_20151113_addname_dataframe.to_excel(daily_201511_excel_writer,'13_5',index=False)
daily_201511_excel_writer.save()
daily_20151114 = pro.daily(start_date='',end_date='',trade_date='20151114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151114_tscode_list = list() 
for ts_code_sh in daily_20151114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151114_tscode_list.append(stock_name)
daily_20151114_addname_dataframe=pd.DataFrame()
daily_20151114_addname_dataframe['cname'] = daily_20151114_tscode_list
for table_name in daily_20151114.columns.values.tolist():
    daily_20151114_addname_dataframe[table_name] = daily_20151114[table_name]
print("daily_20151114 返回数据 row 行数 = "+str(daily_20151114.shape[0]))
daily_20151114_addname_dataframe.to_excel(daily_201511_excel_writer,'14_6',index=False)
daily_201511_excel_writer.save()
daily_20151115 = pro.daily(start_date='',end_date='',trade_date='20151115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151115_tscode_list = list() 
for ts_code_sh in daily_20151115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151115_tscode_list.append(stock_name)
daily_20151115_addname_dataframe=pd.DataFrame()
daily_20151115_addname_dataframe['cname'] = daily_20151115_tscode_list
for table_name in daily_20151115.columns.values.tolist():
    daily_20151115_addname_dataframe[table_name] = daily_20151115[table_name]
print("daily_20151115 返回数据 row 行数 = "+str(daily_20151115.shape[0]))
daily_20151115_addname_dataframe.to_excel(daily_201511_excel_writer,'15_7',index=False)
daily_201511_excel_writer.save()
daily_20151116 = pro.daily(start_date='',end_date='',trade_date='20151116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151116_tscode_list = list() 
for ts_code_sh in daily_20151116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151116_tscode_list.append(stock_name)
daily_20151116_addname_dataframe=pd.DataFrame()
daily_20151116_addname_dataframe['cname'] = daily_20151116_tscode_list
for table_name in daily_20151116.columns.values.tolist():
    daily_20151116_addname_dataframe[table_name] = daily_20151116[table_name]
print("daily_20151116 返回数据 row 行数 = "+str(daily_20151116.shape[0]))
daily_20151116_addname_dataframe.to_excel(daily_201511_excel_writer,'16_1',index=False)
daily_201511_excel_writer.save()
daily_20151117 = pro.daily(start_date='',end_date='',trade_date='20151117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151117_tscode_list = list() 
for ts_code_sh in daily_20151117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151117_tscode_list.append(stock_name)
daily_20151117_addname_dataframe=pd.DataFrame()
daily_20151117_addname_dataframe['cname'] = daily_20151117_tscode_list
for table_name in daily_20151117.columns.values.tolist():
    daily_20151117_addname_dataframe[table_name] = daily_20151117[table_name]
print("daily_20151117 返回数据 row 行数 = "+str(daily_20151117.shape[0]))
daily_20151117_addname_dataframe.to_excel(daily_201511_excel_writer,'17_2',index=False)
daily_201511_excel_writer.save()
daily_20151118 = pro.daily(start_date='',end_date='',trade_date='20151118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151118_tscode_list = list() 
for ts_code_sh in daily_20151118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151118_tscode_list.append(stock_name)
daily_20151118_addname_dataframe=pd.DataFrame()
daily_20151118_addname_dataframe['cname'] = daily_20151118_tscode_list
for table_name in daily_20151118.columns.values.tolist():
    daily_20151118_addname_dataframe[table_name] = daily_20151118[table_name]
print("daily_20151118 返回数据 row 行数 = "+str(daily_20151118.shape[0]))
daily_20151118_addname_dataframe.to_excel(daily_201511_excel_writer,'18_3',index=False)
daily_201511_excel_writer.save()
daily_20151119 = pro.daily(start_date='',end_date='',trade_date='20151119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151119_tscode_list = list() 
for ts_code_sh in daily_20151119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151119_tscode_list.append(stock_name)
daily_20151119_addname_dataframe=pd.DataFrame()
daily_20151119_addname_dataframe['cname'] = daily_20151119_tscode_list
for table_name in daily_20151119.columns.values.tolist():
    daily_20151119_addname_dataframe[table_name] = daily_20151119[table_name]
print("daily_20151119 返回数据 row 行数 = "+str(daily_20151119.shape[0]))
daily_20151119_addname_dataframe.to_excel(daily_201511_excel_writer,'19_4',index=False)
daily_201511_excel_writer.save()
daily_20151120 = pro.daily(start_date='',end_date='',trade_date='20151120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151120_tscode_list = list() 
for ts_code_sh in daily_20151120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151120_tscode_list.append(stock_name)
daily_20151120_addname_dataframe=pd.DataFrame()
daily_20151120_addname_dataframe['cname'] = daily_20151120_tscode_list
for table_name in daily_20151120.columns.values.tolist():
    daily_20151120_addname_dataframe[table_name] = daily_20151120[table_name]
print("daily_20151120 返回数据 row 行数 = "+str(daily_20151120.shape[0]))
daily_20151120_addname_dataframe.to_excel(daily_201511_excel_writer,'20_5',index=False)
daily_201511_excel_writer.save()
daily_20151121 = pro.daily(start_date='',end_date='',trade_date='20151121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151121_tscode_list = list() 
for ts_code_sh in daily_20151121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151121_tscode_list.append(stock_name)
daily_20151121_addname_dataframe=pd.DataFrame()
daily_20151121_addname_dataframe['cname'] = daily_20151121_tscode_list
for table_name in daily_20151121.columns.values.tolist():
    daily_20151121_addname_dataframe[table_name] = daily_20151121[table_name]
print("daily_20151121 返回数据 row 行数 = "+str(daily_20151121.shape[0]))
daily_20151121_addname_dataframe.to_excel(daily_201511_excel_writer,'21_6',index=False)
daily_201511_excel_writer.save()
daily_20151122 = pro.daily(start_date='',end_date='',trade_date='20151122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151122_tscode_list = list() 
for ts_code_sh in daily_20151122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151122_tscode_list.append(stock_name)
daily_20151122_addname_dataframe=pd.DataFrame()
daily_20151122_addname_dataframe['cname'] = daily_20151122_tscode_list
for table_name in daily_20151122.columns.values.tolist():
    daily_20151122_addname_dataframe[table_name] = daily_20151122[table_name]
print("daily_20151122 返回数据 row 行数 = "+str(daily_20151122.shape[0]))
daily_20151122_addname_dataframe.to_excel(daily_201511_excel_writer,'22_7',index=False)
daily_201511_excel_writer.save()
daily_20151123 = pro.daily(start_date='',end_date='',trade_date='20151123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151123_tscode_list = list() 
for ts_code_sh in daily_20151123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151123_tscode_list.append(stock_name)
daily_20151123_addname_dataframe=pd.DataFrame()
daily_20151123_addname_dataframe['cname'] = daily_20151123_tscode_list
for table_name in daily_20151123.columns.values.tolist():
    daily_20151123_addname_dataframe[table_name] = daily_20151123[table_name]
print("daily_20151123 返回数据 row 行数 = "+str(daily_20151123.shape[0]))
daily_20151123_addname_dataframe.to_excel(daily_201511_excel_writer,'23_1',index=False)
daily_201511_excel_writer.save()
daily_20151124 = pro.daily(start_date='',end_date='',trade_date='20151124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151124_tscode_list = list() 
for ts_code_sh in daily_20151124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151124_tscode_list.append(stock_name)
daily_20151124_addname_dataframe=pd.DataFrame()
daily_20151124_addname_dataframe['cname'] = daily_20151124_tscode_list
for table_name in daily_20151124.columns.values.tolist():
    daily_20151124_addname_dataframe[table_name] = daily_20151124[table_name]
print("daily_20151124 返回数据 row 行数 = "+str(daily_20151124.shape[0]))
daily_20151124_addname_dataframe.to_excel(daily_201511_excel_writer,'24_2',index=False)
daily_201511_excel_writer.save()
daily_20151125 = pro.daily(start_date='',end_date='',trade_date='20151125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151125_tscode_list = list() 
for ts_code_sh in daily_20151125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151125_tscode_list.append(stock_name)
daily_20151125_addname_dataframe=pd.DataFrame()
daily_20151125_addname_dataframe['cname'] = daily_20151125_tscode_list
for table_name in daily_20151125.columns.values.tolist():
    daily_20151125_addname_dataframe[table_name] = daily_20151125[table_name]
print("daily_20151125 返回数据 row 行数 = "+str(daily_20151125.shape[0]))
daily_20151125_addname_dataframe.to_excel(daily_201511_excel_writer,'25_3',index=False)
daily_201511_excel_writer.save()
daily_20151126 = pro.daily(start_date='',end_date='',trade_date='20151126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151126_tscode_list = list() 
for ts_code_sh in daily_20151126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151126_tscode_list.append(stock_name)
daily_20151126_addname_dataframe=pd.DataFrame()
daily_20151126_addname_dataframe['cname'] = daily_20151126_tscode_list
for table_name in daily_20151126.columns.values.tolist():
    daily_20151126_addname_dataframe[table_name] = daily_20151126[table_name]
print("daily_20151126 返回数据 row 行数 = "+str(daily_20151126.shape[0]))
daily_20151126_addname_dataframe.to_excel(daily_201511_excel_writer,'26_4',index=False)
daily_201511_excel_writer.save()
daily_20151127 = pro.daily(start_date='',end_date='',trade_date='20151127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151127_tscode_list = list() 
for ts_code_sh in daily_20151127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151127_tscode_list.append(stock_name)
daily_20151127_addname_dataframe=pd.DataFrame()
daily_20151127_addname_dataframe['cname'] = daily_20151127_tscode_list
for table_name in daily_20151127.columns.values.tolist():
    daily_20151127_addname_dataframe[table_name] = daily_20151127[table_name]
print("daily_20151127 返回数据 row 行数 = "+str(daily_20151127.shape[0]))
daily_20151127_addname_dataframe.to_excel(daily_201511_excel_writer,'27_5',index=False)
daily_201511_excel_writer.save()
daily_20151128 = pro.daily(start_date='',end_date='',trade_date='20151128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151128_tscode_list = list() 
for ts_code_sh in daily_20151128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151128_tscode_list.append(stock_name)
daily_20151128_addname_dataframe=pd.DataFrame()
daily_20151128_addname_dataframe['cname'] = daily_20151128_tscode_list
for table_name in daily_20151128.columns.values.tolist():
    daily_20151128_addname_dataframe[table_name] = daily_20151128[table_name]
print("daily_20151128 返回数据 row 行数 = "+str(daily_20151128.shape[0]))
daily_20151128_addname_dataframe.to_excel(daily_201511_excel_writer,'28_6',index=False)
daily_201511_excel_writer.save()
daily_20151129 = pro.daily(start_date='',end_date='',trade_date='20151129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151129_tscode_list = list() 
for ts_code_sh in daily_20151129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151129_tscode_list.append(stock_name)
daily_20151129_addname_dataframe=pd.DataFrame()
daily_20151129_addname_dataframe['cname'] = daily_20151129_tscode_list
for table_name in daily_20151129.columns.values.tolist():
    daily_20151129_addname_dataframe[table_name] = daily_20151129[table_name]
print("daily_20151129 返回数据 row 行数 = "+str(daily_20151129.shape[0]))
daily_20151129_addname_dataframe.to_excel(daily_201511_excel_writer,'29_7',index=False)
daily_201511_excel_writer.save()
daily_20151130 = pro.daily(start_date='',end_date='',trade_date='20151130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151130_tscode_list = list() 
for ts_code_sh in daily_20151130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151130_tscode_list.append(stock_name)
daily_20151130_addname_dataframe=pd.DataFrame()
daily_20151130_addname_dataframe['cname'] = daily_20151130_tscode_list
for table_name in daily_20151130.columns.values.tolist():
    daily_20151130_addname_dataframe[table_name] = daily_20151130[table_name]
print("daily_20151130 返回数据 row 行数 = "+str(daily_20151130.shape[0]))
daily_20151130_addname_dataframe.to_excel(daily_201511_excel_writer,'30_1',index=False)
daily_201511_excel_writer.save()




createexcel('daily_201512.xlsx')
daily_201512_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201512.xlsx')
daily_201512_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201512.xlsx', engine='openpyxl')
daily_201512_excel_writer.book = daily_201512_book
daily_201512_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201512_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20151201")       ###  更新 记录日期
daily_20151201 = pro.daily(start_date='',end_date='',trade_date='20151201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151201_tscode_list = list() 
for ts_code_sh in daily_20151201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151201_tscode_list.append(stock_name)
daily_20151201_addname_dataframe=pd.DataFrame()
daily_20151201_addname_dataframe['cname'] = daily_20151201_tscode_list
for table_name in daily_20151201.columns.values.tolist():
    daily_20151201_addname_dataframe[table_name] = daily_20151201[table_name]
print("daily_20151201 返回数据 row 行数 = "+str(daily_20151201.shape[0]))
daily_20151201_addname_dataframe.to_excel(daily_201512_excel_writer,'1_2',index=False)
daily_201512_excel_writer.save()
daily_20151202 = pro.daily(start_date='',end_date='',trade_date='20151202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151202_tscode_list = list() 
for ts_code_sh in daily_20151202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151202_tscode_list.append(stock_name)
daily_20151202_addname_dataframe=pd.DataFrame()
daily_20151202_addname_dataframe['cname'] = daily_20151202_tscode_list
for table_name in daily_20151202.columns.values.tolist():
    daily_20151202_addname_dataframe[table_name] = daily_20151202[table_name]
print("daily_20151202 返回数据 row 行数 = "+str(daily_20151202.shape[0]))
daily_20151202_addname_dataframe.to_excel(daily_201512_excel_writer,'2_3',index=False)
daily_201512_excel_writer.save()
daily_20151203 = pro.daily(start_date='',end_date='',trade_date='20151203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151203_tscode_list = list() 
for ts_code_sh in daily_20151203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151203_tscode_list.append(stock_name)
daily_20151203_addname_dataframe=pd.DataFrame()
daily_20151203_addname_dataframe['cname'] = daily_20151203_tscode_list
for table_name in daily_20151203.columns.values.tolist():
    daily_20151203_addname_dataframe[table_name] = daily_20151203[table_name]
print("daily_20151203 返回数据 row 行数 = "+str(daily_20151203.shape[0]))
daily_20151203_addname_dataframe.to_excel(daily_201512_excel_writer,'3_4',index=False)
daily_201512_excel_writer.save()
daily_20151204 = pro.daily(start_date='',end_date='',trade_date='20151204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151204_tscode_list = list() 
for ts_code_sh in daily_20151204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151204_tscode_list.append(stock_name)
daily_20151204_addname_dataframe=pd.DataFrame()
daily_20151204_addname_dataframe['cname'] = daily_20151204_tscode_list
for table_name in daily_20151204.columns.values.tolist():
    daily_20151204_addname_dataframe[table_name] = daily_20151204[table_name]
print("daily_20151204 返回数据 row 行数 = "+str(daily_20151204.shape[0]))
daily_20151204_addname_dataframe.to_excel(daily_201512_excel_writer,'4_5',index=False)
daily_201512_excel_writer.save()
daily_20151205 = pro.daily(start_date='',end_date='',trade_date='20151205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151205_tscode_list = list() 
for ts_code_sh in daily_20151205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151205_tscode_list.append(stock_name)
daily_20151205_addname_dataframe=pd.DataFrame()
daily_20151205_addname_dataframe['cname'] = daily_20151205_tscode_list
for table_name in daily_20151205.columns.values.tolist():
    daily_20151205_addname_dataframe[table_name] = daily_20151205[table_name]
print("daily_20151205 返回数据 row 行数 = "+str(daily_20151205.shape[0]))
daily_20151205_addname_dataframe.to_excel(daily_201512_excel_writer,'5_6',index=False)
daily_201512_excel_writer.save()
daily_20151206 = pro.daily(start_date='',end_date='',trade_date='20151206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151206_tscode_list = list() 
for ts_code_sh in daily_20151206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151206_tscode_list.append(stock_name)
daily_20151206_addname_dataframe=pd.DataFrame()
daily_20151206_addname_dataframe['cname'] = daily_20151206_tscode_list
for table_name in daily_20151206.columns.values.tolist():
    daily_20151206_addname_dataframe[table_name] = daily_20151206[table_name]
print("daily_20151206 返回数据 row 行数 = "+str(daily_20151206.shape[0]))
daily_20151206_addname_dataframe.to_excel(daily_201512_excel_writer,'6_7',index=False)
daily_201512_excel_writer.save()
daily_20151207 = pro.daily(start_date='',end_date='',trade_date='20151207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151207_tscode_list = list() 
for ts_code_sh in daily_20151207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151207_tscode_list.append(stock_name)
daily_20151207_addname_dataframe=pd.DataFrame()
daily_20151207_addname_dataframe['cname'] = daily_20151207_tscode_list
for table_name in daily_20151207.columns.values.tolist():
    daily_20151207_addname_dataframe[table_name] = daily_20151207[table_name]
print("daily_20151207 返回数据 row 行数 = "+str(daily_20151207.shape[0]))
daily_20151207_addname_dataframe.to_excel(daily_201512_excel_writer,'7_1',index=False)
daily_201512_excel_writer.save()
daily_20151208 = pro.daily(start_date='',end_date='',trade_date='20151208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151208_tscode_list = list() 
for ts_code_sh in daily_20151208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151208_tscode_list.append(stock_name)
daily_20151208_addname_dataframe=pd.DataFrame()
daily_20151208_addname_dataframe['cname'] = daily_20151208_tscode_list
for table_name in daily_20151208.columns.values.tolist():
    daily_20151208_addname_dataframe[table_name] = daily_20151208[table_name]
print("daily_20151208 返回数据 row 行数 = "+str(daily_20151208.shape[0]))
daily_20151208_addname_dataframe.to_excel(daily_201512_excel_writer,'8_2',index=False)
daily_201512_excel_writer.save()
daily_20151209 = pro.daily(start_date='',end_date='',trade_date='20151209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151209_tscode_list = list() 
for ts_code_sh in daily_20151209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151209_tscode_list.append(stock_name)
daily_20151209_addname_dataframe=pd.DataFrame()
daily_20151209_addname_dataframe['cname'] = daily_20151209_tscode_list
for table_name in daily_20151209.columns.values.tolist():
    daily_20151209_addname_dataframe[table_name] = daily_20151209[table_name]
print("daily_20151209 返回数据 row 行数 = "+str(daily_20151209.shape[0]))
daily_20151209_addname_dataframe.to_excel(daily_201512_excel_writer,'9_3',index=False)
daily_201512_excel_writer.save()
daily_20151210 = pro.daily(start_date='',end_date='',trade_date='20151210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151210_tscode_list = list() 
for ts_code_sh in daily_20151210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151210_tscode_list.append(stock_name)
daily_20151210_addname_dataframe=pd.DataFrame()
daily_20151210_addname_dataframe['cname'] = daily_20151210_tscode_list
for table_name in daily_20151210.columns.values.tolist():
    daily_20151210_addname_dataframe[table_name] = daily_20151210[table_name]
print("daily_20151210 返回数据 row 行数 = "+str(daily_20151210.shape[0]))
daily_20151210_addname_dataframe.to_excel(daily_201512_excel_writer,'10_4',index=False)
daily_201512_excel_writer.save()
daily_20151211 = pro.daily(start_date='',end_date='',trade_date='20151211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151211_tscode_list = list() 
for ts_code_sh in daily_20151211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151211_tscode_list.append(stock_name)
daily_20151211_addname_dataframe=pd.DataFrame()
daily_20151211_addname_dataframe['cname'] = daily_20151211_tscode_list
for table_name in daily_20151211.columns.values.tolist():
    daily_20151211_addname_dataframe[table_name] = daily_20151211[table_name]
print("daily_20151211 返回数据 row 行数 = "+str(daily_20151211.shape[0]))
daily_20151211_addname_dataframe.to_excel(daily_201512_excel_writer,'11_5',index=False)
daily_201512_excel_writer.save()
daily_20151212 = pro.daily(start_date='',end_date='',trade_date='20151212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151212_tscode_list = list() 
for ts_code_sh in daily_20151212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151212_tscode_list.append(stock_name)
daily_20151212_addname_dataframe=pd.DataFrame()
daily_20151212_addname_dataframe['cname'] = daily_20151212_tscode_list
for table_name in daily_20151212.columns.values.tolist():
    daily_20151212_addname_dataframe[table_name] = daily_20151212[table_name]
print("daily_20151212 返回数据 row 行数 = "+str(daily_20151212.shape[0]))
daily_20151212_addname_dataframe.to_excel(daily_201512_excel_writer,'12_6',index=False)
daily_201512_excel_writer.save()
daily_20151213 = pro.daily(start_date='',end_date='',trade_date='20151213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151213_tscode_list = list() 
for ts_code_sh in daily_20151213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151213_tscode_list.append(stock_name)
daily_20151213_addname_dataframe=pd.DataFrame()
daily_20151213_addname_dataframe['cname'] = daily_20151213_tscode_list
for table_name in daily_20151213.columns.values.tolist():
    daily_20151213_addname_dataframe[table_name] = daily_20151213[table_name]
print("daily_20151213 返回数据 row 行数 = "+str(daily_20151213.shape[0]))
daily_20151213_addname_dataframe.to_excel(daily_201512_excel_writer,'13_7',index=False)
daily_201512_excel_writer.save()
daily_20151214 = pro.daily(start_date='',end_date='',trade_date='20151214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151214_tscode_list = list() 
for ts_code_sh in daily_20151214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151214_tscode_list.append(stock_name)
daily_20151214_addname_dataframe=pd.DataFrame()
daily_20151214_addname_dataframe['cname'] = daily_20151214_tscode_list
for table_name in daily_20151214.columns.values.tolist():
    daily_20151214_addname_dataframe[table_name] = daily_20151214[table_name]
print("daily_20151214 返回数据 row 行数 = "+str(daily_20151214.shape[0]))
daily_20151214_addname_dataframe.to_excel(daily_201512_excel_writer,'14_1',index=False)
daily_201512_excel_writer.save()
daily_20151215 = pro.daily(start_date='',end_date='',trade_date='20151215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151215_tscode_list = list() 
for ts_code_sh in daily_20151215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151215_tscode_list.append(stock_name)
daily_20151215_addname_dataframe=pd.DataFrame()
daily_20151215_addname_dataframe['cname'] = daily_20151215_tscode_list
for table_name in daily_20151215.columns.values.tolist():
    daily_20151215_addname_dataframe[table_name] = daily_20151215[table_name]
print("daily_20151215 返回数据 row 行数 = "+str(daily_20151215.shape[0]))
daily_20151215_addname_dataframe.to_excel(daily_201512_excel_writer,'15_2',index=False)
daily_201512_excel_writer.save()
daily_20151216 = pro.daily(start_date='',end_date='',trade_date='20151216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151216_tscode_list = list() 
for ts_code_sh in daily_20151216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151216_tscode_list.append(stock_name)
daily_20151216_addname_dataframe=pd.DataFrame()
daily_20151216_addname_dataframe['cname'] = daily_20151216_tscode_list
for table_name in daily_20151216.columns.values.tolist():
    daily_20151216_addname_dataframe[table_name] = daily_20151216[table_name]
print("daily_20151216 返回数据 row 行数 = "+str(daily_20151216.shape[0]))
daily_20151216_addname_dataframe.to_excel(daily_201512_excel_writer,'16_3',index=False)
daily_201512_excel_writer.save()
daily_20151217 = pro.daily(start_date='',end_date='',trade_date='20151217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151217_tscode_list = list() 
for ts_code_sh in daily_20151217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151217_tscode_list.append(stock_name)
daily_20151217_addname_dataframe=pd.DataFrame()
daily_20151217_addname_dataframe['cname'] = daily_20151217_tscode_list
for table_name in daily_20151217.columns.values.tolist():
    daily_20151217_addname_dataframe[table_name] = daily_20151217[table_name]
print("daily_20151217 返回数据 row 行数 = "+str(daily_20151217.shape[0]))
daily_20151217_addname_dataframe.to_excel(daily_201512_excel_writer,'17_4',index=False)
daily_201512_excel_writer.save()
daily_20151218 = pro.daily(start_date='',end_date='',trade_date='20151218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151218_tscode_list = list() 
for ts_code_sh in daily_20151218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151218_tscode_list.append(stock_name)
daily_20151218_addname_dataframe=pd.DataFrame()
daily_20151218_addname_dataframe['cname'] = daily_20151218_tscode_list
for table_name in daily_20151218.columns.values.tolist():
    daily_20151218_addname_dataframe[table_name] = daily_20151218[table_name]
print("daily_20151218 返回数据 row 行数 = "+str(daily_20151218.shape[0]))
daily_20151218_addname_dataframe.to_excel(daily_201512_excel_writer,'18_5',index=False)
daily_201512_excel_writer.save()
daily_20151219 = pro.daily(start_date='',end_date='',trade_date='20151219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151219_tscode_list = list() 
for ts_code_sh in daily_20151219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151219_tscode_list.append(stock_name)
daily_20151219_addname_dataframe=pd.DataFrame()
daily_20151219_addname_dataframe['cname'] = daily_20151219_tscode_list
for table_name in daily_20151219.columns.values.tolist():
    daily_20151219_addname_dataframe[table_name] = daily_20151219[table_name]
print("daily_20151219 返回数据 row 行数 = "+str(daily_20151219.shape[0]))
daily_20151219_addname_dataframe.to_excel(daily_201512_excel_writer,'19_6',index=False)
daily_201512_excel_writer.save()
daily_20151220 = pro.daily(start_date='',end_date='',trade_date='20151220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151220_tscode_list = list() 
for ts_code_sh in daily_20151220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151220_tscode_list.append(stock_name)
daily_20151220_addname_dataframe=pd.DataFrame()
daily_20151220_addname_dataframe['cname'] = daily_20151220_tscode_list
for table_name in daily_20151220.columns.values.tolist():
    daily_20151220_addname_dataframe[table_name] = daily_20151220[table_name]
print("daily_20151220 返回数据 row 行数 = "+str(daily_20151220.shape[0]))
daily_20151220_addname_dataframe.to_excel(daily_201512_excel_writer,'20_7',index=False)
daily_201512_excel_writer.save()
daily_20151221 = pro.daily(start_date='',end_date='',trade_date='20151221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151221_tscode_list = list() 
for ts_code_sh in daily_20151221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151221_tscode_list.append(stock_name)
daily_20151221_addname_dataframe=pd.DataFrame()
daily_20151221_addname_dataframe['cname'] = daily_20151221_tscode_list
for table_name in daily_20151221.columns.values.tolist():
    daily_20151221_addname_dataframe[table_name] = daily_20151221[table_name]
print("daily_20151221 返回数据 row 行数 = "+str(daily_20151221.shape[0]))
daily_20151221_addname_dataframe.to_excel(daily_201512_excel_writer,'21_1',index=False)
daily_201512_excel_writer.save()
daily_20151222 = pro.daily(start_date='',end_date='',trade_date='20151222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151222_tscode_list = list() 
for ts_code_sh in daily_20151222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151222_tscode_list.append(stock_name)
daily_20151222_addname_dataframe=pd.DataFrame()
daily_20151222_addname_dataframe['cname'] = daily_20151222_tscode_list
for table_name in daily_20151222.columns.values.tolist():
    daily_20151222_addname_dataframe[table_name] = daily_20151222[table_name]
print("daily_20151222 返回数据 row 行数 = "+str(daily_20151222.shape[0]))
daily_20151222_addname_dataframe.to_excel(daily_201512_excel_writer,'22_2',index=False)
daily_201512_excel_writer.save()
daily_20151223 = pro.daily(start_date='',end_date='',trade_date='20151223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151223_tscode_list = list() 
for ts_code_sh in daily_20151223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151223_tscode_list.append(stock_name)
daily_20151223_addname_dataframe=pd.DataFrame()
daily_20151223_addname_dataframe['cname'] = daily_20151223_tscode_list
for table_name in daily_20151223.columns.values.tolist():
    daily_20151223_addname_dataframe[table_name] = daily_20151223[table_name]
print("daily_20151223 返回数据 row 行数 = "+str(daily_20151223.shape[0]))
daily_20151223_addname_dataframe.to_excel(daily_201512_excel_writer,'23_3',index=False)
daily_201512_excel_writer.save()
daily_20151224 = pro.daily(start_date='',end_date='',trade_date='20151224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151224_tscode_list = list() 
for ts_code_sh in daily_20151224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151224_tscode_list.append(stock_name)
daily_20151224_addname_dataframe=pd.DataFrame()
daily_20151224_addname_dataframe['cname'] = daily_20151224_tscode_list
for table_name in daily_20151224.columns.values.tolist():
    daily_20151224_addname_dataframe[table_name] = daily_20151224[table_name]
print("daily_20151224 返回数据 row 行数 = "+str(daily_20151224.shape[0]))
daily_20151224_addname_dataframe.to_excel(daily_201512_excel_writer,'24_4',index=False)
daily_201512_excel_writer.save()
daily_20151225 = pro.daily(start_date='',end_date='',trade_date='20151225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151225_tscode_list = list() 
for ts_code_sh in daily_20151225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151225_tscode_list.append(stock_name)
daily_20151225_addname_dataframe=pd.DataFrame()
daily_20151225_addname_dataframe['cname'] = daily_20151225_tscode_list
for table_name in daily_20151225.columns.values.tolist():
    daily_20151225_addname_dataframe[table_name] = daily_20151225[table_name]
print("daily_20151225 返回数据 row 行数 = "+str(daily_20151225.shape[0]))
daily_20151225_addname_dataframe.to_excel(daily_201512_excel_writer,'25_5',index=False)
daily_201512_excel_writer.save()
daily_20151226 = pro.daily(start_date='',end_date='',trade_date='20151226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151226_tscode_list = list() 
for ts_code_sh in daily_20151226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151226_tscode_list.append(stock_name)
daily_20151226_addname_dataframe=pd.DataFrame()
daily_20151226_addname_dataframe['cname'] = daily_20151226_tscode_list
for table_name in daily_20151226.columns.values.tolist():
    daily_20151226_addname_dataframe[table_name] = daily_20151226[table_name]
print("daily_20151226 返回数据 row 行数 = "+str(daily_20151226.shape[0]))
daily_20151226_addname_dataframe.to_excel(daily_201512_excel_writer,'26_6',index=False)
daily_201512_excel_writer.save()
daily_20151227 = pro.daily(start_date='',end_date='',trade_date='20151227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151227_tscode_list = list() 
for ts_code_sh in daily_20151227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151227_tscode_list.append(stock_name)
daily_20151227_addname_dataframe=pd.DataFrame()
daily_20151227_addname_dataframe['cname'] = daily_20151227_tscode_list
for table_name in daily_20151227.columns.values.tolist():
    daily_20151227_addname_dataframe[table_name] = daily_20151227[table_name]
print("daily_20151227 返回数据 row 行数 = "+str(daily_20151227.shape[0]))
daily_20151227_addname_dataframe.to_excel(daily_201512_excel_writer,'27_7',index=False)
daily_201512_excel_writer.save()
daily_20151228 = pro.daily(start_date='',end_date='',trade_date='20151228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151228_tscode_list = list() 
for ts_code_sh in daily_20151228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151228_tscode_list.append(stock_name)
daily_20151228_addname_dataframe=pd.DataFrame()
daily_20151228_addname_dataframe['cname'] = daily_20151228_tscode_list
for table_name in daily_20151228.columns.values.tolist():
    daily_20151228_addname_dataframe[table_name] = daily_20151228[table_name]
print("daily_20151228 返回数据 row 行数 = "+str(daily_20151228.shape[0]))
daily_20151228_addname_dataframe.to_excel(daily_201512_excel_writer,'28_1',index=False)
daily_201512_excel_writer.save()
daily_20151229 = pro.daily(start_date='',end_date='',trade_date='20151229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151229_tscode_list = list() 
for ts_code_sh in daily_20151229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151229_tscode_list.append(stock_name)
daily_20151229_addname_dataframe=pd.DataFrame()
daily_20151229_addname_dataframe['cname'] = daily_20151229_tscode_list
for table_name in daily_20151229.columns.values.tolist():
    daily_20151229_addname_dataframe[table_name] = daily_20151229[table_name]
print("daily_20151229 返回数据 row 行数 = "+str(daily_20151229.shape[0]))
daily_20151229_addname_dataframe.to_excel(daily_201512_excel_writer,'29_2',index=False)
daily_201512_excel_writer.save()
daily_20151230 = pro.daily(start_date='',end_date='',trade_date='20151230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151230_tscode_list = list() 
for ts_code_sh in daily_20151230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151230_tscode_list.append(stock_name)
daily_20151230_addname_dataframe=pd.DataFrame()
daily_20151230_addname_dataframe['cname'] = daily_20151230_tscode_list
for table_name in daily_20151230.columns.values.tolist():
    daily_20151230_addname_dataframe[table_name] = daily_20151230[table_name]
print("daily_20151230 返回数据 row 行数 = "+str(daily_20151230.shape[0]))
daily_20151230_addname_dataframe.to_excel(daily_201512_excel_writer,'30_3',index=False)
daily_201512_excel_writer.save()
daily_20151231 = pro.daily(start_date='',end_date='',trade_date='20151231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151231_tscode_list = list() 
for ts_code_sh in daily_20151231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151231_tscode_list.append(stock_name)
daily_20151231_addname_dataframe=pd.DataFrame()
daily_20151231_addname_dataframe['cname'] = daily_20151231_tscode_list
for table_name in daily_20151231.columns.values.tolist():
    daily_20151231_addname_dataframe[table_name] = daily_20151231[table_name]
print("daily_20151231 返回数据 row 行数 = "+str(daily_20151231.shape[0]))
daily_20151231_addname_dataframe.to_excel(daily_201512_excel_writer,'31_4',index=False)
daily_201512_excel_writer.save()




createexcel('daily_201601.xlsx')
daily_201601_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201601.xlsx')
daily_201601_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201601.xlsx', engine='openpyxl')
daily_201601_excel_writer.book = daily_201601_book
daily_201601_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201601_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160101")       ###  更新 记录日期
daily_20160101 = pro.daily(start_date='',end_date='',trade_date='20160101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160101_tscode_list = list() 
for ts_code_sh in daily_20160101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160101_tscode_list.append(stock_name)
daily_20160101_addname_dataframe=pd.DataFrame()
daily_20160101_addname_dataframe['cname'] = daily_20160101_tscode_list
for table_name in daily_20160101.columns.values.tolist():
    daily_20160101_addname_dataframe[table_name] = daily_20160101[table_name]
print("daily_20160101 返回数据 row 行数 = "+str(daily_20160101.shape[0]))
daily_20160101_addname_dataframe.to_excel(daily_201601_excel_writer,'1_5',index=False)
daily_201601_excel_writer.save()
daily_20160102 = pro.daily(start_date='',end_date='',trade_date='20160102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160102_tscode_list = list() 
for ts_code_sh in daily_20160102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160102_tscode_list.append(stock_name)
daily_20160102_addname_dataframe=pd.DataFrame()
daily_20160102_addname_dataframe['cname'] = daily_20160102_tscode_list
for table_name in daily_20160102.columns.values.tolist():
    daily_20160102_addname_dataframe[table_name] = daily_20160102[table_name]
print("daily_20160102 返回数据 row 行数 = "+str(daily_20160102.shape[0]))
daily_20160102_addname_dataframe.to_excel(daily_201601_excel_writer,'2_6',index=False)
daily_201601_excel_writer.save()
daily_20160103 = pro.daily(start_date='',end_date='',trade_date='20160103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160103_tscode_list = list() 
for ts_code_sh in daily_20160103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160103_tscode_list.append(stock_name)
daily_20160103_addname_dataframe=pd.DataFrame()
daily_20160103_addname_dataframe['cname'] = daily_20160103_tscode_list
for table_name in daily_20160103.columns.values.tolist():
    daily_20160103_addname_dataframe[table_name] = daily_20160103[table_name]
print("daily_20160103 返回数据 row 行数 = "+str(daily_20160103.shape[0]))
daily_20160103_addname_dataframe.to_excel(daily_201601_excel_writer,'3_7',index=False)
daily_201601_excel_writer.save()
daily_20160104 = pro.daily(start_date='',end_date='',trade_date='20160104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160104_tscode_list = list() 
for ts_code_sh in daily_20160104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160104_tscode_list.append(stock_name)
daily_20160104_addname_dataframe=pd.DataFrame()
daily_20160104_addname_dataframe['cname'] = daily_20160104_tscode_list
for table_name in daily_20160104.columns.values.tolist():
    daily_20160104_addname_dataframe[table_name] = daily_20160104[table_name]
print("daily_20160104 返回数据 row 行数 = "+str(daily_20160104.shape[0]))
daily_20160104_addname_dataframe.to_excel(daily_201601_excel_writer,'4_1',index=False)
daily_201601_excel_writer.save()
daily_20160105 = pro.daily(start_date='',end_date='',trade_date='20160105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160105_tscode_list = list() 
for ts_code_sh in daily_20160105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160105_tscode_list.append(stock_name)
daily_20160105_addname_dataframe=pd.DataFrame()
daily_20160105_addname_dataframe['cname'] = daily_20160105_tscode_list
for table_name in daily_20160105.columns.values.tolist():
    daily_20160105_addname_dataframe[table_name] = daily_20160105[table_name]
print("daily_20160105 返回数据 row 行数 = "+str(daily_20160105.shape[0]))
daily_20160105_addname_dataframe.to_excel(daily_201601_excel_writer,'5_2',index=False)
daily_201601_excel_writer.save()
daily_20160106 = pro.daily(start_date='',end_date='',trade_date='20160106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160106_tscode_list = list() 
for ts_code_sh in daily_20160106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160106_tscode_list.append(stock_name)
daily_20160106_addname_dataframe=pd.DataFrame()
daily_20160106_addname_dataframe['cname'] = daily_20160106_tscode_list
for table_name in daily_20160106.columns.values.tolist():
    daily_20160106_addname_dataframe[table_name] = daily_20160106[table_name]
print("daily_20160106 返回数据 row 行数 = "+str(daily_20160106.shape[0]))
daily_20160106_addname_dataframe.to_excel(daily_201601_excel_writer,'6_3',index=False)
daily_201601_excel_writer.save()
daily_20160107 = pro.daily(start_date='',end_date='',trade_date='20160107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160107_tscode_list = list() 
for ts_code_sh in daily_20160107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160107_tscode_list.append(stock_name)
daily_20160107_addname_dataframe=pd.DataFrame()
daily_20160107_addname_dataframe['cname'] = daily_20160107_tscode_list
for table_name in daily_20160107.columns.values.tolist():
    daily_20160107_addname_dataframe[table_name] = daily_20160107[table_name]
print("daily_20160107 返回数据 row 行数 = "+str(daily_20160107.shape[0]))
daily_20160107_addname_dataframe.to_excel(daily_201601_excel_writer,'7_4',index=False)
daily_201601_excel_writer.save()
daily_20160108 = pro.daily(start_date='',end_date='',trade_date='20160108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160108_tscode_list = list() 
for ts_code_sh in daily_20160108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160108_tscode_list.append(stock_name)
daily_20160108_addname_dataframe=pd.DataFrame()
daily_20160108_addname_dataframe['cname'] = daily_20160108_tscode_list
for table_name in daily_20160108.columns.values.tolist():
    daily_20160108_addname_dataframe[table_name] = daily_20160108[table_name]
print("daily_20160108 返回数据 row 行数 = "+str(daily_20160108.shape[0]))
daily_20160108_addname_dataframe.to_excel(daily_201601_excel_writer,'8_5',index=False)
daily_201601_excel_writer.save()
daily_20160109 = pro.daily(start_date='',end_date='',trade_date='20160109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160109_tscode_list = list() 
for ts_code_sh in daily_20160109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160109_tscode_list.append(stock_name)
daily_20160109_addname_dataframe=pd.DataFrame()
daily_20160109_addname_dataframe['cname'] = daily_20160109_tscode_list
for table_name in daily_20160109.columns.values.tolist():
    daily_20160109_addname_dataframe[table_name] = daily_20160109[table_name]
print("daily_20160109 返回数据 row 行数 = "+str(daily_20160109.shape[0]))
daily_20160109_addname_dataframe.to_excel(daily_201601_excel_writer,'9_6',index=False)
daily_201601_excel_writer.save()
daily_20160110 = pro.daily(start_date='',end_date='',trade_date='20160110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160110_tscode_list = list() 
for ts_code_sh in daily_20160110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160110_tscode_list.append(stock_name)
daily_20160110_addname_dataframe=pd.DataFrame()
daily_20160110_addname_dataframe['cname'] = daily_20160110_tscode_list
for table_name in daily_20160110.columns.values.tolist():
    daily_20160110_addname_dataframe[table_name] = daily_20160110[table_name]
print("daily_20160110 返回数据 row 行数 = "+str(daily_20160110.shape[0]))
daily_20160110_addname_dataframe.to_excel(daily_201601_excel_writer,'10_7',index=False)
daily_201601_excel_writer.save()
daily_20160111 = pro.daily(start_date='',end_date='',trade_date='20160111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160111_tscode_list = list() 
for ts_code_sh in daily_20160111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160111_tscode_list.append(stock_name)
daily_20160111_addname_dataframe=pd.DataFrame()
daily_20160111_addname_dataframe['cname'] = daily_20160111_tscode_list
for table_name in daily_20160111.columns.values.tolist():
    daily_20160111_addname_dataframe[table_name] = daily_20160111[table_name]
print("daily_20160111 返回数据 row 行数 = "+str(daily_20160111.shape[0]))
daily_20160111_addname_dataframe.to_excel(daily_201601_excel_writer,'11_1',index=False)
daily_201601_excel_writer.save()
daily_20160112 = pro.daily(start_date='',end_date='',trade_date='20160112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160112_tscode_list = list() 
for ts_code_sh in daily_20160112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160112_tscode_list.append(stock_name)
daily_20160112_addname_dataframe=pd.DataFrame()
daily_20160112_addname_dataframe['cname'] = daily_20160112_tscode_list
for table_name in daily_20160112.columns.values.tolist():
    daily_20160112_addname_dataframe[table_name] = daily_20160112[table_name]
print("daily_20160112 返回数据 row 行数 = "+str(daily_20160112.shape[0]))
daily_20160112_addname_dataframe.to_excel(daily_201601_excel_writer,'12_2',index=False)
daily_201601_excel_writer.save()
daily_20160113 = pro.daily(start_date='',end_date='',trade_date='20160113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160113_tscode_list = list() 
for ts_code_sh in daily_20160113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160113_tscode_list.append(stock_name)
daily_20160113_addname_dataframe=pd.DataFrame()
daily_20160113_addname_dataframe['cname'] = daily_20160113_tscode_list
for table_name in daily_20160113.columns.values.tolist():
    daily_20160113_addname_dataframe[table_name] = daily_20160113[table_name]
print("daily_20160113 返回数据 row 行数 = "+str(daily_20160113.shape[0]))
daily_20160113_addname_dataframe.to_excel(daily_201601_excel_writer,'13_3',index=False)
daily_201601_excel_writer.save()
daily_20160114 = pro.daily(start_date='',end_date='',trade_date='20160114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160114_tscode_list = list() 
for ts_code_sh in daily_20160114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160114_tscode_list.append(stock_name)
daily_20160114_addname_dataframe=pd.DataFrame()
daily_20160114_addname_dataframe['cname'] = daily_20160114_tscode_list
for table_name in daily_20160114.columns.values.tolist():
    daily_20160114_addname_dataframe[table_name] = daily_20160114[table_name]
print("daily_20160114 返回数据 row 行数 = "+str(daily_20160114.shape[0]))
daily_20160114_addname_dataframe.to_excel(daily_201601_excel_writer,'14_4',index=False)
daily_201601_excel_writer.save()
daily_20160115 = pro.daily(start_date='',end_date='',trade_date='20160115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160115_tscode_list = list() 
for ts_code_sh in daily_20160115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160115_tscode_list.append(stock_name)
daily_20160115_addname_dataframe=pd.DataFrame()
daily_20160115_addname_dataframe['cname'] = daily_20160115_tscode_list
for table_name in daily_20160115.columns.values.tolist():
    daily_20160115_addname_dataframe[table_name] = daily_20160115[table_name]
print("daily_20160115 返回数据 row 行数 = "+str(daily_20160115.shape[0]))
daily_20160115_addname_dataframe.to_excel(daily_201601_excel_writer,'15_5',index=False)
daily_201601_excel_writer.save()
daily_20160116 = pro.daily(start_date='',end_date='',trade_date='20160116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160116_tscode_list = list() 
for ts_code_sh in daily_20160116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160116_tscode_list.append(stock_name)
daily_20160116_addname_dataframe=pd.DataFrame()
daily_20160116_addname_dataframe['cname'] = daily_20160116_tscode_list
for table_name in daily_20160116.columns.values.tolist():
    daily_20160116_addname_dataframe[table_name] = daily_20160116[table_name]
print("daily_20160116 返回数据 row 行数 = "+str(daily_20160116.shape[0]))
daily_20160116_addname_dataframe.to_excel(daily_201601_excel_writer,'16_6',index=False)
daily_201601_excel_writer.save()
daily_20160117 = pro.daily(start_date='',end_date='',trade_date='20160117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160117_tscode_list = list() 
for ts_code_sh in daily_20160117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160117_tscode_list.append(stock_name)
daily_20160117_addname_dataframe=pd.DataFrame()
daily_20160117_addname_dataframe['cname'] = daily_20160117_tscode_list
for table_name in daily_20160117.columns.values.tolist():
    daily_20160117_addname_dataframe[table_name] = daily_20160117[table_name]
print("daily_20160117 返回数据 row 行数 = "+str(daily_20160117.shape[0]))
daily_20160117_addname_dataframe.to_excel(daily_201601_excel_writer,'17_7',index=False)
daily_201601_excel_writer.save()
daily_20160118 = pro.daily(start_date='',end_date='',trade_date='20160118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160118_tscode_list = list() 
for ts_code_sh in daily_20160118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160118_tscode_list.append(stock_name)
daily_20160118_addname_dataframe=pd.DataFrame()
daily_20160118_addname_dataframe['cname'] = daily_20160118_tscode_list
for table_name in daily_20160118.columns.values.tolist():
    daily_20160118_addname_dataframe[table_name] = daily_20160118[table_name]
print("daily_20160118 返回数据 row 行数 = "+str(daily_20160118.shape[0]))
daily_20160118_addname_dataframe.to_excel(daily_201601_excel_writer,'18_1',index=False)
daily_201601_excel_writer.save()
daily_20160119 = pro.daily(start_date='',end_date='',trade_date='20160119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160119_tscode_list = list() 
for ts_code_sh in daily_20160119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160119_tscode_list.append(stock_name)
daily_20160119_addname_dataframe=pd.DataFrame()
daily_20160119_addname_dataframe['cname'] = daily_20160119_tscode_list
for table_name in daily_20160119.columns.values.tolist():
    daily_20160119_addname_dataframe[table_name] = daily_20160119[table_name]
print("daily_20160119 返回数据 row 行数 = "+str(daily_20160119.shape[0]))
daily_20160119_addname_dataframe.to_excel(daily_201601_excel_writer,'19_2',index=False)
daily_201601_excel_writer.save()
daily_20160120 = pro.daily(start_date='',end_date='',trade_date='20160120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160120_tscode_list = list() 
for ts_code_sh in daily_20160120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160120_tscode_list.append(stock_name)
daily_20160120_addname_dataframe=pd.DataFrame()
daily_20160120_addname_dataframe['cname'] = daily_20160120_tscode_list
for table_name in daily_20160120.columns.values.tolist():
    daily_20160120_addname_dataframe[table_name] = daily_20160120[table_name]
print("daily_20160120 返回数据 row 行数 = "+str(daily_20160120.shape[0]))
daily_20160120_addname_dataframe.to_excel(daily_201601_excel_writer,'20_3',index=False)
daily_201601_excel_writer.save()
daily_20160121 = pro.daily(start_date='',end_date='',trade_date='20160121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160121_tscode_list = list() 
for ts_code_sh in daily_20160121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160121_tscode_list.append(stock_name)
daily_20160121_addname_dataframe=pd.DataFrame()
daily_20160121_addname_dataframe['cname'] = daily_20160121_tscode_list
for table_name in daily_20160121.columns.values.tolist():
    daily_20160121_addname_dataframe[table_name] = daily_20160121[table_name]
print("daily_20160121 返回数据 row 行数 = "+str(daily_20160121.shape[0]))
daily_20160121_addname_dataframe.to_excel(daily_201601_excel_writer,'21_4',index=False)
daily_201601_excel_writer.save()
daily_20160122 = pro.daily(start_date='',end_date='',trade_date='20160122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160122_tscode_list = list() 
for ts_code_sh in daily_20160122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160122_tscode_list.append(stock_name)
daily_20160122_addname_dataframe=pd.DataFrame()
daily_20160122_addname_dataframe['cname'] = daily_20160122_tscode_list
for table_name in daily_20160122.columns.values.tolist():
    daily_20160122_addname_dataframe[table_name] = daily_20160122[table_name]
print("daily_20160122 返回数据 row 行数 = "+str(daily_20160122.shape[0]))
daily_20160122_addname_dataframe.to_excel(daily_201601_excel_writer,'22_5',index=False)
daily_201601_excel_writer.save()
daily_20160123 = pro.daily(start_date='',end_date='',trade_date='20160123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160123_tscode_list = list() 
for ts_code_sh in daily_20160123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160123_tscode_list.append(stock_name)
daily_20160123_addname_dataframe=pd.DataFrame()
daily_20160123_addname_dataframe['cname'] = daily_20160123_tscode_list
for table_name in daily_20160123.columns.values.tolist():
    daily_20160123_addname_dataframe[table_name] = daily_20160123[table_name]
print("daily_20160123 返回数据 row 行数 = "+str(daily_20160123.shape[0]))
daily_20160123_addname_dataframe.to_excel(daily_201601_excel_writer,'23_6',index=False)
daily_201601_excel_writer.save()
daily_20160124 = pro.daily(start_date='',end_date='',trade_date='20160124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160124_tscode_list = list() 
for ts_code_sh in daily_20160124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160124_tscode_list.append(stock_name)
daily_20160124_addname_dataframe=pd.DataFrame()
daily_20160124_addname_dataframe['cname'] = daily_20160124_tscode_list
for table_name in daily_20160124.columns.values.tolist():
    daily_20160124_addname_dataframe[table_name] = daily_20160124[table_name]
print("daily_20160124 返回数据 row 行数 = "+str(daily_20160124.shape[0]))
daily_20160124_addname_dataframe.to_excel(daily_201601_excel_writer,'24_7',index=False)
daily_201601_excel_writer.save()
daily_20160125 = pro.daily(start_date='',end_date='',trade_date='20160125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160125_tscode_list = list() 
for ts_code_sh in daily_20160125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160125_tscode_list.append(stock_name)
daily_20160125_addname_dataframe=pd.DataFrame()
daily_20160125_addname_dataframe['cname'] = daily_20160125_tscode_list
for table_name in daily_20160125.columns.values.tolist():
    daily_20160125_addname_dataframe[table_name] = daily_20160125[table_name]
print("daily_20160125 返回数据 row 行数 = "+str(daily_20160125.shape[0]))
daily_20160125_addname_dataframe.to_excel(daily_201601_excel_writer,'25_1',index=False)
daily_201601_excel_writer.save()
daily_20160126 = pro.daily(start_date='',end_date='',trade_date='20160126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160126_tscode_list = list() 
for ts_code_sh in daily_20160126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160126_tscode_list.append(stock_name)
daily_20160126_addname_dataframe=pd.DataFrame()
daily_20160126_addname_dataframe['cname'] = daily_20160126_tscode_list
for table_name in daily_20160126.columns.values.tolist():
    daily_20160126_addname_dataframe[table_name] = daily_20160126[table_name]
print("daily_20160126 返回数据 row 行数 = "+str(daily_20160126.shape[0]))
daily_20160126_addname_dataframe.to_excel(daily_201601_excel_writer,'26_2',index=False)
daily_201601_excel_writer.save()
daily_20160127 = pro.daily(start_date='',end_date='',trade_date='20160127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160127_tscode_list = list() 
for ts_code_sh in daily_20160127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160127_tscode_list.append(stock_name)
daily_20160127_addname_dataframe=pd.DataFrame()
daily_20160127_addname_dataframe['cname'] = daily_20160127_tscode_list
for table_name in daily_20160127.columns.values.tolist():
    daily_20160127_addname_dataframe[table_name] = daily_20160127[table_name]
print("daily_20160127 返回数据 row 行数 = "+str(daily_20160127.shape[0]))
daily_20160127_addname_dataframe.to_excel(daily_201601_excel_writer,'27_3',index=False)
daily_201601_excel_writer.save()
daily_20160128 = pro.daily(start_date='',end_date='',trade_date='20160128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160128_tscode_list = list() 
for ts_code_sh in daily_20160128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160128_tscode_list.append(stock_name)
daily_20160128_addname_dataframe=pd.DataFrame()
daily_20160128_addname_dataframe['cname'] = daily_20160128_tscode_list
for table_name in daily_20160128.columns.values.tolist():
    daily_20160128_addname_dataframe[table_name] = daily_20160128[table_name]
print("daily_20160128 返回数据 row 行数 = "+str(daily_20160128.shape[0]))
daily_20160128_addname_dataframe.to_excel(daily_201601_excel_writer,'28_4',index=False)
daily_201601_excel_writer.save()
daily_20160129 = pro.daily(start_date='',end_date='',trade_date='20160129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160129_tscode_list = list() 
for ts_code_sh in daily_20160129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160129_tscode_list.append(stock_name)
daily_20160129_addname_dataframe=pd.DataFrame()
daily_20160129_addname_dataframe['cname'] = daily_20160129_tscode_list
for table_name in daily_20160129.columns.values.tolist():
    daily_20160129_addname_dataframe[table_name] = daily_20160129[table_name]
print("daily_20160129 返回数据 row 行数 = "+str(daily_20160129.shape[0]))
daily_20160129_addname_dataframe.to_excel(daily_201601_excel_writer,'29_5',index=False)
daily_201601_excel_writer.save()
daily_20160130 = pro.daily(start_date='',end_date='',trade_date='20160130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160130_tscode_list = list() 
for ts_code_sh in daily_20160130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160130_tscode_list.append(stock_name)
daily_20160130_addname_dataframe=pd.DataFrame()
daily_20160130_addname_dataframe['cname'] = daily_20160130_tscode_list
for table_name in daily_20160130.columns.values.tolist():
    daily_20160130_addname_dataframe[table_name] = daily_20160130[table_name]
print("daily_20160130 返回数据 row 行数 = "+str(daily_20160130.shape[0]))
daily_20160130_addname_dataframe.to_excel(daily_201601_excel_writer,'30_6',index=False)
daily_201601_excel_writer.save()
daily_20160131 = pro.daily(start_date='',end_date='',trade_date='20160131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160131_tscode_list = list() 
for ts_code_sh in daily_20160131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160131_tscode_list.append(stock_name)
daily_20160131_addname_dataframe=pd.DataFrame()
daily_20160131_addname_dataframe['cname'] = daily_20160131_tscode_list
for table_name in daily_20160131.columns.values.tolist():
    daily_20160131_addname_dataframe[table_name] = daily_20160131[table_name]
print("daily_20160131 返回数据 row 行数 = "+str(daily_20160131.shape[0]))
daily_20160131_addname_dataframe.to_excel(daily_201601_excel_writer,'31_7',index=False)
daily_201601_excel_writer.save()




createexcel('daily_201602.xlsx')
daily_201602_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201602.xlsx')
daily_201602_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201602.xlsx', engine='openpyxl')
daily_201602_excel_writer.book = daily_201602_book
daily_201602_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201602_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160201")       ###  更新 记录日期
daily_20160201 = pro.daily(start_date='',end_date='',trade_date='20160201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160201_tscode_list = list() 
for ts_code_sh in daily_20160201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160201_tscode_list.append(stock_name)
daily_20160201_addname_dataframe=pd.DataFrame()
daily_20160201_addname_dataframe['cname'] = daily_20160201_tscode_list
for table_name in daily_20160201.columns.values.tolist():
    daily_20160201_addname_dataframe[table_name] = daily_20160201[table_name]
print("daily_20160201 返回数据 row 行数 = "+str(daily_20160201.shape[0]))
daily_20160201_addname_dataframe.to_excel(daily_201602_excel_writer,'1_1',index=False)
daily_201602_excel_writer.save()
daily_20160202 = pro.daily(start_date='',end_date='',trade_date='20160202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160202_tscode_list = list() 
for ts_code_sh in daily_20160202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160202_tscode_list.append(stock_name)
daily_20160202_addname_dataframe=pd.DataFrame()
daily_20160202_addname_dataframe['cname'] = daily_20160202_tscode_list
for table_name in daily_20160202.columns.values.tolist():
    daily_20160202_addname_dataframe[table_name] = daily_20160202[table_name]
print("daily_20160202 返回数据 row 行数 = "+str(daily_20160202.shape[0]))
daily_20160202_addname_dataframe.to_excel(daily_201602_excel_writer,'2_2',index=False)
daily_201602_excel_writer.save()
daily_20160203 = pro.daily(start_date='',end_date='',trade_date='20160203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160203_tscode_list = list() 
for ts_code_sh in daily_20160203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160203_tscode_list.append(stock_name)
daily_20160203_addname_dataframe=pd.DataFrame()
daily_20160203_addname_dataframe['cname'] = daily_20160203_tscode_list
for table_name in daily_20160203.columns.values.tolist():
    daily_20160203_addname_dataframe[table_name] = daily_20160203[table_name]
print("daily_20160203 返回数据 row 行数 = "+str(daily_20160203.shape[0]))
daily_20160203_addname_dataframe.to_excel(daily_201602_excel_writer,'3_3',index=False)
daily_201602_excel_writer.save()
daily_20160204 = pro.daily(start_date='',end_date='',trade_date='20160204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160204_tscode_list = list() 
for ts_code_sh in daily_20160204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160204_tscode_list.append(stock_name)
daily_20160204_addname_dataframe=pd.DataFrame()
daily_20160204_addname_dataframe['cname'] = daily_20160204_tscode_list
for table_name in daily_20160204.columns.values.tolist():
    daily_20160204_addname_dataframe[table_name] = daily_20160204[table_name]
print("daily_20160204 返回数据 row 行数 = "+str(daily_20160204.shape[0]))
daily_20160204_addname_dataframe.to_excel(daily_201602_excel_writer,'4_4',index=False)
daily_201602_excel_writer.save()
daily_20160205 = pro.daily(start_date='',end_date='',trade_date='20160205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160205_tscode_list = list() 
for ts_code_sh in daily_20160205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160205_tscode_list.append(stock_name)
daily_20160205_addname_dataframe=pd.DataFrame()
daily_20160205_addname_dataframe['cname'] = daily_20160205_tscode_list
for table_name in daily_20160205.columns.values.tolist():
    daily_20160205_addname_dataframe[table_name] = daily_20160205[table_name]
print("daily_20160205 返回数据 row 行数 = "+str(daily_20160205.shape[0]))
daily_20160205_addname_dataframe.to_excel(daily_201602_excel_writer,'5_5',index=False)
daily_201602_excel_writer.save()
daily_20160206 = pro.daily(start_date='',end_date='',trade_date='20160206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160206_tscode_list = list() 
for ts_code_sh in daily_20160206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160206_tscode_list.append(stock_name)
daily_20160206_addname_dataframe=pd.DataFrame()
daily_20160206_addname_dataframe['cname'] = daily_20160206_tscode_list
for table_name in daily_20160206.columns.values.tolist():
    daily_20160206_addname_dataframe[table_name] = daily_20160206[table_name]
print("daily_20160206 返回数据 row 行数 = "+str(daily_20160206.shape[0]))
daily_20160206_addname_dataframe.to_excel(daily_201602_excel_writer,'6_6',index=False)
daily_201602_excel_writer.save()
daily_20160207 = pro.daily(start_date='',end_date='',trade_date='20160207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160207_tscode_list = list() 
for ts_code_sh in daily_20160207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160207_tscode_list.append(stock_name)
daily_20160207_addname_dataframe=pd.DataFrame()
daily_20160207_addname_dataframe['cname'] = daily_20160207_tscode_list
for table_name in daily_20160207.columns.values.tolist():
    daily_20160207_addname_dataframe[table_name] = daily_20160207[table_name]
print("daily_20160207 返回数据 row 行数 = "+str(daily_20160207.shape[0]))
daily_20160207_addname_dataframe.to_excel(daily_201602_excel_writer,'7_7',index=False)
daily_201602_excel_writer.save()
daily_20160208 = pro.daily(start_date='',end_date='',trade_date='20160208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160208_tscode_list = list() 
for ts_code_sh in daily_20160208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160208_tscode_list.append(stock_name)
daily_20160208_addname_dataframe=pd.DataFrame()
daily_20160208_addname_dataframe['cname'] = daily_20160208_tscode_list
for table_name in daily_20160208.columns.values.tolist():
    daily_20160208_addname_dataframe[table_name] = daily_20160208[table_name]
print("daily_20160208 返回数据 row 行数 = "+str(daily_20160208.shape[0]))
daily_20160208_addname_dataframe.to_excel(daily_201602_excel_writer,'8_1',index=False)
daily_201602_excel_writer.save()
daily_20160209 = pro.daily(start_date='',end_date='',trade_date='20160209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160209_tscode_list = list() 
for ts_code_sh in daily_20160209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160209_tscode_list.append(stock_name)
daily_20160209_addname_dataframe=pd.DataFrame()
daily_20160209_addname_dataframe['cname'] = daily_20160209_tscode_list
for table_name in daily_20160209.columns.values.tolist():
    daily_20160209_addname_dataframe[table_name] = daily_20160209[table_name]
print("daily_20160209 返回数据 row 行数 = "+str(daily_20160209.shape[0]))
daily_20160209_addname_dataframe.to_excel(daily_201602_excel_writer,'9_2',index=False)
daily_201602_excel_writer.save()
daily_20160210 = pro.daily(start_date='',end_date='',trade_date='20160210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160210_tscode_list = list() 
for ts_code_sh in daily_20160210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160210_tscode_list.append(stock_name)
daily_20160210_addname_dataframe=pd.DataFrame()
daily_20160210_addname_dataframe['cname'] = daily_20160210_tscode_list
for table_name in daily_20160210.columns.values.tolist():
    daily_20160210_addname_dataframe[table_name] = daily_20160210[table_name]
print("daily_20160210 返回数据 row 行数 = "+str(daily_20160210.shape[0]))
daily_20160210_addname_dataframe.to_excel(daily_201602_excel_writer,'10_3',index=False)
daily_201602_excel_writer.save()
daily_20160211 = pro.daily(start_date='',end_date='',trade_date='20160211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160211_tscode_list = list() 
for ts_code_sh in daily_20160211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160211_tscode_list.append(stock_name)
daily_20160211_addname_dataframe=pd.DataFrame()
daily_20160211_addname_dataframe['cname'] = daily_20160211_tscode_list
for table_name in daily_20160211.columns.values.tolist():
    daily_20160211_addname_dataframe[table_name] = daily_20160211[table_name]
print("daily_20160211 返回数据 row 行数 = "+str(daily_20160211.shape[0]))
daily_20160211_addname_dataframe.to_excel(daily_201602_excel_writer,'11_4',index=False)
daily_201602_excel_writer.save()
daily_20160212 = pro.daily(start_date='',end_date='',trade_date='20160212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160212_tscode_list = list() 
for ts_code_sh in daily_20160212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160212_tscode_list.append(stock_name)
daily_20160212_addname_dataframe=pd.DataFrame()
daily_20160212_addname_dataframe['cname'] = daily_20160212_tscode_list
for table_name in daily_20160212.columns.values.tolist():
    daily_20160212_addname_dataframe[table_name] = daily_20160212[table_name]
print("daily_20160212 返回数据 row 行数 = "+str(daily_20160212.shape[0]))
daily_20160212_addname_dataframe.to_excel(daily_201602_excel_writer,'12_5',index=False)
daily_201602_excel_writer.save()
daily_20160213 = pro.daily(start_date='',end_date='',trade_date='20160213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160213_tscode_list = list() 
for ts_code_sh in daily_20160213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160213_tscode_list.append(stock_name)
daily_20160213_addname_dataframe=pd.DataFrame()
daily_20160213_addname_dataframe['cname'] = daily_20160213_tscode_list
for table_name in daily_20160213.columns.values.tolist():
    daily_20160213_addname_dataframe[table_name] = daily_20160213[table_name]
print("daily_20160213 返回数据 row 行数 = "+str(daily_20160213.shape[0]))
daily_20160213_addname_dataframe.to_excel(daily_201602_excel_writer,'13_6',index=False)
daily_201602_excel_writer.save()
daily_20160214 = pro.daily(start_date='',end_date='',trade_date='20160214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160214_tscode_list = list() 
for ts_code_sh in daily_20160214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160214_tscode_list.append(stock_name)
daily_20160214_addname_dataframe=pd.DataFrame()
daily_20160214_addname_dataframe['cname'] = daily_20160214_tscode_list
for table_name in daily_20160214.columns.values.tolist():
    daily_20160214_addname_dataframe[table_name] = daily_20160214[table_name]
print("daily_20160214 返回数据 row 行数 = "+str(daily_20160214.shape[0]))
daily_20160214_addname_dataframe.to_excel(daily_201602_excel_writer,'14_7',index=False)
daily_201602_excel_writer.save()
daily_20160215 = pro.daily(start_date='',end_date='',trade_date='20160215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160215_tscode_list = list() 
for ts_code_sh in daily_20160215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160215_tscode_list.append(stock_name)
daily_20160215_addname_dataframe=pd.DataFrame()
daily_20160215_addname_dataframe['cname'] = daily_20160215_tscode_list
for table_name in daily_20160215.columns.values.tolist():
    daily_20160215_addname_dataframe[table_name] = daily_20160215[table_name]
print("daily_20160215 返回数据 row 行数 = "+str(daily_20160215.shape[0]))
daily_20160215_addname_dataframe.to_excel(daily_201602_excel_writer,'15_1',index=False)
daily_201602_excel_writer.save()
daily_20160216 = pro.daily(start_date='',end_date='',trade_date='20160216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160216_tscode_list = list() 
for ts_code_sh in daily_20160216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160216_tscode_list.append(stock_name)
daily_20160216_addname_dataframe=pd.DataFrame()
daily_20160216_addname_dataframe['cname'] = daily_20160216_tscode_list
for table_name in daily_20160216.columns.values.tolist():
    daily_20160216_addname_dataframe[table_name] = daily_20160216[table_name]
print("daily_20160216 返回数据 row 行数 = "+str(daily_20160216.shape[0]))
daily_20160216_addname_dataframe.to_excel(daily_201602_excel_writer,'16_2',index=False)
daily_201602_excel_writer.save()
daily_20160217 = pro.daily(start_date='',end_date='',trade_date='20160217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160217_tscode_list = list() 
for ts_code_sh in daily_20160217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160217_tscode_list.append(stock_name)
daily_20160217_addname_dataframe=pd.DataFrame()
daily_20160217_addname_dataframe['cname'] = daily_20160217_tscode_list
for table_name in daily_20160217.columns.values.tolist():
    daily_20160217_addname_dataframe[table_name] = daily_20160217[table_name]
print("daily_20160217 返回数据 row 行数 = "+str(daily_20160217.shape[0]))
daily_20160217_addname_dataframe.to_excel(daily_201602_excel_writer,'17_3',index=False)
daily_201602_excel_writer.save()
daily_20160218 = pro.daily(start_date='',end_date='',trade_date='20160218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160218_tscode_list = list() 
for ts_code_sh in daily_20160218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160218_tscode_list.append(stock_name)
daily_20160218_addname_dataframe=pd.DataFrame()
daily_20160218_addname_dataframe['cname'] = daily_20160218_tscode_list
for table_name in daily_20160218.columns.values.tolist():
    daily_20160218_addname_dataframe[table_name] = daily_20160218[table_name]
print("daily_20160218 返回数据 row 行数 = "+str(daily_20160218.shape[0]))
daily_20160218_addname_dataframe.to_excel(daily_201602_excel_writer,'18_4',index=False)
daily_201602_excel_writer.save()
daily_20160219 = pro.daily(start_date='',end_date='',trade_date='20160219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160219_tscode_list = list() 
for ts_code_sh in daily_20160219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160219_tscode_list.append(stock_name)
daily_20160219_addname_dataframe=pd.DataFrame()
daily_20160219_addname_dataframe['cname'] = daily_20160219_tscode_list
for table_name in daily_20160219.columns.values.tolist():
    daily_20160219_addname_dataframe[table_name] = daily_20160219[table_name]
print("daily_20160219 返回数据 row 行数 = "+str(daily_20160219.shape[0]))
daily_20160219_addname_dataframe.to_excel(daily_201602_excel_writer,'19_5',index=False)
daily_201602_excel_writer.save()
daily_20160220 = pro.daily(start_date='',end_date='',trade_date='20160220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160220_tscode_list = list() 
for ts_code_sh in daily_20160220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160220_tscode_list.append(stock_name)
daily_20160220_addname_dataframe=pd.DataFrame()
daily_20160220_addname_dataframe['cname'] = daily_20160220_tscode_list
for table_name in daily_20160220.columns.values.tolist():
    daily_20160220_addname_dataframe[table_name] = daily_20160220[table_name]
print("daily_20160220 返回数据 row 行数 = "+str(daily_20160220.shape[0]))
daily_20160220_addname_dataframe.to_excel(daily_201602_excel_writer,'20_6',index=False)
daily_201602_excel_writer.save()
daily_20160221 = pro.daily(start_date='',end_date='',trade_date='20160221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160221_tscode_list = list() 
for ts_code_sh in daily_20160221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160221_tscode_list.append(stock_name)
daily_20160221_addname_dataframe=pd.DataFrame()
daily_20160221_addname_dataframe['cname'] = daily_20160221_tscode_list
for table_name in daily_20160221.columns.values.tolist():
    daily_20160221_addname_dataframe[table_name] = daily_20160221[table_name]
print("daily_20160221 返回数据 row 行数 = "+str(daily_20160221.shape[0]))
daily_20160221_addname_dataframe.to_excel(daily_201602_excel_writer,'21_7',index=False)
daily_201602_excel_writer.save()
daily_20160222 = pro.daily(start_date='',end_date='',trade_date='20160222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160222_tscode_list = list() 
for ts_code_sh in daily_20160222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160222_tscode_list.append(stock_name)
daily_20160222_addname_dataframe=pd.DataFrame()
daily_20160222_addname_dataframe['cname'] = daily_20160222_tscode_list
for table_name in daily_20160222.columns.values.tolist():
    daily_20160222_addname_dataframe[table_name] = daily_20160222[table_name]
print("daily_20160222 返回数据 row 行数 = "+str(daily_20160222.shape[0]))
daily_20160222_addname_dataframe.to_excel(daily_201602_excel_writer,'22_1',index=False)
daily_201602_excel_writer.save()
daily_20160223 = pro.daily(start_date='',end_date='',trade_date='20160223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160223_tscode_list = list() 
for ts_code_sh in daily_20160223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160223_tscode_list.append(stock_name)
daily_20160223_addname_dataframe=pd.DataFrame()
daily_20160223_addname_dataframe['cname'] = daily_20160223_tscode_list
for table_name in daily_20160223.columns.values.tolist():
    daily_20160223_addname_dataframe[table_name] = daily_20160223[table_name]
print("daily_20160223 返回数据 row 行数 = "+str(daily_20160223.shape[0]))
daily_20160223_addname_dataframe.to_excel(daily_201602_excel_writer,'23_2',index=False)
daily_201602_excel_writer.save()
daily_20160224 = pro.daily(start_date='',end_date='',trade_date='20160224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160224_tscode_list = list() 
for ts_code_sh in daily_20160224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160224_tscode_list.append(stock_name)
daily_20160224_addname_dataframe=pd.DataFrame()
daily_20160224_addname_dataframe['cname'] = daily_20160224_tscode_list
for table_name in daily_20160224.columns.values.tolist():
    daily_20160224_addname_dataframe[table_name] = daily_20160224[table_name]
print("daily_20160224 返回数据 row 行数 = "+str(daily_20160224.shape[0]))
daily_20160224_addname_dataframe.to_excel(daily_201602_excel_writer,'24_3',index=False)
daily_201602_excel_writer.save()
daily_20160225 = pro.daily(start_date='',end_date='',trade_date='20160225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160225_tscode_list = list() 
for ts_code_sh in daily_20160225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160225_tscode_list.append(stock_name)
daily_20160225_addname_dataframe=pd.DataFrame()
daily_20160225_addname_dataframe['cname'] = daily_20160225_tscode_list
for table_name in daily_20160225.columns.values.tolist():
    daily_20160225_addname_dataframe[table_name] = daily_20160225[table_name]
print("daily_20160225 返回数据 row 行数 = "+str(daily_20160225.shape[0]))
daily_20160225_addname_dataframe.to_excel(daily_201602_excel_writer,'25_4',index=False)
daily_201602_excel_writer.save()
daily_20160226 = pro.daily(start_date='',end_date='',trade_date='20160226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160226_tscode_list = list() 
for ts_code_sh in daily_20160226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160226_tscode_list.append(stock_name)
daily_20160226_addname_dataframe=pd.DataFrame()
daily_20160226_addname_dataframe['cname'] = daily_20160226_tscode_list
for table_name in daily_20160226.columns.values.tolist():
    daily_20160226_addname_dataframe[table_name] = daily_20160226[table_name]
print("daily_20160226 返回数据 row 行数 = "+str(daily_20160226.shape[0]))
daily_20160226_addname_dataframe.to_excel(daily_201602_excel_writer,'26_5',index=False)
daily_201602_excel_writer.save()
daily_20160227 = pro.daily(start_date='',end_date='',trade_date='20160227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160227_tscode_list = list() 
for ts_code_sh in daily_20160227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160227_tscode_list.append(stock_name)
daily_20160227_addname_dataframe=pd.DataFrame()
daily_20160227_addname_dataframe['cname'] = daily_20160227_tscode_list
for table_name in daily_20160227.columns.values.tolist():
    daily_20160227_addname_dataframe[table_name] = daily_20160227[table_name]
print("daily_20160227 返回数据 row 行数 = "+str(daily_20160227.shape[0]))
daily_20160227_addname_dataframe.to_excel(daily_201602_excel_writer,'27_6',index=False)
daily_201602_excel_writer.save()
daily_20160228 = pro.daily(start_date='',end_date='',trade_date='20160228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160228_tscode_list = list() 
for ts_code_sh in daily_20160228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160228_tscode_list.append(stock_name)
daily_20160228_addname_dataframe=pd.DataFrame()
daily_20160228_addname_dataframe['cname'] = daily_20160228_tscode_list
for table_name in daily_20160228.columns.values.tolist():
    daily_20160228_addname_dataframe[table_name] = daily_20160228[table_name]
print("daily_20160228 返回数据 row 行数 = "+str(daily_20160228.shape[0]))
daily_20160228_addname_dataframe.to_excel(daily_201602_excel_writer,'28_7',index=False)
daily_201602_excel_writer.save()
daily_20160229 = pro.daily(start_date='',end_date='',trade_date='20160229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160229_tscode_list = list() 
for ts_code_sh in daily_20160229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160229_tscode_list.append(stock_name)
daily_20160229_addname_dataframe=pd.DataFrame()
daily_20160229_addname_dataframe['cname'] = daily_20160229_tscode_list
for table_name in daily_20160229.columns.values.tolist():
    daily_20160229_addname_dataframe[table_name] = daily_20160229[table_name]
print("daily_20160229 返回数据 row 行数 = "+str(daily_20160229.shape[0]))
daily_20160229_addname_dataframe.to_excel(daily_201602_excel_writer,'29_1',index=False)
daily_201602_excel_writer.save()




createexcel('daily_201603.xlsx')
daily_201603_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201603.xlsx')
daily_201603_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201603.xlsx', engine='openpyxl')
daily_201603_excel_writer.book = daily_201603_book
daily_201603_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201603_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160301")       ###  更新 记录日期
daily_20160301 = pro.daily(start_date='',end_date='',trade_date='20160301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160301_tscode_list = list() 
for ts_code_sh in daily_20160301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160301_tscode_list.append(stock_name)
daily_20160301_addname_dataframe=pd.DataFrame()
daily_20160301_addname_dataframe['cname'] = daily_20160301_tscode_list
for table_name in daily_20160301.columns.values.tolist():
    daily_20160301_addname_dataframe[table_name] = daily_20160301[table_name]
print("daily_20160301 返回数据 row 行数 = "+str(daily_20160301.shape[0]))
daily_20160301_addname_dataframe.to_excel(daily_201603_excel_writer,'1_2',index=False)
daily_201603_excel_writer.save()
daily_20160302 = pro.daily(start_date='',end_date='',trade_date='20160302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160302_tscode_list = list() 
for ts_code_sh in daily_20160302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160302_tscode_list.append(stock_name)
daily_20160302_addname_dataframe=pd.DataFrame()
daily_20160302_addname_dataframe['cname'] = daily_20160302_tscode_list
for table_name in daily_20160302.columns.values.tolist():
    daily_20160302_addname_dataframe[table_name] = daily_20160302[table_name]
print("daily_20160302 返回数据 row 行数 = "+str(daily_20160302.shape[0]))
daily_20160302_addname_dataframe.to_excel(daily_201603_excel_writer,'2_3',index=False)
daily_201603_excel_writer.save()
daily_20160303 = pro.daily(start_date='',end_date='',trade_date='20160303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160303_tscode_list = list() 
for ts_code_sh in daily_20160303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160303_tscode_list.append(stock_name)
daily_20160303_addname_dataframe=pd.DataFrame()
daily_20160303_addname_dataframe['cname'] = daily_20160303_tscode_list
for table_name in daily_20160303.columns.values.tolist():
    daily_20160303_addname_dataframe[table_name] = daily_20160303[table_name]
print("daily_20160303 返回数据 row 行数 = "+str(daily_20160303.shape[0]))
daily_20160303_addname_dataframe.to_excel(daily_201603_excel_writer,'3_4',index=False)
daily_201603_excel_writer.save()
daily_20160304 = pro.daily(start_date='',end_date='',trade_date='20160304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160304_tscode_list = list() 
for ts_code_sh in daily_20160304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160304_tscode_list.append(stock_name)
daily_20160304_addname_dataframe=pd.DataFrame()
daily_20160304_addname_dataframe['cname'] = daily_20160304_tscode_list
for table_name in daily_20160304.columns.values.tolist():
    daily_20160304_addname_dataframe[table_name] = daily_20160304[table_name]
print("daily_20160304 返回数据 row 行数 = "+str(daily_20160304.shape[0]))
daily_20160304_addname_dataframe.to_excel(daily_201603_excel_writer,'4_5',index=False)
daily_201603_excel_writer.save()
daily_20160305 = pro.daily(start_date='',end_date='',trade_date='20160305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160305_tscode_list = list() 
for ts_code_sh in daily_20160305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160305_tscode_list.append(stock_name)
daily_20160305_addname_dataframe=pd.DataFrame()
daily_20160305_addname_dataframe['cname'] = daily_20160305_tscode_list
for table_name in daily_20160305.columns.values.tolist():
    daily_20160305_addname_dataframe[table_name] = daily_20160305[table_name]
print("daily_20160305 返回数据 row 行数 = "+str(daily_20160305.shape[0]))
daily_20160305_addname_dataframe.to_excel(daily_201603_excel_writer,'5_6',index=False)
daily_201603_excel_writer.save()
daily_20160306 = pro.daily(start_date='',end_date='',trade_date='20160306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160306_tscode_list = list() 
for ts_code_sh in daily_20160306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160306_tscode_list.append(stock_name)
daily_20160306_addname_dataframe=pd.DataFrame()
daily_20160306_addname_dataframe['cname'] = daily_20160306_tscode_list
for table_name in daily_20160306.columns.values.tolist():
    daily_20160306_addname_dataframe[table_name] = daily_20160306[table_name]
print("daily_20160306 返回数据 row 行数 = "+str(daily_20160306.shape[0]))
daily_20160306_addname_dataframe.to_excel(daily_201603_excel_writer,'6_7',index=False)
daily_201603_excel_writer.save()
daily_20160307 = pro.daily(start_date='',end_date='',trade_date='20160307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160307_tscode_list = list() 
for ts_code_sh in daily_20160307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160307_tscode_list.append(stock_name)
daily_20160307_addname_dataframe=pd.DataFrame()
daily_20160307_addname_dataframe['cname'] = daily_20160307_tscode_list
for table_name in daily_20160307.columns.values.tolist():
    daily_20160307_addname_dataframe[table_name] = daily_20160307[table_name]
print("daily_20160307 返回数据 row 行数 = "+str(daily_20160307.shape[0]))
daily_20160307_addname_dataframe.to_excel(daily_201603_excel_writer,'7_1',index=False)
daily_201603_excel_writer.save()
daily_20160308 = pro.daily(start_date='',end_date='',trade_date='20160308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160308_tscode_list = list() 
for ts_code_sh in daily_20160308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160308_tscode_list.append(stock_name)
daily_20160308_addname_dataframe=pd.DataFrame()
daily_20160308_addname_dataframe['cname'] = daily_20160308_tscode_list
for table_name in daily_20160308.columns.values.tolist():
    daily_20160308_addname_dataframe[table_name] = daily_20160308[table_name]
print("daily_20160308 返回数据 row 行数 = "+str(daily_20160308.shape[0]))
daily_20160308_addname_dataframe.to_excel(daily_201603_excel_writer,'8_2',index=False)
daily_201603_excel_writer.save()
daily_20160309 = pro.daily(start_date='',end_date='',trade_date='20160309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160309_tscode_list = list() 
for ts_code_sh in daily_20160309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160309_tscode_list.append(stock_name)
daily_20160309_addname_dataframe=pd.DataFrame()
daily_20160309_addname_dataframe['cname'] = daily_20160309_tscode_list
for table_name in daily_20160309.columns.values.tolist():
    daily_20160309_addname_dataframe[table_name] = daily_20160309[table_name]
print("daily_20160309 返回数据 row 行数 = "+str(daily_20160309.shape[0]))
daily_20160309_addname_dataframe.to_excel(daily_201603_excel_writer,'9_3',index=False)
daily_201603_excel_writer.save()
daily_20160310 = pro.daily(start_date='',end_date='',trade_date='20160310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160310_tscode_list = list() 
for ts_code_sh in daily_20160310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160310_tscode_list.append(stock_name)
daily_20160310_addname_dataframe=pd.DataFrame()
daily_20160310_addname_dataframe['cname'] = daily_20160310_tscode_list
for table_name in daily_20160310.columns.values.tolist():
    daily_20160310_addname_dataframe[table_name] = daily_20160310[table_name]
print("daily_20160310 返回数据 row 行数 = "+str(daily_20160310.shape[0]))
daily_20160310_addname_dataframe.to_excel(daily_201603_excel_writer,'10_4',index=False)
daily_201603_excel_writer.save()
daily_20160311 = pro.daily(start_date='',end_date='',trade_date='20160311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160311_tscode_list = list() 
for ts_code_sh in daily_20160311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160311_tscode_list.append(stock_name)
daily_20160311_addname_dataframe=pd.DataFrame()
daily_20160311_addname_dataframe['cname'] = daily_20160311_tscode_list
for table_name in daily_20160311.columns.values.tolist():
    daily_20160311_addname_dataframe[table_name] = daily_20160311[table_name]
print("daily_20160311 返回数据 row 行数 = "+str(daily_20160311.shape[0]))
daily_20160311_addname_dataframe.to_excel(daily_201603_excel_writer,'11_5',index=False)
daily_201603_excel_writer.save()
daily_20160312 = pro.daily(start_date='',end_date='',trade_date='20160312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160312_tscode_list = list() 
for ts_code_sh in daily_20160312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160312_tscode_list.append(stock_name)
daily_20160312_addname_dataframe=pd.DataFrame()
daily_20160312_addname_dataframe['cname'] = daily_20160312_tscode_list
for table_name in daily_20160312.columns.values.tolist():
    daily_20160312_addname_dataframe[table_name] = daily_20160312[table_name]
print("daily_20160312 返回数据 row 行数 = "+str(daily_20160312.shape[0]))
daily_20160312_addname_dataframe.to_excel(daily_201603_excel_writer,'12_6',index=False)
daily_201603_excel_writer.save()
daily_20160313 = pro.daily(start_date='',end_date='',trade_date='20160313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160313_tscode_list = list() 
for ts_code_sh in daily_20160313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160313_tscode_list.append(stock_name)
daily_20160313_addname_dataframe=pd.DataFrame()
daily_20160313_addname_dataframe['cname'] = daily_20160313_tscode_list
for table_name in daily_20160313.columns.values.tolist():
    daily_20160313_addname_dataframe[table_name] = daily_20160313[table_name]
print("daily_20160313 返回数据 row 行数 = "+str(daily_20160313.shape[0]))
daily_20160313_addname_dataframe.to_excel(daily_201603_excel_writer,'13_7',index=False)
daily_201603_excel_writer.save()
daily_20160314 = pro.daily(start_date='',end_date='',trade_date='20160314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160314_tscode_list = list() 
for ts_code_sh in daily_20160314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160314_tscode_list.append(stock_name)
daily_20160314_addname_dataframe=pd.DataFrame()
daily_20160314_addname_dataframe['cname'] = daily_20160314_tscode_list
for table_name in daily_20160314.columns.values.tolist():
    daily_20160314_addname_dataframe[table_name] = daily_20160314[table_name]
print("daily_20160314 返回数据 row 行数 = "+str(daily_20160314.shape[0]))
daily_20160314_addname_dataframe.to_excel(daily_201603_excel_writer,'14_1',index=False)
daily_201603_excel_writer.save()
daily_20160315 = pro.daily(start_date='',end_date='',trade_date='20160315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160315_tscode_list = list() 
for ts_code_sh in daily_20160315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160315_tscode_list.append(stock_name)
daily_20160315_addname_dataframe=pd.DataFrame()
daily_20160315_addname_dataframe['cname'] = daily_20160315_tscode_list
for table_name in daily_20160315.columns.values.tolist():
    daily_20160315_addname_dataframe[table_name] = daily_20160315[table_name]
print("daily_20160315 返回数据 row 行数 = "+str(daily_20160315.shape[0]))
daily_20160315_addname_dataframe.to_excel(daily_201603_excel_writer,'15_2',index=False)
daily_201603_excel_writer.save()
daily_20160316 = pro.daily(start_date='',end_date='',trade_date='20160316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160316_tscode_list = list() 
for ts_code_sh in daily_20160316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160316_tscode_list.append(stock_name)
daily_20160316_addname_dataframe=pd.DataFrame()
daily_20160316_addname_dataframe['cname'] = daily_20160316_tscode_list
for table_name in daily_20160316.columns.values.tolist():
    daily_20160316_addname_dataframe[table_name] = daily_20160316[table_name]
print("daily_20160316 返回数据 row 行数 = "+str(daily_20160316.shape[0]))
daily_20160316_addname_dataframe.to_excel(daily_201603_excel_writer,'16_3',index=False)
daily_201603_excel_writer.save()
daily_20160317 = pro.daily(start_date='',end_date='',trade_date='20160317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160317_tscode_list = list() 
for ts_code_sh in daily_20160317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160317_tscode_list.append(stock_name)
daily_20160317_addname_dataframe=pd.DataFrame()
daily_20160317_addname_dataframe['cname'] = daily_20160317_tscode_list
for table_name in daily_20160317.columns.values.tolist():
    daily_20160317_addname_dataframe[table_name] = daily_20160317[table_name]
print("daily_20160317 返回数据 row 行数 = "+str(daily_20160317.shape[0]))
daily_20160317_addname_dataframe.to_excel(daily_201603_excel_writer,'17_4',index=False)
daily_201603_excel_writer.save()
daily_20160318 = pro.daily(start_date='',end_date='',trade_date='20160318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160318_tscode_list = list() 
for ts_code_sh in daily_20160318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160318_tscode_list.append(stock_name)
daily_20160318_addname_dataframe=pd.DataFrame()
daily_20160318_addname_dataframe['cname'] = daily_20160318_tscode_list
for table_name in daily_20160318.columns.values.tolist():
    daily_20160318_addname_dataframe[table_name] = daily_20160318[table_name]
print("daily_20160318 返回数据 row 行数 = "+str(daily_20160318.shape[0]))
daily_20160318_addname_dataframe.to_excel(daily_201603_excel_writer,'18_5',index=False)
daily_201603_excel_writer.save()
daily_20160319 = pro.daily(start_date='',end_date='',trade_date='20160319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160319_tscode_list = list() 
for ts_code_sh in daily_20160319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160319_tscode_list.append(stock_name)
daily_20160319_addname_dataframe=pd.DataFrame()
daily_20160319_addname_dataframe['cname'] = daily_20160319_tscode_list
for table_name in daily_20160319.columns.values.tolist():
    daily_20160319_addname_dataframe[table_name] = daily_20160319[table_name]
print("daily_20160319 返回数据 row 行数 = "+str(daily_20160319.shape[0]))
daily_20160319_addname_dataframe.to_excel(daily_201603_excel_writer,'19_6',index=False)
daily_201603_excel_writer.save()
daily_20160320 = pro.daily(start_date='',end_date='',trade_date='20160320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160320_tscode_list = list() 
for ts_code_sh in daily_20160320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160320_tscode_list.append(stock_name)
daily_20160320_addname_dataframe=pd.DataFrame()
daily_20160320_addname_dataframe['cname'] = daily_20160320_tscode_list
for table_name in daily_20160320.columns.values.tolist():
    daily_20160320_addname_dataframe[table_name] = daily_20160320[table_name]
print("daily_20160320 返回数据 row 行数 = "+str(daily_20160320.shape[0]))
daily_20160320_addname_dataframe.to_excel(daily_201603_excel_writer,'20_7',index=False)
daily_201603_excel_writer.save()
daily_20160321 = pro.daily(start_date='',end_date='',trade_date='20160321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160321_tscode_list = list() 
for ts_code_sh in daily_20160321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160321_tscode_list.append(stock_name)
daily_20160321_addname_dataframe=pd.DataFrame()
daily_20160321_addname_dataframe['cname'] = daily_20160321_tscode_list
for table_name in daily_20160321.columns.values.tolist():
    daily_20160321_addname_dataframe[table_name] = daily_20160321[table_name]
print("daily_20160321 返回数据 row 行数 = "+str(daily_20160321.shape[0]))
daily_20160321_addname_dataframe.to_excel(daily_201603_excel_writer,'21_1',index=False)
daily_201603_excel_writer.save()
daily_20160322 = pro.daily(start_date='',end_date='',trade_date='20160322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160322_tscode_list = list() 
for ts_code_sh in daily_20160322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160322_tscode_list.append(stock_name)
daily_20160322_addname_dataframe=pd.DataFrame()
daily_20160322_addname_dataframe['cname'] = daily_20160322_tscode_list
for table_name in daily_20160322.columns.values.tolist():
    daily_20160322_addname_dataframe[table_name] = daily_20160322[table_name]
print("daily_20160322 返回数据 row 行数 = "+str(daily_20160322.shape[0]))
daily_20160322_addname_dataframe.to_excel(daily_201603_excel_writer,'22_2',index=False)
daily_201603_excel_writer.save()
daily_20160323 = pro.daily(start_date='',end_date='',trade_date='20160323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160323_tscode_list = list() 
for ts_code_sh in daily_20160323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160323_tscode_list.append(stock_name)
daily_20160323_addname_dataframe=pd.DataFrame()
daily_20160323_addname_dataframe['cname'] = daily_20160323_tscode_list
for table_name in daily_20160323.columns.values.tolist():
    daily_20160323_addname_dataframe[table_name] = daily_20160323[table_name]
print("daily_20160323 返回数据 row 行数 = "+str(daily_20160323.shape[0]))
daily_20160323_addname_dataframe.to_excel(daily_201603_excel_writer,'23_3',index=False)
daily_201603_excel_writer.save()
daily_20160324 = pro.daily(start_date='',end_date='',trade_date='20160324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160324_tscode_list = list() 
for ts_code_sh in daily_20160324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160324_tscode_list.append(stock_name)
daily_20160324_addname_dataframe=pd.DataFrame()
daily_20160324_addname_dataframe['cname'] = daily_20160324_tscode_list
for table_name in daily_20160324.columns.values.tolist():
    daily_20160324_addname_dataframe[table_name] = daily_20160324[table_name]
print("daily_20160324 返回数据 row 行数 = "+str(daily_20160324.shape[0]))
daily_20160324_addname_dataframe.to_excel(daily_201603_excel_writer,'24_4',index=False)
daily_201603_excel_writer.save()
daily_20160325 = pro.daily(start_date='',end_date='',trade_date='20160325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160325_tscode_list = list() 
for ts_code_sh in daily_20160325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160325_tscode_list.append(stock_name)
daily_20160325_addname_dataframe=pd.DataFrame()
daily_20160325_addname_dataframe['cname'] = daily_20160325_tscode_list
for table_name in daily_20160325.columns.values.tolist():
    daily_20160325_addname_dataframe[table_name] = daily_20160325[table_name]
print("daily_20160325 返回数据 row 行数 = "+str(daily_20160325.shape[0]))
daily_20160325_addname_dataframe.to_excel(daily_201603_excel_writer,'25_5',index=False)
daily_201603_excel_writer.save()
daily_20160326 = pro.daily(start_date='',end_date='',trade_date='20160326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160326_tscode_list = list() 
for ts_code_sh in daily_20160326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160326_tscode_list.append(stock_name)
daily_20160326_addname_dataframe=pd.DataFrame()
daily_20160326_addname_dataframe['cname'] = daily_20160326_tscode_list
for table_name in daily_20160326.columns.values.tolist():
    daily_20160326_addname_dataframe[table_name] = daily_20160326[table_name]
print("daily_20160326 返回数据 row 行数 = "+str(daily_20160326.shape[0]))
daily_20160326_addname_dataframe.to_excel(daily_201603_excel_writer,'26_6',index=False)
daily_201603_excel_writer.save()
daily_20160327 = pro.daily(start_date='',end_date='',trade_date='20160327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160327_tscode_list = list() 
for ts_code_sh in daily_20160327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160327_tscode_list.append(stock_name)
daily_20160327_addname_dataframe=pd.DataFrame()
daily_20160327_addname_dataframe['cname'] = daily_20160327_tscode_list
for table_name in daily_20160327.columns.values.tolist():
    daily_20160327_addname_dataframe[table_name] = daily_20160327[table_name]
print("daily_20160327 返回数据 row 行数 = "+str(daily_20160327.shape[0]))
daily_20160327_addname_dataframe.to_excel(daily_201603_excel_writer,'27_7',index=False)
daily_201603_excel_writer.save()
daily_20160328 = pro.daily(start_date='',end_date='',trade_date='20160328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160328_tscode_list = list() 
for ts_code_sh in daily_20160328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160328_tscode_list.append(stock_name)
daily_20160328_addname_dataframe=pd.DataFrame()
daily_20160328_addname_dataframe['cname'] = daily_20160328_tscode_list
for table_name in daily_20160328.columns.values.tolist():
    daily_20160328_addname_dataframe[table_name] = daily_20160328[table_name]
print("daily_20160328 返回数据 row 行数 = "+str(daily_20160328.shape[0]))
daily_20160328_addname_dataframe.to_excel(daily_201603_excel_writer,'28_1',index=False)
daily_201603_excel_writer.save()
daily_20160329 = pro.daily(start_date='',end_date='',trade_date='20160329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160329_tscode_list = list() 
for ts_code_sh in daily_20160329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160329_tscode_list.append(stock_name)
daily_20160329_addname_dataframe=pd.DataFrame()
daily_20160329_addname_dataframe['cname'] = daily_20160329_tscode_list
for table_name in daily_20160329.columns.values.tolist():
    daily_20160329_addname_dataframe[table_name] = daily_20160329[table_name]
print("daily_20160329 返回数据 row 行数 = "+str(daily_20160329.shape[0]))
daily_20160329_addname_dataframe.to_excel(daily_201603_excel_writer,'29_2',index=False)
daily_201603_excel_writer.save()
daily_20160330 = pro.daily(start_date='',end_date='',trade_date='20160330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160330_tscode_list = list() 
for ts_code_sh in daily_20160330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160330_tscode_list.append(stock_name)
daily_20160330_addname_dataframe=pd.DataFrame()
daily_20160330_addname_dataframe['cname'] = daily_20160330_tscode_list
for table_name in daily_20160330.columns.values.tolist():
    daily_20160330_addname_dataframe[table_name] = daily_20160330[table_name]
print("daily_20160330 返回数据 row 行数 = "+str(daily_20160330.shape[0]))
daily_20160330_addname_dataframe.to_excel(daily_201603_excel_writer,'30_3',index=False)
daily_201603_excel_writer.save()
daily_20160331 = pro.daily(start_date='',end_date='',trade_date='20160331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160331_tscode_list = list() 
for ts_code_sh in daily_20160331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160331_tscode_list.append(stock_name)
daily_20160331_addname_dataframe=pd.DataFrame()
daily_20160331_addname_dataframe['cname'] = daily_20160331_tscode_list
for table_name in daily_20160331.columns.values.tolist():
    daily_20160331_addname_dataframe[table_name] = daily_20160331[table_name]
print("daily_20160331 返回数据 row 行数 = "+str(daily_20160331.shape[0]))
daily_20160331_addname_dataframe.to_excel(daily_201603_excel_writer,'31_4',index=False)
daily_201603_excel_writer.save()




createexcel('daily_201604.xlsx')
daily_201604_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201604.xlsx')
daily_201604_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201604.xlsx', engine='openpyxl')
daily_201604_excel_writer.book = daily_201604_book
daily_201604_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201604_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160401")       ###  更新 记录日期
daily_20160401 = pro.daily(start_date='',end_date='',trade_date='20160401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160401_tscode_list = list() 
for ts_code_sh in daily_20160401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160401_tscode_list.append(stock_name)
daily_20160401_addname_dataframe=pd.DataFrame()
daily_20160401_addname_dataframe['cname'] = daily_20160401_tscode_list
for table_name in daily_20160401.columns.values.tolist():
    daily_20160401_addname_dataframe[table_name] = daily_20160401[table_name]
print("daily_20160401 返回数据 row 行数 = "+str(daily_20160401.shape[0]))
daily_20160401_addname_dataframe.to_excel(daily_201604_excel_writer,'1_5',index=False)
daily_201604_excel_writer.save()
daily_20160402 = pro.daily(start_date='',end_date='',trade_date='20160402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160402_tscode_list = list() 
for ts_code_sh in daily_20160402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160402_tscode_list.append(stock_name)
daily_20160402_addname_dataframe=pd.DataFrame()
daily_20160402_addname_dataframe['cname'] = daily_20160402_tscode_list
for table_name in daily_20160402.columns.values.tolist():
    daily_20160402_addname_dataframe[table_name] = daily_20160402[table_name]
print("daily_20160402 返回数据 row 行数 = "+str(daily_20160402.shape[0]))
daily_20160402_addname_dataframe.to_excel(daily_201604_excel_writer,'2_6',index=False)
daily_201604_excel_writer.save()
daily_20160403 = pro.daily(start_date='',end_date='',trade_date='20160403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160403_tscode_list = list() 
for ts_code_sh in daily_20160403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160403_tscode_list.append(stock_name)
daily_20160403_addname_dataframe=pd.DataFrame()
daily_20160403_addname_dataframe['cname'] = daily_20160403_tscode_list
for table_name in daily_20160403.columns.values.tolist():
    daily_20160403_addname_dataframe[table_name] = daily_20160403[table_name]
print("daily_20160403 返回数据 row 行数 = "+str(daily_20160403.shape[0]))
daily_20160403_addname_dataframe.to_excel(daily_201604_excel_writer,'3_7',index=False)
daily_201604_excel_writer.save()
daily_20160404 = pro.daily(start_date='',end_date='',trade_date='20160404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160404_tscode_list = list() 
for ts_code_sh in daily_20160404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160404_tscode_list.append(stock_name)
daily_20160404_addname_dataframe=pd.DataFrame()
daily_20160404_addname_dataframe['cname'] = daily_20160404_tscode_list
for table_name in daily_20160404.columns.values.tolist():
    daily_20160404_addname_dataframe[table_name] = daily_20160404[table_name]
print("daily_20160404 返回数据 row 行数 = "+str(daily_20160404.shape[0]))
daily_20160404_addname_dataframe.to_excel(daily_201604_excel_writer,'4_1',index=False)
daily_201604_excel_writer.save()
daily_20160405 = pro.daily(start_date='',end_date='',trade_date='20160405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160405_tscode_list = list() 
for ts_code_sh in daily_20160405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160405_tscode_list.append(stock_name)
daily_20160405_addname_dataframe=pd.DataFrame()
daily_20160405_addname_dataframe['cname'] = daily_20160405_tscode_list
for table_name in daily_20160405.columns.values.tolist():
    daily_20160405_addname_dataframe[table_name] = daily_20160405[table_name]
print("daily_20160405 返回数据 row 行数 = "+str(daily_20160405.shape[0]))
daily_20160405_addname_dataframe.to_excel(daily_201604_excel_writer,'5_2',index=False)
daily_201604_excel_writer.save()
daily_20160406 = pro.daily(start_date='',end_date='',trade_date='20160406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160406_tscode_list = list() 
for ts_code_sh in daily_20160406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160406_tscode_list.append(stock_name)
daily_20160406_addname_dataframe=pd.DataFrame()
daily_20160406_addname_dataframe['cname'] = daily_20160406_tscode_list
for table_name in daily_20160406.columns.values.tolist():
    daily_20160406_addname_dataframe[table_name] = daily_20160406[table_name]
print("daily_20160406 返回数据 row 行数 = "+str(daily_20160406.shape[0]))
daily_20160406_addname_dataframe.to_excel(daily_201604_excel_writer,'6_3',index=False)
daily_201604_excel_writer.save()
daily_20160407 = pro.daily(start_date='',end_date='',trade_date='20160407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160407_tscode_list = list() 
for ts_code_sh in daily_20160407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160407_tscode_list.append(stock_name)
daily_20160407_addname_dataframe=pd.DataFrame()
daily_20160407_addname_dataframe['cname'] = daily_20160407_tscode_list
for table_name in daily_20160407.columns.values.tolist():
    daily_20160407_addname_dataframe[table_name] = daily_20160407[table_name]
print("daily_20160407 返回数据 row 行数 = "+str(daily_20160407.shape[0]))
daily_20160407_addname_dataframe.to_excel(daily_201604_excel_writer,'7_4',index=False)
daily_201604_excel_writer.save()
daily_20160408 = pro.daily(start_date='',end_date='',trade_date='20160408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160408_tscode_list = list() 
for ts_code_sh in daily_20160408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160408_tscode_list.append(stock_name)
daily_20160408_addname_dataframe=pd.DataFrame()
daily_20160408_addname_dataframe['cname'] = daily_20160408_tscode_list
for table_name in daily_20160408.columns.values.tolist():
    daily_20160408_addname_dataframe[table_name] = daily_20160408[table_name]
print("daily_20160408 返回数据 row 行数 = "+str(daily_20160408.shape[0]))
daily_20160408_addname_dataframe.to_excel(daily_201604_excel_writer,'8_5',index=False)
daily_201604_excel_writer.save()
daily_20160409 = pro.daily(start_date='',end_date='',trade_date='20160409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160409_tscode_list = list() 
for ts_code_sh in daily_20160409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160409_tscode_list.append(stock_name)
daily_20160409_addname_dataframe=pd.DataFrame()
daily_20160409_addname_dataframe['cname'] = daily_20160409_tscode_list
for table_name in daily_20160409.columns.values.tolist():
    daily_20160409_addname_dataframe[table_name] = daily_20160409[table_name]
print("daily_20160409 返回数据 row 行数 = "+str(daily_20160409.shape[0]))
daily_20160409_addname_dataframe.to_excel(daily_201604_excel_writer,'9_6',index=False)
daily_201604_excel_writer.save()
daily_20160410 = pro.daily(start_date='',end_date='',trade_date='20160410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160410_tscode_list = list() 
for ts_code_sh in daily_20160410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160410_tscode_list.append(stock_name)
daily_20160410_addname_dataframe=pd.DataFrame()
daily_20160410_addname_dataframe['cname'] = daily_20160410_tscode_list
for table_name in daily_20160410.columns.values.tolist():
    daily_20160410_addname_dataframe[table_name] = daily_20160410[table_name]
print("daily_20160410 返回数据 row 行数 = "+str(daily_20160410.shape[0]))
daily_20160410_addname_dataframe.to_excel(daily_201604_excel_writer,'10_7',index=False)
daily_201604_excel_writer.save()
daily_20160411 = pro.daily(start_date='',end_date='',trade_date='20160411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160411_tscode_list = list() 
for ts_code_sh in daily_20160411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160411_tscode_list.append(stock_name)
daily_20160411_addname_dataframe=pd.DataFrame()
daily_20160411_addname_dataframe['cname'] = daily_20160411_tscode_list
for table_name in daily_20160411.columns.values.tolist():
    daily_20160411_addname_dataframe[table_name] = daily_20160411[table_name]
print("daily_20160411 返回数据 row 行数 = "+str(daily_20160411.shape[0]))
daily_20160411_addname_dataframe.to_excel(daily_201604_excel_writer,'11_1',index=False)
daily_201604_excel_writer.save()
daily_20160412 = pro.daily(start_date='',end_date='',trade_date='20160412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160412_tscode_list = list() 
for ts_code_sh in daily_20160412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160412_tscode_list.append(stock_name)
daily_20160412_addname_dataframe=pd.DataFrame()
daily_20160412_addname_dataframe['cname'] = daily_20160412_tscode_list
for table_name in daily_20160412.columns.values.tolist():
    daily_20160412_addname_dataframe[table_name] = daily_20160412[table_name]
print("daily_20160412 返回数据 row 行数 = "+str(daily_20160412.shape[0]))
daily_20160412_addname_dataframe.to_excel(daily_201604_excel_writer,'12_2',index=False)
daily_201604_excel_writer.save()
daily_20160413 = pro.daily(start_date='',end_date='',trade_date='20160413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160413_tscode_list = list() 
for ts_code_sh in daily_20160413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160413_tscode_list.append(stock_name)
daily_20160413_addname_dataframe=pd.DataFrame()
daily_20160413_addname_dataframe['cname'] = daily_20160413_tscode_list
for table_name in daily_20160413.columns.values.tolist():
    daily_20160413_addname_dataframe[table_name] = daily_20160413[table_name]
print("daily_20160413 返回数据 row 行数 = "+str(daily_20160413.shape[0]))
daily_20160413_addname_dataframe.to_excel(daily_201604_excel_writer,'13_3',index=False)
daily_201604_excel_writer.save()
daily_20160414 = pro.daily(start_date='',end_date='',trade_date='20160414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160414_tscode_list = list() 
for ts_code_sh in daily_20160414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160414_tscode_list.append(stock_name)
daily_20160414_addname_dataframe=pd.DataFrame()
daily_20160414_addname_dataframe['cname'] = daily_20160414_tscode_list
for table_name in daily_20160414.columns.values.tolist():
    daily_20160414_addname_dataframe[table_name] = daily_20160414[table_name]
print("daily_20160414 返回数据 row 行数 = "+str(daily_20160414.shape[0]))
daily_20160414_addname_dataframe.to_excel(daily_201604_excel_writer,'14_4',index=False)
daily_201604_excel_writer.save()
daily_20160415 = pro.daily(start_date='',end_date='',trade_date='20160415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160415_tscode_list = list() 
for ts_code_sh in daily_20160415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160415_tscode_list.append(stock_name)
daily_20160415_addname_dataframe=pd.DataFrame()
daily_20160415_addname_dataframe['cname'] = daily_20160415_tscode_list
for table_name in daily_20160415.columns.values.tolist():
    daily_20160415_addname_dataframe[table_name] = daily_20160415[table_name]
print("daily_20160415 返回数据 row 行数 = "+str(daily_20160415.shape[0]))
daily_20160415_addname_dataframe.to_excel(daily_201604_excel_writer,'15_5',index=False)
daily_201604_excel_writer.save()
daily_20160416 = pro.daily(start_date='',end_date='',trade_date='20160416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160416_tscode_list = list() 
for ts_code_sh in daily_20160416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160416_tscode_list.append(stock_name)
daily_20160416_addname_dataframe=pd.DataFrame()
daily_20160416_addname_dataframe['cname'] = daily_20160416_tscode_list
for table_name in daily_20160416.columns.values.tolist():
    daily_20160416_addname_dataframe[table_name] = daily_20160416[table_name]
print("daily_20160416 返回数据 row 行数 = "+str(daily_20160416.shape[0]))
daily_20160416_addname_dataframe.to_excel(daily_201604_excel_writer,'16_6',index=False)
daily_201604_excel_writer.save()
daily_20160417 = pro.daily(start_date='',end_date='',trade_date='20160417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160417_tscode_list = list() 
for ts_code_sh in daily_20160417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160417_tscode_list.append(stock_name)
daily_20160417_addname_dataframe=pd.DataFrame()
daily_20160417_addname_dataframe['cname'] = daily_20160417_tscode_list
for table_name in daily_20160417.columns.values.tolist():
    daily_20160417_addname_dataframe[table_name] = daily_20160417[table_name]
print("daily_20160417 返回数据 row 行数 = "+str(daily_20160417.shape[0]))
daily_20160417_addname_dataframe.to_excel(daily_201604_excel_writer,'17_7',index=False)
daily_201604_excel_writer.save()
daily_20160418 = pro.daily(start_date='',end_date='',trade_date='20160418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160418_tscode_list = list() 
for ts_code_sh in daily_20160418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160418_tscode_list.append(stock_name)
daily_20160418_addname_dataframe=pd.DataFrame()
daily_20160418_addname_dataframe['cname'] = daily_20160418_tscode_list
for table_name in daily_20160418.columns.values.tolist():
    daily_20160418_addname_dataframe[table_name] = daily_20160418[table_name]
print("daily_20160418 返回数据 row 行数 = "+str(daily_20160418.shape[0]))
daily_20160418_addname_dataframe.to_excel(daily_201604_excel_writer,'18_1',index=False)
daily_201604_excel_writer.save()
daily_20160419 = pro.daily(start_date='',end_date='',trade_date='20160419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160419_tscode_list = list() 
for ts_code_sh in daily_20160419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160419_tscode_list.append(stock_name)
daily_20160419_addname_dataframe=pd.DataFrame()
daily_20160419_addname_dataframe['cname'] = daily_20160419_tscode_list
for table_name in daily_20160419.columns.values.tolist():
    daily_20160419_addname_dataframe[table_name] = daily_20160419[table_name]
print("daily_20160419 返回数据 row 行数 = "+str(daily_20160419.shape[0]))
daily_20160419_addname_dataframe.to_excel(daily_201604_excel_writer,'19_2',index=False)
daily_201604_excel_writer.save()
daily_20160420 = pro.daily(start_date='',end_date='',trade_date='20160420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160420_tscode_list = list() 
for ts_code_sh in daily_20160420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160420_tscode_list.append(stock_name)
daily_20160420_addname_dataframe=pd.DataFrame()
daily_20160420_addname_dataframe['cname'] = daily_20160420_tscode_list
for table_name in daily_20160420.columns.values.tolist():
    daily_20160420_addname_dataframe[table_name] = daily_20160420[table_name]
print("daily_20160420 返回数据 row 行数 = "+str(daily_20160420.shape[0]))
daily_20160420_addname_dataframe.to_excel(daily_201604_excel_writer,'20_3',index=False)
daily_201604_excel_writer.save()
daily_20160421 = pro.daily(start_date='',end_date='',trade_date='20160421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160421_tscode_list = list() 
for ts_code_sh in daily_20160421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160421_tscode_list.append(stock_name)
daily_20160421_addname_dataframe=pd.DataFrame()
daily_20160421_addname_dataframe['cname'] = daily_20160421_tscode_list
for table_name in daily_20160421.columns.values.tolist():
    daily_20160421_addname_dataframe[table_name] = daily_20160421[table_name]
print("daily_20160421 返回数据 row 行数 = "+str(daily_20160421.shape[0]))
daily_20160421_addname_dataframe.to_excel(daily_201604_excel_writer,'21_4',index=False)
daily_201604_excel_writer.save()
daily_20160422 = pro.daily(start_date='',end_date='',trade_date='20160422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160422_tscode_list = list() 
for ts_code_sh in daily_20160422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160422_tscode_list.append(stock_name)
daily_20160422_addname_dataframe=pd.DataFrame()
daily_20160422_addname_dataframe['cname'] = daily_20160422_tscode_list
for table_name in daily_20160422.columns.values.tolist():
    daily_20160422_addname_dataframe[table_name] = daily_20160422[table_name]
print("daily_20160422 返回数据 row 行数 = "+str(daily_20160422.shape[0]))
daily_20160422_addname_dataframe.to_excel(daily_201604_excel_writer,'22_5',index=False)
daily_201604_excel_writer.save()
daily_20160423 = pro.daily(start_date='',end_date='',trade_date='20160423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160423_tscode_list = list() 
for ts_code_sh in daily_20160423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160423_tscode_list.append(stock_name)
daily_20160423_addname_dataframe=pd.DataFrame()
daily_20160423_addname_dataframe['cname'] = daily_20160423_tscode_list
for table_name in daily_20160423.columns.values.tolist():
    daily_20160423_addname_dataframe[table_name] = daily_20160423[table_name]
print("daily_20160423 返回数据 row 行数 = "+str(daily_20160423.shape[0]))
daily_20160423_addname_dataframe.to_excel(daily_201604_excel_writer,'23_6',index=False)
daily_201604_excel_writer.save()
daily_20160424 = pro.daily(start_date='',end_date='',trade_date='20160424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160424_tscode_list = list() 
for ts_code_sh in daily_20160424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160424_tscode_list.append(stock_name)
daily_20160424_addname_dataframe=pd.DataFrame()
daily_20160424_addname_dataframe['cname'] = daily_20160424_tscode_list
for table_name in daily_20160424.columns.values.tolist():
    daily_20160424_addname_dataframe[table_name] = daily_20160424[table_name]
print("daily_20160424 返回数据 row 行数 = "+str(daily_20160424.shape[0]))
daily_20160424_addname_dataframe.to_excel(daily_201604_excel_writer,'24_7',index=False)
daily_201604_excel_writer.save()
daily_20160425 = pro.daily(start_date='',end_date='',trade_date='20160425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160425_tscode_list = list() 
for ts_code_sh in daily_20160425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160425_tscode_list.append(stock_name)
daily_20160425_addname_dataframe=pd.DataFrame()
daily_20160425_addname_dataframe['cname'] = daily_20160425_tscode_list
for table_name in daily_20160425.columns.values.tolist():
    daily_20160425_addname_dataframe[table_name] = daily_20160425[table_name]
print("daily_20160425 返回数据 row 行数 = "+str(daily_20160425.shape[0]))
daily_20160425_addname_dataframe.to_excel(daily_201604_excel_writer,'25_1',index=False)
daily_201604_excel_writer.save()
daily_20160426 = pro.daily(start_date='',end_date='',trade_date='20160426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160426_tscode_list = list() 
for ts_code_sh in daily_20160426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160426_tscode_list.append(stock_name)
daily_20160426_addname_dataframe=pd.DataFrame()
daily_20160426_addname_dataframe['cname'] = daily_20160426_tscode_list
for table_name in daily_20160426.columns.values.tolist():
    daily_20160426_addname_dataframe[table_name] = daily_20160426[table_name]
print("daily_20160426 返回数据 row 行数 = "+str(daily_20160426.shape[0]))
daily_20160426_addname_dataframe.to_excel(daily_201604_excel_writer,'26_2',index=False)
daily_201604_excel_writer.save()
daily_20160427 = pro.daily(start_date='',end_date='',trade_date='20160427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160427_tscode_list = list() 
for ts_code_sh in daily_20160427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160427_tscode_list.append(stock_name)
daily_20160427_addname_dataframe=pd.DataFrame()
daily_20160427_addname_dataframe['cname'] = daily_20160427_tscode_list
for table_name in daily_20160427.columns.values.tolist():
    daily_20160427_addname_dataframe[table_name] = daily_20160427[table_name]
print("daily_20160427 返回数据 row 行数 = "+str(daily_20160427.shape[0]))
daily_20160427_addname_dataframe.to_excel(daily_201604_excel_writer,'27_3',index=False)
daily_201604_excel_writer.save()
daily_20160428 = pro.daily(start_date='',end_date='',trade_date='20160428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160428_tscode_list = list() 
for ts_code_sh in daily_20160428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160428_tscode_list.append(stock_name)
daily_20160428_addname_dataframe=pd.DataFrame()
daily_20160428_addname_dataframe['cname'] = daily_20160428_tscode_list
for table_name in daily_20160428.columns.values.tolist():
    daily_20160428_addname_dataframe[table_name] = daily_20160428[table_name]
print("daily_20160428 返回数据 row 行数 = "+str(daily_20160428.shape[0]))
daily_20160428_addname_dataframe.to_excel(daily_201604_excel_writer,'28_4',index=False)
daily_201604_excel_writer.save()
daily_20160429 = pro.daily(start_date='',end_date='',trade_date='20160429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160429_tscode_list = list() 
for ts_code_sh in daily_20160429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160429_tscode_list.append(stock_name)
daily_20160429_addname_dataframe=pd.DataFrame()
daily_20160429_addname_dataframe['cname'] = daily_20160429_tscode_list
for table_name in daily_20160429.columns.values.tolist():
    daily_20160429_addname_dataframe[table_name] = daily_20160429[table_name]
print("daily_20160429 返回数据 row 行数 = "+str(daily_20160429.shape[0]))
daily_20160429_addname_dataframe.to_excel(daily_201604_excel_writer,'29_5',index=False)
daily_201604_excel_writer.save()
daily_20160430 = pro.daily(start_date='',end_date='',trade_date='20160430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160430_tscode_list = list() 
for ts_code_sh in daily_20160430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160430_tscode_list.append(stock_name)
daily_20160430_addname_dataframe=pd.DataFrame()
daily_20160430_addname_dataframe['cname'] = daily_20160430_tscode_list
for table_name in daily_20160430.columns.values.tolist():
    daily_20160430_addname_dataframe[table_name] = daily_20160430[table_name]
print("daily_20160430 返回数据 row 行数 = "+str(daily_20160430.shape[0]))
daily_20160430_addname_dataframe.to_excel(daily_201604_excel_writer,'30_6',index=False)
daily_201604_excel_writer.save()




createexcel('daily_201605.xlsx')
daily_201605_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201605.xlsx')
daily_201605_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201605.xlsx', engine='openpyxl')
daily_201605_excel_writer.book = daily_201605_book
daily_201605_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201605_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160501")       ###  更新 记录日期
daily_20160501 = pro.daily(start_date='',end_date='',trade_date='20160501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160501_tscode_list = list() 
for ts_code_sh in daily_20160501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160501_tscode_list.append(stock_name)
daily_20160501_addname_dataframe=pd.DataFrame()
daily_20160501_addname_dataframe['cname'] = daily_20160501_tscode_list
for table_name in daily_20160501.columns.values.tolist():
    daily_20160501_addname_dataframe[table_name] = daily_20160501[table_name]
print("daily_20160501 返回数据 row 行数 = "+str(daily_20160501.shape[0]))
daily_20160501_addname_dataframe.to_excel(daily_201605_excel_writer,'1_7',index=False)
daily_201605_excel_writer.save()
daily_20160502 = pro.daily(start_date='',end_date='',trade_date='20160502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160502_tscode_list = list() 
for ts_code_sh in daily_20160502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160502_tscode_list.append(stock_name)
daily_20160502_addname_dataframe=pd.DataFrame()
daily_20160502_addname_dataframe['cname'] = daily_20160502_tscode_list
for table_name in daily_20160502.columns.values.tolist():
    daily_20160502_addname_dataframe[table_name] = daily_20160502[table_name]
print("daily_20160502 返回数据 row 行数 = "+str(daily_20160502.shape[0]))
daily_20160502_addname_dataframe.to_excel(daily_201605_excel_writer,'2_1',index=False)
daily_201605_excel_writer.save()
daily_20160503 = pro.daily(start_date='',end_date='',trade_date='20160503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160503_tscode_list = list() 
for ts_code_sh in daily_20160503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160503_tscode_list.append(stock_name)
daily_20160503_addname_dataframe=pd.DataFrame()
daily_20160503_addname_dataframe['cname'] = daily_20160503_tscode_list
for table_name in daily_20160503.columns.values.tolist():
    daily_20160503_addname_dataframe[table_name] = daily_20160503[table_name]
print("daily_20160503 返回数据 row 行数 = "+str(daily_20160503.shape[0]))
daily_20160503_addname_dataframe.to_excel(daily_201605_excel_writer,'3_2',index=False)
daily_201605_excel_writer.save()
daily_20160504 = pro.daily(start_date='',end_date='',trade_date='20160504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160504_tscode_list = list() 
for ts_code_sh in daily_20160504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160504_tscode_list.append(stock_name)
daily_20160504_addname_dataframe=pd.DataFrame()
daily_20160504_addname_dataframe['cname'] = daily_20160504_tscode_list
for table_name in daily_20160504.columns.values.tolist():
    daily_20160504_addname_dataframe[table_name] = daily_20160504[table_name]
print("daily_20160504 返回数据 row 行数 = "+str(daily_20160504.shape[0]))
daily_20160504_addname_dataframe.to_excel(daily_201605_excel_writer,'4_3',index=False)
daily_201605_excel_writer.save()
daily_20160505 = pro.daily(start_date='',end_date='',trade_date='20160505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160505_tscode_list = list() 
for ts_code_sh in daily_20160505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160505_tscode_list.append(stock_name)
daily_20160505_addname_dataframe=pd.DataFrame()
daily_20160505_addname_dataframe['cname'] = daily_20160505_tscode_list
for table_name in daily_20160505.columns.values.tolist():
    daily_20160505_addname_dataframe[table_name] = daily_20160505[table_name]
print("daily_20160505 返回数据 row 行数 = "+str(daily_20160505.shape[0]))
daily_20160505_addname_dataframe.to_excel(daily_201605_excel_writer,'5_4',index=False)
daily_201605_excel_writer.save()
daily_20160506 = pro.daily(start_date='',end_date='',trade_date='20160506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160506_tscode_list = list() 
for ts_code_sh in daily_20160506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160506_tscode_list.append(stock_name)
daily_20160506_addname_dataframe=pd.DataFrame()
daily_20160506_addname_dataframe['cname'] = daily_20160506_tscode_list
for table_name in daily_20160506.columns.values.tolist():
    daily_20160506_addname_dataframe[table_name] = daily_20160506[table_name]
print("daily_20160506 返回数据 row 行数 = "+str(daily_20160506.shape[0]))
daily_20160506_addname_dataframe.to_excel(daily_201605_excel_writer,'6_5',index=False)
daily_201605_excel_writer.save()
daily_20160507 = pro.daily(start_date='',end_date='',trade_date='20160507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160507_tscode_list = list() 
for ts_code_sh in daily_20160507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160507_tscode_list.append(stock_name)
daily_20160507_addname_dataframe=pd.DataFrame()
daily_20160507_addname_dataframe['cname'] = daily_20160507_tscode_list
for table_name in daily_20160507.columns.values.tolist():
    daily_20160507_addname_dataframe[table_name] = daily_20160507[table_name]
print("daily_20160507 返回数据 row 行数 = "+str(daily_20160507.shape[0]))
daily_20160507_addname_dataframe.to_excel(daily_201605_excel_writer,'7_6',index=False)
daily_201605_excel_writer.save()
daily_20160508 = pro.daily(start_date='',end_date='',trade_date='20160508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160508_tscode_list = list() 
for ts_code_sh in daily_20160508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160508_tscode_list.append(stock_name)
daily_20160508_addname_dataframe=pd.DataFrame()
daily_20160508_addname_dataframe['cname'] = daily_20160508_tscode_list
for table_name in daily_20160508.columns.values.tolist():
    daily_20160508_addname_dataframe[table_name] = daily_20160508[table_name]
print("daily_20160508 返回数据 row 行数 = "+str(daily_20160508.shape[0]))
daily_20160508_addname_dataframe.to_excel(daily_201605_excel_writer,'8_7',index=False)
daily_201605_excel_writer.save()
daily_20160509 = pro.daily(start_date='',end_date='',trade_date='20160509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160509_tscode_list = list() 
for ts_code_sh in daily_20160509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160509_tscode_list.append(stock_name)
daily_20160509_addname_dataframe=pd.DataFrame()
daily_20160509_addname_dataframe['cname'] = daily_20160509_tscode_list
for table_name in daily_20160509.columns.values.tolist():
    daily_20160509_addname_dataframe[table_name] = daily_20160509[table_name]
print("daily_20160509 返回数据 row 行数 = "+str(daily_20160509.shape[0]))
daily_20160509_addname_dataframe.to_excel(daily_201605_excel_writer,'9_1',index=False)
daily_201605_excel_writer.save()
daily_20160510 = pro.daily(start_date='',end_date='',trade_date='20160510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160510_tscode_list = list() 
for ts_code_sh in daily_20160510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160510_tscode_list.append(stock_name)
daily_20160510_addname_dataframe=pd.DataFrame()
daily_20160510_addname_dataframe['cname'] = daily_20160510_tscode_list
for table_name in daily_20160510.columns.values.tolist():
    daily_20160510_addname_dataframe[table_name] = daily_20160510[table_name]
print("daily_20160510 返回数据 row 行数 = "+str(daily_20160510.shape[0]))
daily_20160510_addname_dataframe.to_excel(daily_201605_excel_writer,'10_2',index=False)
daily_201605_excel_writer.save()
daily_20160511 = pro.daily(start_date='',end_date='',trade_date='20160511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160511_tscode_list = list() 
for ts_code_sh in daily_20160511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160511_tscode_list.append(stock_name)
daily_20160511_addname_dataframe=pd.DataFrame()
daily_20160511_addname_dataframe['cname'] = daily_20160511_tscode_list
for table_name in daily_20160511.columns.values.tolist():
    daily_20160511_addname_dataframe[table_name] = daily_20160511[table_name]
print("daily_20160511 返回数据 row 行数 = "+str(daily_20160511.shape[0]))
daily_20160511_addname_dataframe.to_excel(daily_201605_excel_writer,'11_3',index=False)
daily_201605_excel_writer.save()
daily_20160512 = pro.daily(start_date='',end_date='',trade_date='20160512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160512_tscode_list = list() 
for ts_code_sh in daily_20160512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160512_tscode_list.append(stock_name)
daily_20160512_addname_dataframe=pd.DataFrame()
daily_20160512_addname_dataframe['cname'] = daily_20160512_tscode_list
for table_name in daily_20160512.columns.values.tolist():
    daily_20160512_addname_dataframe[table_name] = daily_20160512[table_name]
print("daily_20160512 返回数据 row 行数 = "+str(daily_20160512.shape[0]))
daily_20160512_addname_dataframe.to_excel(daily_201605_excel_writer,'12_4',index=False)
daily_201605_excel_writer.save()
daily_20160513 = pro.daily(start_date='',end_date='',trade_date='20160513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160513_tscode_list = list() 
for ts_code_sh in daily_20160513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160513_tscode_list.append(stock_name)
daily_20160513_addname_dataframe=pd.DataFrame()
daily_20160513_addname_dataframe['cname'] = daily_20160513_tscode_list
for table_name in daily_20160513.columns.values.tolist():
    daily_20160513_addname_dataframe[table_name] = daily_20160513[table_name]
print("daily_20160513 返回数据 row 行数 = "+str(daily_20160513.shape[0]))
daily_20160513_addname_dataframe.to_excel(daily_201605_excel_writer,'13_5',index=False)
daily_201605_excel_writer.save()
daily_20160514 = pro.daily(start_date='',end_date='',trade_date='20160514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160514_tscode_list = list() 
for ts_code_sh in daily_20160514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160514_tscode_list.append(stock_name)
daily_20160514_addname_dataframe=pd.DataFrame()
daily_20160514_addname_dataframe['cname'] = daily_20160514_tscode_list
for table_name in daily_20160514.columns.values.tolist():
    daily_20160514_addname_dataframe[table_name] = daily_20160514[table_name]
print("daily_20160514 返回数据 row 行数 = "+str(daily_20160514.shape[0]))
daily_20160514_addname_dataframe.to_excel(daily_201605_excel_writer,'14_6',index=False)
daily_201605_excel_writer.save()
daily_20160515 = pro.daily(start_date='',end_date='',trade_date='20160515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160515_tscode_list = list() 
for ts_code_sh in daily_20160515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160515_tscode_list.append(stock_name)
daily_20160515_addname_dataframe=pd.DataFrame()
daily_20160515_addname_dataframe['cname'] = daily_20160515_tscode_list
for table_name in daily_20160515.columns.values.tolist():
    daily_20160515_addname_dataframe[table_name] = daily_20160515[table_name]
print("daily_20160515 返回数据 row 行数 = "+str(daily_20160515.shape[0]))
daily_20160515_addname_dataframe.to_excel(daily_201605_excel_writer,'15_7',index=False)
daily_201605_excel_writer.save()
daily_20160516 = pro.daily(start_date='',end_date='',trade_date='20160516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160516_tscode_list = list() 
for ts_code_sh in daily_20160516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160516_tscode_list.append(stock_name)
daily_20160516_addname_dataframe=pd.DataFrame()
daily_20160516_addname_dataframe['cname'] = daily_20160516_tscode_list
for table_name in daily_20160516.columns.values.tolist():
    daily_20160516_addname_dataframe[table_name] = daily_20160516[table_name]
print("daily_20160516 返回数据 row 行数 = "+str(daily_20160516.shape[0]))
daily_20160516_addname_dataframe.to_excel(daily_201605_excel_writer,'16_1',index=False)
daily_201605_excel_writer.save()
daily_20160517 = pro.daily(start_date='',end_date='',trade_date='20160517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160517_tscode_list = list() 
for ts_code_sh in daily_20160517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160517_tscode_list.append(stock_name)
daily_20160517_addname_dataframe=pd.DataFrame()
daily_20160517_addname_dataframe['cname'] = daily_20160517_tscode_list
for table_name in daily_20160517.columns.values.tolist():
    daily_20160517_addname_dataframe[table_name] = daily_20160517[table_name]
print("daily_20160517 返回数据 row 行数 = "+str(daily_20160517.shape[0]))
daily_20160517_addname_dataframe.to_excel(daily_201605_excel_writer,'17_2',index=False)
daily_201605_excel_writer.save()
daily_20160518 = pro.daily(start_date='',end_date='',trade_date='20160518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160518_tscode_list = list() 
for ts_code_sh in daily_20160518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160518_tscode_list.append(stock_name)
daily_20160518_addname_dataframe=pd.DataFrame()
daily_20160518_addname_dataframe['cname'] = daily_20160518_tscode_list
for table_name in daily_20160518.columns.values.tolist():
    daily_20160518_addname_dataframe[table_name] = daily_20160518[table_name]
print("daily_20160518 返回数据 row 行数 = "+str(daily_20160518.shape[0]))
daily_20160518_addname_dataframe.to_excel(daily_201605_excel_writer,'18_3',index=False)
daily_201605_excel_writer.save()
daily_20160519 = pro.daily(start_date='',end_date='',trade_date='20160519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160519_tscode_list = list() 
for ts_code_sh in daily_20160519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160519_tscode_list.append(stock_name)
daily_20160519_addname_dataframe=pd.DataFrame()
daily_20160519_addname_dataframe['cname'] = daily_20160519_tscode_list
for table_name in daily_20160519.columns.values.tolist():
    daily_20160519_addname_dataframe[table_name] = daily_20160519[table_name]
print("daily_20160519 返回数据 row 行数 = "+str(daily_20160519.shape[0]))
daily_20160519_addname_dataframe.to_excel(daily_201605_excel_writer,'19_4',index=False)
daily_201605_excel_writer.save()
daily_20160520 = pro.daily(start_date='',end_date='',trade_date='20160520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160520_tscode_list = list() 
for ts_code_sh in daily_20160520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160520_tscode_list.append(stock_name)
daily_20160520_addname_dataframe=pd.DataFrame()
daily_20160520_addname_dataframe['cname'] = daily_20160520_tscode_list
for table_name in daily_20160520.columns.values.tolist():
    daily_20160520_addname_dataframe[table_name] = daily_20160520[table_name]
print("daily_20160520 返回数据 row 行数 = "+str(daily_20160520.shape[0]))
daily_20160520_addname_dataframe.to_excel(daily_201605_excel_writer,'20_5',index=False)
daily_201605_excel_writer.save()
daily_20160521 = pro.daily(start_date='',end_date='',trade_date='20160521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160521_tscode_list = list() 
for ts_code_sh in daily_20160521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160521_tscode_list.append(stock_name)
daily_20160521_addname_dataframe=pd.DataFrame()
daily_20160521_addname_dataframe['cname'] = daily_20160521_tscode_list
for table_name in daily_20160521.columns.values.tolist():
    daily_20160521_addname_dataframe[table_name] = daily_20160521[table_name]
print("daily_20160521 返回数据 row 行数 = "+str(daily_20160521.shape[0]))
daily_20160521_addname_dataframe.to_excel(daily_201605_excel_writer,'21_6',index=False)
daily_201605_excel_writer.save()
daily_20160522 = pro.daily(start_date='',end_date='',trade_date='20160522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160522_tscode_list = list() 
for ts_code_sh in daily_20160522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160522_tscode_list.append(stock_name)
daily_20160522_addname_dataframe=pd.DataFrame()
daily_20160522_addname_dataframe['cname'] = daily_20160522_tscode_list
for table_name in daily_20160522.columns.values.tolist():
    daily_20160522_addname_dataframe[table_name] = daily_20160522[table_name]
print("daily_20160522 返回数据 row 行数 = "+str(daily_20160522.shape[0]))
daily_20160522_addname_dataframe.to_excel(daily_201605_excel_writer,'22_7',index=False)
daily_201605_excel_writer.save()
daily_20160523 = pro.daily(start_date='',end_date='',trade_date='20160523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160523_tscode_list = list() 
for ts_code_sh in daily_20160523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160523_tscode_list.append(stock_name)
daily_20160523_addname_dataframe=pd.DataFrame()
daily_20160523_addname_dataframe['cname'] = daily_20160523_tscode_list
for table_name in daily_20160523.columns.values.tolist():
    daily_20160523_addname_dataframe[table_name] = daily_20160523[table_name]
print("daily_20160523 返回数据 row 行数 = "+str(daily_20160523.shape[0]))
daily_20160523_addname_dataframe.to_excel(daily_201605_excel_writer,'23_1',index=False)
daily_201605_excel_writer.save()
daily_20160524 = pro.daily(start_date='',end_date='',trade_date='20160524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160524_tscode_list = list() 
for ts_code_sh in daily_20160524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160524_tscode_list.append(stock_name)
daily_20160524_addname_dataframe=pd.DataFrame()
daily_20160524_addname_dataframe['cname'] = daily_20160524_tscode_list
for table_name in daily_20160524.columns.values.tolist():
    daily_20160524_addname_dataframe[table_name] = daily_20160524[table_name]
print("daily_20160524 返回数据 row 行数 = "+str(daily_20160524.shape[0]))
daily_20160524_addname_dataframe.to_excel(daily_201605_excel_writer,'24_2',index=False)
daily_201605_excel_writer.save()
daily_20160525 = pro.daily(start_date='',end_date='',trade_date='20160525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160525_tscode_list = list() 
for ts_code_sh in daily_20160525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160525_tscode_list.append(stock_name)
daily_20160525_addname_dataframe=pd.DataFrame()
daily_20160525_addname_dataframe['cname'] = daily_20160525_tscode_list
for table_name in daily_20160525.columns.values.tolist():
    daily_20160525_addname_dataframe[table_name] = daily_20160525[table_name]
print("daily_20160525 返回数据 row 行数 = "+str(daily_20160525.shape[0]))
daily_20160525_addname_dataframe.to_excel(daily_201605_excel_writer,'25_3',index=False)
daily_201605_excel_writer.save()
daily_20160526 = pro.daily(start_date='',end_date='',trade_date='20160526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160526_tscode_list = list() 
for ts_code_sh in daily_20160526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160526_tscode_list.append(stock_name)
daily_20160526_addname_dataframe=pd.DataFrame()
daily_20160526_addname_dataframe['cname'] = daily_20160526_tscode_list
for table_name in daily_20160526.columns.values.tolist():
    daily_20160526_addname_dataframe[table_name] = daily_20160526[table_name]
print("daily_20160526 返回数据 row 行数 = "+str(daily_20160526.shape[0]))
daily_20160526_addname_dataframe.to_excel(daily_201605_excel_writer,'26_4',index=False)
daily_201605_excel_writer.save()
daily_20160527 = pro.daily(start_date='',end_date='',trade_date='20160527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160527_tscode_list = list() 
for ts_code_sh in daily_20160527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160527_tscode_list.append(stock_name)
daily_20160527_addname_dataframe=pd.DataFrame()
daily_20160527_addname_dataframe['cname'] = daily_20160527_tscode_list
for table_name in daily_20160527.columns.values.tolist():
    daily_20160527_addname_dataframe[table_name] = daily_20160527[table_name]
print("daily_20160527 返回数据 row 行数 = "+str(daily_20160527.shape[0]))
daily_20160527_addname_dataframe.to_excel(daily_201605_excel_writer,'27_5',index=False)
daily_201605_excel_writer.save()
daily_20160528 = pro.daily(start_date='',end_date='',trade_date='20160528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160528_tscode_list = list() 
for ts_code_sh in daily_20160528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160528_tscode_list.append(stock_name)
daily_20160528_addname_dataframe=pd.DataFrame()
daily_20160528_addname_dataframe['cname'] = daily_20160528_tscode_list
for table_name in daily_20160528.columns.values.tolist():
    daily_20160528_addname_dataframe[table_name] = daily_20160528[table_name]
print("daily_20160528 返回数据 row 行数 = "+str(daily_20160528.shape[0]))
daily_20160528_addname_dataframe.to_excel(daily_201605_excel_writer,'28_6',index=False)
daily_201605_excel_writer.save()
daily_20160529 = pro.daily(start_date='',end_date='',trade_date='20160529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160529_tscode_list = list() 
for ts_code_sh in daily_20160529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160529_tscode_list.append(stock_name)
daily_20160529_addname_dataframe=pd.DataFrame()
daily_20160529_addname_dataframe['cname'] = daily_20160529_tscode_list
for table_name in daily_20160529.columns.values.tolist():
    daily_20160529_addname_dataframe[table_name] = daily_20160529[table_name]
print("daily_20160529 返回数据 row 行数 = "+str(daily_20160529.shape[0]))
daily_20160529_addname_dataframe.to_excel(daily_201605_excel_writer,'29_7',index=False)
daily_201605_excel_writer.save()
daily_20160530 = pro.daily(start_date='',end_date='',trade_date='20160530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160530_tscode_list = list() 
for ts_code_sh in daily_20160530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160530_tscode_list.append(stock_name)
daily_20160530_addname_dataframe=pd.DataFrame()
daily_20160530_addname_dataframe['cname'] = daily_20160530_tscode_list
for table_name in daily_20160530.columns.values.tolist():
    daily_20160530_addname_dataframe[table_name] = daily_20160530[table_name]
print("daily_20160530 返回数据 row 行数 = "+str(daily_20160530.shape[0]))
daily_20160530_addname_dataframe.to_excel(daily_201605_excel_writer,'30_1',index=False)
daily_201605_excel_writer.save()
daily_20160531 = pro.daily(start_date='',end_date='',trade_date='20160531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160531_tscode_list = list() 
for ts_code_sh in daily_20160531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160531_tscode_list.append(stock_name)
daily_20160531_addname_dataframe=pd.DataFrame()
daily_20160531_addname_dataframe['cname'] = daily_20160531_tscode_list
for table_name in daily_20160531.columns.values.tolist():
    daily_20160531_addname_dataframe[table_name] = daily_20160531[table_name]
print("daily_20160531 返回数据 row 行数 = "+str(daily_20160531.shape[0]))
daily_20160531_addname_dataframe.to_excel(daily_201605_excel_writer,'31_2',index=False)
daily_201605_excel_writer.save()




createexcel('daily_201606.xlsx')
daily_201606_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201606.xlsx')
daily_201606_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201606.xlsx', engine='openpyxl')
daily_201606_excel_writer.book = daily_201606_book
daily_201606_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201606_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160601")       ###  更新 记录日期
daily_20160601 = pro.daily(start_date='',end_date='',trade_date='20160601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160601_tscode_list = list() 
for ts_code_sh in daily_20160601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160601_tscode_list.append(stock_name)
daily_20160601_addname_dataframe=pd.DataFrame()
daily_20160601_addname_dataframe['cname'] = daily_20160601_tscode_list
for table_name in daily_20160601.columns.values.tolist():
    daily_20160601_addname_dataframe[table_name] = daily_20160601[table_name]
print("daily_20160601 返回数据 row 行数 = "+str(daily_20160601.shape[0]))
daily_20160601_addname_dataframe.to_excel(daily_201606_excel_writer,'1_3',index=False)
daily_201606_excel_writer.save()
daily_20160602 = pro.daily(start_date='',end_date='',trade_date='20160602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160602_tscode_list = list() 
for ts_code_sh in daily_20160602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160602_tscode_list.append(stock_name)
daily_20160602_addname_dataframe=pd.DataFrame()
daily_20160602_addname_dataframe['cname'] = daily_20160602_tscode_list
for table_name in daily_20160602.columns.values.tolist():
    daily_20160602_addname_dataframe[table_name] = daily_20160602[table_name]
print("daily_20160602 返回数据 row 行数 = "+str(daily_20160602.shape[0]))
daily_20160602_addname_dataframe.to_excel(daily_201606_excel_writer,'2_4',index=False)
daily_201606_excel_writer.save()
daily_20160603 = pro.daily(start_date='',end_date='',trade_date='20160603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160603_tscode_list = list() 
for ts_code_sh in daily_20160603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160603_tscode_list.append(stock_name)
daily_20160603_addname_dataframe=pd.DataFrame()
daily_20160603_addname_dataframe['cname'] = daily_20160603_tscode_list
for table_name in daily_20160603.columns.values.tolist():
    daily_20160603_addname_dataframe[table_name] = daily_20160603[table_name]
print("daily_20160603 返回数据 row 行数 = "+str(daily_20160603.shape[0]))
daily_20160603_addname_dataframe.to_excel(daily_201606_excel_writer,'3_5',index=False)
daily_201606_excel_writer.save()
daily_20160604 = pro.daily(start_date='',end_date='',trade_date='20160604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160604_tscode_list = list() 
for ts_code_sh in daily_20160604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160604_tscode_list.append(stock_name)
daily_20160604_addname_dataframe=pd.DataFrame()
daily_20160604_addname_dataframe['cname'] = daily_20160604_tscode_list
for table_name in daily_20160604.columns.values.tolist():
    daily_20160604_addname_dataframe[table_name] = daily_20160604[table_name]
print("daily_20160604 返回数据 row 行数 = "+str(daily_20160604.shape[0]))
daily_20160604_addname_dataframe.to_excel(daily_201606_excel_writer,'4_6',index=False)
daily_201606_excel_writer.save()
daily_20160605 = pro.daily(start_date='',end_date='',trade_date='20160605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160605_tscode_list = list() 
for ts_code_sh in daily_20160605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160605_tscode_list.append(stock_name)
daily_20160605_addname_dataframe=pd.DataFrame()
daily_20160605_addname_dataframe['cname'] = daily_20160605_tscode_list
for table_name in daily_20160605.columns.values.tolist():
    daily_20160605_addname_dataframe[table_name] = daily_20160605[table_name]
print("daily_20160605 返回数据 row 行数 = "+str(daily_20160605.shape[0]))
daily_20160605_addname_dataframe.to_excel(daily_201606_excel_writer,'5_7',index=False)
daily_201606_excel_writer.save()
daily_20160606 = pro.daily(start_date='',end_date='',trade_date='20160606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160606_tscode_list = list() 
for ts_code_sh in daily_20160606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160606_tscode_list.append(stock_name)
daily_20160606_addname_dataframe=pd.DataFrame()
daily_20160606_addname_dataframe['cname'] = daily_20160606_tscode_list
for table_name in daily_20160606.columns.values.tolist():
    daily_20160606_addname_dataframe[table_name] = daily_20160606[table_name]
print("daily_20160606 返回数据 row 行数 = "+str(daily_20160606.shape[0]))
daily_20160606_addname_dataframe.to_excel(daily_201606_excel_writer,'6_1',index=False)
daily_201606_excel_writer.save()
daily_20160607 = pro.daily(start_date='',end_date='',trade_date='20160607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160607_tscode_list = list() 
for ts_code_sh in daily_20160607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160607_tscode_list.append(stock_name)
daily_20160607_addname_dataframe=pd.DataFrame()
daily_20160607_addname_dataframe['cname'] = daily_20160607_tscode_list
for table_name in daily_20160607.columns.values.tolist():
    daily_20160607_addname_dataframe[table_name] = daily_20160607[table_name]
print("daily_20160607 返回数据 row 行数 = "+str(daily_20160607.shape[0]))
daily_20160607_addname_dataframe.to_excel(daily_201606_excel_writer,'7_2',index=False)
daily_201606_excel_writer.save()
daily_20160608 = pro.daily(start_date='',end_date='',trade_date='20160608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160608_tscode_list = list() 
for ts_code_sh in daily_20160608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160608_tscode_list.append(stock_name)
daily_20160608_addname_dataframe=pd.DataFrame()
daily_20160608_addname_dataframe['cname'] = daily_20160608_tscode_list
for table_name in daily_20160608.columns.values.tolist():
    daily_20160608_addname_dataframe[table_name] = daily_20160608[table_name]
print("daily_20160608 返回数据 row 行数 = "+str(daily_20160608.shape[0]))
daily_20160608_addname_dataframe.to_excel(daily_201606_excel_writer,'8_3',index=False)
daily_201606_excel_writer.save()
daily_20160609 = pro.daily(start_date='',end_date='',trade_date='20160609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160609_tscode_list = list() 
for ts_code_sh in daily_20160609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160609_tscode_list.append(stock_name)
daily_20160609_addname_dataframe=pd.DataFrame()
daily_20160609_addname_dataframe['cname'] = daily_20160609_tscode_list
for table_name in daily_20160609.columns.values.tolist():
    daily_20160609_addname_dataframe[table_name] = daily_20160609[table_name]
print("daily_20160609 返回数据 row 行数 = "+str(daily_20160609.shape[0]))
daily_20160609_addname_dataframe.to_excel(daily_201606_excel_writer,'9_4',index=False)
daily_201606_excel_writer.save()
daily_20160610 = pro.daily(start_date='',end_date='',trade_date='20160610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160610_tscode_list = list() 
for ts_code_sh in daily_20160610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160610_tscode_list.append(stock_name)
daily_20160610_addname_dataframe=pd.DataFrame()
daily_20160610_addname_dataframe['cname'] = daily_20160610_tscode_list
for table_name in daily_20160610.columns.values.tolist():
    daily_20160610_addname_dataframe[table_name] = daily_20160610[table_name]
print("daily_20160610 返回数据 row 行数 = "+str(daily_20160610.shape[0]))
daily_20160610_addname_dataframe.to_excel(daily_201606_excel_writer,'10_5',index=False)
daily_201606_excel_writer.save()
daily_20160611 = pro.daily(start_date='',end_date='',trade_date='20160611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160611_tscode_list = list() 
for ts_code_sh in daily_20160611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160611_tscode_list.append(stock_name)
daily_20160611_addname_dataframe=pd.DataFrame()
daily_20160611_addname_dataframe['cname'] = daily_20160611_tscode_list
for table_name in daily_20160611.columns.values.tolist():
    daily_20160611_addname_dataframe[table_name] = daily_20160611[table_name]
print("daily_20160611 返回数据 row 行数 = "+str(daily_20160611.shape[0]))
daily_20160611_addname_dataframe.to_excel(daily_201606_excel_writer,'11_6',index=False)
daily_201606_excel_writer.save()
daily_20160612 = pro.daily(start_date='',end_date='',trade_date='20160612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160612_tscode_list = list() 
for ts_code_sh in daily_20160612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160612_tscode_list.append(stock_name)
daily_20160612_addname_dataframe=pd.DataFrame()
daily_20160612_addname_dataframe['cname'] = daily_20160612_tscode_list
for table_name in daily_20160612.columns.values.tolist():
    daily_20160612_addname_dataframe[table_name] = daily_20160612[table_name]
print("daily_20160612 返回数据 row 行数 = "+str(daily_20160612.shape[0]))
daily_20160612_addname_dataframe.to_excel(daily_201606_excel_writer,'12_7',index=False)
daily_201606_excel_writer.save()
daily_20160613 = pro.daily(start_date='',end_date='',trade_date='20160613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160613_tscode_list = list() 
for ts_code_sh in daily_20160613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160613_tscode_list.append(stock_name)
daily_20160613_addname_dataframe=pd.DataFrame()
daily_20160613_addname_dataframe['cname'] = daily_20160613_tscode_list
for table_name in daily_20160613.columns.values.tolist():
    daily_20160613_addname_dataframe[table_name] = daily_20160613[table_name]
print("daily_20160613 返回数据 row 行数 = "+str(daily_20160613.shape[0]))
daily_20160613_addname_dataframe.to_excel(daily_201606_excel_writer,'13_1',index=False)
daily_201606_excel_writer.save()
daily_20160614 = pro.daily(start_date='',end_date='',trade_date='20160614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160614_tscode_list = list() 
for ts_code_sh in daily_20160614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160614_tscode_list.append(stock_name)
daily_20160614_addname_dataframe=pd.DataFrame()
daily_20160614_addname_dataframe['cname'] = daily_20160614_tscode_list
for table_name in daily_20160614.columns.values.tolist():
    daily_20160614_addname_dataframe[table_name] = daily_20160614[table_name]
print("daily_20160614 返回数据 row 行数 = "+str(daily_20160614.shape[0]))
daily_20160614_addname_dataframe.to_excel(daily_201606_excel_writer,'14_2',index=False)
daily_201606_excel_writer.save()
daily_20160615 = pro.daily(start_date='',end_date='',trade_date='20160615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160615_tscode_list = list() 
for ts_code_sh in daily_20160615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160615_tscode_list.append(stock_name)
daily_20160615_addname_dataframe=pd.DataFrame()
daily_20160615_addname_dataframe['cname'] = daily_20160615_tscode_list
for table_name in daily_20160615.columns.values.tolist():
    daily_20160615_addname_dataframe[table_name] = daily_20160615[table_name]
print("daily_20160615 返回数据 row 行数 = "+str(daily_20160615.shape[0]))
daily_20160615_addname_dataframe.to_excel(daily_201606_excel_writer,'15_3',index=False)
daily_201606_excel_writer.save()
daily_20160616 = pro.daily(start_date='',end_date='',trade_date='20160616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160616_tscode_list = list() 
for ts_code_sh in daily_20160616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160616_tscode_list.append(stock_name)
daily_20160616_addname_dataframe=pd.DataFrame()
daily_20160616_addname_dataframe['cname'] = daily_20160616_tscode_list
for table_name in daily_20160616.columns.values.tolist():
    daily_20160616_addname_dataframe[table_name] = daily_20160616[table_name]
print("daily_20160616 返回数据 row 行数 = "+str(daily_20160616.shape[0]))
daily_20160616_addname_dataframe.to_excel(daily_201606_excel_writer,'16_4',index=False)
daily_201606_excel_writer.save()
daily_20160617 = pro.daily(start_date='',end_date='',trade_date='20160617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160617_tscode_list = list() 
for ts_code_sh in daily_20160617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160617_tscode_list.append(stock_name)
daily_20160617_addname_dataframe=pd.DataFrame()
daily_20160617_addname_dataframe['cname'] = daily_20160617_tscode_list
for table_name in daily_20160617.columns.values.tolist():
    daily_20160617_addname_dataframe[table_name] = daily_20160617[table_name]
print("daily_20160617 返回数据 row 行数 = "+str(daily_20160617.shape[0]))
daily_20160617_addname_dataframe.to_excel(daily_201606_excel_writer,'17_5',index=False)
daily_201606_excel_writer.save()
daily_20160618 = pro.daily(start_date='',end_date='',trade_date='20160618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160618_tscode_list = list() 
for ts_code_sh in daily_20160618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160618_tscode_list.append(stock_name)
daily_20160618_addname_dataframe=pd.DataFrame()
daily_20160618_addname_dataframe['cname'] = daily_20160618_tscode_list
for table_name in daily_20160618.columns.values.tolist():
    daily_20160618_addname_dataframe[table_name] = daily_20160618[table_name]
print("daily_20160618 返回数据 row 行数 = "+str(daily_20160618.shape[0]))
daily_20160618_addname_dataframe.to_excel(daily_201606_excel_writer,'18_6',index=False)
daily_201606_excel_writer.save()
daily_20160619 = pro.daily(start_date='',end_date='',trade_date='20160619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160619_tscode_list = list() 
for ts_code_sh in daily_20160619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160619_tscode_list.append(stock_name)
daily_20160619_addname_dataframe=pd.DataFrame()
daily_20160619_addname_dataframe['cname'] = daily_20160619_tscode_list
for table_name in daily_20160619.columns.values.tolist():
    daily_20160619_addname_dataframe[table_name] = daily_20160619[table_name]
print("daily_20160619 返回数据 row 行数 = "+str(daily_20160619.shape[0]))
daily_20160619_addname_dataframe.to_excel(daily_201606_excel_writer,'19_7',index=False)
daily_201606_excel_writer.save()
daily_20160620 = pro.daily(start_date='',end_date='',trade_date='20160620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160620_tscode_list = list() 
for ts_code_sh in daily_20160620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160620_tscode_list.append(stock_name)
daily_20160620_addname_dataframe=pd.DataFrame()
daily_20160620_addname_dataframe['cname'] = daily_20160620_tscode_list
for table_name in daily_20160620.columns.values.tolist():
    daily_20160620_addname_dataframe[table_name] = daily_20160620[table_name]
print("daily_20160620 返回数据 row 行数 = "+str(daily_20160620.shape[0]))
daily_20160620_addname_dataframe.to_excel(daily_201606_excel_writer,'20_1',index=False)
daily_201606_excel_writer.save()
daily_20160621 = pro.daily(start_date='',end_date='',trade_date='20160621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160621_tscode_list = list() 
for ts_code_sh in daily_20160621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160621_tscode_list.append(stock_name)
daily_20160621_addname_dataframe=pd.DataFrame()
daily_20160621_addname_dataframe['cname'] = daily_20160621_tscode_list
for table_name in daily_20160621.columns.values.tolist():
    daily_20160621_addname_dataframe[table_name] = daily_20160621[table_name]
print("daily_20160621 返回数据 row 行数 = "+str(daily_20160621.shape[0]))
daily_20160621_addname_dataframe.to_excel(daily_201606_excel_writer,'21_2',index=False)
daily_201606_excel_writer.save()
daily_20160622 = pro.daily(start_date='',end_date='',trade_date='20160622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160622_tscode_list = list() 
for ts_code_sh in daily_20160622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160622_tscode_list.append(stock_name)
daily_20160622_addname_dataframe=pd.DataFrame()
daily_20160622_addname_dataframe['cname'] = daily_20160622_tscode_list
for table_name in daily_20160622.columns.values.tolist():
    daily_20160622_addname_dataframe[table_name] = daily_20160622[table_name]
print("daily_20160622 返回数据 row 行数 = "+str(daily_20160622.shape[0]))
daily_20160622_addname_dataframe.to_excel(daily_201606_excel_writer,'22_3',index=False)
daily_201606_excel_writer.save()
daily_20160623 = pro.daily(start_date='',end_date='',trade_date='20160623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160623_tscode_list = list() 
for ts_code_sh in daily_20160623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160623_tscode_list.append(stock_name)
daily_20160623_addname_dataframe=pd.DataFrame()
daily_20160623_addname_dataframe['cname'] = daily_20160623_tscode_list
for table_name in daily_20160623.columns.values.tolist():
    daily_20160623_addname_dataframe[table_name] = daily_20160623[table_name]
print("daily_20160623 返回数据 row 行数 = "+str(daily_20160623.shape[0]))
daily_20160623_addname_dataframe.to_excel(daily_201606_excel_writer,'23_4',index=False)
daily_201606_excel_writer.save()
daily_20160624 = pro.daily(start_date='',end_date='',trade_date='20160624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160624_tscode_list = list() 
for ts_code_sh in daily_20160624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160624_tscode_list.append(stock_name)
daily_20160624_addname_dataframe=pd.DataFrame()
daily_20160624_addname_dataframe['cname'] = daily_20160624_tscode_list
for table_name in daily_20160624.columns.values.tolist():
    daily_20160624_addname_dataframe[table_name] = daily_20160624[table_name]
print("daily_20160624 返回数据 row 行数 = "+str(daily_20160624.shape[0]))
daily_20160624_addname_dataframe.to_excel(daily_201606_excel_writer,'24_5',index=False)
daily_201606_excel_writer.save()
daily_20160625 = pro.daily(start_date='',end_date='',trade_date='20160625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160625_tscode_list = list() 
for ts_code_sh in daily_20160625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160625_tscode_list.append(stock_name)
daily_20160625_addname_dataframe=pd.DataFrame()
daily_20160625_addname_dataframe['cname'] = daily_20160625_tscode_list
for table_name in daily_20160625.columns.values.tolist():
    daily_20160625_addname_dataframe[table_name] = daily_20160625[table_name]
print("daily_20160625 返回数据 row 行数 = "+str(daily_20160625.shape[0]))
daily_20160625_addname_dataframe.to_excel(daily_201606_excel_writer,'25_6',index=False)
daily_201606_excel_writer.save()
daily_20160626 = pro.daily(start_date='',end_date='',trade_date='20160626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160626_tscode_list = list() 
for ts_code_sh in daily_20160626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160626_tscode_list.append(stock_name)
daily_20160626_addname_dataframe=pd.DataFrame()
daily_20160626_addname_dataframe['cname'] = daily_20160626_tscode_list
for table_name in daily_20160626.columns.values.tolist():
    daily_20160626_addname_dataframe[table_name] = daily_20160626[table_name]
print("daily_20160626 返回数据 row 行数 = "+str(daily_20160626.shape[0]))
daily_20160626_addname_dataframe.to_excel(daily_201606_excel_writer,'26_7',index=False)
daily_201606_excel_writer.save()
daily_20160627 = pro.daily(start_date='',end_date='',trade_date='20160627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160627_tscode_list = list() 
for ts_code_sh in daily_20160627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160627_tscode_list.append(stock_name)
daily_20160627_addname_dataframe=pd.DataFrame()
daily_20160627_addname_dataframe['cname'] = daily_20160627_tscode_list
for table_name in daily_20160627.columns.values.tolist():
    daily_20160627_addname_dataframe[table_name] = daily_20160627[table_name]
print("daily_20160627 返回数据 row 行数 = "+str(daily_20160627.shape[0]))
daily_20160627_addname_dataframe.to_excel(daily_201606_excel_writer,'27_1',index=False)
daily_201606_excel_writer.save()
daily_20160628 = pro.daily(start_date='',end_date='',trade_date='20160628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160628_tscode_list = list() 
for ts_code_sh in daily_20160628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160628_tscode_list.append(stock_name)
daily_20160628_addname_dataframe=pd.DataFrame()
daily_20160628_addname_dataframe['cname'] = daily_20160628_tscode_list
for table_name in daily_20160628.columns.values.tolist():
    daily_20160628_addname_dataframe[table_name] = daily_20160628[table_name]
print("daily_20160628 返回数据 row 行数 = "+str(daily_20160628.shape[0]))
daily_20160628_addname_dataframe.to_excel(daily_201606_excel_writer,'28_2',index=False)
daily_201606_excel_writer.save()
daily_20160629 = pro.daily(start_date='',end_date='',trade_date='20160629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160629_tscode_list = list() 
for ts_code_sh in daily_20160629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160629_tscode_list.append(stock_name)
daily_20160629_addname_dataframe=pd.DataFrame()
daily_20160629_addname_dataframe['cname'] = daily_20160629_tscode_list
for table_name in daily_20160629.columns.values.tolist():
    daily_20160629_addname_dataframe[table_name] = daily_20160629[table_name]
print("daily_20160629 返回数据 row 行数 = "+str(daily_20160629.shape[0]))
daily_20160629_addname_dataframe.to_excel(daily_201606_excel_writer,'29_3',index=False)
daily_201606_excel_writer.save()
daily_20160630 = pro.daily(start_date='',end_date='',trade_date='20160630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160630_tscode_list = list() 
for ts_code_sh in daily_20160630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160630_tscode_list.append(stock_name)
daily_20160630_addname_dataframe=pd.DataFrame()
daily_20160630_addname_dataframe['cname'] = daily_20160630_tscode_list
for table_name in daily_20160630.columns.values.tolist():
    daily_20160630_addname_dataframe[table_name] = daily_20160630[table_name]
print("daily_20160630 返回数据 row 行数 = "+str(daily_20160630.shape[0]))
daily_20160630_addname_dataframe.to_excel(daily_201606_excel_writer,'30_4',index=False)
daily_201606_excel_writer.save()




createexcel('daily_201607.xlsx')
daily_201607_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201607.xlsx')
daily_201607_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201607.xlsx', engine='openpyxl')
daily_201607_excel_writer.book = daily_201607_book
daily_201607_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201607_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160701")       ###  更新 记录日期
daily_20160701 = pro.daily(start_date='',end_date='',trade_date='20160701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160701_tscode_list = list() 
for ts_code_sh in daily_20160701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160701_tscode_list.append(stock_name)
daily_20160701_addname_dataframe=pd.DataFrame()
daily_20160701_addname_dataframe['cname'] = daily_20160701_tscode_list
for table_name in daily_20160701.columns.values.tolist():
    daily_20160701_addname_dataframe[table_name] = daily_20160701[table_name]
print("daily_20160701 返回数据 row 行数 = "+str(daily_20160701.shape[0]))
daily_20160701_addname_dataframe.to_excel(daily_201607_excel_writer,'1_5',index=False)
daily_201607_excel_writer.save()
daily_20160702 = pro.daily(start_date='',end_date='',trade_date='20160702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160702_tscode_list = list() 
for ts_code_sh in daily_20160702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160702_tscode_list.append(stock_name)
daily_20160702_addname_dataframe=pd.DataFrame()
daily_20160702_addname_dataframe['cname'] = daily_20160702_tscode_list
for table_name in daily_20160702.columns.values.tolist():
    daily_20160702_addname_dataframe[table_name] = daily_20160702[table_name]
print("daily_20160702 返回数据 row 行数 = "+str(daily_20160702.shape[0]))
daily_20160702_addname_dataframe.to_excel(daily_201607_excel_writer,'2_6',index=False)
daily_201607_excel_writer.save()
daily_20160703 = pro.daily(start_date='',end_date='',trade_date='20160703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160703_tscode_list = list() 
for ts_code_sh in daily_20160703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160703_tscode_list.append(stock_name)
daily_20160703_addname_dataframe=pd.DataFrame()
daily_20160703_addname_dataframe['cname'] = daily_20160703_tscode_list
for table_name in daily_20160703.columns.values.tolist():
    daily_20160703_addname_dataframe[table_name] = daily_20160703[table_name]
print("daily_20160703 返回数据 row 行数 = "+str(daily_20160703.shape[0]))
daily_20160703_addname_dataframe.to_excel(daily_201607_excel_writer,'3_7',index=False)
daily_201607_excel_writer.save()
daily_20160704 = pro.daily(start_date='',end_date='',trade_date='20160704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160704_tscode_list = list() 
for ts_code_sh in daily_20160704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160704_tscode_list.append(stock_name)
daily_20160704_addname_dataframe=pd.DataFrame()
daily_20160704_addname_dataframe['cname'] = daily_20160704_tscode_list
for table_name in daily_20160704.columns.values.tolist():
    daily_20160704_addname_dataframe[table_name] = daily_20160704[table_name]
print("daily_20160704 返回数据 row 行数 = "+str(daily_20160704.shape[0]))
daily_20160704_addname_dataframe.to_excel(daily_201607_excel_writer,'4_1',index=False)
daily_201607_excel_writer.save()
daily_20160705 = pro.daily(start_date='',end_date='',trade_date='20160705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160705_tscode_list = list() 
for ts_code_sh in daily_20160705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160705_tscode_list.append(stock_name)
daily_20160705_addname_dataframe=pd.DataFrame()
daily_20160705_addname_dataframe['cname'] = daily_20160705_tscode_list
for table_name in daily_20160705.columns.values.tolist():
    daily_20160705_addname_dataframe[table_name] = daily_20160705[table_name]
print("daily_20160705 返回数据 row 行数 = "+str(daily_20160705.shape[0]))
daily_20160705_addname_dataframe.to_excel(daily_201607_excel_writer,'5_2',index=False)
daily_201607_excel_writer.save()
daily_20160706 = pro.daily(start_date='',end_date='',trade_date='20160706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160706_tscode_list = list() 
for ts_code_sh in daily_20160706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160706_tscode_list.append(stock_name)
daily_20160706_addname_dataframe=pd.DataFrame()
daily_20160706_addname_dataframe['cname'] = daily_20160706_tscode_list
for table_name in daily_20160706.columns.values.tolist():
    daily_20160706_addname_dataframe[table_name] = daily_20160706[table_name]
print("daily_20160706 返回数据 row 行数 = "+str(daily_20160706.shape[0]))
daily_20160706_addname_dataframe.to_excel(daily_201607_excel_writer,'6_3',index=False)
daily_201607_excel_writer.save()
daily_20160707 = pro.daily(start_date='',end_date='',trade_date='20160707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160707_tscode_list = list() 
for ts_code_sh in daily_20160707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160707_tscode_list.append(stock_name)
daily_20160707_addname_dataframe=pd.DataFrame()
daily_20160707_addname_dataframe['cname'] = daily_20160707_tscode_list
for table_name in daily_20160707.columns.values.tolist():
    daily_20160707_addname_dataframe[table_name] = daily_20160707[table_name]
print("daily_20160707 返回数据 row 行数 = "+str(daily_20160707.shape[0]))
daily_20160707_addname_dataframe.to_excel(daily_201607_excel_writer,'7_4',index=False)
daily_201607_excel_writer.save()
daily_20160708 = pro.daily(start_date='',end_date='',trade_date='20160708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160708_tscode_list = list() 
for ts_code_sh in daily_20160708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160708_tscode_list.append(stock_name)
daily_20160708_addname_dataframe=pd.DataFrame()
daily_20160708_addname_dataframe['cname'] = daily_20160708_tscode_list
for table_name in daily_20160708.columns.values.tolist():
    daily_20160708_addname_dataframe[table_name] = daily_20160708[table_name]
print("daily_20160708 返回数据 row 行数 = "+str(daily_20160708.shape[0]))
daily_20160708_addname_dataframe.to_excel(daily_201607_excel_writer,'8_5',index=False)
daily_201607_excel_writer.save()
daily_20160709 = pro.daily(start_date='',end_date='',trade_date='20160709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160709_tscode_list = list() 
for ts_code_sh in daily_20160709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160709_tscode_list.append(stock_name)
daily_20160709_addname_dataframe=pd.DataFrame()
daily_20160709_addname_dataframe['cname'] = daily_20160709_tscode_list
for table_name in daily_20160709.columns.values.tolist():
    daily_20160709_addname_dataframe[table_name] = daily_20160709[table_name]
print("daily_20160709 返回数据 row 行数 = "+str(daily_20160709.shape[0]))
daily_20160709_addname_dataframe.to_excel(daily_201607_excel_writer,'9_6',index=False)
daily_201607_excel_writer.save()
daily_20160710 = pro.daily(start_date='',end_date='',trade_date='20160710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160710_tscode_list = list() 
for ts_code_sh in daily_20160710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160710_tscode_list.append(stock_name)
daily_20160710_addname_dataframe=pd.DataFrame()
daily_20160710_addname_dataframe['cname'] = daily_20160710_tscode_list
for table_name in daily_20160710.columns.values.tolist():
    daily_20160710_addname_dataframe[table_name] = daily_20160710[table_name]
print("daily_20160710 返回数据 row 行数 = "+str(daily_20160710.shape[0]))
daily_20160710_addname_dataframe.to_excel(daily_201607_excel_writer,'10_7',index=False)
daily_201607_excel_writer.save()
daily_20160711 = pro.daily(start_date='',end_date='',trade_date='20160711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160711_tscode_list = list() 
for ts_code_sh in daily_20160711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160711_tscode_list.append(stock_name)
daily_20160711_addname_dataframe=pd.DataFrame()
daily_20160711_addname_dataframe['cname'] = daily_20160711_tscode_list
for table_name in daily_20160711.columns.values.tolist():
    daily_20160711_addname_dataframe[table_name] = daily_20160711[table_name]
print("daily_20160711 返回数据 row 行数 = "+str(daily_20160711.shape[0]))
daily_20160711_addname_dataframe.to_excel(daily_201607_excel_writer,'11_1',index=False)
daily_201607_excel_writer.save()
daily_20160712 = pro.daily(start_date='',end_date='',trade_date='20160712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160712_tscode_list = list() 
for ts_code_sh in daily_20160712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160712_tscode_list.append(stock_name)
daily_20160712_addname_dataframe=pd.DataFrame()
daily_20160712_addname_dataframe['cname'] = daily_20160712_tscode_list
for table_name in daily_20160712.columns.values.tolist():
    daily_20160712_addname_dataframe[table_name] = daily_20160712[table_name]
print("daily_20160712 返回数据 row 行数 = "+str(daily_20160712.shape[0]))
daily_20160712_addname_dataframe.to_excel(daily_201607_excel_writer,'12_2',index=False)
daily_201607_excel_writer.save()
daily_20160713 = pro.daily(start_date='',end_date='',trade_date='20160713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160713_tscode_list = list() 
for ts_code_sh in daily_20160713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160713_tscode_list.append(stock_name)
daily_20160713_addname_dataframe=pd.DataFrame()
daily_20160713_addname_dataframe['cname'] = daily_20160713_tscode_list
for table_name in daily_20160713.columns.values.tolist():
    daily_20160713_addname_dataframe[table_name] = daily_20160713[table_name]
print("daily_20160713 返回数据 row 行数 = "+str(daily_20160713.shape[0]))
daily_20160713_addname_dataframe.to_excel(daily_201607_excel_writer,'13_3',index=False)
daily_201607_excel_writer.save()
daily_20160714 = pro.daily(start_date='',end_date='',trade_date='20160714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160714_tscode_list = list() 
for ts_code_sh in daily_20160714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160714_tscode_list.append(stock_name)
daily_20160714_addname_dataframe=pd.DataFrame()
daily_20160714_addname_dataframe['cname'] = daily_20160714_tscode_list
for table_name in daily_20160714.columns.values.tolist():
    daily_20160714_addname_dataframe[table_name] = daily_20160714[table_name]
print("daily_20160714 返回数据 row 行数 = "+str(daily_20160714.shape[0]))
daily_20160714_addname_dataframe.to_excel(daily_201607_excel_writer,'14_4',index=False)
daily_201607_excel_writer.save()
daily_20160715 = pro.daily(start_date='',end_date='',trade_date='20160715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160715_tscode_list = list() 
for ts_code_sh in daily_20160715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160715_tscode_list.append(stock_name)
daily_20160715_addname_dataframe=pd.DataFrame()
daily_20160715_addname_dataframe['cname'] = daily_20160715_tscode_list
for table_name in daily_20160715.columns.values.tolist():
    daily_20160715_addname_dataframe[table_name] = daily_20160715[table_name]
print("daily_20160715 返回数据 row 行数 = "+str(daily_20160715.shape[0]))
daily_20160715_addname_dataframe.to_excel(daily_201607_excel_writer,'15_5',index=False)
daily_201607_excel_writer.save()
daily_20160716 = pro.daily(start_date='',end_date='',trade_date='20160716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160716_tscode_list = list() 
for ts_code_sh in daily_20160716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160716_tscode_list.append(stock_name)
daily_20160716_addname_dataframe=pd.DataFrame()
daily_20160716_addname_dataframe['cname'] = daily_20160716_tscode_list
for table_name in daily_20160716.columns.values.tolist():
    daily_20160716_addname_dataframe[table_name] = daily_20160716[table_name]
print("daily_20160716 返回数据 row 行数 = "+str(daily_20160716.shape[0]))
daily_20160716_addname_dataframe.to_excel(daily_201607_excel_writer,'16_6',index=False)
daily_201607_excel_writer.save()
daily_20160717 = pro.daily(start_date='',end_date='',trade_date='20160717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160717_tscode_list = list() 
for ts_code_sh in daily_20160717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160717_tscode_list.append(stock_name)
daily_20160717_addname_dataframe=pd.DataFrame()
daily_20160717_addname_dataframe['cname'] = daily_20160717_tscode_list
for table_name in daily_20160717.columns.values.tolist():
    daily_20160717_addname_dataframe[table_name] = daily_20160717[table_name]
print("daily_20160717 返回数据 row 行数 = "+str(daily_20160717.shape[0]))
daily_20160717_addname_dataframe.to_excel(daily_201607_excel_writer,'17_7',index=False)
daily_201607_excel_writer.save()
daily_20160718 = pro.daily(start_date='',end_date='',trade_date='20160718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160718_tscode_list = list() 
for ts_code_sh in daily_20160718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160718_tscode_list.append(stock_name)
daily_20160718_addname_dataframe=pd.DataFrame()
daily_20160718_addname_dataframe['cname'] = daily_20160718_tscode_list
for table_name in daily_20160718.columns.values.tolist():
    daily_20160718_addname_dataframe[table_name] = daily_20160718[table_name]
print("daily_20160718 返回数据 row 行数 = "+str(daily_20160718.shape[0]))
daily_20160718_addname_dataframe.to_excel(daily_201607_excel_writer,'18_1',index=False)
daily_201607_excel_writer.save()
daily_20160719 = pro.daily(start_date='',end_date='',trade_date='20160719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160719_tscode_list = list() 
for ts_code_sh in daily_20160719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160719_tscode_list.append(stock_name)
daily_20160719_addname_dataframe=pd.DataFrame()
daily_20160719_addname_dataframe['cname'] = daily_20160719_tscode_list
for table_name in daily_20160719.columns.values.tolist():
    daily_20160719_addname_dataframe[table_name] = daily_20160719[table_name]
print("daily_20160719 返回数据 row 行数 = "+str(daily_20160719.shape[0]))
daily_20160719_addname_dataframe.to_excel(daily_201607_excel_writer,'19_2',index=False)
daily_201607_excel_writer.save()
daily_20160720 = pro.daily(start_date='',end_date='',trade_date='20160720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160720_tscode_list = list() 
for ts_code_sh in daily_20160720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160720_tscode_list.append(stock_name)
daily_20160720_addname_dataframe=pd.DataFrame()
daily_20160720_addname_dataframe['cname'] = daily_20160720_tscode_list
for table_name in daily_20160720.columns.values.tolist():
    daily_20160720_addname_dataframe[table_name] = daily_20160720[table_name]
print("daily_20160720 返回数据 row 行数 = "+str(daily_20160720.shape[0]))
daily_20160720_addname_dataframe.to_excel(daily_201607_excel_writer,'20_3',index=False)
daily_201607_excel_writer.save()
daily_20160721 = pro.daily(start_date='',end_date='',trade_date='20160721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160721_tscode_list = list() 
for ts_code_sh in daily_20160721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160721_tscode_list.append(stock_name)
daily_20160721_addname_dataframe=pd.DataFrame()
daily_20160721_addname_dataframe['cname'] = daily_20160721_tscode_list
for table_name in daily_20160721.columns.values.tolist():
    daily_20160721_addname_dataframe[table_name] = daily_20160721[table_name]
print("daily_20160721 返回数据 row 行数 = "+str(daily_20160721.shape[0]))
daily_20160721_addname_dataframe.to_excel(daily_201607_excel_writer,'21_4',index=False)
daily_201607_excel_writer.save()
daily_20160722 = pro.daily(start_date='',end_date='',trade_date='20160722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160722_tscode_list = list() 
for ts_code_sh in daily_20160722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160722_tscode_list.append(stock_name)
daily_20160722_addname_dataframe=pd.DataFrame()
daily_20160722_addname_dataframe['cname'] = daily_20160722_tscode_list
for table_name in daily_20160722.columns.values.tolist():
    daily_20160722_addname_dataframe[table_name] = daily_20160722[table_name]
print("daily_20160722 返回数据 row 行数 = "+str(daily_20160722.shape[0]))
daily_20160722_addname_dataframe.to_excel(daily_201607_excel_writer,'22_5',index=False)
daily_201607_excel_writer.save()
daily_20160723 = pro.daily(start_date='',end_date='',trade_date='20160723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160723_tscode_list = list() 
for ts_code_sh in daily_20160723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160723_tscode_list.append(stock_name)
daily_20160723_addname_dataframe=pd.DataFrame()
daily_20160723_addname_dataframe['cname'] = daily_20160723_tscode_list
for table_name in daily_20160723.columns.values.tolist():
    daily_20160723_addname_dataframe[table_name] = daily_20160723[table_name]
print("daily_20160723 返回数据 row 行数 = "+str(daily_20160723.shape[0]))
daily_20160723_addname_dataframe.to_excel(daily_201607_excel_writer,'23_6',index=False)
daily_201607_excel_writer.save()
daily_20160724 = pro.daily(start_date='',end_date='',trade_date='20160724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160724_tscode_list = list() 
for ts_code_sh in daily_20160724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160724_tscode_list.append(stock_name)
daily_20160724_addname_dataframe=pd.DataFrame()
daily_20160724_addname_dataframe['cname'] = daily_20160724_tscode_list
for table_name in daily_20160724.columns.values.tolist():
    daily_20160724_addname_dataframe[table_name] = daily_20160724[table_name]
print("daily_20160724 返回数据 row 行数 = "+str(daily_20160724.shape[0]))
daily_20160724_addname_dataframe.to_excel(daily_201607_excel_writer,'24_7',index=False)
daily_201607_excel_writer.save()
daily_20160725 = pro.daily(start_date='',end_date='',trade_date='20160725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160725_tscode_list = list() 
for ts_code_sh in daily_20160725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160725_tscode_list.append(stock_name)
daily_20160725_addname_dataframe=pd.DataFrame()
daily_20160725_addname_dataframe['cname'] = daily_20160725_tscode_list
for table_name in daily_20160725.columns.values.tolist():
    daily_20160725_addname_dataframe[table_name] = daily_20160725[table_name]
print("daily_20160725 返回数据 row 行数 = "+str(daily_20160725.shape[0]))
daily_20160725_addname_dataframe.to_excel(daily_201607_excel_writer,'25_1',index=False)
daily_201607_excel_writer.save()
daily_20160726 = pro.daily(start_date='',end_date='',trade_date='20160726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160726_tscode_list = list() 
for ts_code_sh in daily_20160726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160726_tscode_list.append(stock_name)
daily_20160726_addname_dataframe=pd.DataFrame()
daily_20160726_addname_dataframe['cname'] = daily_20160726_tscode_list
for table_name in daily_20160726.columns.values.tolist():
    daily_20160726_addname_dataframe[table_name] = daily_20160726[table_name]
print("daily_20160726 返回数据 row 行数 = "+str(daily_20160726.shape[0]))
daily_20160726_addname_dataframe.to_excel(daily_201607_excel_writer,'26_2',index=False)
daily_201607_excel_writer.save()
daily_20160727 = pro.daily(start_date='',end_date='',trade_date='20160727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160727_tscode_list = list() 
for ts_code_sh in daily_20160727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160727_tscode_list.append(stock_name)
daily_20160727_addname_dataframe=pd.DataFrame()
daily_20160727_addname_dataframe['cname'] = daily_20160727_tscode_list
for table_name in daily_20160727.columns.values.tolist():
    daily_20160727_addname_dataframe[table_name] = daily_20160727[table_name]
print("daily_20160727 返回数据 row 行数 = "+str(daily_20160727.shape[0]))
daily_20160727_addname_dataframe.to_excel(daily_201607_excel_writer,'27_3',index=False)
daily_201607_excel_writer.save()
daily_20160728 = pro.daily(start_date='',end_date='',trade_date='20160728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160728_tscode_list = list() 
for ts_code_sh in daily_20160728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160728_tscode_list.append(stock_name)
daily_20160728_addname_dataframe=pd.DataFrame()
daily_20160728_addname_dataframe['cname'] = daily_20160728_tscode_list
for table_name in daily_20160728.columns.values.tolist():
    daily_20160728_addname_dataframe[table_name] = daily_20160728[table_name]
print("daily_20160728 返回数据 row 行数 = "+str(daily_20160728.shape[0]))
daily_20160728_addname_dataframe.to_excel(daily_201607_excel_writer,'28_4',index=False)
daily_201607_excel_writer.save()
daily_20160729 = pro.daily(start_date='',end_date='',trade_date='20160729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160729_tscode_list = list() 
for ts_code_sh in daily_20160729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160729_tscode_list.append(stock_name)
daily_20160729_addname_dataframe=pd.DataFrame()
daily_20160729_addname_dataframe['cname'] = daily_20160729_tscode_list
for table_name in daily_20160729.columns.values.tolist():
    daily_20160729_addname_dataframe[table_name] = daily_20160729[table_name]
print("daily_20160729 返回数据 row 行数 = "+str(daily_20160729.shape[0]))
daily_20160729_addname_dataframe.to_excel(daily_201607_excel_writer,'29_5',index=False)
daily_201607_excel_writer.save()
daily_20160730 = pro.daily(start_date='',end_date='',trade_date='20160730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160730_tscode_list = list() 
for ts_code_sh in daily_20160730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160730_tscode_list.append(stock_name)
daily_20160730_addname_dataframe=pd.DataFrame()
daily_20160730_addname_dataframe['cname'] = daily_20160730_tscode_list
for table_name in daily_20160730.columns.values.tolist():
    daily_20160730_addname_dataframe[table_name] = daily_20160730[table_name]
print("daily_20160730 返回数据 row 行数 = "+str(daily_20160730.shape[0]))
daily_20160730_addname_dataframe.to_excel(daily_201607_excel_writer,'30_6',index=False)
daily_201607_excel_writer.save()
daily_20160731 = pro.daily(start_date='',end_date='',trade_date='20160731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160731_tscode_list = list() 
for ts_code_sh in daily_20160731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160731_tscode_list.append(stock_name)
daily_20160731_addname_dataframe=pd.DataFrame()
daily_20160731_addname_dataframe['cname'] = daily_20160731_tscode_list
for table_name in daily_20160731.columns.values.tolist():
    daily_20160731_addname_dataframe[table_name] = daily_20160731[table_name]
print("daily_20160731 返回数据 row 行数 = "+str(daily_20160731.shape[0]))
daily_20160731_addname_dataframe.to_excel(daily_201607_excel_writer,'31_7',index=False)
daily_201607_excel_writer.save()




createexcel('daily_201608.xlsx')
daily_201608_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201608.xlsx')
daily_201608_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201608.xlsx', engine='openpyxl')
daily_201608_excel_writer.book = daily_201608_book
daily_201608_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201608_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160801")       ###  更新 记录日期
daily_20160801 = pro.daily(start_date='',end_date='',trade_date='20160801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160801_tscode_list = list() 
for ts_code_sh in daily_20160801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160801_tscode_list.append(stock_name)
daily_20160801_addname_dataframe=pd.DataFrame()
daily_20160801_addname_dataframe['cname'] = daily_20160801_tscode_list
for table_name in daily_20160801.columns.values.tolist():
    daily_20160801_addname_dataframe[table_name] = daily_20160801[table_name]
print("daily_20160801 返回数据 row 行数 = "+str(daily_20160801.shape[0]))
daily_20160801_addname_dataframe.to_excel(daily_201608_excel_writer,'1_1',index=False)
daily_201608_excel_writer.save()
daily_20160802 = pro.daily(start_date='',end_date='',trade_date='20160802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160802_tscode_list = list() 
for ts_code_sh in daily_20160802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160802_tscode_list.append(stock_name)
daily_20160802_addname_dataframe=pd.DataFrame()
daily_20160802_addname_dataframe['cname'] = daily_20160802_tscode_list
for table_name in daily_20160802.columns.values.tolist():
    daily_20160802_addname_dataframe[table_name] = daily_20160802[table_name]
print("daily_20160802 返回数据 row 行数 = "+str(daily_20160802.shape[0]))
daily_20160802_addname_dataframe.to_excel(daily_201608_excel_writer,'2_2',index=False)
daily_201608_excel_writer.save()
daily_20160803 = pro.daily(start_date='',end_date='',trade_date='20160803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160803_tscode_list = list() 
for ts_code_sh in daily_20160803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160803_tscode_list.append(stock_name)
daily_20160803_addname_dataframe=pd.DataFrame()
daily_20160803_addname_dataframe['cname'] = daily_20160803_tscode_list
for table_name in daily_20160803.columns.values.tolist():
    daily_20160803_addname_dataframe[table_name] = daily_20160803[table_name]
print("daily_20160803 返回数据 row 行数 = "+str(daily_20160803.shape[0]))
daily_20160803_addname_dataframe.to_excel(daily_201608_excel_writer,'3_3',index=False)
daily_201608_excel_writer.save()
daily_20160804 = pro.daily(start_date='',end_date='',trade_date='20160804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160804_tscode_list = list() 
for ts_code_sh in daily_20160804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160804_tscode_list.append(stock_name)
daily_20160804_addname_dataframe=pd.DataFrame()
daily_20160804_addname_dataframe['cname'] = daily_20160804_tscode_list
for table_name in daily_20160804.columns.values.tolist():
    daily_20160804_addname_dataframe[table_name] = daily_20160804[table_name]
print("daily_20160804 返回数据 row 行数 = "+str(daily_20160804.shape[0]))
daily_20160804_addname_dataframe.to_excel(daily_201608_excel_writer,'4_4',index=False)
daily_201608_excel_writer.save()
daily_20160805 = pro.daily(start_date='',end_date='',trade_date='20160805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160805_tscode_list = list() 
for ts_code_sh in daily_20160805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160805_tscode_list.append(stock_name)
daily_20160805_addname_dataframe=pd.DataFrame()
daily_20160805_addname_dataframe['cname'] = daily_20160805_tscode_list
for table_name in daily_20160805.columns.values.tolist():
    daily_20160805_addname_dataframe[table_name] = daily_20160805[table_name]
print("daily_20160805 返回数据 row 行数 = "+str(daily_20160805.shape[0]))
daily_20160805_addname_dataframe.to_excel(daily_201608_excel_writer,'5_5',index=False)
daily_201608_excel_writer.save()
daily_20160806 = pro.daily(start_date='',end_date='',trade_date='20160806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160806_tscode_list = list() 
for ts_code_sh in daily_20160806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160806_tscode_list.append(stock_name)
daily_20160806_addname_dataframe=pd.DataFrame()
daily_20160806_addname_dataframe['cname'] = daily_20160806_tscode_list
for table_name in daily_20160806.columns.values.tolist():
    daily_20160806_addname_dataframe[table_name] = daily_20160806[table_name]
print("daily_20160806 返回数据 row 行数 = "+str(daily_20160806.shape[0]))
daily_20160806_addname_dataframe.to_excel(daily_201608_excel_writer,'6_6',index=False)
daily_201608_excel_writer.save()
daily_20160807 = pro.daily(start_date='',end_date='',trade_date='20160807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160807_tscode_list = list() 
for ts_code_sh in daily_20160807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160807_tscode_list.append(stock_name)
daily_20160807_addname_dataframe=pd.DataFrame()
daily_20160807_addname_dataframe['cname'] = daily_20160807_tscode_list
for table_name in daily_20160807.columns.values.tolist():
    daily_20160807_addname_dataframe[table_name] = daily_20160807[table_name]
print("daily_20160807 返回数据 row 行数 = "+str(daily_20160807.shape[0]))
daily_20160807_addname_dataframe.to_excel(daily_201608_excel_writer,'7_7',index=False)
daily_201608_excel_writer.save()
daily_20160808 = pro.daily(start_date='',end_date='',trade_date='20160808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160808_tscode_list = list() 
for ts_code_sh in daily_20160808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160808_tscode_list.append(stock_name)
daily_20160808_addname_dataframe=pd.DataFrame()
daily_20160808_addname_dataframe['cname'] = daily_20160808_tscode_list
for table_name in daily_20160808.columns.values.tolist():
    daily_20160808_addname_dataframe[table_name] = daily_20160808[table_name]
print("daily_20160808 返回数据 row 行数 = "+str(daily_20160808.shape[0]))
daily_20160808_addname_dataframe.to_excel(daily_201608_excel_writer,'8_1',index=False)
daily_201608_excel_writer.save()
daily_20160809 = pro.daily(start_date='',end_date='',trade_date='20160809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160809_tscode_list = list() 
for ts_code_sh in daily_20160809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160809_tscode_list.append(stock_name)
daily_20160809_addname_dataframe=pd.DataFrame()
daily_20160809_addname_dataframe['cname'] = daily_20160809_tscode_list
for table_name in daily_20160809.columns.values.tolist():
    daily_20160809_addname_dataframe[table_name] = daily_20160809[table_name]
print("daily_20160809 返回数据 row 行数 = "+str(daily_20160809.shape[0]))
daily_20160809_addname_dataframe.to_excel(daily_201608_excel_writer,'9_2',index=False)
daily_201608_excel_writer.save()
daily_20160810 = pro.daily(start_date='',end_date='',trade_date='20160810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160810_tscode_list = list() 
for ts_code_sh in daily_20160810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160810_tscode_list.append(stock_name)
daily_20160810_addname_dataframe=pd.DataFrame()
daily_20160810_addname_dataframe['cname'] = daily_20160810_tscode_list
for table_name in daily_20160810.columns.values.tolist():
    daily_20160810_addname_dataframe[table_name] = daily_20160810[table_name]
print("daily_20160810 返回数据 row 行数 = "+str(daily_20160810.shape[0]))
daily_20160810_addname_dataframe.to_excel(daily_201608_excel_writer,'10_3',index=False)
daily_201608_excel_writer.save()
daily_20160811 = pro.daily(start_date='',end_date='',trade_date='20160811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160811_tscode_list = list() 
for ts_code_sh in daily_20160811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160811_tscode_list.append(stock_name)
daily_20160811_addname_dataframe=pd.DataFrame()
daily_20160811_addname_dataframe['cname'] = daily_20160811_tscode_list
for table_name in daily_20160811.columns.values.tolist():
    daily_20160811_addname_dataframe[table_name] = daily_20160811[table_name]
print("daily_20160811 返回数据 row 行数 = "+str(daily_20160811.shape[0]))
daily_20160811_addname_dataframe.to_excel(daily_201608_excel_writer,'11_4',index=False)
daily_201608_excel_writer.save()
daily_20160812 = pro.daily(start_date='',end_date='',trade_date='20160812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160812_tscode_list = list() 
for ts_code_sh in daily_20160812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160812_tscode_list.append(stock_name)
daily_20160812_addname_dataframe=pd.DataFrame()
daily_20160812_addname_dataframe['cname'] = daily_20160812_tscode_list
for table_name in daily_20160812.columns.values.tolist():
    daily_20160812_addname_dataframe[table_name] = daily_20160812[table_name]
print("daily_20160812 返回数据 row 行数 = "+str(daily_20160812.shape[0]))
daily_20160812_addname_dataframe.to_excel(daily_201608_excel_writer,'12_5',index=False)
daily_201608_excel_writer.save()
daily_20160813 = pro.daily(start_date='',end_date='',trade_date='20160813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160813_tscode_list = list() 
for ts_code_sh in daily_20160813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160813_tscode_list.append(stock_name)
daily_20160813_addname_dataframe=pd.DataFrame()
daily_20160813_addname_dataframe['cname'] = daily_20160813_tscode_list
for table_name in daily_20160813.columns.values.tolist():
    daily_20160813_addname_dataframe[table_name] = daily_20160813[table_name]
print("daily_20160813 返回数据 row 行数 = "+str(daily_20160813.shape[0]))
daily_20160813_addname_dataframe.to_excel(daily_201608_excel_writer,'13_6',index=False)
daily_201608_excel_writer.save()
daily_20160814 = pro.daily(start_date='',end_date='',trade_date='20160814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160814_tscode_list = list() 
for ts_code_sh in daily_20160814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160814_tscode_list.append(stock_name)
daily_20160814_addname_dataframe=pd.DataFrame()
daily_20160814_addname_dataframe['cname'] = daily_20160814_tscode_list
for table_name in daily_20160814.columns.values.tolist():
    daily_20160814_addname_dataframe[table_name] = daily_20160814[table_name]
print("daily_20160814 返回数据 row 行数 = "+str(daily_20160814.shape[0]))
daily_20160814_addname_dataframe.to_excel(daily_201608_excel_writer,'14_7',index=False)
daily_201608_excel_writer.save()
daily_20160815 = pro.daily(start_date='',end_date='',trade_date='20160815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160815_tscode_list = list() 
for ts_code_sh in daily_20160815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160815_tscode_list.append(stock_name)
daily_20160815_addname_dataframe=pd.DataFrame()
daily_20160815_addname_dataframe['cname'] = daily_20160815_tscode_list
for table_name in daily_20160815.columns.values.tolist():
    daily_20160815_addname_dataframe[table_name] = daily_20160815[table_name]
print("daily_20160815 返回数据 row 行数 = "+str(daily_20160815.shape[0]))
daily_20160815_addname_dataframe.to_excel(daily_201608_excel_writer,'15_1',index=False)
daily_201608_excel_writer.save()
daily_20160816 = pro.daily(start_date='',end_date='',trade_date='20160816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160816_tscode_list = list() 
for ts_code_sh in daily_20160816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160816_tscode_list.append(stock_name)
daily_20160816_addname_dataframe=pd.DataFrame()
daily_20160816_addname_dataframe['cname'] = daily_20160816_tscode_list
for table_name in daily_20160816.columns.values.tolist():
    daily_20160816_addname_dataframe[table_name] = daily_20160816[table_name]
print("daily_20160816 返回数据 row 行数 = "+str(daily_20160816.shape[0]))
daily_20160816_addname_dataframe.to_excel(daily_201608_excel_writer,'16_2',index=False)
daily_201608_excel_writer.save()
daily_20160817 = pro.daily(start_date='',end_date='',trade_date='20160817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160817_tscode_list = list() 
for ts_code_sh in daily_20160817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160817_tscode_list.append(stock_name)
daily_20160817_addname_dataframe=pd.DataFrame()
daily_20160817_addname_dataframe['cname'] = daily_20160817_tscode_list
for table_name in daily_20160817.columns.values.tolist():
    daily_20160817_addname_dataframe[table_name] = daily_20160817[table_name]
print("daily_20160817 返回数据 row 行数 = "+str(daily_20160817.shape[0]))
daily_20160817_addname_dataframe.to_excel(daily_201608_excel_writer,'17_3',index=False)
daily_201608_excel_writer.save()
daily_20160818 = pro.daily(start_date='',end_date='',trade_date='20160818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160818_tscode_list = list() 
for ts_code_sh in daily_20160818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160818_tscode_list.append(stock_name)
daily_20160818_addname_dataframe=pd.DataFrame()
daily_20160818_addname_dataframe['cname'] = daily_20160818_tscode_list
for table_name in daily_20160818.columns.values.tolist():
    daily_20160818_addname_dataframe[table_name] = daily_20160818[table_name]
print("daily_20160818 返回数据 row 行数 = "+str(daily_20160818.shape[0]))
daily_20160818_addname_dataframe.to_excel(daily_201608_excel_writer,'18_4',index=False)
daily_201608_excel_writer.save()
daily_20160819 = pro.daily(start_date='',end_date='',trade_date='20160819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160819_tscode_list = list() 
for ts_code_sh in daily_20160819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160819_tscode_list.append(stock_name)
daily_20160819_addname_dataframe=pd.DataFrame()
daily_20160819_addname_dataframe['cname'] = daily_20160819_tscode_list
for table_name in daily_20160819.columns.values.tolist():
    daily_20160819_addname_dataframe[table_name] = daily_20160819[table_name]
print("daily_20160819 返回数据 row 行数 = "+str(daily_20160819.shape[0]))
daily_20160819_addname_dataframe.to_excel(daily_201608_excel_writer,'19_5',index=False)
daily_201608_excel_writer.save()
daily_20160820 = pro.daily(start_date='',end_date='',trade_date='20160820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160820_tscode_list = list() 
for ts_code_sh in daily_20160820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160820_tscode_list.append(stock_name)
daily_20160820_addname_dataframe=pd.DataFrame()
daily_20160820_addname_dataframe['cname'] = daily_20160820_tscode_list
for table_name in daily_20160820.columns.values.tolist():
    daily_20160820_addname_dataframe[table_name] = daily_20160820[table_name]
print("daily_20160820 返回数据 row 行数 = "+str(daily_20160820.shape[0]))
daily_20160820_addname_dataframe.to_excel(daily_201608_excel_writer,'20_6',index=False)
daily_201608_excel_writer.save()
daily_20160821 = pro.daily(start_date='',end_date='',trade_date='20160821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160821_tscode_list = list() 
for ts_code_sh in daily_20160821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160821_tscode_list.append(stock_name)
daily_20160821_addname_dataframe=pd.DataFrame()
daily_20160821_addname_dataframe['cname'] = daily_20160821_tscode_list
for table_name in daily_20160821.columns.values.tolist():
    daily_20160821_addname_dataframe[table_name] = daily_20160821[table_name]
print("daily_20160821 返回数据 row 行数 = "+str(daily_20160821.shape[0]))
daily_20160821_addname_dataframe.to_excel(daily_201608_excel_writer,'21_7',index=False)
daily_201608_excel_writer.save()
daily_20160822 = pro.daily(start_date='',end_date='',trade_date='20160822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160822_tscode_list = list() 
for ts_code_sh in daily_20160822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160822_tscode_list.append(stock_name)
daily_20160822_addname_dataframe=pd.DataFrame()
daily_20160822_addname_dataframe['cname'] = daily_20160822_tscode_list
for table_name in daily_20160822.columns.values.tolist():
    daily_20160822_addname_dataframe[table_name] = daily_20160822[table_name]
print("daily_20160822 返回数据 row 行数 = "+str(daily_20160822.shape[0]))
daily_20160822_addname_dataframe.to_excel(daily_201608_excel_writer,'22_1',index=False)
daily_201608_excel_writer.save()
daily_20160823 = pro.daily(start_date='',end_date='',trade_date='20160823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160823_tscode_list = list() 
for ts_code_sh in daily_20160823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160823_tscode_list.append(stock_name)
daily_20160823_addname_dataframe=pd.DataFrame()
daily_20160823_addname_dataframe['cname'] = daily_20160823_tscode_list
for table_name in daily_20160823.columns.values.tolist():
    daily_20160823_addname_dataframe[table_name] = daily_20160823[table_name]
print("daily_20160823 返回数据 row 行数 = "+str(daily_20160823.shape[0]))
daily_20160823_addname_dataframe.to_excel(daily_201608_excel_writer,'23_2',index=False)
daily_201608_excel_writer.save()
daily_20160824 = pro.daily(start_date='',end_date='',trade_date='20160824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160824_tscode_list = list() 
for ts_code_sh in daily_20160824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160824_tscode_list.append(stock_name)
daily_20160824_addname_dataframe=pd.DataFrame()
daily_20160824_addname_dataframe['cname'] = daily_20160824_tscode_list
for table_name in daily_20160824.columns.values.tolist():
    daily_20160824_addname_dataframe[table_name] = daily_20160824[table_name]
print("daily_20160824 返回数据 row 行数 = "+str(daily_20160824.shape[0]))
daily_20160824_addname_dataframe.to_excel(daily_201608_excel_writer,'24_3',index=False)
daily_201608_excel_writer.save()
daily_20160825 = pro.daily(start_date='',end_date='',trade_date='20160825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160825_tscode_list = list() 
for ts_code_sh in daily_20160825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160825_tscode_list.append(stock_name)
daily_20160825_addname_dataframe=pd.DataFrame()
daily_20160825_addname_dataframe['cname'] = daily_20160825_tscode_list
for table_name in daily_20160825.columns.values.tolist():
    daily_20160825_addname_dataframe[table_name] = daily_20160825[table_name]
print("daily_20160825 返回数据 row 行数 = "+str(daily_20160825.shape[0]))
daily_20160825_addname_dataframe.to_excel(daily_201608_excel_writer,'25_4',index=False)
daily_201608_excel_writer.save()
daily_20160826 = pro.daily(start_date='',end_date='',trade_date='20160826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160826_tscode_list = list() 
for ts_code_sh in daily_20160826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160826_tscode_list.append(stock_name)
daily_20160826_addname_dataframe=pd.DataFrame()
daily_20160826_addname_dataframe['cname'] = daily_20160826_tscode_list
for table_name in daily_20160826.columns.values.tolist():
    daily_20160826_addname_dataframe[table_name] = daily_20160826[table_name]
print("daily_20160826 返回数据 row 行数 = "+str(daily_20160826.shape[0]))
daily_20160826_addname_dataframe.to_excel(daily_201608_excel_writer,'26_5',index=False)
daily_201608_excel_writer.save()
daily_20160827 = pro.daily(start_date='',end_date='',trade_date='20160827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160827_tscode_list = list() 
for ts_code_sh in daily_20160827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160827_tscode_list.append(stock_name)
daily_20160827_addname_dataframe=pd.DataFrame()
daily_20160827_addname_dataframe['cname'] = daily_20160827_tscode_list
for table_name in daily_20160827.columns.values.tolist():
    daily_20160827_addname_dataframe[table_name] = daily_20160827[table_name]
print("daily_20160827 返回数据 row 行数 = "+str(daily_20160827.shape[0]))
daily_20160827_addname_dataframe.to_excel(daily_201608_excel_writer,'27_6',index=False)
daily_201608_excel_writer.save()
daily_20160828 = pro.daily(start_date='',end_date='',trade_date='20160828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160828_tscode_list = list() 
for ts_code_sh in daily_20160828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160828_tscode_list.append(stock_name)
daily_20160828_addname_dataframe=pd.DataFrame()
daily_20160828_addname_dataframe['cname'] = daily_20160828_tscode_list
for table_name in daily_20160828.columns.values.tolist():
    daily_20160828_addname_dataframe[table_name] = daily_20160828[table_name]
print("daily_20160828 返回数据 row 行数 = "+str(daily_20160828.shape[0]))
daily_20160828_addname_dataframe.to_excel(daily_201608_excel_writer,'28_7',index=False)
daily_201608_excel_writer.save()
daily_20160829 = pro.daily(start_date='',end_date='',trade_date='20160829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160829_tscode_list = list() 
for ts_code_sh in daily_20160829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160829_tscode_list.append(stock_name)
daily_20160829_addname_dataframe=pd.DataFrame()
daily_20160829_addname_dataframe['cname'] = daily_20160829_tscode_list
for table_name in daily_20160829.columns.values.tolist():
    daily_20160829_addname_dataframe[table_name] = daily_20160829[table_name]
print("daily_20160829 返回数据 row 行数 = "+str(daily_20160829.shape[0]))
daily_20160829_addname_dataframe.to_excel(daily_201608_excel_writer,'29_1',index=False)
daily_201608_excel_writer.save()
daily_20160830 = pro.daily(start_date='',end_date='',trade_date='20160830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160830_tscode_list = list() 
for ts_code_sh in daily_20160830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160830_tscode_list.append(stock_name)
daily_20160830_addname_dataframe=pd.DataFrame()
daily_20160830_addname_dataframe['cname'] = daily_20160830_tscode_list
for table_name in daily_20160830.columns.values.tolist():
    daily_20160830_addname_dataframe[table_name] = daily_20160830[table_name]
print("daily_20160830 返回数据 row 行数 = "+str(daily_20160830.shape[0]))
daily_20160830_addname_dataframe.to_excel(daily_201608_excel_writer,'30_2',index=False)
daily_201608_excel_writer.save()
daily_20160831 = pro.daily(start_date='',end_date='',trade_date='20160831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160831_tscode_list = list() 
for ts_code_sh in daily_20160831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160831_tscode_list.append(stock_name)
daily_20160831_addname_dataframe=pd.DataFrame()
daily_20160831_addname_dataframe['cname'] = daily_20160831_tscode_list
for table_name in daily_20160831.columns.values.tolist():
    daily_20160831_addname_dataframe[table_name] = daily_20160831[table_name]
print("daily_20160831 返回数据 row 行数 = "+str(daily_20160831.shape[0]))
daily_20160831_addname_dataframe.to_excel(daily_201608_excel_writer,'31_3',index=False)
daily_201608_excel_writer.save()




createexcel('daily_201609.xlsx')
daily_201609_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201609.xlsx')
daily_201609_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201609.xlsx', engine='openpyxl')
daily_201609_excel_writer.book = daily_201609_book
daily_201609_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201609_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160901")       ###  更新 记录日期
daily_20160901 = pro.daily(start_date='',end_date='',trade_date='20160901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160901_tscode_list = list() 
for ts_code_sh in daily_20160901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160901_tscode_list.append(stock_name)
daily_20160901_addname_dataframe=pd.DataFrame()
daily_20160901_addname_dataframe['cname'] = daily_20160901_tscode_list
for table_name in daily_20160901.columns.values.tolist():
    daily_20160901_addname_dataframe[table_name] = daily_20160901[table_name]
print("daily_20160901 返回数据 row 行数 = "+str(daily_20160901.shape[0]))
daily_20160901_addname_dataframe.to_excel(daily_201609_excel_writer,'1_4',index=False)
daily_201609_excel_writer.save()
daily_20160902 = pro.daily(start_date='',end_date='',trade_date='20160902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160902_tscode_list = list() 
for ts_code_sh in daily_20160902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160902_tscode_list.append(stock_name)
daily_20160902_addname_dataframe=pd.DataFrame()
daily_20160902_addname_dataframe['cname'] = daily_20160902_tscode_list
for table_name in daily_20160902.columns.values.tolist():
    daily_20160902_addname_dataframe[table_name] = daily_20160902[table_name]
print("daily_20160902 返回数据 row 行数 = "+str(daily_20160902.shape[0]))
daily_20160902_addname_dataframe.to_excel(daily_201609_excel_writer,'2_5',index=False)
daily_201609_excel_writer.save()
daily_20160903 = pro.daily(start_date='',end_date='',trade_date='20160903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160903_tscode_list = list() 
for ts_code_sh in daily_20160903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160903_tscode_list.append(stock_name)
daily_20160903_addname_dataframe=pd.DataFrame()
daily_20160903_addname_dataframe['cname'] = daily_20160903_tscode_list
for table_name in daily_20160903.columns.values.tolist():
    daily_20160903_addname_dataframe[table_name] = daily_20160903[table_name]
print("daily_20160903 返回数据 row 行数 = "+str(daily_20160903.shape[0]))
daily_20160903_addname_dataframe.to_excel(daily_201609_excel_writer,'3_6',index=False)
daily_201609_excel_writer.save()
daily_20160904 = pro.daily(start_date='',end_date='',trade_date='20160904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160904_tscode_list = list() 
for ts_code_sh in daily_20160904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160904_tscode_list.append(stock_name)
daily_20160904_addname_dataframe=pd.DataFrame()
daily_20160904_addname_dataframe['cname'] = daily_20160904_tscode_list
for table_name in daily_20160904.columns.values.tolist():
    daily_20160904_addname_dataframe[table_name] = daily_20160904[table_name]
print("daily_20160904 返回数据 row 行数 = "+str(daily_20160904.shape[0]))
daily_20160904_addname_dataframe.to_excel(daily_201609_excel_writer,'4_7',index=False)
daily_201609_excel_writer.save()
daily_20160905 = pro.daily(start_date='',end_date='',trade_date='20160905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160905_tscode_list = list() 
for ts_code_sh in daily_20160905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160905_tscode_list.append(stock_name)
daily_20160905_addname_dataframe=pd.DataFrame()
daily_20160905_addname_dataframe['cname'] = daily_20160905_tscode_list
for table_name in daily_20160905.columns.values.tolist():
    daily_20160905_addname_dataframe[table_name] = daily_20160905[table_name]
print("daily_20160905 返回数据 row 行数 = "+str(daily_20160905.shape[0]))
daily_20160905_addname_dataframe.to_excel(daily_201609_excel_writer,'5_1',index=False)
daily_201609_excel_writer.save()
daily_20160906 = pro.daily(start_date='',end_date='',trade_date='20160906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160906_tscode_list = list() 
for ts_code_sh in daily_20160906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160906_tscode_list.append(stock_name)
daily_20160906_addname_dataframe=pd.DataFrame()
daily_20160906_addname_dataframe['cname'] = daily_20160906_tscode_list
for table_name in daily_20160906.columns.values.tolist():
    daily_20160906_addname_dataframe[table_name] = daily_20160906[table_name]
print("daily_20160906 返回数据 row 行数 = "+str(daily_20160906.shape[0]))
daily_20160906_addname_dataframe.to_excel(daily_201609_excel_writer,'6_2',index=False)
daily_201609_excel_writer.save()
daily_20160907 = pro.daily(start_date='',end_date='',trade_date='20160907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160907_tscode_list = list() 
for ts_code_sh in daily_20160907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160907_tscode_list.append(stock_name)
daily_20160907_addname_dataframe=pd.DataFrame()
daily_20160907_addname_dataframe['cname'] = daily_20160907_tscode_list
for table_name in daily_20160907.columns.values.tolist():
    daily_20160907_addname_dataframe[table_name] = daily_20160907[table_name]
print("daily_20160907 返回数据 row 行数 = "+str(daily_20160907.shape[0]))
daily_20160907_addname_dataframe.to_excel(daily_201609_excel_writer,'7_3',index=False)
daily_201609_excel_writer.save()
daily_20160908 = pro.daily(start_date='',end_date='',trade_date='20160908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160908_tscode_list = list() 
for ts_code_sh in daily_20160908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160908_tscode_list.append(stock_name)
daily_20160908_addname_dataframe=pd.DataFrame()
daily_20160908_addname_dataframe['cname'] = daily_20160908_tscode_list
for table_name in daily_20160908.columns.values.tolist():
    daily_20160908_addname_dataframe[table_name] = daily_20160908[table_name]
print("daily_20160908 返回数据 row 行数 = "+str(daily_20160908.shape[0]))
daily_20160908_addname_dataframe.to_excel(daily_201609_excel_writer,'8_4',index=False)
daily_201609_excel_writer.save()
daily_20160909 = pro.daily(start_date='',end_date='',trade_date='20160909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160909_tscode_list = list() 
for ts_code_sh in daily_20160909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160909_tscode_list.append(stock_name)
daily_20160909_addname_dataframe=pd.DataFrame()
daily_20160909_addname_dataframe['cname'] = daily_20160909_tscode_list
for table_name in daily_20160909.columns.values.tolist():
    daily_20160909_addname_dataframe[table_name] = daily_20160909[table_name]
print("daily_20160909 返回数据 row 行数 = "+str(daily_20160909.shape[0]))
daily_20160909_addname_dataframe.to_excel(daily_201609_excel_writer,'9_5',index=False)
daily_201609_excel_writer.save()
daily_20160910 = pro.daily(start_date='',end_date='',trade_date='20160910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160910_tscode_list = list() 
for ts_code_sh in daily_20160910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160910_tscode_list.append(stock_name)
daily_20160910_addname_dataframe=pd.DataFrame()
daily_20160910_addname_dataframe['cname'] = daily_20160910_tscode_list
for table_name in daily_20160910.columns.values.tolist():
    daily_20160910_addname_dataframe[table_name] = daily_20160910[table_name]
print("daily_20160910 返回数据 row 行数 = "+str(daily_20160910.shape[0]))
daily_20160910_addname_dataframe.to_excel(daily_201609_excel_writer,'10_6',index=False)
daily_201609_excel_writer.save()
daily_20160911 = pro.daily(start_date='',end_date='',trade_date='20160911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160911_tscode_list = list() 
for ts_code_sh in daily_20160911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160911_tscode_list.append(stock_name)
daily_20160911_addname_dataframe=pd.DataFrame()
daily_20160911_addname_dataframe['cname'] = daily_20160911_tscode_list
for table_name in daily_20160911.columns.values.tolist():
    daily_20160911_addname_dataframe[table_name] = daily_20160911[table_name]
print("daily_20160911 返回数据 row 行数 = "+str(daily_20160911.shape[0]))
daily_20160911_addname_dataframe.to_excel(daily_201609_excel_writer,'11_7',index=False)
daily_201609_excel_writer.save()
daily_20160912 = pro.daily(start_date='',end_date='',trade_date='20160912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160912_tscode_list = list() 
for ts_code_sh in daily_20160912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160912_tscode_list.append(stock_name)
daily_20160912_addname_dataframe=pd.DataFrame()
daily_20160912_addname_dataframe['cname'] = daily_20160912_tscode_list
for table_name in daily_20160912.columns.values.tolist():
    daily_20160912_addname_dataframe[table_name] = daily_20160912[table_name]
print("daily_20160912 返回数据 row 行数 = "+str(daily_20160912.shape[0]))
daily_20160912_addname_dataframe.to_excel(daily_201609_excel_writer,'12_1',index=False)
daily_201609_excel_writer.save()
daily_20160913 = pro.daily(start_date='',end_date='',trade_date='20160913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160913_tscode_list = list() 
for ts_code_sh in daily_20160913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160913_tscode_list.append(stock_name)
daily_20160913_addname_dataframe=pd.DataFrame()
daily_20160913_addname_dataframe['cname'] = daily_20160913_tscode_list
for table_name in daily_20160913.columns.values.tolist():
    daily_20160913_addname_dataframe[table_name] = daily_20160913[table_name]
print("daily_20160913 返回数据 row 行数 = "+str(daily_20160913.shape[0]))
daily_20160913_addname_dataframe.to_excel(daily_201609_excel_writer,'13_2',index=False)
daily_201609_excel_writer.save()
daily_20160914 = pro.daily(start_date='',end_date='',trade_date='20160914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160914_tscode_list = list() 
for ts_code_sh in daily_20160914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160914_tscode_list.append(stock_name)
daily_20160914_addname_dataframe=pd.DataFrame()
daily_20160914_addname_dataframe['cname'] = daily_20160914_tscode_list
for table_name in daily_20160914.columns.values.tolist():
    daily_20160914_addname_dataframe[table_name] = daily_20160914[table_name]
print("daily_20160914 返回数据 row 行数 = "+str(daily_20160914.shape[0]))
daily_20160914_addname_dataframe.to_excel(daily_201609_excel_writer,'14_3',index=False)
daily_201609_excel_writer.save()
daily_20160915 = pro.daily(start_date='',end_date='',trade_date='20160915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160915_tscode_list = list() 
for ts_code_sh in daily_20160915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160915_tscode_list.append(stock_name)
daily_20160915_addname_dataframe=pd.DataFrame()
daily_20160915_addname_dataframe['cname'] = daily_20160915_tscode_list
for table_name in daily_20160915.columns.values.tolist():
    daily_20160915_addname_dataframe[table_name] = daily_20160915[table_name]
print("daily_20160915 返回数据 row 行数 = "+str(daily_20160915.shape[0]))
daily_20160915_addname_dataframe.to_excel(daily_201609_excel_writer,'15_4',index=False)
daily_201609_excel_writer.save()
daily_20160916 = pro.daily(start_date='',end_date='',trade_date='20160916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160916_tscode_list = list() 
for ts_code_sh in daily_20160916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160916_tscode_list.append(stock_name)
daily_20160916_addname_dataframe=pd.DataFrame()
daily_20160916_addname_dataframe['cname'] = daily_20160916_tscode_list
for table_name in daily_20160916.columns.values.tolist():
    daily_20160916_addname_dataframe[table_name] = daily_20160916[table_name]
print("daily_20160916 返回数据 row 行数 = "+str(daily_20160916.shape[0]))
daily_20160916_addname_dataframe.to_excel(daily_201609_excel_writer,'16_5',index=False)
daily_201609_excel_writer.save()
daily_20160917 = pro.daily(start_date='',end_date='',trade_date='20160917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160917_tscode_list = list() 
for ts_code_sh in daily_20160917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160917_tscode_list.append(stock_name)
daily_20160917_addname_dataframe=pd.DataFrame()
daily_20160917_addname_dataframe['cname'] = daily_20160917_tscode_list
for table_name in daily_20160917.columns.values.tolist():
    daily_20160917_addname_dataframe[table_name] = daily_20160917[table_name]
print("daily_20160917 返回数据 row 行数 = "+str(daily_20160917.shape[0]))
daily_20160917_addname_dataframe.to_excel(daily_201609_excel_writer,'17_6',index=False)
daily_201609_excel_writer.save()
daily_20160918 = pro.daily(start_date='',end_date='',trade_date='20160918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160918_tscode_list = list() 
for ts_code_sh in daily_20160918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160918_tscode_list.append(stock_name)
daily_20160918_addname_dataframe=pd.DataFrame()
daily_20160918_addname_dataframe['cname'] = daily_20160918_tscode_list
for table_name in daily_20160918.columns.values.tolist():
    daily_20160918_addname_dataframe[table_name] = daily_20160918[table_name]
print("daily_20160918 返回数据 row 行数 = "+str(daily_20160918.shape[0]))
daily_20160918_addname_dataframe.to_excel(daily_201609_excel_writer,'18_7',index=False)
daily_201609_excel_writer.save()
daily_20160919 = pro.daily(start_date='',end_date='',trade_date='20160919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160919_tscode_list = list() 
for ts_code_sh in daily_20160919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160919_tscode_list.append(stock_name)
daily_20160919_addname_dataframe=pd.DataFrame()
daily_20160919_addname_dataframe['cname'] = daily_20160919_tscode_list
for table_name in daily_20160919.columns.values.tolist():
    daily_20160919_addname_dataframe[table_name] = daily_20160919[table_name]
print("daily_20160919 返回数据 row 行数 = "+str(daily_20160919.shape[0]))
daily_20160919_addname_dataframe.to_excel(daily_201609_excel_writer,'19_1',index=False)
daily_201609_excel_writer.save()
daily_20160920 = pro.daily(start_date='',end_date='',trade_date='20160920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160920_tscode_list = list() 
for ts_code_sh in daily_20160920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160920_tscode_list.append(stock_name)
daily_20160920_addname_dataframe=pd.DataFrame()
daily_20160920_addname_dataframe['cname'] = daily_20160920_tscode_list
for table_name in daily_20160920.columns.values.tolist():
    daily_20160920_addname_dataframe[table_name] = daily_20160920[table_name]
print("daily_20160920 返回数据 row 行数 = "+str(daily_20160920.shape[0]))
daily_20160920_addname_dataframe.to_excel(daily_201609_excel_writer,'20_2',index=False)
daily_201609_excel_writer.save()
daily_20160921 = pro.daily(start_date='',end_date='',trade_date='20160921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160921_tscode_list = list() 
for ts_code_sh in daily_20160921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160921_tscode_list.append(stock_name)
daily_20160921_addname_dataframe=pd.DataFrame()
daily_20160921_addname_dataframe['cname'] = daily_20160921_tscode_list
for table_name in daily_20160921.columns.values.tolist():
    daily_20160921_addname_dataframe[table_name] = daily_20160921[table_name]
print("daily_20160921 返回数据 row 行数 = "+str(daily_20160921.shape[0]))
daily_20160921_addname_dataframe.to_excel(daily_201609_excel_writer,'21_3',index=False)
daily_201609_excel_writer.save()
daily_20160922 = pro.daily(start_date='',end_date='',trade_date='20160922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160922_tscode_list = list() 
for ts_code_sh in daily_20160922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160922_tscode_list.append(stock_name)
daily_20160922_addname_dataframe=pd.DataFrame()
daily_20160922_addname_dataframe['cname'] = daily_20160922_tscode_list
for table_name in daily_20160922.columns.values.tolist():
    daily_20160922_addname_dataframe[table_name] = daily_20160922[table_name]
print("daily_20160922 返回数据 row 行数 = "+str(daily_20160922.shape[0]))
daily_20160922_addname_dataframe.to_excel(daily_201609_excel_writer,'22_4',index=False)
daily_201609_excel_writer.save()
daily_20160923 = pro.daily(start_date='',end_date='',trade_date='20160923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160923_tscode_list = list() 
for ts_code_sh in daily_20160923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160923_tscode_list.append(stock_name)
daily_20160923_addname_dataframe=pd.DataFrame()
daily_20160923_addname_dataframe['cname'] = daily_20160923_tscode_list
for table_name in daily_20160923.columns.values.tolist():
    daily_20160923_addname_dataframe[table_name] = daily_20160923[table_name]
print("daily_20160923 返回数据 row 行数 = "+str(daily_20160923.shape[0]))
daily_20160923_addname_dataframe.to_excel(daily_201609_excel_writer,'23_5',index=False)
daily_201609_excel_writer.save()
daily_20160924 = pro.daily(start_date='',end_date='',trade_date='20160924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160924_tscode_list = list() 
for ts_code_sh in daily_20160924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160924_tscode_list.append(stock_name)
daily_20160924_addname_dataframe=pd.DataFrame()
daily_20160924_addname_dataframe['cname'] = daily_20160924_tscode_list
for table_name in daily_20160924.columns.values.tolist():
    daily_20160924_addname_dataframe[table_name] = daily_20160924[table_name]
print("daily_20160924 返回数据 row 行数 = "+str(daily_20160924.shape[0]))
daily_20160924_addname_dataframe.to_excel(daily_201609_excel_writer,'24_6',index=False)
daily_201609_excel_writer.save()
daily_20160925 = pro.daily(start_date='',end_date='',trade_date='20160925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160925_tscode_list = list() 
for ts_code_sh in daily_20160925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160925_tscode_list.append(stock_name)
daily_20160925_addname_dataframe=pd.DataFrame()
daily_20160925_addname_dataframe['cname'] = daily_20160925_tscode_list
for table_name in daily_20160925.columns.values.tolist():
    daily_20160925_addname_dataframe[table_name] = daily_20160925[table_name]
print("daily_20160925 返回数据 row 行数 = "+str(daily_20160925.shape[0]))
daily_20160925_addname_dataframe.to_excel(daily_201609_excel_writer,'25_7',index=False)
daily_201609_excel_writer.save()
daily_20160926 = pro.daily(start_date='',end_date='',trade_date='20160926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160926_tscode_list = list() 
for ts_code_sh in daily_20160926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160926_tscode_list.append(stock_name)
daily_20160926_addname_dataframe=pd.DataFrame()
daily_20160926_addname_dataframe['cname'] = daily_20160926_tscode_list
for table_name in daily_20160926.columns.values.tolist():
    daily_20160926_addname_dataframe[table_name] = daily_20160926[table_name]
print("daily_20160926 返回数据 row 行数 = "+str(daily_20160926.shape[0]))
daily_20160926_addname_dataframe.to_excel(daily_201609_excel_writer,'26_1',index=False)
daily_201609_excel_writer.save()
daily_20160927 = pro.daily(start_date='',end_date='',trade_date='20160927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160927_tscode_list = list() 
for ts_code_sh in daily_20160927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160927_tscode_list.append(stock_name)
daily_20160927_addname_dataframe=pd.DataFrame()
daily_20160927_addname_dataframe['cname'] = daily_20160927_tscode_list
for table_name in daily_20160927.columns.values.tolist():
    daily_20160927_addname_dataframe[table_name] = daily_20160927[table_name]
print("daily_20160927 返回数据 row 行数 = "+str(daily_20160927.shape[0]))
daily_20160927_addname_dataframe.to_excel(daily_201609_excel_writer,'27_2',index=False)
daily_201609_excel_writer.save()
daily_20160928 = pro.daily(start_date='',end_date='',trade_date='20160928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160928_tscode_list = list() 
for ts_code_sh in daily_20160928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160928_tscode_list.append(stock_name)
daily_20160928_addname_dataframe=pd.DataFrame()
daily_20160928_addname_dataframe['cname'] = daily_20160928_tscode_list
for table_name in daily_20160928.columns.values.tolist():
    daily_20160928_addname_dataframe[table_name] = daily_20160928[table_name]
print("daily_20160928 返回数据 row 行数 = "+str(daily_20160928.shape[0]))
daily_20160928_addname_dataframe.to_excel(daily_201609_excel_writer,'28_3',index=False)
daily_201609_excel_writer.save()
daily_20160929 = pro.daily(start_date='',end_date='',trade_date='20160929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160929_tscode_list = list() 
for ts_code_sh in daily_20160929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160929_tscode_list.append(stock_name)
daily_20160929_addname_dataframe=pd.DataFrame()
daily_20160929_addname_dataframe['cname'] = daily_20160929_tscode_list
for table_name in daily_20160929.columns.values.tolist():
    daily_20160929_addname_dataframe[table_name] = daily_20160929[table_name]
print("daily_20160929 返回数据 row 行数 = "+str(daily_20160929.shape[0]))
daily_20160929_addname_dataframe.to_excel(daily_201609_excel_writer,'29_4',index=False)
daily_201609_excel_writer.save()
daily_20160930 = pro.daily(start_date='',end_date='',trade_date='20160930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160930_tscode_list = list() 
for ts_code_sh in daily_20160930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160930_tscode_list.append(stock_name)
daily_20160930_addname_dataframe=pd.DataFrame()
daily_20160930_addname_dataframe['cname'] = daily_20160930_tscode_list
for table_name in daily_20160930.columns.values.tolist():
    daily_20160930_addname_dataframe[table_name] = daily_20160930[table_name]
print("daily_20160930 返回数据 row 行数 = "+str(daily_20160930.shape[0]))
daily_20160930_addname_dataframe.to_excel(daily_201609_excel_writer,'30_5',index=False)
daily_201609_excel_writer.save()




createexcel('daily_201610.xlsx')
daily_201610_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201610.xlsx')
daily_201610_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201610.xlsx', engine='openpyxl')
daily_201610_excel_writer.book = daily_201610_book
daily_201610_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201610_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20161001")       ###  更新 记录日期
daily_20161001 = pro.daily(start_date='',end_date='',trade_date='20161001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161001_tscode_list = list() 
for ts_code_sh in daily_20161001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161001_tscode_list.append(stock_name)
daily_20161001_addname_dataframe=pd.DataFrame()
daily_20161001_addname_dataframe['cname'] = daily_20161001_tscode_list
for table_name in daily_20161001.columns.values.tolist():
    daily_20161001_addname_dataframe[table_name] = daily_20161001[table_name]
print("daily_20161001 返回数据 row 行数 = "+str(daily_20161001.shape[0]))
daily_20161001_addname_dataframe.to_excel(daily_201610_excel_writer,'1_6',index=False)
daily_201610_excel_writer.save()
daily_20161002 = pro.daily(start_date='',end_date='',trade_date='20161002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161002_tscode_list = list() 
for ts_code_sh in daily_20161002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161002_tscode_list.append(stock_name)
daily_20161002_addname_dataframe=pd.DataFrame()
daily_20161002_addname_dataframe['cname'] = daily_20161002_tscode_list
for table_name in daily_20161002.columns.values.tolist():
    daily_20161002_addname_dataframe[table_name] = daily_20161002[table_name]
print("daily_20161002 返回数据 row 行数 = "+str(daily_20161002.shape[0]))
daily_20161002_addname_dataframe.to_excel(daily_201610_excel_writer,'2_7',index=False)
daily_201610_excel_writer.save()
daily_20161003 = pro.daily(start_date='',end_date='',trade_date='20161003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161003_tscode_list = list() 
for ts_code_sh in daily_20161003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161003_tscode_list.append(stock_name)
daily_20161003_addname_dataframe=pd.DataFrame()
daily_20161003_addname_dataframe['cname'] = daily_20161003_tscode_list
for table_name in daily_20161003.columns.values.tolist():
    daily_20161003_addname_dataframe[table_name] = daily_20161003[table_name]
print("daily_20161003 返回数据 row 行数 = "+str(daily_20161003.shape[0]))
daily_20161003_addname_dataframe.to_excel(daily_201610_excel_writer,'3_1',index=False)
daily_201610_excel_writer.save()
daily_20161004 = pro.daily(start_date='',end_date='',trade_date='20161004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161004_tscode_list = list() 
for ts_code_sh in daily_20161004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161004_tscode_list.append(stock_name)
daily_20161004_addname_dataframe=pd.DataFrame()
daily_20161004_addname_dataframe['cname'] = daily_20161004_tscode_list
for table_name in daily_20161004.columns.values.tolist():
    daily_20161004_addname_dataframe[table_name] = daily_20161004[table_name]
print("daily_20161004 返回数据 row 行数 = "+str(daily_20161004.shape[0]))
daily_20161004_addname_dataframe.to_excel(daily_201610_excel_writer,'4_2',index=False)
daily_201610_excel_writer.save()
daily_20161005 = pro.daily(start_date='',end_date='',trade_date='20161005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161005_tscode_list = list() 
for ts_code_sh in daily_20161005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161005_tscode_list.append(stock_name)
daily_20161005_addname_dataframe=pd.DataFrame()
daily_20161005_addname_dataframe['cname'] = daily_20161005_tscode_list
for table_name in daily_20161005.columns.values.tolist():
    daily_20161005_addname_dataframe[table_name] = daily_20161005[table_name]
print("daily_20161005 返回数据 row 行数 = "+str(daily_20161005.shape[0]))
daily_20161005_addname_dataframe.to_excel(daily_201610_excel_writer,'5_3',index=False)
daily_201610_excel_writer.save()
daily_20161006 = pro.daily(start_date='',end_date='',trade_date='20161006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161006_tscode_list = list() 
for ts_code_sh in daily_20161006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161006_tscode_list.append(stock_name)
daily_20161006_addname_dataframe=pd.DataFrame()
daily_20161006_addname_dataframe['cname'] = daily_20161006_tscode_list
for table_name in daily_20161006.columns.values.tolist():
    daily_20161006_addname_dataframe[table_name] = daily_20161006[table_name]
print("daily_20161006 返回数据 row 行数 = "+str(daily_20161006.shape[0]))
daily_20161006_addname_dataframe.to_excel(daily_201610_excel_writer,'6_4',index=False)
daily_201610_excel_writer.save()
daily_20161007 = pro.daily(start_date='',end_date='',trade_date='20161007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161007_tscode_list = list() 
for ts_code_sh in daily_20161007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161007_tscode_list.append(stock_name)
daily_20161007_addname_dataframe=pd.DataFrame()
daily_20161007_addname_dataframe['cname'] = daily_20161007_tscode_list
for table_name in daily_20161007.columns.values.tolist():
    daily_20161007_addname_dataframe[table_name] = daily_20161007[table_name]
print("daily_20161007 返回数据 row 行数 = "+str(daily_20161007.shape[0]))
daily_20161007_addname_dataframe.to_excel(daily_201610_excel_writer,'7_5',index=False)
daily_201610_excel_writer.save()
daily_20161008 = pro.daily(start_date='',end_date='',trade_date='20161008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161008_tscode_list = list() 
for ts_code_sh in daily_20161008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161008_tscode_list.append(stock_name)
daily_20161008_addname_dataframe=pd.DataFrame()
daily_20161008_addname_dataframe['cname'] = daily_20161008_tscode_list
for table_name in daily_20161008.columns.values.tolist():
    daily_20161008_addname_dataframe[table_name] = daily_20161008[table_name]
print("daily_20161008 返回数据 row 行数 = "+str(daily_20161008.shape[0]))
daily_20161008_addname_dataframe.to_excel(daily_201610_excel_writer,'8_6',index=False)
daily_201610_excel_writer.save()
daily_20161009 = pro.daily(start_date='',end_date='',trade_date='20161009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161009_tscode_list = list() 
for ts_code_sh in daily_20161009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161009_tscode_list.append(stock_name)
daily_20161009_addname_dataframe=pd.DataFrame()
daily_20161009_addname_dataframe['cname'] = daily_20161009_tscode_list
for table_name in daily_20161009.columns.values.tolist():
    daily_20161009_addname_dataframe[table_name] = daily_20161009[table_name]
print("daily_20161009 返回数据 row 行数 = "+str(daily_20161009.shape[0]))
daily_20161009_addname_dataframe.to_excel(daily_201610_excel_writer,'9_7',index=False)
daily_201610_excel_writer.save()
daily_20161010 = pro.daily(start_date='',end_date='',trade_date='20161010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161010_tscode_list = list() 
for ts_code_sh in daily_20161010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161010_tscode_list.append(stock_name)
daily_20161010_addname_dataframe=pd.DataFrame()
daily_20161010_addname_dataframe['cname'] = daily_20161010_tscode_list
for table_name in daily_20161010.columns.values.tolist():
    daily_20161010_addname_dataframe[table_name] = daily_20161010[table_name]
print("daily_20161010 返回数据 row 行数 = "+str(daily_20161010.shape[0]))
daily_20161010_addname_dataframe.to_excel(daily_201610_excel_writer,'10_1',index=False)
daily_201610_excel_writer.save()
daily_20161011 = pro.daily(start_date='',end_date='',trade_date='20161011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161011_tscode_list = list() 
for ts_code_sh in daily_20161011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161011_tscode_list.append(stock_name)
daily_20161011_addname_dataframe=pd.DataFrame()
daily_20161011_addname_dataframe['cname'] = daily_20161011_tscode_list
for table_name in daily_20161011.columns.values.tolist():
    daily_20161011_addname_dataframe[table_name] = daily_20161011[table_name]
print("daily_20161011 返回数据 row 行数 = "+str(daily_20161011.shape[0]))
daily_20161011_addname_dataframe.to_excel(daily_201610_excel_writer,'11_2',index=False)
daily_201610_excel_writer.save()
daily_20161012 = pro.daily(start_date='',end_date='',trade_date='20161012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161012_tscode_list = list() 
for ts_code_sh in daily_20161012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161012_tscode_list.append(stock_name)
daily_20161012_addname_dataframe=pd.DataFrame()
daily_20161012_addname_dataframe['cname'] = daily_20161012_tscode_list
for table_name in daily_20161012.columns.values.tolist():
    daily_20161012_addname_dataframe[table_name] = daily_20161012[table_name]
print("daily_20161012 返回数据 row 行数 = "+str(daily_20161012.shape[0]))
daily_20161012_addname_dataframe.to_excel(daily_201610_excel_writer,'12_3',index=False)
daily_201610_excel_writer.save()
daily_20161013 = pro.daily(start_date='',end_date='',trade_date='20161013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161013_tscode_list = list() 
for ts_code_sh in daily_20161013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161013_tscode_list.append(stock_name)
daily_20161013_addname_dataframe=pd.DataFrame()
daily_20161013_addname_dataframe['cname'] = daily_20161013_tscode_list
for table_name in daily_20161013.columns.values.tolist():
    daily_20161013_addname_dataframe[table_name] = daily_20161013[table_name]
print("daily_20161013 返回数据 row 行数 = "+str(daily_20161013.shape[0]))
daily_20161013_addname_dataframe.to_excel(daily_201610_excel_writer,'13_4',index=False)
daily_201610_excel_writer.save()
daily_20161014 = pro.daily(start_date='',end_date='',trade_date='20161014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161014_tscode_list = list() 
for ts_code_sh in daily_20161014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161014_tscode_list.append(stock_name)
daily_20161014_addname_dataframe=pd.DataFrame()
daily_20161014_addname_dataframe['cname'] = daily_20161014_tscode_list
for table_name in daily_20161014.columns.values.tolist():
    daily_20161014_addname_dataframe[table_name] = daily_20161014[table_name]
print("daily_20161014 返回数据 row 行数 = "+str(daily_20161014.shape[0]))
daily_20161014_addname_dataframe.to_excel(daily_201610_excel_writer,'14_5',index=False)
daily_201610_excel_writer.save()
daily_20161015 = pro.daily(start_date='',end_date='',trade_date='20161015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161015_tscode_list = list() 
for ts_code_sh in daily_20161015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161015_tscode_list.append(stock_name)
daily_20161015_addname_dataframe=pd.DataFrame()
daily_20161015_addname_dataframe['cname'] = daily_20161015_tscode_list
for table_name in daily_20161015.columns.values.tolist():
    daily_20161015_addname_dataframe[table_name] = daily_20161015[table_name]
print("daily_20161015 返回数据 row 行数 = "+str(daily_20161015.shape[0]))
daily_20161015_addname_dataframe.to_excel(daily_201610_excel_writer,'15_6',index=False)
daily_201610_excel_writer.save()
daily_20161016 = pro.daily(start_date='',end_date='',trade_date='20161016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161016_tscode_list = list() 
for ts_code_sh in daily_20161016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161016_tscode_list.append(stock_name)
daily_20161016_addname_dataframe=pd.DataFrame()
daily_20161016_addname_dataframe['cname'] = daily_20161016_tscode_list
for table_name in daily_20161016.columns.values.tolist():
    daily_20161016_addname_dataframe[table_name] = daily_20161016[table_name]
print("daily_20161016 返回数据 row 行数 = "+str(daily_20161016.shape[0]))
daily_20161016_addname_dataframe.to_excel(daily_201610_excel_writer,'16_7',index=False)
daily_201610_excel_writer.save()
daily_20161017 = pro.daily(start_date='',end_date='',trade_date='20161017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161017_tscode_list = list() 
for ts_code_sh in daily_20161017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161017_tscode_list.append(stock_name)
daily_20161017_addname_dataframe=pd.DataFrame()
daily_20161017_addname_dataframe['cname'] = daily_20161017_tscode_list
for table_name in daily_20161017.columns.values.tolist():
    daily_20161017_addname_dataframe[table_name] = daily_20161017[table_name]
print("daily_20161017 返回数据 row 行数 = "+str(daily_20161017.shape[0]))
daily_20161017_addname_dataframe.to_excel(daily_201610_excel_writer,'17_1',index=False)
daily_201610_excel_writer.save()
daily_20161018 = pro.daily(start_date='',end_date='',trade_date='20161018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161018_tscode_list = list() 
for ts_code_sh in daily_20161018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161018_tscode_list.append(stock_name)
daily_20161018_addname_dataframe=pd.DataFrame()
daily_20161018_addname_dataframe['cname'] = daily_20161018_tscode_list
for table_name in daily_20161018.columns.values.tolist():
    daily_20161018_addname_dataframe[table_name] = daily_20161018[table_name]
print("daily_20161018 返回数据 row 行数 = "+str(daily_20161018.shape[0]))
daily_20161018_addname_dataframe.to_excel(daily_201610_excel_writer,'18_2',index=False)
daily_201610_excel_writer.save()
daily_20161019 = pro.daily(start_date='',end_date='',trade_date='20161019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161019_tscode_list = list() 
for ts_code_sh in daily_20161019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161019_tscode_list.append(stock_name)
daily_20161019_addname_dataframe=pd.DataFrame()
daily_20161019_addname_dataframe['cname'] = daily_20161019_tscode_list
for table_name in daily_20161019.columns.values.tolist():
    daily_20161019_addname_dataframe[table_name] = daily_20161019[table_name]
print("daily_20161019 返回数据 row 行数 = "+str(daily_20161019.shape[0]))
daily_20161019_addname_dataframe.to_excel(daily_201610_excel_writer,'19_3',index=False)
daily_201610_excel_writer.save()
daily_20161020 = pro.daily(start_date='',end_date='',trade_date='20161020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161020_tscode_list = list() 
for ts_code_sh in daily_20161020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161020_tscode_list.append(stock_name)
daily_20161020_addname_dataframe=pd.DataFrame()
daily_20161020_addname_dataframe['cname'] = daily_20161020_tscode_list
for table_name in daily_20161020.columns.values.tolist():
    daily_20161020_addname_dataframe[table_name] = daily_20161020[table_name]
print("daily_20161020 返回数据 row 行数 = "+str(daily_20161020.shape[0]))
daily_20161020_addname_dataframe.to_excel(daily_201610_excel_writer,'20_4',index=False)
daily_201610_excel_writer.save()
daily_20161021 = pro.daily(start_date='',end_date='',trade_date='20161021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161021_tscode_list = list() 
for ts_code_sh in daily_20161021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161021_tscode_list.append(stock_name)
daily_20161021_addname_dataframe=pd.DataFrame()
daily_20161021_addname_dataframe['cname'] = daily_20161021_tscode_list
for table_name in daily_20161021.columns.values.tolist():
    daily_20161021_addname_dataframe[table_name] = daily_20161021[table_name]
print("daily_20161021 返回数据 row 行数 = "+str(daily_20161021.shape[0]))
daily_20161021_addname_dataframe.to_excel(daily_201610_excel_writer,'21_5',index=False)
daily_201610_excel_writer.save()
daily_20161022 = pro.daily(start_date='',end_date='',trade_date='20161022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161022_tscode_list = list() 
for ts_code_sh in daily_20161022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161022_tscode_list.append(stock_name)
daily_20161022_addname_dataframe=pd.DataFrame()
daily_20161022_addname_dataframe['cname'] = daily_20161022_tscode_list
for table_name in daily_20161022.columns.values.tolist():
    daily_20161022_addname_dataframe[table_name] = daily_20161022[table_name]
print("daily_20161022 返回数据 row 行数 = "+str(daily_20161022.shape[0]))
daily_20161022_addname_dataframe.to_excel(daily_201610_excel_writer,'22_6',index=False)
daily_201610_excel_writer.save()
daily_20161023 = pro.daily(start_date='',end_date='',trade_date='20161023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161023_tscode_list = list() 
for ts_code_sh in daily_20161023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161023_tscode_list.append(stock_name)
daily_20161023_addname_dataframe=pd.DataFrame()
daily_20161023_addname_dataframe['cname'] = daily_20161023_tscode_list
for table_name in daily_20161023.columns.values.tolist():
    daily_20161023_addname_dataframe[table_name] = daily_20161023[table_name]
print("daily_20161023 返回数据 row 行数 = "+str(daily_20161023.shape[0]))
daily_20161023_addname_dataframe.to_excel(daily_201610_excel_writer,'23_7',index=False)
daily_201610_excel_writer.save()
daily_20161024 = pro.daily(start_date='',end_date='',trade_date='20161024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161024_tscode_list = list() 
for ts_code_sh in daily_20161024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161024_tscode_list.append(stock_name)
daily_20161024_addname_dataframe=pd.DataFrame()
daily_20161024_addname_dataframe['cname'] = daily_20161024_tscode_list
for table_name in daily_20161024.columns.values.tolist():
    daily_20161024_addname_dataframe[table_name] = daily_20161024[table_name]
print("daily_20161024 返回数据 row 行数 = "+str(daily_20161024.shape[0]))
daily_20161024_addname_dataframe.to_excel(daily_201610_excel_writer,'24_1',index=False)
daily_201610_excel_writer.save()
daily_20161025 = pro.daily(start_date='',end_date='',trade_date='20161025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161025_tscode_list = list() 
for ts_code_sh in daily_20161025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161025_tscode_list.append(stock_name)
daily_20161025_addname_dataframe=pd.DataFrame()
daily_20161025_addname_dataframe['cname'] = daily_20161025_tscode_list
for table_name in daily_20161025.columns.values.tolist():
    daily_20161025_addname_dataframe[table_name] = daily_20161025[table_name]
print("daily_20161025 返回数据 row 行数 = "+str(daily_20161025.shape[0]))
daily_20161025_addname_dataframe.to_excel(daily_201610_excel_writer,'25_2',index=False)
daily_201610_excel_writer.save()
daily_20161026 = pro.daily(start_date='',end_date='',trade_date='20161026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161026_tscode_list = list() 
for ts_code_sh in daily_20161026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161026_tscode_list.append(stock_name)
daily_20161026_addname_dataframe=pd.DataFrame()
daily_20161026_addname_dataframe['cname'] = daily_20161026_tscode_list
for table_name in daily_20161026.columns.values.tolist():
    daily_20161026_addname_dataframe[table_name] = daily_20161026[table_name]
print("daily_20161026 返回数据 row 行数 = "+str(daily_20161026.shape[0]))
daily_20161026_addname_dataframe.to_excel(daily_201610_excel_writer,'26_3',index=False)
daily_201610_excel_writer.save()
daily_20161027 = pro.daily(start_date='',end_date='',trade_date='20161027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161027_tscode_list = list() 
for ts_code_sh in daily_20161027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161027_tscode_list.append(stock_name)
daily_20161027_addname_dataframe=pd.DataFrame()
daily_20161027_addname_dataframe['cname'] = daily_20161027_tscode_list
for table_name in daily_20161027.columns.values.tolist():
    daily_20161027_addname_dataframe[table_name] = daily_20161027[table_name]
print("daily_20161027 返回数据 row 行数 = "+str(daily_20161027.shape[0]))
daily_20161027_addname_dataframe.to_excel(daily_201610_excel_writer,'27_4',index=False)
daily_201610_excel_writer.save()
daily_20161028 = pro.daily(start_date='',end_date='',trade_date='20161028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161028_tscode_list = list() 
for ts_code_sh in daily_20161028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161028_tscode_list.append(stock_name)
daily_20161028_addname_dataframe=pd.DataFrame()
daily_20161028_addname_dataframe['cname'] = daily_20161028_tscode_list
for table_name in daily_20161028.columns.values.tolist():
    daily_20161028_addname_dataframe[table_name] = daily_20161028[table_name]
print("daily_20161028 返回数据 row 行数 = "+str(daily_20161028.shape[0]))
daily_20161028_addname_dataframe.to_excel(daily_201610_excel_writer,'28_5',index=False)
daily_201610_excel_writer.save()
daily_20161029 = pro.daily(start_date='',end_date='',trade_date='20161029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161029_tscode_list = list() 
for ts_code_sh in daily_20161029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161029_tscode_list.append(stock_name)
daily_20161029_addname_dataframe=pd.DataFrame()
daily_20161029_addname_dataframe['cname'] = daily_20161029_tscode_list
for table_name in daily_20161029.columns.values.tolist():
    daily_20161029_addname_dataframe[table_name] = daily_20161029[table_name]
print("daily_20161029 返回数据 row 行数 = "+str(daily_20161029.shape[0]))
daily_20161029_addname_dataframe.to_excel(daily_201610_excel_writer,'29_6',index=False)
daily_201610_excel_writer.save()
daily_20161030 = pro.daily(start_date='',end_date='',trade_date='20161030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161030_tscode_list = list() 
for ts_code_sh in daily_20161030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161030_tscode_list.append(stock_name)
daily_20161030_addname_dataframe=pd.DataFrame()
daily_20161030_addname_dataframe['cname'] = daily_20161030_tscode_list
for table_name in daily_20161030.columns.values.tolist():
    daily_20161030_addname_dataframe[table_name] = daily_20161030[table_name]
print("daily_20161030 返回数据 row 行数 = "+str(daily_20161030.shape[0]))
daily_20161030_addname_dataframe.to_excel(daily_201610_excel_writer,'30_7',index=False)
daily_201610_excel_writer.save()
daily_20161031 = pro.daily(start_date='',end_date='',trade_date='20161031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161031_tscode_list = list() 
for ts_code_sh in daily_20161031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161031_tscode_list.append(stock_name)
daily_20161031_addname_dataframe=pd.DataFrame()
daily_20161031_addname_dataframe['cname'] = daily_20161031_tscode_list
for table_name in daily_20161031.columns.values.tolist():
    daily_20161031_addname_dataframe[table_name] = daily_20161031[table_name]
print("daily_20161031 返回数据 row 行数 = "+str(daily_20161031.shape[0]))
daily_20161031_addname_dataframe.to_excel(daily_201610_excel_writer,'31_1',index=False)
daily_201610_excel_writer.save()




createexcel('daily_201611.xlsx')
daily_201611_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201611.xlsx')
daily_201611_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201611.xlsx', engine='openpyxl')
daily_201611_excel_writer.book = daily_201611_book
daily_201611_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201611_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20161101")       ###  更新 记录日期
daily_20161101 = pro.daily(start_date='',end_date='',trade_date='20161101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161101_tscode_list = list() 
for ts_code_sh in daily_20161101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161101_tscode_list.append(stock_name)
daily_20161101_addname_dataframe=pd.DataFrame()
daily_20161101_addname_dataframe['cname'] = daily_20161101_tscode_list
for table_name in daily_20161101.columns.values.tolist():
    daily_20161101_addname_dataframe[table_name] = daily_20161101[table_name]
print("daily_20161101 返回数据 row 行数 = "+str(daily_20161101.shape[0]))
daily_20161101_addname_dataframe.to_excel(daily_201611_excel_writer,'1_2',index=False)
daily_201611_excel_writer.save()
daily_20161102 = pro.daily(start_date='',end_date='',trade_date='20161102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161102_tscode_list = list() 
for ts_code_sh in daily_20161102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161102_tscode_list.append(stock_name)
daily_20161102_addname_dataframe=pd.DataFrame()
daily_20161102_addname_dataframe['cname'] = daily_20161102_tscode_list
for table_name in daily_20161102.columns.values.tolist():
    daily_20161102_addname_dataframe[table_name] = daily_20161102[table_name]
print("daily_20161102 返回数据 row 行数 = "+str(daily_20161102.shape[0]))
daily_20161102_addname_dataframe.to_excel(daily_201611_excel_writer,'2_3',index=False)
daily_201611_excel_writer.save()
daily_20161103 = pro.daily(start_date='',end_date='',trade_date='20161103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161103_tscode_list = list() 
for ts_code_sh in daily_20161103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161103_tscode_list.append(stock_name)
daily_20161103_addname_dataframe=pd.DataFrame()
daily_20161103_addname_dataframe['cname'] = daily_20161103_tscode_list
for table_name in daily_20161103.columns.values.tolist():
    daily_20161103_addname_dataframe[table_name] = daily_20161103[table_name]
print("daily_20161103 返回数据 row 行数 = "+str(daily_20161103.shape[0]))
daily_20161103_addname_dataframe.to_excel(daily_201611_excel_writer,'3_4',index=False)
daily_201611_excel_writer.save()
daily_20161104 = pro.daily(start_date='',end_date='',trade_date='20161104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161104_tscode_list = list() 
for ts_code_sh in daily_20161104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161104_tscode_list.append(stock_name)
daily_20161104_addname_dataframe=pd.DataFrame()
daily_20161104_addname_dataframe['cname'] = daily_20161104_tscode_list
for table_name in daily_20161104.columns.values.tolist():
    daily_20161104_addname_dataframe[table_name] = daily_20161104[table_name]
print("daily_20161104 返回数据 row 行数 = "+str(daily_20161104.shape[0]))
daily_20161104_addname_dataframe.to_excel(daily_201611_excel_writer,'4_5',index=False)
daily_201611_excel_writer.save()
daily_20161105 = pro.daily(start_date='',end_date='',trade_date='20161105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161105_tscode_list = list() 
for ts_code_sh in daily_20161105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161105_tscode_list.append(stock_name)
daily_20161105_addname_dataframe=pd.DataFrame()
daily_20161105_addname_dataframe['cname'] = daily_20161105_tscode_list
for table_name in daily_20161105.columns.values.tolist():
    daily_20161105_addname_dataframe[table_name] = daily_20161105[table_name]
print("daily_20161105 返回数据 row 行数 = "+str(daily_20161105.shape[0]))
daily_20161105_addname_dataframe.to_excel(daily_201611_excel_writer,'5_6',index=False)
daily_201611_excel_writer.save()
daily_20161106 = pro.daily(start_date='',end_date='',trade_date='20161106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161106_tscode_list = list() 
for ts_code_sh in daily_20161106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161106_tscode_list.append(stock_name)
daily_20161106_addname_dataframe=pd.DataFrame()
daily_20161106_addname_dataframe['cname'] = daily_20161106_tscode_list
for table_name in daily_20161106.columns.values.tolist():
    daily_20161106_addname_dataframe[table_name] = daily_20161106[table_name]
print("daily_20161106 返回数据 row 行数 = "+str(daily_20161106.shape[0]))
daily_20161106_addname_dataframe.to_excel(daily_201611_excel_writer,'6_7',index=False)
daily_201611_excel_writer.save()
daily_20161107 = pro.daily(start_date='',end_date='',trade_date='20161107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161107_tscode_list = list() 
for ts_code_sh in daily_20161107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161107_tscode_list.append(stock_name)
daily_20161107_addname_dataframe=pd.DataFrame()
daily_20161107_addname_dataframe['cname'] = daily_20161107_tscode_list
for table_name in daily_20161107.columns.values.tolist():
    daily_20161107_addname_dataframe[table_name] = daily_20161107[table_name]
print("daily_20161107 返回数据 row 行数 = "+str(daily_20161107.shape[0]))
daily_20161107_addname_dataframe.to_excel(daily_201611_excel_writer,'7_1',index=False)
daily_201611_excel_writer.save()
daily_20161108 = pro.daily(start_date='',end_date='',trade_date='20161108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161108_tscode_list = list() 
for ts_code_sh in daily_20161108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161108_tscode_list.append(stock_name)
daily_20161108_addname_dataframe=pd.DataFrame()
daily_20161108_addname_dataframe['cname'] = daily_20161108_tscode_list
for table_name in daily_20161108.columns.values.tolist():
    daily_20161108_addname_dataframe[table_name] = daily_20161108[table_name]
print("daily_20161108 返回数据 row 行数 = "+str(daily_20161108.shape[0]))
daily_20161108_addname_dataframe.to_excel(daily_201611_excel_writer,'8_2',index=False)
daily_201611_excel_writer.save()
daily_20161109 = pro.daily(start_date='',end_date='',trade_date='20161109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161109_tscode_list = list() 
for ts_code_sh in daily_20161109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161109_tscode_list.append(stock_name)
daily_20161109_addname_dataframe=pd.DataFrame()
daily_20161109_addname_dataframe['cname'] = daily_20161109_tscode_list
for table_name in daily_20161109.columns.values.tolist():
    daily_20161109_addname_dataframe[table_name] = daily_20161109[table_name]
print("daily_20161109 返回数据 row 行数 = "+str(daily_20161109.shape[0]))
daily_20161109_addname_dataframe.to_excel(daily_201611_excel_writer,'9_3',index=False)
daily_201611_excel_writer.save()
daily_20161110 = pro.daily(start_date='',end_date='',trade_date='20161110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161110_tscode_list = list() 
for ts_code_sh in daily_20161110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161110_tscode_list.append(stock_name)
daily_20161110_addname_dataframe=pd.DataFrame()
daily_20161110_addname_dataframe['cname'] = daily_20161110_tscode_list
for table_name in daily_20161110.columns.values.tolist():
    daily_20161110_addname_dataframe[table_name] = daily_20161110[table_name]
print("daily_20161110 返回数据 row 行数 = "+str(daily_20161110.shape[0]))
daily_20161110_addname_dataframe.to_excel(daily_201611_excel_writer,'10_4',index=False)
daily_201611_excel_writer.save()
daily_20161111 = pro.daily(start_date='',end_date='',trade_date='20161111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161111_tscode_list = list() 
for ts_code_sh in daily_20161111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161111_tscode_list.append(stock_name)
daily_20161111_addname_dataframe=pd.DataFrame()
daily_20161111_addname_dataframe['cname'] = daily_20161111_tscode_list
for table_name in daily_20161111.columns.values.tolist():
    daily_20161111_addname_dataframe[table_name] = daily_20161111[table_name]
print("daily_20161111 返回数据 row 行数 = "+str(daily_20161111.shape[0]))
daily_20161111_addname_dataframe.to_excel(daily_201611_excel_writer,'11_5',index=False)
daily_201611_excel_writer.save()
daily_20161112 = pro.daily(start_date='',end_date='',trade_date='20161112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161112_tscode_list = list() 
for ts_code_sh in daily_20161112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161112_tscode_list.append(stock_name)
daily_20161112_addname_dataframe=pd.DataFrame()
daily_20161112_addname_dataframe['cname'] = daily_20161112_tscode_list
for table_name in daily_20161112.columns.values.tolist():
    daily_20161112_addname_dataframe[table_name] = daily_20161112[table_name]
print("daily_20161112 返回数据 row 行数 = "+str(daily_20161112.shape[0]))
daily_20161112_addname_dataframe.to_excel(daily_201611_excel_writer,'12_6',index=False)
daily_201611_excel_writer.save()
daily_20161113 = pro.daily(start_date='',end_date='',trade_date='20161113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161113_tscode_list = list() 
for ts_code_sh in daily_20161113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161113_tscode_list.append(stock_name)
daily_20161113_addname_dataframe=pd.DataFrame()
daily_20161113_addname_dataframe['cname'] = daily_20161113_tscode_list
for table_name in daily_20161113.columns.values.tolist():
    daily_20161113_addname_dataframe[table_name] = daily_20161113[table_name]
print("daily_20161113 返回数据 row 行数 = "+str(daily_20161113.shape[0]))
daily_20161113_addname_dataframe.to_excel(daily_201611_excel_writer,'13_7',index=False)
daily_201611_excel_writer.save()
daily_20161114 = pro.daily(start_date='',end_date='',trade_date='20161114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161114_tscode_list = list() 
for ts_code_sh in daily_20161114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161114_tscode_list.append(stock_name)
daily_20161114_addname_dataframe=pd.DataFrame()
daily_20161114_addname_dataframe['cname'] = daily_20161114_tscode_list
for table_name in daily_20161114.columns.values.tolist():
    daily_20161114_addname_dataframe[table_name] = daily_20161114[table_name]
print("daily_20161114 返回数据 row 行数 = "+str(daily_20161114.shape[0]))
daily_20161114_addname_dataframe.to_excel(daily_201611_excel_writer,'14_1',index=False)
daily_201611_excel_writer.save()
daily_20161115 = pro.daily(start_date='',end_date='',trade_date='20161115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161115_tscode_list = list() 
for ts_code_sh in daily_20161115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161115_tscode_list.append(stock_name)
daily_20161115_addname_dataframe=pd.DataFrame()
daily_20161115_addname_dataframe['cname'] = daily_20161115_tscode_list
for table_name in daily_20161115.columns.values.tolist():
    daily_20161115_addname_dataframe[table_name] = daily_20161115[table_name]
print("daily_20161115 返回数据 row 行数 = "+str(daily_20161115.shape[0]))
daily_20161115_addname_dataframe.to_excel(daily_201611_excel_writer,'15_2',index=False)
daily_201611_excel_writer.save()
daily_20161116 = pro.daily(start_date='',end_date='',trade_date='20161116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161116_tscode_list = list() 
for ts_code_sh in daily_20161116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161116_tscode_list.append(stock_name)
daily_20161116_addname_dataframe=pd.DataFrame()
daily_20161116_addname_dataframe['cname'] = daily_20161116_tscode_list
for table_name in daily_20161116.columns.values.tolist():
    daily_20161116_addname_dataframe[table_name] = daily_20161116[table_name]
print("daily_20161116 返回数据 row 行数 = "+str(daily_20161116.shape[0]))
daily_20161116_addname_dataframe.to_excel(daily_201611_excel_writer,'16_3',index=False)
daily_201611_excel_writer.save()
daily_20161117 = pro.daily(start_date='',end_date='',trade_date='20161117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161117_tscode_list = list() 
for ts_code_sh in daily_20161117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161117_tscode_list.append(stock_name)
daily_20161117_addname_dataframe=pd.DataFrame()
daily_20161117_addname_dataframe['cname'] = daily_20161117_tscode_list
for table_name in daily_20161117.columns.values.tolist():
    daily_20161117_addname_dataframe[table_name] = daily_20161117[table_name]
print("daily_20161117 返回数据 row 行数 = "+str(daily_20161117.shape[0]))
daily_20161117_addname_dataframe.to_excel(daily_201611_excel_writer,'17_4',index=False)
daily_201611_excel_writer.save()
daily_20161118 = pro.daily(start_date='',end_date='',trade_date='20161118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161118_tscode_list = list() 
for ts_code_sh in daily_20161118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161118_tscode_list.append(stock_name)
daily_20161118_addname_dataframe=pd.DataFrame()
daily_20161118_addname_dataframe['cname'] = daily_20161118_tscode_list
for table_name in daily_20161118.columns.values.tolist():
    daily_20161118_addname_dataframe[table_name] = daily_20161118[table_name]
print("daily_20161118 返回数据 row 行数 = "+str(daily_20161118.shape[0]))
daily_20161118_addname_dataframe.to_excel(daily_201611_excel_writer,'18_5',index=False)
daily_201611_excel_writer.save()
daily_20161119 = pro.daily(start_date='',end_date='',trade_date='20161119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161119_tscode_list = list() 
for ts_code_sh in daily_20161119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161119_tscode_list.append(stock_name)
daily_20161119_addname_dataframe=pd.DataFrame()
daily_20161119_addname_dataframe['cname'] = daily_20161119_tscode_list
for table_name in daily_20161119.columns.values.tolist():
    daily_20161119_addname_dataframe[table_name] = daily_20161119[table_name]
print("daily_20161119 返回数据 row 行数 = "+str(daily_20161119.shape[0]))
daily_20161119_addname_dataframe.to_excel(daily_201611_excel_writer,'19_6',index=False)
daily_201611_excel_writer.save()
daily_20161120 = pro.daily(start_date='',end_date='',trade_date='20161120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161120_tscode_list = list() 
for ts_code_sh in daily_20161120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161120_tscode_list.append(stock_name)
daily_20161120_addname_dataframe=pd.DataFrame()
daily_20161120_addname_dataframe['cname'] = daily_20161120_tscode_list
for table_name in daily_20161120.columns.values.tolist():
    daily_20161120_addname_dataframe[table_name] = daily_20161120[table_name]
print("daily_20161120 返回数据 row 行数 = "+str(daily_20161120.shape[0]))
daily_20161120_addname_dataframe.to_excel(daily_201611_excel_writer,'20_7',index=False)
daily_201611_excel_writer.save()
daily_20161121 = pro.daily(start_date='',end_date='',trade_date='20161121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161121_tscode_list = list() 
for ts_code_sh in daily_20161121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161121_tscode_list.append(stock_name)
daily_20161121_addname_dataframe=pd.DataFrame()
daily_20161121_addname_dataframe['cname'] = daily_20161121_tscode_list
for table_name in daily_20161121.columns.values.tolist():
    daily_20161121_addname_dataframe[table_name] = daily_20161121[table_name]
print("daily_20161121 返回数据 row 行数 = "+str(daily_20161121.shape[0]))
daily_20161121_addname_dataframe.to_excel(daily_201611_excel_writer,'21_1',index=False)
daily_201611_excel_writer.save()
daily_20161122 = pro.daily(start_date='',end_date='',trade_date='20161122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161122_tscode_list = list() 
for ts_code_sh in daily_20161122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161122_tscode_list.append(stock_name)
daily_20161122_addname_dataframe=pd.DataFrame()
daily_20161122_addname_dataframe['cname'] = daily_20161122_tscode_list
for table_name in daily_20161122.columns.values.tolist():
    daily_20161122_addname_dataframe[table_name] = daily_20161122[table_name]
print("daily_20161122 返回数据 row 行数 = "+str(daily_20161122.shape[0]))
daily_20161122_addname_dataframe.to_excel(daily_201611_excel_writer,'22_2',index=False)
daily_201611_excel_writer.save()
daily_20161123 = pro.daily(start_date='',end_date='',trade_date='20161123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161123_tscode_list = list() 
for ts_code_sh in daily_20161123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161123_tscode_list.append(stock_name)
daily_20161123_addname_dataframe=pd.DataFrame()
daily_20161123_addname_dataframe['cname'] = daily_20161123_tscode_list
for table_name in daily_20161123.columns.values.tolist():
    daily_20161123_addname_dataframe[table_name] = daily_20161123[table_name]
print("daily_20161123 返回数据 row 行数 = "+str(daily_20161123.shape[0]))
daily_20161123_addname_dataframe.to_excel(daily_201611_excel_writer,'23_3',index=False)
daily_201611_excel_writer.save()
daily_20161124 = pro.daily(start_date='',end_date='',trade_date='20161124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161124_tscode_list = list() 
for ts_code_sh in daily_20161124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161124_tscode_list.append(stock_name)
daily_20161124_addname_dataframe=pd.DataFrame()
daily_20161124_addname_dataframe['cname'] = daily_20161124_tscode_list
for table_name in daily_20161124.columns.values.tolist():
    daily_20161124_addname_dataframe[table_name] = daily_20161124[table_name]
print("daily_20161124 返回数据 row 行数 = "+str(daily_20161124.shape[0]))
daily_20161124_addname_dataframe.to_excel(daily_201611_excel_writer,'24_4',index=False)
daily_201611_excel_writer.save()
daily_20161125 = pro.daily(start_date='',end_date='',trade_date='20161125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161125_tscode_list = list() 
for ts_code_sh in daily_20161125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161125_tscode_list.append(stock_name)
daily_20161125_addname_dataframe=pd.DataFrame()
daily_20161125_addname_dataframe['cname'] = daily_20161125_tscode_list
for table_name in daily_20161125.columns.values.tolist():
    daily_20161125_addname_dataframe[table_name] = daily_20161125[table_name]
print("daily_20161125 返回数据 row 行数 = "+str(daily_20161125.shape[0]))
daily_20161125_addname_dataframe.to_excel(daily_201611_excel_writer,'25_5',index=False)
daily_201611_excel_writer.save()
daily_20161126 = pro.daily(start_date='',end_date='',trade_date='20161126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161126_tscode_list = list() 
for ts_code_sh in daily_20161126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161126_tscode_list.append(stock_name)
daily_20161126_addname_dataframe=pd.DataFrame()
daily_20161126_addname_dataframe['cname'] = daily_20161126_tscode_list
for table_name in daily_20161126.columns.values.tolist():
    daily_20161126_addname_dataframe[table_name] = daily_20161126[table_name]
print("daily_20161126 返回数据 row 行数 = "+str(daily_20161126.shape[0]))
daily_20161126_addname_dataframe.to_excel(daily_201611_excel_writer,'26_6',index=False)
daily_201611_excel_writer.save()
daily_20161127 = pro.daily(start_date='',end_date='',trade_date='20161127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161127_tscode_list = list() 
for ts_code_sh in daily_20161127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161127_tscode_list.append(stock_name)
daily_20161127_addname_dataframe=pd.DataFrame()
daily_20161127_addname_dataframe['cname'] = daily_20161127_tscode_list
for table_name in daily_20161127.columns.values.tolist():
    daily_20161127_addname_dataframe[table_name] = daily_20161127[table_name]
print("daily_20161127 返回数据 row 行数 = "+str(daily_20161127.shape[0]))
daily_20161127_addname_dataframe.to_excel(daily_201611_excel_writer,'27_7',index=False)
daily_201611_excel_writer.save()
daily_20161128 = pro.daily(start_date='',end_date='',trade_date='20161128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161128_tscode_list = list() 
for ts_code_sh in daily_20161128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161128_tscode_list.append(stock_name)
daily_20161128_addname_dataframe=pd.DataFrame()
daily_20161128_addname_dataframe['cname'] = daily_20161128_tscode_list
for table_name in daily_20161128.columns.values.tolist():
    daily_20161128_addname_dataframe[table_name] = daily_20161128[table_name]
print("daily_20161128 返回数据 row 行数 = "+str(daily_20161128.shape[0]))
daily_20161128_addname_dataframe.to_excel(daily_201611_excel_writer,'28_1',index=False)
daily_201611_excel_writer.save()
daily_20161129 = pro.daily(start_date='',end_date='',trade_date='20161129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161129_tscode_list = list() 
for ts_code_sh in daily_20161129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161129_tscode_list.append(stock_name)
daily_20161129_addname_dataframe=pd.DataFrame()
daily_20161129_addname_dataframe['cname'] = daily_20161129_tscode_list
for table_name in daily_20161129.columns.values.tolist():
    daily_20161129_addname_dataframe[table_name] = daily_20161129[table_name]
print("daily_20161129 返回数据 row 行数 = "+str(daily_20161129.shape[0]))
daily_20161129_addname_dataframe.to_excel(daily_201611_excel_writer,'29_2',index=False)
daily_201611_excel_writer.save()
daily_20161130 = pro.daily(start_date='',end_date='',trade_date='20161130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161130_tscode_list = list() 
for ts_code_sh in daily_20161130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161130_tscode_list.append(stock_name)
daily_20161130_addname_dataframe=pd.DataFrame()
daily_20161130_addname_dataframe['cname'] = daily_20161130_tscode_list
for table_name in daily_20161130.columns.values.tolist():
    daily_20161130_addname_dataframe[table_name] = daily_20161130[table_name]
print("daily_20161130 返回数据 row 行数 = "+str(daily_20161130.shape[0]))
daily_20161130_addname_dataframe.to_excel(daily_201611_excel_writer,'30_3',index=False)
daily_201611_excel_writer.save()




createexcel('daily_201612.xlsx')
daily_201612_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201612.xlsx')
daily_201612_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201612.xlsx', engine='openpyxl')
daily_201612_excel_writer.book = daily_201612_book
daily_201612_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201612_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20161201")       ###  更新 记录日期
daily_20161201 = pro.daily(start_date='',end_date='',trade_date='20161201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161201_tscode_list = list() 
for ts_code_sh in daily_20161201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161201_tscode_list.append(stock_name)
daily_20161201_addname_dataframe=pd.DataFrame()
daily_20161201_addname_dataframe['cname'] = daily_20161201_tscode_list
for table_name in daily_20161201.columns.values.tolist():
    daily_20161201_addname_dataframe[table_name] = daily_20161201[table_name]
print("daily_20161201 返回数据 row 行数 = "+str(daily_20161201.shape[0]))
daily_20161201_addname_dataframe.to_excel(daily_201612_excel_writer,'1_4',index=False)
daily_201612_excel_writer.save()
daily_20161202 = pro.daily(start_date='',end_date='',trade_date='20161202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161202_tscode_list = list() 
for ts_code_sh in daily_20161202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161202_tscode_list.append(stock_name)
daily_20161202_addname_dataframe=pd.DataFrame()
daily_20161202_addname_dataframe['cname'] = daily_20161202_tscode_list
for table_name in daily_20161202.columns.values.tolist():
    daily_20161202_addname_dataframe[table_name] = daily_20161202[table_name]
print("daily_20161202 返回数据 row 行数 = "+str(daily_20161202.shape[0]))
daily_20161202_addname_dataframe.to_excel(daily_201612_excel_writer,'2_5',index=False)
daily_201612_excel_writer.save()
daily_20161203 = pro.daily(start_date='',end_date='',trade_date='20161203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161203_tscode_list = list() 
for ts_code_sh in daily_20161203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161203_tscode_list.append(stock_name)
daily_20161203_addname_dataframe=pd.DataFrame()
daily_20161203_addname_dataframe['cname'] = daily_20161203_tscode_list
for table_name in daily_20161203.columns.values.tolist():
    daily_20161203_addname_dataframe[table_name] = daily_20161203[table_name]
print("daily_20161203 返回数据 row 行数 = "+str(daily_20161203.shape[0]))
daily_20161203_addname_dataframe.to_excel(daily_201612_excel_writer,'3_6',index=False)
daily_201612_excel_writer.save()
daily_20161204 = pro.daily(start_date='',end_date='',trade_date='20161204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161204_tscode_list = list() 
for ts_code_sh in daily_20161204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161204_tscode_list.append(stock_name)
daily_20161204_addname_dataframe=pd.DataFrame()
daily_20161204_addname_dataframe['cname'] = daily_20161204_tscode_list
for table_name in daily_20161204.columns.values.tolist():
    daily_20161204_addname_dataframe[table_name] = daily_20161204[table_name]
print("daily_20161204 返回数据 row 行数 = "+str(daily_20161204.shape[0]))
daily_20161204_addname_dataframe.to_excel(daily_201612_excel_writer,'4_7',index=False)
daily_201612_excel_writer.save()
daily_20161205 = pro.daily(start_date='',end_date='',trade_date='20161205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161205_tscode_list = list() 
for ts_code_sh in daily_20161205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161205_tscode_list.append(stock_name)
daily_20161205_addname_dataframe=pd.DataFrame()
daily_20161205_addname_dataframe['cname'] = daily_20161205_tscode_list
for table_name in daily_20161205.columns.values.tolist():
    daily_20161205_addname_dataframe[table_name] = daily_20161205[table_name]
print("daily_20161205 返回数据 row 行数 = "+str(daily_20161205.shape[0]))
daily_20161205_addname_dataframe.to_excel(daily_201612_excel_writer,'5_1',index=False)
daily_201612_excel_writer.save()
daily_20161206 = pro.daily(start_date='',end_date='',trade_date='20161206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161206_tscode_list = list() 
for ts_code_sh in daily_20161206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161206_tscode_list.append(stock_name)
daily_20161206_addname_dataframe=pd.DataFrame()
daily_20161206_addname_dataframe['cname'] = daily_20161206_tscode_list
for table_name in daily_20161206.columns.values.tolist():
    daily_20161206_addname_dataframe[table_name] = daily_20161206[table_name]
print("daily_20161206 返回数据 row 行数 = "+str(daily_20161206.shape[0]))
daily_20161206_addname_dataframe.to_excel(daily_201612_excel_writer,'6_2',index=False)
daily_201612_excel_writer.save()
daily_20161207 = pro.daily(start_date='',end_date='',trade_date='20161207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161207_tscode_list = list() 
for ts_code_sh in daily_20161207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161207_tscode_list.append(stock_name)
daily_20161207_addname_dataframe=pd.DataFrame()
daily_20161207_addname_dataframe['cname'] = daily_20161207_tscode_list
for table_name in daily_20161207.columns.values.tolist():
    daily_20161207_addname_dataframe[table_name] = daily_20161207[table_name]
print("daily_20161207 返回数据 row 行数 = "+str(daily_20161207.shape[0]))
daily_20161207_addname_dataframe.to_excel(daily_201612_excel_writer,'7_3',index=False)
daily_201612_excel_writer.save()
daily_20161208 = pro.daily(start_date='',end_date='',trade_date='20161208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161208_tscode_list = list() 
for ts_code_sh in daily_20161208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161208_tscode_list.append(stock_name)
daily_20161208_addname_dataframe=pd.DataFrame()
daily_20161208_addname_dataframe['cname'] = daily_20161208_tscode_list
for table_name in daily_20161208.columns.values.tolist():
    daily_20161208_addname_dataframe[table_name] = daily_20161208[table_name]
print("daily_20161208 返回数据 row 行数 = "+str(daily_20161208.shape[0]))
daily_20161208_addname_dataframe.to_excel(daily_201612_excel_writer,'8_4',index=False)
daily_201612_excel_writer.save()
daily_20161209 = pro.daily(start_date='',end_date='',trade_date='20161209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161209_tscode_list = list() 
for ts_code_sh in daily_20161209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161209_tscode_list.append(stock_name)
daily_20161209_addname_dataframe=pd.DataFrame()
daily_20161209_addname_dataframe['cname'] = daily_20161209_tscode_list
for table_name in daily_20161209.columns.values.tolist():
    daily_20161209_addname_dataframe[table_name] = daily_20161209[table_name]
print("daily_20161209 返回数据 row 行数 = "+str(daily_20161209.shape[0]))
daily_20161209_addname_dataframe.to_excel(daily_201612_excel_writer,'9_5',index=False)
daily_201612_excel_writer.save()
daily_20161210 = pro.daily(start_date='',end_date='',trade_date='20161210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161210_tscode_list = list() 
for ts_code_sh in daily_20161210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161210_tscode_list.append(stock_name)
daily_20161210_addname_dataframe=pd.DataFrame()
daily_20161210_addname_dataframe['cname'] = daily_20161210_tscode_list
for table_name in daily_20161210.columns.values.tolist():
    daily_20161210_addname_dataframe[table_name] = daily_20161210[table_name]
print("daily_20161210 返回数据 row 行数 = "+str(daily_20161210.shape[0]))
daily_20161210_addname_dataframe.to_excel(daily_201612_excel_writer,'10_6',index=False)
daily_201612_excel_writer.save()
daily_20161211 = pro.daily(start_date='',end_date='',trade_date='20161211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161211_tscode_list = list() 
for ts_code_sh in daily_20161211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161211_tscode_list.append(stock_name)
daily_20161211_addname_dataframe=pd.DataFrame()
daily_20161211_addname_dataframe['cname'] = daily_20161211_tscode_list
for table_name in daily_20161211.columns.values.tolist():
    daily_20161211_addname_dataframe[table_name] = daily_20161211[table_name]
print("daily_20161211 返回数据 row 行数 = "+str(daily_20161211.shape[0]))
daily_20161211_addname_dataframe.to_excel(daily_201612_excel_writer,'11_7',index=False)
daily_201612_excel_writer.save()
daily_20161212 = pro.daily(start_date='',end_date='',trade_date='20161212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161212_tscode_list = list() 
for ts_code_sh in daily_20161212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161212_tscode_list.append(stock_name)
daily_20161212_addname_dataframe=pd.DataFrame()
daily_20161212_addname_dataframe['cname'] = daily_20161212_tscode_list
for table_name in daily_20161212.columns.values.tolist():
    daily_20161212_addname_dataframe[table_name] = daily_20161212[table_name]
print("daily_20161212 返回数据 row 行数 = "+str(daily_20161212.shape[0]))
daily_20161212_addname_dataframe.to_excel(daily_201612_excel_writer,'12_1',index=False)
daily_201612_excel_writer.save()
daily_20161213 = pro.daily(start_date='',end_date='',trade_date='20161213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161213_tscode_list = list() 
for ts_code_sh in daily_20161213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161213_tscode_list.append(stock_name)
daily_20161213_addname_dataframe=pd.DataFrame()
daily_20161213_addname_dataframe['cname'] = daily_20161213_tscode_list
for table_name in daily_20161213.columns.values.tolist():
    daily_20161213_addname_dataframe[table_name] = daily_20161213[table_name]
print("daily_20161213 返回数据 row 行数 = "+str(daily_20161213.shape[0]))
daily_20161213_addname_dataframe.to_excel(daily_201612_excel_writer,'13_2',index=False)
daily_201612_excel_writer.save()
daily_20161214 = pro.daily(start_date='',end_date='',trade_date='20161214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161214_tscode_list = list() 
for ts_code_sh in daily_20161214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161214_tscode_list.append(stock_name)
daily_20161214_addname_dataframe=pd.DataFrame()
daily_20161214_addname_dataframe['cname'] = daily_20161214_tscode_list
for table_name in daily_20161214.columns.values.tolist():
    daily_20161214_addname_dataframe[table_name] = daily_20161214[table_name]
print("daily_20161214 返回数据 row 行数 = "+str(daily_20161214.shape[0]))
daily_20161214_addname_dataframe.to_excel(daily_201612_excel_writer,'14_3',index=False)
daily_201612_excel_writer.save()
daily_20161215 = pro.daily(start_date='',end_date='',trade_date='20161215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161215_tscode_list = list() 
for ts_code_sh in daily_20161215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161215_tscode_list.append(stock_name)
daily_20161215_addname_dataframe=pd.DataFrame()
daily_20161215_addname_dataframe['cname'] = daily_20161215_tscode_list
for table_name in daily_20161215.columns.values.tolist():
    daily_20161215_addname_dataframe[table_name] = daily_20161215[table_name]
print("daily_20161215 返回数据 row 行数 = "+str(daily_20161215.shape[0]))
daily_20161215_addname_dataframe.to_excel(daily_201612_excel_writer,'15_4',index=False)
daily_201612_excel_writer.save()
daily_20161216 = pro.daily(start_date='',end_date='',trade_date='20161216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161216_tscode_list = list() 
for ts_code_sh in daily_20161216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161216_tscode_list.append(stock_name)
daily_20161216_addname_dataframe=pd.DataFrame()
daily_20161216_addname_dataframe['cname'] = daily_20161216_tscode_list
for table_name in daily_20161216.columns.values.tolist():
    daily_20161216_addname_dataframe[table_name] = daily_20161216[table_name]
print("daily_20161216 返回数据 row 行数 = "+str(daily_20161216.shape[0]))
daily_20161216_addname_dataframe.to_excel(daily_201612_excel_writer,'16_5',index=False)
daily_201612_excel_writer.save()
daily_20161217 = pro.daily(start_date='',end_date='',trade_date='20161217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161217_tscode_list = list() 
for ts_code_sh in daily_20161217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161217_tscode_list.append(stock_name)
daily_20161217_addname_dataframe=pd.DataFrame()
daily_20161217_addname_dataframe['cname'] = daily_20161217_tscode_list
for table_name in daily_20161217.columns.values.tolist():
    daily_20161217_addname_dataframe[table_name] = daily_20161217[table_name]
print("daily_20161217 返回数据 row 行数 = "+str(daily_20161217.shape[0]))
daily_20161217_addname_dataframe.to_excel(daily_201612_excel_writer,'17_6',index=False)
daily_201612_excel_writer.save()
daily_20161218 = pro.daily(start_date='',end_date='',trade_date='20161218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161218_tscode_list = list() 
for ts_code_sh in daily_20161218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161218_tscode_list.append(stock_name)
daily_20161218_addname_dataframe=pd.DataFrame()
daily_20161218_addname_dataframe['cname'] = daily_20161218_tscode_list
for table_name in daily_20161218.columns.values.tolist():
    daily_20161218_addname_dataframe[table_name] = daily_20161218[table_name]
print("daily_20161218 返回数据 row 行数 = "+str(daily_20161218.shape[0]))
daily_20161218_addname_dataframe.to_excel(daily_201612_excel_writer,'18_7',index=False)
daily_201612_excel_writer.save()
daily_20161219 = pro.daily(start_date='',end_date='',trade_date='20161219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161219_tscode_list = list() 
for ts_code_sh in daily_20161219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161219_tscode_list.append(stock_name)
daily_20161219_addname_dataframe=pd.DataFrame()
daily_20161219_addname_dataframe['cname'] = daily_20161219_tscode_list
for table_name in daily_20161219.columns.values.tolist():
    daily_20161219_addname_dataframe[table_name] = daily_20161219[table_name]
print("daily_20161219 返回数据 row 行数 = "+str(daily_20161219.shape[0]))
daily_20161219_addname_dataframe.to_excel(daily_201612_excel_writer,'19_1',index=False)
daily_201612_excel_writer.save()
daily_20161220 = pro.daily(start_date='',end_date='',trade_date='20161220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161220_tscode_list = list() 
for ts_code_sh in daily_20161220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161220_tscode_list.append(stock_name)
daily_20161220_addname_dataframe=pd.DataFrame()
daily_20161220_addname_dataframe['cname'] = daily_20161220_tscode_list
for table_name in daily_20161220.columns.values.tolist():
    daily_20161220_addname_dataframe[table_name] = daily_20161220[table_name]
print("daily_20161220 返回数据 row 行数 = "+str(daily_20161220.shape[0]))
daily_20161220_addname_dataframe.to_excel(daily_201612_excel_writer,'20_2',index=False)
daily_201612_excel_writer.save()
daily_20161221 = pro.daily(start_date='',end_date='',trade_date='20161221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161221_tscode_list = list() 
for ts_code_sh in daily_20161221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161221_tscode_list.append(stock_name)
daily_20161221_addname_dataframe=pd.DataFrame()
daily_20161221_addname_dataframe['cname'] = daily_20161221_tscode_list
for table_name in daily_20161221.columns.values.tolist():
    daily_20161221_addname_dataframe[table_name] = daily_20161221[table_name]
print("daily_20161221 返回数据 row 行数 = "+str(daily_20161221.shape[0]))
daily_20161221_addname_dataframe.to_excel(daily_201612_excel_writer,'21_3',index=False)
daily_201612_excel_writer.save()
daily_20161222 = pro.daily(start_date='',end_date='',trade_date='20161222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161222_tscode_list = list() 
for ts_code_sh in daily_20161222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161222_tscode_list.append(stock_name)
daily_20161222_addname_dataframe=pd.DataFrame()
daily_20161222_addname_dataframe['cname'] = daily_20161222_tscode_list
for table_name in daily_20161222.columns.values.tolist():
    daily_20161222_addname_dataframe[table_name] = daily_20161222[table_name]
print("daily_20161222 返回数据 row 行数 = "+str(daily_20161222.shape[0]))
daily_20161222_addname_dataframe.to_excel(daily_201612_excel_writer,'22_4',index=False)
daily_201612_excel_writer.save()
daily_20161223 = pro.daily(start_date='',end_date='',trade_date='20161223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161223_tscode_list = list() 
for ts_code_sh in daily_20161223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161223_tscode_list.append(stock_name)
daily_20161223_addname_dataframe=pd.DataFrame()
daily_20161223_addname_dataframe['cname'] = daily_20161223_tscode_list
for table_name in daily_20161223.columns.values.tolist():
    daily_20161223_addname_dataframe[table_name] = daily_20161223[table_name]
print("daily_20161223 返回数据 row 行数 = "+str(daily_20161223.shape[0]))
daily_20161223_addname_dataframe.to_excel(daily_201612_excel_writer,'23_5',index=False)
daily_201612_excel_writer.save()
daily_20161224 = pro.daily(start_date='',end_date='',trade_date='20161224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161224_tscode_list = list() 
for ts_code_sh in daily_20161224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161224_tscode_list.append(stock_name)
daily_20161224_addname_dataframe=pd.DataFrame()
daily_20161224_addname_dataframe['cname'] = daily_20161224_tscode_list
for table_name in daily_20161224.columns.values.tolist():
    daily_20161224_addname_dataframe[table_name] = daily_20161224[table_name]
print("daily_20161224 返回数据 row 行数 = "+str(daily_20161224.shape[0]))
daily_20161224_addname_dataframe.to_excel(daily_201612_excel_writer,'24_6',index=False)
daily_201612_excel_writer.save()
daily_20161225 = pro.daily(start_date='',end_date='',trade_date='20161225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161225_tscode_list = list() 
for ts_code_sh in daily_20161225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161225_tscode_list.append(stock_name)
daily_20161225_addname_dataframe=pd.DataFrame()
daily_20161225_addname_dataframe['cname'] = daily_20161225_tscode_list
for table_name in daily_20161225.columns.values.tolist():
    daily_20161225_addname_dataframe[table_name] = daily_20161225[table_name]
print("daily_20161225 返回数据 row 行数 = "+str(daily_20161225.shape[0]))
daily_20161225_addname_dataframe.to_excel(daily_201612_excel_writer,'25_7',index=False)
daily_201612_excel_writer.save()
daily_20161226 = pro.daily(start_date='',end_date='',trade_date='20161226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161226_tscode_list = list() 
for ts_code_sh in daily_20161226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161226_tscode_list.append(stock_name)
daily_20161226_addname_dataframe=pd.DataFrame()
daily_20161226_addname_dataframe['cname'] = daily_20161226_tscode_list
for table_name in daily_20161226.columns.values.tolist():
    daily_20161226_addname_dataframe[table_name] = daily_20161226[table_name]
print("daily_20161226 返回数据 row 行数 = "+str(daily_20161226.shape[0]))
daily_20161226_addname_dataframe.to_excel(daily_201612_excel_writer,'26_1',index=False)
daily_201612_excel_writer.save()
daily_20161227 = pro.daily(start_date='',end_date='',trade_date='20161227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161227_tscode_list = list() 
for ts_code_sh in daily_20161227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161227_tscode_list.append(stock_name)
daily_20161227_addname_dataframe=pd.DataFrame()
daily_20161227_addname_dataframe['cname'] = daily_20161227_tscode_list
for table_name in daily_20161227.columns.values.tolist():
    daily_20161227_addname_dataframe[table_name] = daily_20161227[table_name]
print("daily_20161227 返回数据 row 行数 = "+str(daily_20161227.shape[0]))
daily_20161227_addname_dataframe.to_excel(daily_201612_excel_writer,'27_2',index=False)
daily_201612_excel_writer.save()
daily_20161228 = pro.daily(start_date='',end_date='',trade_date='20161228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161228_tscode_list = list() 
for ts_code_sh in daily_20161228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161228_tscode_list.append(stock_name)
daily_20161228_addname_dataframe=pd.DataFrame()
daily_20161228_addname_dataframe['cname'] = daily_20161228_tscode_list
for table_name in daily_20161228.columns.values.tolist():
    daily_20161228_addname_dataframe[table_name] = daily_20161228[table_name]
print("daily_20161228 返回数据 row 行数 = "+str(daily_20161228.shape[0]))
daily_20161228_addname_dataframe.to_excel(daily_201612_excel_writer,'28_3',index=False)
daily_201612_excel_writer.save()
daily_20161229 = pro.daily(start_date='',end_date='',trade_date='20161229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161229_tscode_list = list() 
for ts_code_sh in daily_20161229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161229_tscode_list.append(stock_name)
daily_20161229_addname_dataframe=pd.DataFrame()
daily_20161229_addname_dataframe['cname'] = daily_20161229_tscode_list
for table_name in daily_20161229.columns.values.tolist():
    daily_20161229_addname_dataframe[table_name] = daily_20161229[table_name]
print("daily_20161229 返回数据 row 行数 = "+str(daily_20161229.shape[0]))
daily_20161229_addname_dataframe.to_excel(daily_201612_excel_writer,'29_4',index=False)
daily_201612_excel_writer.save()
daily_20161230 = pro.daily(start_date='',end_date='',trade_date='20161230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161230_tscode_list = list() 
for ts_code_sh in daily_20161230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161230_tscode_list.append(stock_name)
daily_20161230_addname_dataframe=pd.DataFrame()
daily_20161230_addname_dataframe['cname'] = daily_20161230_tscode_list
for table_name in daily_20161230.columns.values.tolist():
    daily_20161230_addname_dataframe[table_name] = daily_20161230[table_name]
print("daily_20161230 返回数据 row 行数 = "+str(daily_20161230.shape[0]))
daily_20161230_addname_dataframe.to_excel(daily_201612_excel_writer,'30_5',index=False)
daily_201612_excel_writer.save()
daily_20161231 = pro.daily(start_date='',end_date='',trade_date='20161231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161231_tscode_list = list() 
for ts_code_sh in daily_20161231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161231_tscode_list.append(stock_name)
daily_20161231_addname_dataframe=pd.DataFrame()
daily_20161231_addname_dataframe['cname'] = daily_20161231_tscode_list
for table_name in daily_20161231.columns.values.tolist():
    daily_20161231_addname_dataframe[table_name] = daily_20161231[table_name]
print("daily_20161231 返回数据 row 行数 = "+str(daily_20161231.shape[0]))
daily_20161231_addname_dataframe.to_excel(daily_201612_excel_writer,'31_6',index=False)
daily_201612_excel_writer.save()




createexcel('daily_201701.xlsx')
daily_201701_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201701.xlsx')
daily_201701_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201701.xlsx', engine='openpyxl')
daily_201701_excel_writer.book = daily_201701_book
daily_201701_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201701_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170101")       ###  更新 记录日期
daily_20170101 = pro.daily(start_date='',end_date='',trade_date='20170101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170101_tscode_list = list() 
for ts_code_sh in daily_20170101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170101_tscode_list.append(stock_name)
daily_20170101_addname_dataframe=pd.DataFrame()
daily_20170101_addname_dataframe['cname'] = daily_20170101_tscode_list
for table_name in daily_20170101.columns.values.tolist():
    daily_20170101_addname_dataframe[table_name] = daily_20170101[table_name]
print("daily_20170101 返回数据 row 行数 = "+str(daily_20170101.shape[0]))
daily_20170101_addname_dataframe.to_excel(daily_201701_excel_writer,'1_7',index=False)
daily_201701_excel_writer.save()
daily_20170102 = pro.daily(start_date='',end_date='',trade_date='20170102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170102_tscode_list = list() 
for ts_code_sh in daily_20170102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170102_tscode_list.append(stock_name)
daily_20170102_addname_dataframe=pd.DataFrame()
daily_20170102_addname_dataframe['cname'] = daily_20170102_tscode_list
for table_name in daily_20170102.columns.values.tolist():
    daily_20170102_addname_dataframe[table_name] = daily_20170102[table_name]
print("daily_20170102 返回数据 row 行数 = "+str(daily_20170102.shape[0]))
daily_20170102_addname_dataframe.to_excel(daily_201701_excel_writer,'2_1',index=False)
daily_201701_excel_writer.save()
daily_20170103 = pro.daily(start_date='',end_date='',trade_date='20170103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170103_tscode_list = list() 
for ts_code_sh in daily_20170103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170103_tscode_list.append(stock_name)
daily_20170103_addname_dataframe=pd.DataFrame()
daily_20170103_addname_dataframe['cname'] = daily_20170103_tscode_list
for table_name in daily_20170103.columns.values.tolist():
    daily_20170103_addname_dataframe[table_name] = daily_20170103[table_name]
print("daily_20170103 返回数据 row 行数 = "+str(daily_20170103.shape[0]))
daily_20170103_addname_dataframe.to_excel(daily_201701_excel_writer,'3_2',index=False)
daily_201701_excel_writer.save()
daily_20170104 = pro.daily(start_date='',end_date='',trade_date='20170104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170104_tscode_list = list() 
for ts_code_sh in daily_20170104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170104_tscode_list.append(stock_name)
daily_20170104_addname_dataframe=pd.DataFrame()
daily_20170104_addname_dataframe['cname'] = daily_20170104_tscode_list
for table_name in daily_20170104.columns.values.tolist():
    daily_20170104_addname_dataframe[table_name] = daily_20170104[table_name]
print("daily_20170104 返回数据 row 行数 = "+str(daily_20170104.shape[0]))
daily_20170104_addname_dataframe.to_excel(daily_201701_excel_writer,'4_3',index=False)
daily_201701_excel_writer.save()
daily_20170105 = pro.daily(start_date='',end_date='',trade_date='20170105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170105_tscode_list = list() 
for ts_code_sh in daily_20170105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170105_tscode_list.append(stock_name)
daily_20170105_addname_dataframe=pd.DataFrame()
daily_20170105_addname_dataframe['cname'] = daily_20170105_tscode_list
for table_name in daily_20170105.columns.values.tolist():
    daily_20170105_addname_dataframe[table_name] = daily_20170105[table_name]
print("daily_20170105 返回数据 row 行数 = "+str(daily_20170105.shape[0]))
daily_20170105_addname_dataframe.to_excel(daily_201701_excel_writer,'5_4',index=False)
daily_201701_excel_writer.save()
daily_20170106 = pro.daily(start_date='',end_date='',trade_date='20170106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170106_tscode_list = list() 
for ts_code_sh in daily_20170106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170106_tscode_list.append(stock_name)
daily_20170106_addname_dataframe=pd.DataFrame()
daily_20170106_addname_dataframe['cname'] = daily_20170106_tscode_list
for table_name in daily_20170106.columns.values.tolist():
    daily_20170106_addname_dataframe[table_name] = daily_20170106[table_name]
print("daily_20170106 返回数据 row 行数 = "+str(daily_20170106.shape[0]))
daily_20170106_addname_dataframe.to_excel(daily_201701_excel_writer,'6_5',index=False)
daily_201701_excel_writer.save()
daily_20170107 = pro.daily(start_date='',end_date='',trade_date='20170107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170107_tscode_list = list() 
for ts_code_sh in daily_20170107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170107_tscode_list.append(stock_name)
daily_20170107_addname_dataframe=pd.DataFrame()
daily_20170107_addname_dataframe['cname'] = daily_20170107_tscode_list
for table_name in daily_20170107.columns.values.tolist():
    daily_20170107_addname_dataframe[table_name] = daily_20170107[table_name]
print("daily_20170107 返回数据 row 行数 = "+str(daily_20170107.shape[0]))
daily_20170107_addname_dataframe.to_excel(daily_201701_excel_writer,'7_6',index=False)
daily_201701_excel_writer.save()
daily_20170108 = pro.daily(start_date='',end_date='',trade_date='20170108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170108_tscode_list = list() 
for ts_code_sh in daily_20170108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170108_tscode_list.append(stock_name)
daily_20170108_addname_dataframe=pd.DataFrame()
daily_20170108_addname_dataframe['cname'] = daily_20170108_tscode_list
for table_name in daily_20170108.columns.values.tolist():
    daily_20170108_addname_dataframe[table_name] = daily_20170108[table_name]
print("daily_20170108 返回数据 row 行数 = "+str(daily_20170108.shape[0]))
daily_20170108_addname_dataframe.to_excel(daily_201701_excel_writer,'8_7',index=False)
daily_201701_excel_writer.save()
daily_20170109 = pro.daily(start_date='',end_date='',trade_date='20170109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170109_tscode_list = list() 
for ts_code_sh in daily_20170109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170109_tscode_list.append(stock_name)
daily_20170109_addname_dataframe=pd.DataFrame()
daily_20170109_addname_dataframe['cname'] = daily_20170109_tscode_list
for table_name in daily_20170109.columns.values.tolist():
    daily_20170109_addname_dataframe[table_name] = daily_20170109[table_name]
print("daily_20170109 返回数据 row 行数 = "+str(daily_20170109.shape[0]))
daily_20170109_addname_dataframe.to_excel(daily_201701_excel_writer,'9_1',index=False)
daily_201701_excel_writer.save()
daily_20170110 = pro.daily(start_date='',end_date='',trade_date='20170110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170110_tscode_list = list() 
for ts_code_sh in daily_20170110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170110_tscode_list.append(stock_name)
daily_20170110_addname_dataframe=pd.DataFrame()
daily_20170110_addname_dataframe['cname'] = daily_20170110_tscode_list
for table_name in daily_20170110.columns.values.tolist():
    daily_20170110_addname_dataframe[table_name] = daily_20170110[table_name]
print("daily_20170110 返回数据 row 行数 = "+str(daily_20170110.shape[0]))
daily_20170110_addname_dataframe.to_excel(daily_201701_excel_writer,'10_2',index=False)
daily_201701_excel_writer.save()
daily_20170111 = pro.daily(start_date='',end_date='',trade_date='20170111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170111_tscode_list = list() 
for ts_code_sh in daily_20170111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170111_tscode_list.append(stock_name)
daily_20170111_addname_dataframe=pd.DataFrame()
daily_20170111_addname_dataframe['cname'] = daily_20170111_tscode_list
for table_name in daily_20170111.columns.values.tolist():
    daily_20170111_addname_dataframe[table_name] = daily_20170111[table_name]
print("daily_20170111 返回数据 row 行数 = "+str(daily_20170111.shape[0]))
daily_20170111_addname_dataframe.to_excel(daily_201701_excel_writer,'11_3',index=False)
daily_201701_excel_writer.save()
daily_20170112 = pro.daily(start_date='',end_date='',trade_date='20170112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170112_tscode_list = list() 
for ts_code_sh in daily_20170112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170112_tscode_list.append(stock_name)
daily_20170112_addname_dataframe=pd.DataFrame()
daily_20170112_addname_dataframe['cname'] = daily_20170112_tscode_list
for table_name in daily_20170112.columns.values.tolist():
    daily_20170112_addname_dataframe[table_name] = daily_20170112[table_name]
print("daily_20170112 返回数据 row 行数 = "+str(daily_20170112.shape[0]))
daily_20170112_addname_dataframe.to_excel(daily_201701_excel_writer,'12_4',index=False)
daily_201701_excel_writer.save()
daily_20170113 = pro.daily(start_date='',end_date='',trade_date='20170113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170113_tscode_list = list() 
for ts_code_sh in daily_20170113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170113_tscode_list.append(stock_name)
daily_20170113_addname_dataframe=pd.DataFrame()
daily_20170113_addname_dataframe['cname'] = daily_20170113_tscode_list
for table_name in daily_20170113.columns.values.tolist():
    daily_20170113_addname_dataframe[table_name] = daily_20170113[table_name]
print("daily_20170113 返回数据 row 行数 = "+str(daily_20170113.shape[0]))
daily_20170113_addname_dataframe.to_excel(daily_201701_excel_writer,'13_5',index=False)
daily_201701_excel_writer.save()
daily_20170114 = pro.daily(start_date='',end_date='',trade_date='20170114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170114_tscode_list = list() 
for ts_code_sh in daily_20170114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170114_tscode_list.append(stock_name)
daily_20170114_addname_dataframe=pd.DataFrame()
daily_20170114_addname_dataframe['cname'] = daily_20170114_tscode_list
for table_name in daily_20170114.columns.values.tolist():
    daily_20170114_addname_dataframe[table_name] = daily_20170114[table_name]
print("daily_20170114 返回数据 row 行数 = "+str(daily_20170114.shape[0]))
daily_20170114_addname_dataframe.to_excel(daily_201701_excel_writer,'14_6',index=False)
daily_201701_excel_writer.save()
daily_20170115 = pro.daily(start_date='',end_date='',trade_date='20170115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170115_tscode_list = list() 
for ts_code_sh in daily_20170115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170115_tscode_list.append(stock_name)
daily_20170115_addname_dataframe=pd.DataFrame()
daily_20170115_addname_dataframe['cname'] = daily_20170115_tscode_list
for table_name in daily_20170115.columns.values.tolist():
    daily_20170115_addname_dataframe[table_name] = daily_20170115[table_name]
print("daily_20170115 返回数据 row 行数 = "+str(daily_20170115.shape[0]))
daily_20170115_addname_dataframe.to_excel(daily_201701_excel_writer,'15_7',index=False)
daily_201701_excel_writer.save()
daily_20170116 = pro.daily(start_date='',end_date='',trade_date='20170116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170116_tscode_list = list() 
for ts_code_sh in daily_20170116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170116_tscode_list.append(stock_name)
daily_20170116_addname_dataframe=pd.DataFrame()
daily_20170116_addname_dataframe['cname'] = daily_20170116_tscode_list
for table_name in daily_20170116.columns.values.tolist():
    daily_20170116_addname_dataframe[table_name] = daily_20170116[table_name]
print("daily_20170116 返回数据 row 行数 = "+str(daily_20170116.shape[0]))
daily_20170116_addname_dataframe.to_excel(daily_201701_excel_writer,'16_1',index=False)
daily_201701_excel_writer.save()
daily_20170117 = pro.daily(start_date='',end_date='',trade_date='20170117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170117_tscode_list = list() 
for ts_code_sh in daily_20170117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170117_tscode_list.append(stock_name)
daily_20170117_addname_dataframe=pd.DataFrame()
daily_20170117_addname_dataframe['cname'] = daily_20170117_tscode_list
for table_name in daily_20170117.columns.values.tolist():
    daily_20170117_addname_dataframe[table_name] = daily_20170117[table_name]
print("daily_20170117 返回数据 row 行数 = "+str(daily_20170117.shape[0]))
daily_20170117_addname_dataframe.to_excel(daily_201701_excel_writer,'17_2',index=False)
daily_201701_excel_writer.save()
daily_20170118 = pro.daily(start_date='',end_date='',trade_date='20170118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170118_tscode_list = list() 
for ts_code_sh in daily_20170118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170118_tscode_list.append(stock_name)
daily_20170118_addname_dataframe=pd.DataFrame()
daily_20170118_addname_dataframe['cname'] = daily_20170118_tscode_list
for table_name in daily_20170118.columns.values.tolist():
    daily_20170118_addname_dataframe[table_name] = daily_20170118[table_name]
print("daily_20170118 返回数据 row 行数 = "+str(daily_20170118.shape[0]))
daily_20170118_addname_dataframe.to_excel(daily_201701_excel_writer,'18_3',index=False)
daily_201701_excel_writer.save()
daily_20170119 = pro.daily(start_date='',end_date='',trade_date='20170119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170119_tscode_list = list() 
for ts_code_sh in daily_20170119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170119_tscode_list.append(stock_name)
daily_20170119_addname_dataframe=pd.DataFrame()
daily_20170119_addname_dataframe['cname'] = daily_20170119_tscode_list
for table_name in daily_20170119.columns.values.tolist():
    daily_20170119_addname_dataframe[table_name] = daily_20170119[table_name]
print("daily_20170119 返回数据 row 行数 = "+str(daily_20170119.shape[0]))
daily_20170119_addname_dataframe.to_excel(daily_201701_excel_writer,'19_4',index=False)
daily_201701_excel_writer.save()
daily_20170120 = pro.daily(start_date='',end_date='',trade_date='20170120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170120_tscode_list = list() 
for ts_code_sh in daily_20170120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170120_tscode_list.append(stock_name)
daily_20170120_addname_dataframe=pd.DataFrame()
daily_20170120_addname_dataframe['cname'] = daily_20170120_tscode_list
for table_name in daily_20170120.columns.values.tolist():
    daily_20170120_addname_dataframe[table_name] = daily_20170120[table_name]
print("daily_20170120 返回数据 row 行数 = "+str(daily_20170120.shape[0]))
daily_20170120_addname_dataframe.to_excel(daily_201701_excel_writer,'20_5',index=False)
daily_201701_excel_writer.save()
daily_20170121 = pro.daily(start_date='',end_date='',trade_date='20170121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170121_tscode_list = list() 
for ts_code_sh in daily_20170121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170121_tscode_list.append(stock_name)
daily_20170121_addname_dataframe=pd.DataFrame()
daily_20170121_addname_dataframe['cname'] = daily_20170121_tscode_list
for table_name in daily_20170121.columns.values.tolist():
    daily_20170121_addname_dataframe[table_name] = daily_20170121[table_name]
print("daily_20170121 返回数据 row 行数 = "+str(daily_20170121.shape[0]))
daily_20170121_addname_dataframe.to_excel(daily_201701_excel_writer,'21_6',index=False)
daily_201701_excel_writer.save()
daily_20170122 = pro.daily(start_date='',end_date='',trade_date='20170122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170122_tscode_list = list() 
for ts_code_sh in daily_20170122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170122_tscode_list.append(stock_name)
daily_20170122_addname_dataframe=pd.DataFrame()
daily_20170122_addname_dataframe['cname'] = daily_20170122_tscode_list
for table_name in daily_20170122.columns.values.tolist():
    daily_20170122_addname_dataframe[table_name] = daily_20170122[table_name]
print("daily_20170122 返回数据 row 行数 = "+str(daily_20170122.shape[0]))
daily_20170122_addname_dataframe.to_excel(daily_201701_excel_writer,'22_7',index=False)
daily_201701_excel_writer.save()
daily_20170123 = pro.daily(start_date='',end_date='',trade_date='20170123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170123_tscode_list = list() 
for ts_code_sh in daily_20170123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170123_tscode_list.append(stock_name)
daily_20170123_addname_dataframe=pd.DataFrame()
daily_20170123_addname_dataframe['cname'] = daily_20170123_tscode_list
for table_name in daily_20170123.columns.values.tolist():
    daily_20170123_addname_dataframe[table_name] = daily_20170123[table_name]
print("daily_20170123 返回数据 row 行数 = "+str(daily_20170123.shape[0]))
daily_20170123_addname_dataframe.to_excel(daily_201701_excel_writer,'23_1',index=False)
daily_201701_excel_writer.save()
daily_20170124 = pro.daily(start_date='',end_date='',trade_date='20170124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170124_tscode_list = list() 
for ts_code_sh in daily_20170124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170124_tscode_list.append(stock_name)
daily_20170124_addname_dataframe=pd.DataFrame()
daily_20170124_addname_dataframe['cname'] = daily_20170124_tscode_list
for table_name in daily_20170124.columns.values.tolist():
    daily_20170124_addname_dataframe[table_name] = daily_20170124[table_name]
print("daily_20170124 返回数据 row 行数 = "+str(daily_20170124.shape[0]))
daily_20170124_addname_dataframe.to_excel(daily_201701_excel_writer,'24_2',index=False)
daily_201701_excel_writer.save()
daily_20170125 = pro.daily(start_date='',end_date='',trade_date='20170125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170125_tscode_list = list() 
for ts_code_sh in daily_20170125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170125_tscode_list.append(stock_name)
daily_20170125_addname_dataframe=pd.DataFrame()
daily_20170125_addname_dataframe['cname'] = daily_20170125_tscode_list
for table_name in daily_20170125.columns.values.tolist():
    daily_20170125_addname_dataframe[table_name] = daily_20170125[table_name]
print("daily_20170125 返回数据 row 行数 = "+str(daily_20170125.shape[0]))
daily_20170125_addname_dataframe.to_excel(daily_201701_excel_writer,'25_3',index=False)
daily_201701_excel_writer.save()
daily_20170126 = pro.daily(start_date='',end_date='',trade_date='20170126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170126_tscode_list = list() 
for ts_code_sh in daily_20170126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170126_tscode_list.append(stock_name)
daily_20170126_addname_dataframe=pd.DataFrame()
daily_20170126_addname_dataframe['cname'] = daily_20170126_tscode_list
for table_name in daily_20170126.columns.values.tolist():
    daily_20170126_addname_dataframe[table_name] = daily_20170126[table_name]
print("daily_20170126 返回数据 row 行数 = "+str(daily_20170126.shape[0]))
daily_20170126_addname_dataframe.to_excel(daily_201701_excel_writer,'26_4',index=False)
daily_201701_excel_writer.save()
daily_20170127 = pro.daily(start_date='',end_date='',trade_date='20170127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170127_tscode_list = list() 
for ts_code_sh in daily_20170127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170127_tscode_list.append(stock_name)
daily_20170127_addname_dataframe=pd.DataFrame()
daily_20170127_addname_dataframe['cname'] = daily_20170127_tscode_list
for table_name in daily_20170127.columns.values.tolist():
    daily_20170127_addname_dataframe[table_name] = daily_20170127[table_name]
print("daily_20170127 返回数据 row 行数 = "+str(daily_20170127.shape[0]))
daily_20170127_addname_dataframe.to_excel(daily_201701_excel_writer,'27_5',index=False)
daily_201701_excel_writer.save()
daily_20170128 = pro.daily(start_date='',end_date='',trade_date='20170128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170128_tscode_list = list() 
for ts_code_sh in daily_20170128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170128_tscode_list.append(stock_name)
daily_20170128_addname_dataframe=pd.DataFrame()
daily_20170128_addname_dataframe['cname'] = daily_20170128_tscode_list
for table_name in daily_20170128.columns.values.tolist():
    daily_20170128_addname_dataframe[table_name] = daily_20170128[table_name]
print("daily_20170128 返回数据 row 行数 = "+str(daily_20170128.shape[0]))
daily_20170128_addname_dataframe.to_excel(daily_201701_excel_writer,'28_6',index=False)
daily_201701_excel_writer.save()
daily_20170129 = pro.daily(start_date='',end_date='',trade_date='20170129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170129_tscode_list = list() 
for ts_code_sh in daily_20170129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170129_tscode_list.append(stock_name)
daily_20170129_addname_dataframe=pd.DataFrame()
daily_20170129_addname_dataframe['cname'] = daily_20170129_tscode_list
for table_name in daily_20170129.columns.values.tolist():
    daily_20170129_addname_dataframe[table_name] = daily_20170129[table_name]
print("daily_20170129 返回数据 row 行数 = "+str(daily_20170129.shape[0]))
daily_20170129_addname_dataframe.to_excel(daily_201701_excel_writer,'29_7',index=False)
daily_201701_excel_writer.save()
daily_20170130 = pro.daily(start_date='',end_date='',trade_date='20170130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170130_tscode_list = list() 
for ts_code_sh in daily_20170130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170130_tscode_list.append(stock_name)
daily_20170130_addname_dataframe=pd.DataFrame()
daily_20170130_addname_dataframe['cname'] = daily_20170130_tscode_list
for table_name in daily_20170130.columns.values.tolist():
    daily_20170130_addname_dataframe[table_name] = daily_20170130[table_name]
print("daily_20170130 返回数据 row 行数 = "+str(daily_20170130.shape[0]))
daily_20170130_addname_dataframe.to_excel(daily_201701_excel_writer,'30_1',index=False)
daily_201701_excel_writer.save()
daily_20170131 = pro.daily(start_date='',end_date='',trade_date='20170131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170131_tscode_list = list() 
for ts_code_sh in daily_20170131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170131_tscode_list.append(stock_name)
daily_20170131_addname_dataframe=pd.DataFrame()
daily_20170131_addname_dataframe['cname'] = daily_20170131_tscode_list
for table_name in daily_20170131.columns.values.tolist():
    daily_20170131_addname_dataframe[table_name] = daily_20170131[table_name]
print("daily_20170131 返回数据 row 行数 = "+str(daily_20170131.shape[0]))
daily_20170131_addname_dataframe.to_excel(daily_201701_excel_writer,'31_2',index=False)
daily_201701_excel_writer.save()




createexcel('daily_201702.xlsx')
daily_201702_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201702.xlsx')
daily_201702_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201702.xlsx', engine='openpyxl')
daily_201702_excel_writer.book = daily_201702_book
daily_201702_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201702_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170201")       ###  更新 记录日期
daily_20170201 = pro.daily(start_date='',end_date='',trade_date='20170201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170201_tscode_list = list() 
for ts_code_sh in daily_20170201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170201_tscode_list.append(stock_name)
daily_20170201_addname_dataframe=pd.DataFrame()
daily_20170201_addname_dataframe['cname'] = daily_20170201_tscode_list
for table_name in daily_20170201.columns.values.tolist():
    daily_20170201_addname_dataframe[table_name] = daily_20170201[table_name]
print("daily_20170201 返回数据 row 行数 = "+str(daily_20170201.shape[0]))
daily_20170201_addname_dataframe.to_excel(daily_201702_excel_writer,'1_3',index=False)
daily_201702_excel_writer.save()
daily_20170202 = pro.daily(start_date='',end_date='',trade_date='20170202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170202_tscode_list = list() 
for ts_code_sh in daily_20170202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170202_tscode_list.append(stock_name)
daily_20170202_addname_dataframe=pd.DataFrame()
daily_20170202_addname_dataframe['cname'] = daily_20170202_tscode_list
for table_name in daily_20170202.columns.values.tolist():
    daily_20170202_addname_dataframe[table_name] = daily_20170202[table_name]
print("daily_20170202 返回数据 row 行数 = "+str(daily_20170202.shape[0]))
daily_20170202_addname_dataframe.to_excel(daily_201702_excel_writer,'2_4',index=False)
daily_201702_excel_writer.save()
daily_20170203 = pro.daily(start_date='',end_date='',trade_date='20170203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170203_tscode_list = list() 
for ts_code_sh in daily_20170203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170203_tscode_list.append(stock_name)
daily_20170203_addname_dataframe=pd.DataFrame()
daily_20170203_addname_dataframe['cname'] = daily_20170203_tscode_list
for table_name in daily_20170203.columns.values.tolist():
    daily_20170203_addname_dataframe[table_name] = daily_20170203[table_name]
print("daily_20170203 返回数据 row 行数 = "+str(daily_20170203.shape[0]))
daily_20170203_addname_dataframe.to_excel(daily_201702_excel_writer,'3_5',index=False)
daily_201702_excel_writer.save()
daily_20170204 = pro.daily(start_date='',end_date='',trade_date='20170204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170204_tscode_list = list() 
for ts_code_sh in daily_20170204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170204_tscode_list.append(stock_name)
daily_20170204_addname_dataframe=pd.DataFrame()
daily_20170204_addname_dataframe['cname'] = daily_20170204_tscode_list
for table_name in daily_20170204.columns.values.tolist():
    daily_20170204_addname_dataframe[table_name] = daily_20170204[table_name]
print("daily_20170204 返回数据 row 行数 = "+str(daily_20170204.shape[0]))
daily_20170204_addname_dataframe.to_excel(daily_201702_excel_writer,'4_6',index=False)
daily_201702_excel_writer.save()
daily_20170205 = pro.daily(start_date='',end_date='',trade_date='20170205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170205_tscode_list = list() 
for ts_code_sh in daily_20170205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170205_tscode_list.append(stock_name)
daily_20170205_addname_dataframe=pd.DataFrame()
daily_20170205_addname_dataframe['cname'] = daily_20170205_tscode_list
for table_name in daily_20170205.columns.values.tolist():
    daily_20170205_addname_dataframe[table_name] = daily_20170205[table_name]
print("daily_20170205 返回数据 row 行数 = "+str(daily_20170205.shape[0]))
daily_20170205_addname_dataframe.to_excel(daily_201702_excel_writer,'5_7',index=False)
daily_201702_excel_writer.save()
daily_20170206 = pro.daily(start_date='',end_date='',trade_date='20170206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170206_tscode_list = list() 
for ts_code_sh in daily_20170206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170206_tscode_list.append(stock_name)
daily_20170206_addname_dataframe=pd.DataFrame()
daily_20170206_addname_dataframe['cname'] = daily_20170206_tscode_list
for table_name in daily_20170206.columns.values.tolist():
    daily_20170206_addname_dataframe[table_name] = daily_20170206[table_name]
print("daily_20170206 返回数据 row 行数 = "+str(daily_20170206.shape[0]))
daily_20170206_addname_dataframe.to_excel(daily_201702_excel_writer,'6_1',index=False)
daily_201702_excel_writer.save()
daily_20170207 = pro.daily(start_date='',end_date='',trade_date='20170207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170207_tscode_list = list() 
for ts_code_sh in daily_20170207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170207_tscode_list.append(stock_name)
daily_20170207_addname_dataframe=pd.DataFrame()
daily_20170207_addname_dataframe['cname'] = daily_20170207_tscode_list
for table_name in daily_20170207.columns.values.tolist():
    daily_20170207_addname_dataframe[table_name] = daily_20170207[table_name]
print("daily_20170207 返回数据 row 行数 = "+str(daily_20170207.shape[0]))
daily_20170207_addname_dataframe.to_excel(daily_201702_excel_writer,'7_2',index=False)
daily_201702_excel_writer.save()
daily_20170208 = pro.daily(start_date='',end_date='',trade_date='20170208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170208_tscode_list = list() 
for ts_code_sh in daily_20170208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170208_tscode_list.append(stock_name)
daily_20170208_addname_dataframe=pd.DataFrame()
daily_20170208_addname_dataframe['cname'] = daily_20170208_tscode_list
for table_name in daily_20170208.columns.values.tolist():
    daily_20170208_addname_dataframe[table_name] = daily_20170208[table_name]
print("daily_20170208 返回数据 row 行数 = "+str(daily_20170208.shape[0]))
daily_20170208_addname_dataframe.to_excel(daily_201702_excel_writer,'8_3',index=False)
daily_201702_excel_writer.save()
daily_20170209 = pro.daily(start_date='',end_date='',trade_date='20170209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170209_tscode_list = list() 
for ts_code_sh in daily_20170209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170209_tscode_list.append(stock_name)
daily_20170209_addname_dataframe=pd.DataFrame()
daily_20170209_addname_dataframe['cname'] = daily_20170209_tscode_list
for table_name in daily_20170209.columns.values.tolist():
    daily_20170209_addname_dataframe[table_name] = daily_20170209[table_name]
print("daily_20170209 返回数据 row 行数 = "+str(daily_20170209.shape[0]))
daily_20170209_addname_dataframe.to_excel(daily_201702_excel_writer,'9_4',index=False)
daily_201702_excel_writer.save()
daily_20170210 = pro.daily(start_date='',end_date='',trade_date='20170210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170210_tscode_list = list() 
for ts_code_sh in daily_20170210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170210_tscode_list.append(stock_name)
daily_20170210_addname_dataframe=pd.DataFrame()
daily_20170210_addname_dataframe['cname'] = daily_20170210_tscode_list
for table_name in daily_20170210.columns.values.tolist():
    daily_20170210_addname_dataframe[table_name] = daily_20170210[table_name]
print("daily_20170210 返回数据 row 行数 = "+str(daily_20170210.shape[0]))
daily_20170210_addname_dataframe.to_excel(daily_201702_excel_writer,'10_5',index=False)
daily_201702_excel_writer.save()
daily_20170211 = pro.daily(start_date='',end_date='',trade_date='20170211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170211_tscode_list = list() 
for ts_code_sh in daily_20170211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170211_tscode_list.append(stock_name)
daily_20170211_addname_dataframe=pd.DataFrame()
daily_20170211_addname_dataframe['cname'] = daily_20170211_tscode_list
for table_name in daily_20170211.columns.values.tolist():
    daily_20170211_addname_dataframe[table_name] = daily_20170211[table_name]
print("daily_20170211 返回数据 row 行数 = "+str(daily_20170211.shape[0]))
daily_20170211_addname_dataframe.to_excel(daily_201702_excel_writer,'11_6',index=False)
daily_201702_excel_writer.save()
daily_20170212 = pro.daily(start_date='',end_date='',trade_date='20170212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170212_tscode_list = list() 
for ts_code_sh in daily_20170212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170212_tscode_list.append(stock_name)
daily_20170212_addname_dataframe=pd.DataFrame()
daily_20170212_addname_dataframe['cname'] = daily_20170212_tscode_list
for table_name in daily_20170212.columns.values.tolist():
    daily_20170212_addname_dataframe[table_name] = daily_20170212[table_name]
print("daily_20170212 返回数据 row 行数 = "+str(daily_20170212.shape[0]))
daily_20170212_addname_dataframe.to_excel(daily_201702_excel_writer,'12_7',index=False)
daily_201702_excel_writer.save()
daily_20170213 = pro.daily(start_date='',end_date='',trade_date='20170213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170213_tscode_list = list() 
for ts_code_sh in daily_20170213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170213_tscode_list.append(stock_name)
daily_20170213_addname_dataframe=pd.DataFrame()
daily_20170213_addname_dataframe['cname'] = daily_20170213_tscode_list
for table_name in daily_20170213.columns.values.tolist():
    daily_20170213_addname_dataframe[table_name] = daily_20170213[table_name]
print("daily_20170213 返回数据 row 行数 = "+str(daily_20170213.shape[0]))
daily_20170213_addname_dataframe.to_excel(daily_201702_excel_writer,'13_1',index=False)
daily_201702_excel_writer.save()
daily_20170214 = pro.daily(start_date='',end_date='',trade_date='20170214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170214_tscode_list = list() 
for ts_code_sh in daily_20170214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170214_tscode_list.append(stock_name)
daily_20170214_addname_dataframe=pd.DataFrame()
daily_20170214_addname_dataframe['cname'] = daily_20170214_tscode_list
for table_name in daily_20170214.columns.values.tolist():
    daily_20170214_addname_dataframe[table_name] = daily_20170214[table_name]
print("daily_20170214 返回数据 row 行数 = "+str(daily_20170214.shape[0]))
daily_20170214_addname_dataframe.to_excel(daily_201702_excel_writer,'14_2',index=False)
daily_201702_excel_writer.save()
daily_20170215 = pro.daily(start_date='',end_date='',trade_date='20170215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170215_tscode_list = list() 
for ts_code_sh in daily_20170215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170215_tscode_list.append(stock_name)
daily_20170215_addname_dataframe=pd.DataFrame()
daily_20170215_addname_dataframe['cname'] = daily_20170215_tscode_list
for table_name in daily_20170215.columns.values.tolist():
    daily_20170215_addname_dataframe[table_name] = daily_20170215[table_name]
print("daily_20170215 返回数据 row 行数 = "+str(daily_20170215.shape[0]))
daily_20170215_addname_dataframe.to_excel(daily_201702_excel_writer,'15_3',index=False)
daily_201702_excel_writer.save()
daily_20170216 = pro.daily(start_date='',end_date='',trade_date='20170216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170216_tscode_list = list() 
for ts_code_sh in daily_20170216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170216_tscode_list.append(stock_name)
daily_20170216_addname_dataframe=pd.DataFrame()
daily_20170216_addname_dataframe['cname'] = daily_20170216_tscode_list
for table_name in daily_20170216.columns.values.tolist():
    daily_20170216_addname_dataframe[table_name] = daily_20170216[table_name]
print("daily_20170216 返回数据 row 行数 = "+str(daily_20170216.shape[0]))
daily_20170216_addname_dataframe.to_excel(daily_201702_excel_writer,'16_4',index=False)
daily_201702_excel_writer.save()
daily_20170217 = pro.daily(start_date='',end_date='',trade_date='20170217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170217_tscode_list = list() 
for ts_code_sh in daily_20170217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170217_tscode_list.append(stock_name)
daily_20170217_addname_dataframe=pd.DataFrame()
daily_20170217_addname_dataframe['cname'] = daily_20170217_tscode_list
for table_name in daily_20170217.columns.values.tolist():
    daily_20170217_addname_dataframe[table_name] = daily_20170217[table_name]
print("daily_20170217 返回数据 row 行数 = "+str(daily_20170217.shape[0]))
daily_20170217_addname_dataframe.to_excel(daily_201702_excel_writer,'17_5',index=False)
daily_201702_excel_writer.save()
daily_20170218 = pro.daily(start_date='',end_date='',trade_date='20170218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170218_tscode_list = list() 
for ts_code_sh in daily_20170218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170218_tscode_list.append(stock_name)
daily_20170218_addname_dataframe=pd.DataFrame()
daily_20170218_addname_dataframe['cname'] = daily_20170218_tscode_list
for table_name in daily_20170218.columns.values.tolist():
    daily_20170218_addname_dataframe[table_name] = daily_20170218[table_name]
print("daily_20170218 返回数据 row 行数 = "+str(daily_20170218.shape[0]))
daily_20170218_addname_dataframe.to_excel(daily_201702_excel_writer,'18_6',index=False)
daily_201702_excel_writer.save()
daily_20170219 = pro.daily(start_date='',end_date='',trade_date='20170219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170219_tscode_list = list() 
for ts_code_sh in daily_20170219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170219_tscode_list.append(stock_name)
daily_20170219_addname_dataframe=pd.DataFrame()
daily_20170219_addname_dataframe['cname'] = daily_20170219_tscode_list
for table_name in daily_20170219.columns.values.tolist():
    daily_20170219_addname_dataframe[table_name] = daily_20170219[table_name]
print("daily_20170219 返回数据 row 行数 = "+str(daily_20170219.shape[0]))
daily_20170219_addname_dataframe.to_excel(daily_201702_excel_writer,'19_7',index=False)
daily_201702_excel_writer.save()
daily_20170220 = pro.daily(start_date='',end_date='',trade_date='20170220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170220_tscode_list = list() 
for ts_code_sh in daily_20170220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170220_tscode_list.append(stock_name)
daily_20170220_addname_dataframe=pd.DataFrame()
daily_20170220_addname_dataframe['cname'] = daily_20170220_tscode_list
for table_name in daily_20170220.columns.values.tolist():
    daily_20170220_addname_dataframe[table_name] = daily_20170220[table_name]
print("daily_20170220 返回数据 row 行数 = "+str(daily_20170220.shape[0]))
daily_20170220_addname_dataframe.to_excel(daily_201702_excel_writer,'20_1',index=False)
daily_201702_excel_writer.save()
daily_20170221 = pro.daily(start_date='',end_date='',trade_date='20170221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170221_tscode_list = list() 
for ts_code_sh in daily_20170221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170221_tscode_list.append(stock_name)
daily_20170221_addname_dataframe=pd.DataFrame()
daily_20170221_addname_dataframe['cname'] = daily_20170221_tscode_list
for table_name in daily_20170221.columns.values.tolist():
    daily_20170221_addname_dataframe[table_name] = daily_20170221[table_name]
print("daily_20170221 返回数据 row 行数 = "+str(daily_20170221.shape[0]))
daily_20170221_addname_dataframe.to_excel(daily_201702_excel_writer,'21_2',index=False)
daily_201702_excel_writer.save()
daily_20170222 = pro.daily(start_date='',end_date='',trade_date='20170222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170222_tscode_list = list() 
for ts_code_sh in daily_20170222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170222_tscode_list.append(stock_name)
daily_20170222_addname_dataframe=pd.DataFrame()
daily_20170222_addname_dataframe['cname'] = daily_20170222_tscode_list
for table_name in daily_20170222.columns.values.tolist():
    daily_20170222_addname_dataframe[table_name] = daily_20170222[table_name]
print("daily_20170222 返回数据 row 行数 = "+str(daily_20170222.shape[0]))
daily_20170222_addname_dataframe.to_excel(daily_201702_excel_writer,'22_3',index=False)
daily_201702_excel_writer.save()
daily_20170223 = pro.daily(start_date='',end_date='',trade_date='20170223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170223_tscode_list = list() 
for ts_code_sh in daily_20170223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170223_tscode_list.append(stock_name)
daily_20170223_addname_dataframe=pd.DataFrame()
daily_20170223_addname_dataframe['cname'] = daily_20170223_tscode_list
for table_name in daily_20170223.columns.values.tolist():
    daily_20170223_addname_dataframe[table_name] = daily_20170223[table_name]
print("daily_20170223 返回数据 row 行数 = "+str(daily_20170223.shape[0]))
daily_20170223_addname_dataframe.to_excel(daily_201702_excel_writer,'23_4',index=False)
daily_201702_excel_writer.save()
daily_20170224 = pro.daily(start_date='',end_date='',trade_date='20170224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170224_tscode_list = list() 
for ts_code_sh in daily_20170224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170224_tscode_list.append(stock_name)
daily_20170224_addname_dataframe=pd.DataFrame()
daily_20170224_addname_dataframe['cname'] = daily_20170224_tscode_list
for table_name in daily_20170224.columns.values.tolist():
    daily_20170224_addname_dataframe[table_name] = daily_20170224[table_name]
print("daily_20170224 返回数据 row 行数 = "+str(daily_20170224.shape[0]))
daily_20170224_addname_dataframe.to_excel(daily_201702_excel_writer,'24_5',index=False)
daily_201702_excel_writer.save()
daily_20170225 = pro.daily(start_date='',end_date='',trade_date='20170225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170225_tscode_list = list() 
for ts_code_sh in daily_20170225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170225_tscode_list.append(stock_name)
daily_20170225_addname_dataframe=pd.DataFrame()
daily_20170225_addname_dataframe['cname'] = daily_20170225_tscode_list
for table_name in daily_20170225.columns.values.tolist():
    daily_20170225_addname_dataframe[table_name] = daily_20170225[table_name]
print("daily_20170225 返回数据 row 行数 = "+str(daily_20170225.shape[0]))
daily_20170225_addname_dataframe.to_excel(daily_201702_excel_writer,'25_6',index=False)
daily_201702_excel_writer.save()
daily_20170226 = pro.daily(start_date='',end_date='',trade_date='20170226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170226_tscode_list = list() 
for ts_code_sh in daily_20170226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170226_tscode_list.append(stock_name)
daily_20170226_addname_dataframe=pd.DataFrame()
daily_20170226_addname_dataframe['cname'] = daily_20170226_tscode_list
for table_name in daily_20170226.columns.values.tolist():
    daily_20170226_addname_dataframe[table_name] = daily_20170226[table_name]
print("daily_20170226 返回数据 row 行数 = "+str(daily_20170226.shape[0]))
daily_20170226_addname_dataframe.to_excel(daily_201702_excel_writer,'26_7',index=False)
daily_201702_excel_writer.save()
daily_20170227 = pro.daily(start_date='',end_date='',trade_date='20170227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170227_tscode_list = list() 
for ts_code_sh in daily_20170227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170227_tscode_list.append(stock_name)
daily_20170227_addname_dataframe=pd.DataFrame()
daily_20170227_addname_dataframe['cname'] = daily_20170227_tscode_list
for table_name in daily_20170227.columns.values.tolist():
    daily_20170227_addname_dataframe[table_name] = daily_20170227[table_name]
print("daily_20170227 返回数据 row 行数 = "+str(daily_20170227.shape[0]))
daily_20170227_addname_dataframe.to_excel(daily_201702_excel_writer,'27_1',index=False)
daily_201702_excel_writer.save()
daily_20170228 = pro.daily(start_date='',end_date='',trade_date='20170228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170228_tscode_list = list() 
for ts_code_sh in daily_20170228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170228_tscode_list.append(stock_name)
daily_20170228_addname_dataframe=pd.DataFrame()
daily_20170228_addname_dataframe['cname'] = daily_20170228_tscode_list
for table_name in daily_20170228.columns.values.tolist():
    daily_20170228_addname_dataframe[table_name] = daily_20170228[table_name]
print("daily_20170228 返回数据 row 行数 = "+str(daily_20170228.shape[0]))
daily_20170228_addname_dataframe.to_excel(daily_201702_excel_writer,'28_2',index=False)
daily_201702_excel_writer.save()




createexcel('daily_201703.xlsx')
daily_201703_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201703.xlsx')
daily_201703_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201703.xlsx', engine='openpyxl')
daily_201703_excel_writer.book = daily_201703_book
daily_201703_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201703_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170301")       ###  更新 记录日期
daily_20170301 = pro.daily(start_date='',end_date='',trade_date='20170301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170301_tscode_list = list() 
for ts_code_sh in daily_20170301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170301_tscode_list.append(stock_name)
daily_20170301_addname_dataframe=pd.DataFrame()
daily_20170301_addname_dataframe['cname'] = daily_20170301_tscode_list
for table_name in daily_20170301.columns.values.tolist():
    daily_20170301_addname_dataframe[table_name] = daily_20170301[table_name]
print("daily_20170301 返回数据 row 行数 = "+str(daily_20170301.shape[0]))
daily_20170301_addname_dataframe.to_excel(daily_201703_excel_writer,'1_3',index=False)
daily_201703_excel_writer.save()
daily_20170302 = pro.daily(start_date='',end_date='',trade_date='20170302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170302_tscode_list = list() 
for ts_code_sh in daily_20170302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170302_tscode_list.append(stock_name)
daily_20170302_addname_dataframe=pd.DataFrame()
daily_20170302_addname_dataframe['cname'] = daily_20170302_tscode_list
for table_name in daily_20170302.columns.values.tolist():
    daily_20170302_addname_dataframe[table_name] = daily_20170302[table_name]
print("daily_20170302 返回数据 row 行数 = "+str(daily_20170302.shape[0]))
daily_20170302_addname_dataframe.to_excel(daily_201703_excel_writer,'2_4',index=False)
daily_201703_excel_writer.save()
daily_20170303 = pro.daily(start_date='',end_date='',trade_date='20170303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170303_tscode_list = list() 
for ts_code_sh in daily_20170303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170303_tscode_list.append(stock_name)
daily_20170303_addname_dataframe=pd.DataFrame()
daily_20170303_addname_dataframe['cname'] = daily_20170303_tscode_list
for table_name in daily_20170303.columns.values.tolist():
    daily_20170303_addname_dataframe[table_name] = daily_20170303[table_name]
print("daily_20170303 返回数据 row 行数 = "+str(daily_20170303.shape[0]))
daily_20170303_addname_dataframe.to_excel(daily_201703_excel_writer,'3_5',index=False)
daily_201703_excel_writer.save()
daily_20170304 = pro.daily(start_date='',end_date='',trade_date='20170304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170304_tscode_list = list() 
for ts_code_sh in daily_20170304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170304_tscode_list.append(stock_name)
daily_20170304_addname_dataframe=pd.DataFrame()
daily_20170304_addname_dataframe['cname'] = daily_20170304_tscode_list
for table_name in daily_20170304.columns.values.tolist():
    daily_20170304_addname_dataframe[table_name] = daily_20170304[table_name]
print("daily_20170304 返回数据 row 行数 = "+str(daily_20170304.shape[0]))
daily_20170304_addname_dataframe.to_excel(daily_201703_excel_writer,'4_6',index=False)
daily_201703_excel_writer.save()
daily_20170305 = pro.daily(start_date='',end_date='',trade_date='20170305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170305_tscode_list = list() 
for ts_code_sh in daily_20170305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170305_tscode_list.append(stock_name)
daily_20170305_addname_dataframe=pd.DataFrame()
daily_20170305_addname_dataframe['cname'] = daily_20170305_tscode_list
for table_name in daily_20170305.columns.values.tolist():
    daily_20170305_addname_dataframe[table_name] = daily_20170305[table_name]
print("daily_20170305 返回数据 row 行数 = "+str(daily_20170305.shape[0]))
daily_20170305_addname_dataframe.to_excel(daily_201703_excel_writer,'5_7',index=False)
daily_201703_excel_writer.save()
daily_20170306 = pro.daily(start_date='',end_date='',trade_date='20170306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170306_tscode_list = list() 
for ts_code_sh in daily_20170306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170306_tscode_list.append(stock_name)
daily_20170306_addname_dataframe=pd.DataFrame()
daily_20170306_addname_dataframe['cname'] = daily_20170306_tscode_list
for table_name in daily_20170306.columns.values.tolist():
    daily_20170306_addname_dataframe[table_name] = daily_20170306[table_name]
print("daily_20170306 返回数据 row 行数 = "+str(daily_20170306.shape[0]))
daily_20170306_addname_dataframe.to_excel(daily_201703_excel_writer,'6_1',index=False)
daily_201703_excel_writer.save()
daily_20170307 = pro.daily(start_date='',end_date='',trade_date='20170307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170307_tscode_list = list() 
for ts_code_sh in daily_20170307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170307_tscode_list.append(stock_name)
daily_20170307_addname_dataframe=pd.DataFrame()
daily_20170307_addname_dataframe['cname'] = daily_20170307_tscode_list
for table_name in daily_20170307.columns.values.tolist():
    daily_20170307_addname_dataframe[table_name] = daily_20170307[table_name]
print("daily_20170307 返回数据 row 行数 = "+str(daily_20170307.shape[0]))
daily_20170307_addname_dataframe.to_excel(daily_201703_excel_writer,'7_2',index=False)
daily_201703_excel_writer.save()
daily_20170308 = pro.daily(start_date='',end_date='',trade_date='20170308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170308_tscode_list = list() 
for ts_code_sh in daily_20170308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170308_tscode_list.append(stock_name)
daily_20170308_addname_dataframe=pd.DataFrame()
daily_20170308_addname_dataframe['cname'] = daily_20170308_tscode_list
for table_name in daily_20170308.columns.values.tolist():
    daily_20170308_addname_dataframe[table_name] = daily_20170308[table_name]
print("daily_20170308 返回数据 row 行数 = "+str(daily_20170308.shape[0]))
daily_20170308_addname_dataframe.to_excel(daily_201703_excel_writer,'8_3',index=False)
daily_201703_excel_writer.save()
daily_20170309 = pro.daily(start_date='',end_date='',trade_date='20170309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170309_tscode_list = list() 
for ts_code_sh in daily_20170309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170309_tscode_list.append(stock_name)
daily_20170309_addname_dataframe=pd.DataFrame()
daily_20170309_addname_dataframe['cname'] = daily_20170309_tscode_list
for table_name in daily_20170309.columns.values.tolist():
    daily_20170309_addname_dataframe[table_name] = daily_20170309[table_name]
print("daily_20170309 返回数据 row 行数 = "+str(daily_20170309.shape[0]))
daily_20170309_addname_dataframe.to_excel(daily_201703_excel_writer,'9_4',index=False)
daily_201703_excel_writer.save()
daily_20170310 = pro.daily(start_date='',end_date='',trade_date='20170310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170310_tscode_list = list() 
for ts_code_sh in daily_20170310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170310_tscode_list.append(stock_name)
daily_20170310_addname_dataframe=pd.DataFrame()
daily_20170310_addname_dataframe['cname'] = daily_20170310_tscode_list
for table_name in daily_20170310.columns.values.tolist():
    daily_20170310_addname_dataframe[table_name] = daily_20170310[table_name]
print("daily_20170310 返回数据 row 行数 = "+str(daily_20170310.shape[0]))
daily_20170310_addname_dataframe.to_excel(daily_201703_excel_writer,'10_5',index=False)
daily_201703_excel_writer.save()
daily_20170311 = pro.daily(start_date='',end_date='',trade_date='20170311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170311_tscode_list = list() 
for ts_code_sh in daily_20170311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170311_tscode_list.append(stock_name)
daily_20170311_addname_dataframe=pd.DataFrame()
daily_20170311_addname_dataframe['cname'] = daily_20170311_tscode_list
for table_name in daily_20170311.columns.values.tolist():
    daily_20170311_addname_dataframe[table_name] = daily_20170311[table_name]
print("daily_20170311 返回数据 row 行数 = "+str(daily_20170311.shape[0]))
daily_20170311_addname_dataframe.to_excel(daily_201703_excel_writer,'11_6',index=False)
daily_201703_excel_writer.save()
daily_20170312 = pro.daily(start_date='',end_date='',trade_date='20170312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170312_tscode_list = list() 
for ts_code_sh in daily_20170312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170312_tscode_list.append(stock_name)
daily_20170312_addname_dataframe=pd.DataFrame()
daily_20170312_addname_dataframe['cname'] = daily_20170312_tscode_list
for table_name in daily_20170312.columns.values.tolist():
    daily_20170312_addname_dataframe[table_name] = daily_20170312[table_name]
print("daily_20170312 返回数据 row 行数 = "+str(daily_20170312.shape[0]))
daily_20170312_addname_dataframe.to_excel(daily_201703_excel_writer,'12_7',index=False)
daily_201703_excel_writer.save()
daily_20170313 = pro.daily(start_date='',end_date='',trade_date='20170313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170313_tscode_list = list() 
for ts_code_sh in daily_20170313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170313_tscode_list.append(stock_name)
daily_20170313_addname_dataframe=pd.DataFrame()
daily_20170313_addname_dataframe['cname'] = daily_20170313_tscode_list
for table_name in daily_20170313.columns.values.tolist():
    daily_20170313_addname_dataframe[table_name] = daily_20170313[table_name]
print("daily_20170313 返回数据 row 行数 = "+str(daily_20170313.shape[0]))
daily_20170313_addname_dataframe.to_excel(daily_201703_excel_writer,'13_1',index=False)
daily_201703_excel_writer.save()
daily_20170314 = pro.daily(start_date='',end_date='',trade_date='20170314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170314_tscode_list = list() 
for ts_code_sh in daily_20170314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170314_tscode_list.append(stock_name)
daily_20170314_addname_dataframe=pd.DataFrame()
daily_20170314_addname_dataframe['cname'] = daily_20170314_tscode_list
for table_name in daily_20170314.columns.values.tolist():
    daily_20170314_addname_dataframe[table_name] = daily_20170314[table_name]
print("daily_20170314 返回数据 row 行数 = "+str(daily_20170314.shape[0]))
daily_20170314_addname_dataframe.to_excel(daily_201703_excel_writer,'14_2',index=False)
daily_201703_excel_writer.save()
daily_20170315 = pro.daily(start_date='',end_date='',trade_date='20170315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170315_tscode_list = list() 
for ts_code_sh in daily_20170315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170315_tscode_list.append(stock_name)
daily_20170315_addname_dataframe=pd.DataFrame()
daily_20170315_addname_dataframe['cname'] = daily_20170315_tscode_list
for table_name in daily_20170315.columns.values.tolist():
    daily_20170315_addname_dataframe[table_name] = daily_20170315[table_name]
print("daily_20170315 返回数据 row 行数 = "+str(daily_20170315.shape[0]))
daily_20170315_addname_dataframe.to_excel(daily_201703_excel_writer,'15_3',index=False)
daily_201703_excel_writer.save()
daily_20170316 = pro.daily(start_date='',end_date='',trade_date='20170316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170316_tscode_list = list() 
for ts_code_sh in daily_20170316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170316_tscode_list.append(stock_name)
daily_20170316_addname_dataframe=pd.DataFrame()
daily_20170316_addname_dataframe['cname'] = daily_20170316_tscode_list
for table_name in daily_20170316.columns.values.tolist():
    daily_20170316_addname_dataframe[table_name] = daily_20170316[table_name]
print("daily_20170316 返回数据 row 行数 = "+str(daily_20170316.shape[0]))
daily_20170316_addname_dataframe.to_excel(daily_201703_excel_writer,'16_4',index=False)
daily_201703_excel_writer.save()
daily_20170317 = pro.daily(start_date='',end_date='',trade_date='20170317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170317_tscode_list = list() 
for ts_code_sh in daily_20170317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170317_tscode_list.append(stock_name)
daily_20170317_addname_dataframe=pd.DataFrame()
daily_20170317_addname_dataframe['cname'] = daily_20170317_tscode_list
for table_name in daily_20170317.columns.values.tolist():
    daily_20170317_addname_dataframe[table_name] = daily_20170317[table_name]
print("daily_20170317 返回数据 row 行数 = "+str(daily_20170317.shape[0]))
daily_20170317_addname_dataframe.to_excel(daily_201703_excel_writer,'17_5',index=False)
daily_201703_excel_writer.save()
daily_20170318 = pro.daily(start_date='',end_date='',trade_date='20170318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170318_tscode_list = list() 
for ts_code_sh in daily_20170318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170318_tscode_list.append(stock_name)
daily_20170318_addname_dataframe=pd.DataFrame()
daily_20170318_addname_dataframe['cname'] = daily_20170318_tscode_list
for table_name in daily_20170318.columns.values.tolist():
    daily_20170318_addname_dataframe[table_name] = daily_20170318[table_name]
print("daily_20170318 返回数据 row 行数 = "+str(daily_20170318.shape[0]))
daily_20170318_addname_dataframe.to_excel(daily_201703_excel_writer,'18_6',index=False)
daily_201703_excel_writer.save()
daily_20170319 = pro.daily(start_date='',end_date='',trade_date='20170319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170319_tscode_list = list() 
for ts_code_sh in daily_20170319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170319_tscode_list.append(stock_name)
daily_20170319_addname_dataframe=pd.DataFrame()
daily_20170319_addname_dataframe['cname'] = daily_20170319_tscode_list
for table_name in daily_20170319.columns.values.tolist():
    daily_20170319_addname_dataframe[table_name] = daily_20170319[table_name]
print("daily_20170319 返回数据 row 行数 = "+str(daily_20170319.shape[0]))
daily_20170319_addname_dataframe.to_excel(daily_201703_excel_writer,'19_7',index=False)
daily_201703_excel_writer.save()
daily_20170320 = pro.daily(start_date='',end_date='',trade_date='20170320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170320_tscode_list = list() 
for ts_code_sh in daily_20170320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170320_tscode_list.append(stock_name)
daily_20170320_addname_dataframe=pd.DataFrame()
daily_20170320_addname_dataframe['cname'] = daily_20170320_tscode_list
for table_name in daily_20170320.columns.values.tolist():
    daily_20170320_addname_dataframe[table_name] = daily_20170320[table_name]
print("daily_20170320 返回数据 row 行数 = "+str(daily_20170320.shape[0]))
daily_20170320_addname_dataframe.to_excel(daily_201703_excel_writer,'20_1',index=False)
daily_201703_excel_writer.save()
daily_20170321 = pro.daily(start_date='',end_date='',trade_date='20170321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170321_tscode_list = list() 
for ts_code_sh in daily_20170321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170321_tscode_list.append(stock_name)
daily_20170321_addname_dataframe=pd.DataFrame()
daily_20170321_addname_dataframe['cname'] = daily_20170321_tscode_list
for table_name in daily_20170321.columns.values.tolist():
    daily_20170321_addname_dataframe[table_name] = daily_20170321[table_name]
print("daily_20170321 返回数据 row 行数 = "+str(daily_20170321.shape[0]))
daily_20170321_addname_dataframe.to_excel(daily_201703_excel_writer,'21_2',index=False)
daily_201703_excel_writer.save()
daily_20170322 = pro.daily(start_date='',end_date='',trade_date='20170322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170322_tscode_list = list() 
for ts_code_sh in daily_20170322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170322_tscode_list.append(stock_name)
daily_20170322_addname_dataframe=pd.DataFrame()
daily_20170322_addname_dataframe['cname'] = daily_20170322_tscode_list
for table_name in daily_20170322.columns.values.tolist():
    daily_20170322_addname_dataframe[table_name] = daily_20170322[table_name]
print("daily_20170322 返回数据 row 行数 = "+str(daily_20170322.shape[0]))
daily_20170322_addname_dataframe.to_excel(daily_201703_excel_writer,'22_3',index=False)
daily_201703_excel_writer.save()
daily_20170323 = pro.daily(start_date='',end_date='',trade_date='20170323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170323_tscode_list = list() 
for ts_code_sh in daily_20170323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170323_tscode_list.append(stock_name)
daily_20170323_addname_dataframe=pd.DataFrame()
daily_20170323_addname_dataframe['cname'] = daily_20170323_tscode_list
for table_name in daily_20170323.columns.values.tolist():
    daily_20170323_addname_dataframe[table_name] = daily_20170323[table_name]
print("daily_20170323 返回数据 row 行数 = "+str(daily_20170323.shape[0]))
daily_20170323_addname_dataframe.to_excel(daily_201703_excel_writer,'23_4',index=False)
daily_201703_excel_writer.save()
daily_20170324 = pro.daily(start_date='',end_date='',trade_date='20170324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170324_tscode_list = list() 
for ts_code_sh in daily_20170324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170324_tscode_list.append(stock_name)
daily_20170324_addname_dataframe=pd.DataFrame()
daily_20170324_addname_dataframe['cname'] = daily_20170324_tscode_list
for table_name in daily_20170324.columns.values.tolist():
    daily_20170324_addname_dataframe[table_name] = daily_20170324[table_name]
print("daily_20170324 返回数据 row 行数 = "+str(daily_20170324.shape[0]))
daily_20170324_addname_dataframe.to_excel(daily_201703_excel_writer,'24_5',index=False)
daily_201703_excel_writer.save()
daily_20170325 = pro.daily(start_date='',end_date='',trade_date='20170325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170325_tscode_list = list() 
for ts_code_sh in daily_20170325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170325_tscode_list.append(stock_name)
daily_20170325_addname_dataframe=pd.DataFrame()
daily_20170325_addname_dataframe['cname'] = daily_20170325_tscode_list
for table_name in daily_20170325.columns.values.tolist():
    daily_20170325_addname_dataframe[table_name] = daily_20170325[table_name]
print("daily_20170325 返回数据 row 行数 = "+str(daily_20170325.shape[0]))
daily_20170325_addname_dataframe.to_excel(daily_201703_excel_writer,'25_6',index=False)
daily_201703_excel_writer.save()
daily_20170326 = pro.daily(start_date='',end_date='',trade_date='20170326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170326_tscode_list = list() 
for ts_code_sh in daily_20170326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170326_tscode_list.append(stock_name)
daily_20170326_addname_dataframe=pd.DataFrame()
daily_20170326_addname_dataframe['cname'] = daily_20170326_tscode_list
for table_name in daily_20170326.columns.values.tolist():
    daily_20170326_addname_dataframe[table_name] = daily_20170326[table_name]
print("daily_20170326 返回数据 row 行数 = "+str(daily_20170326.shape[0]))
daily_20170326_addname_dataframe.to_excel(daily_201703_excel_writer,'26_7',index=False)
daily_201703_excel_writer.save()
daily_20170327 = pro.daily(start_date='',end_date='',trade_date='20170327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170327_tscode_list = list() 
for ts_code_sh in daily_20170327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170327_tscode_list.append(stock_name)
daily_20170327_addname_dataframe=pd.DataFrame()
daily_20170327_addname_dataframe['cname'] = daily_20170327_tscode_list
for table_name in daily_20170327.columns.values.tolist():
    daily_20170327_addname_dataframe[table_name] = daily_20170327[table_name]
print("daily_20170327 返回数据 row 行数 = "+str(daily_20170327.shape[0]))
daily_20170327_addname_dataframe.to_excel(daily_201703_excel_writer,'27_1',index=False)
daily_201703_excel_writer.save()
daily_20170328 = pro.daily(start_date='',end_date='',trade_date='20170328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170328_tscode_list = list() 
for ts_code_sh in daily_20170328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170328_tscode_list.append(stock_name)
daily_20170328_addname_dataframe=pd.DataFrame()
daily_20170328_addname_dataframe['cname'] = daily_20170328_tscode_list
for table_name in daily_20170328.columns.values.tolist():
    daily_20170328_addname_dataframe[table_name] = daily_20170328[table_name]
print("daily_20170328 返回数据 row 行数 = "+str(daily_20170328.shape[0]))
daily_20170328_addname_dataframe.to_excel(daily_201703_excel_writer,'28_2',index=False)
daily_201703_excel_writer.save()
daily_20170329 = pro.daily(start_date='',end_date='',trade_date='20170329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170329_tscode_list = list() 
for ts_code_sh in daily_20170329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170329_tscode_list.append(stock_name)
daily_20170329_addname_dataframe=pd.DataFrame()
daily_20170329_addname_dataframe['cname'] = daily_20170329_tscode_list
for table_name in daily_20170329.columns.values.tolist():
    daily_20170329_addname_dataframe[table_name] = daily_20170329[table_name]
print("daily_20170329 返回数据 row 行数 = "+str(daily_20170329.shape[0]))
daily_20170329_addname_dataframe.to_excel(daily_201703_excel_writer,'29_3',index=False)
daily_201703_excel_writer.save()
daily_20170330 = pro.daily(start_date='',end_date='',trade_date='20170330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170330_tscode_list = list() 
for ts_code_sh in daily_20170330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170330_tscode_list.append(stock_name)
daily_20170330_addname_dataframe=pd.DataFrame()
daily_20170330_addname_dataframe['cname'] = daily_20170330_tscode_list
for table_name in daily_20170330.columns.values.tolist():
    daily_20170330_addname_dataframe[table_name] = daily_20170330[table_name]
print("daily_20170330 返回数据 row 行数 = "+str(daily_20170330.shape[0]))
daily_20170330_addname_dataframe.to_excel(daily_201703_excel_writer,'30_4',index=False)
daily_201703_excel_writer.save()
daily_20170331 = pro.daily(start_date='',end_date='',trade_date='20170331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170331_tscode_list = list() 
for ts_code_sh in daily_20170331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170331_tscode_list.append(stock_name)
daily_20170331_addname_dataframe=pd.DataFrame()
daily_20170331_addname_dataframe['cname'] = daily_20170331_tscode_list
for table_name in daily_20170331.columns.values.tolist():
    daily_20170331_addname_dataframe[table_name] = daily_20170331[table_name]
print("daily_20170331 返回数据 row 行数 = "+str(daily_20170331.shape[0]))
daily_20170331_addname_dataframe.to_excel(daily_201703_excel_writer,'31_5',index=False)
daily_201703_excel_writer.save()




createexcel('daily_201704.xlsx')
daily_201704_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201704.xlsx')
daily_201704_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201704.xlsx', engine='openpyxl')
daily_201704_excel_writer.book = daily_201704_book
daily_201704_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201704_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170401")       ###  更新 记录日期
daily_20170401 = pro.daily(start_date='',end_date='',trade_date='20170401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170401_tscode_list = list() 
for ts_code_sh in daily_20170401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170401_tscode_list.append(stock_name)
daily_20170401_addname_dataframe=pd.DataFrame()
daily_20170401_addname_dataframe['cname'] = daily_20170401_tscode_list
for table_name in daily_20170401.columns.values.tolist():
    daily_20170401_addname_dataframe[table_name] = daily_20170401[table_name]
print("daily_20170401 返回数据 row 行数 = "+str(daily_20170401.shape[0]))
daily_20170401_addname_dataframe.to_excel(daily_201704_excel_writer,'1_6',index=False)
daily_201704_excel_writer.save()
daily_20170402 = pro.daily(start_date='',end_date='',trade_date='20170402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170402_tscode_list = list() 
for ts_code_sh in daily_20170402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170402_tscode_list.append(stock_name)
daily_20170402_addname_dataframe=pd.DataFrame()
daily_20170402_addname_dataframe['cname'] = daily_20170402_tscode_list
for table_name in daily_20170402.columns.values.tolist():
    daily_20170402_addname_dataframe[table_name] = daily_20170402[table_name]
print("daily_20170402 返回数据 row 行数 = "+str(daily_20170402.shape[0]))
daily_20170402_addname_dataframe.to_excel(daily_201704_excel_writer,'2_7',index=False)
daily_201704_excel_writer.save()
daily_20170403 = pro.daily(start_date='',end_date='',trade_date='20170403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170403_tscode_list = list() 
for ts_code_sh in daily_20170403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170403_tscode_list.append(stock_name)
daily_20170403_addname_dataframe=pd.DataFrame()
daily_20170403_addname_dataframe['cname'] = daily_20170403_tscode_list
for table_name in daily_20170403.columns.values.tolist():
    daily_20170403_addname_dataframe[table_name] = daily_20170403[table_name]
print("daily_20170403 返回数据 row 行数 = "+str(daily_20170403.shape[0]))
daily_20170403_addname_dataframe.to_excel(daily_201704_excel_writer,'3_1',index=False)
daily_201704_excel_writer.save()
daily_20170404 = pro.daily(start_date='',end_date='',trade_date='20170404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170404_tscode_list = list() 
for ts_code_sh in daily_20170404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170404_tscode_list.append(stock_name)
daily_20170404_addname_dataframe=pd.DataFrame()
daily_20170404_addname_dataframe['cname'] = daily_20170404_tscode_list
for table_name in daily_20170404.columns.values.tolist():
    daily_20170404_addname_dataframe[table_name] = daily_20170404[table_name]
print("daily_20170404 返回数据 row 行数 = "+str(daily_20170404.shape[0]))
daily_20170404_addname_dataframe.to_excel(daily_201704_excel_writer,'4_2',index=False)
daily_201704_excel_writer.save()
daily_20170405 = pro.daily(start_date='',end_date='',trade_date='20170405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170405_tscode_list = list() 
for ts_code_sh in daily_20170405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170405_tscode_list.append(stock_name)
daily_20170405_addname_dataframe=pd.DataFrame()
daily_20170405_addname_dataframe['cname'] = daily_20170405_tscode_list
for table_name in daily_20170405.columns.values.tolist():
    daily_20170405_addname_dataframe[table_name] = daily_20170405[table_name]
print("daily_20170405 返回数据 row 行数 = "+str(daily_20170405.shape[0]))
daily_20170405_addname_dataframe.to_excel(daily_201704_excel_writer,'5_3',index=False)
daily_201704_excel_writer.save()
daily_20170406 = pro.daily(start_date='',end_date='',trade_date='20170406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170406_tscode_list = list() 
for ts_code_sh in daily_20170406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170406_tscode_list.append(stock_name)
daily_20170406_addname_dataframe=pd.DataFrame()
daily_20170406_addname_dataframe['cname'] = daily_20170406_tscode_list
for table_name in daily_20170406.columns.values.tolist():
    daily_20170406_addname_dataframe[table_name] = daily_20170406[table_name]
print("daily_20170406 返回数据 row 行数 = "+str(daily_20170406.shape[0]))
daily_20170406_addname_dataframe.to_excel(daily_201704_excel_writer,'6_4',index=False)
daily_201704_excel_writer.save()
daily_20170407 = pro.daily(start_date='',end_date='',trade_date='20170407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170407_tscode_list = list() 
for ts_code_sh in daily_20170407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170407_tscode_list.append(stock_name)
daily_20170407_addname_dataframe=pd.DataFrame()
daily_20170407_addname_dataframe['cname'] = daily_20170407_tscode_list
for table_name in daily_20170407.columns.values.tolist():
    daily_20170407_addname_dataframe[table_name] = daily_20170407[table_name]
print("daily_20170407 返回数据 row 行数 = "+str(daily_20170407.shape[0]))
daily_20170407_addname_dataframe.to_excel(daily_201704_excel_writer,'7_5',index=False)
daily_201704_excel_writer.save()
daily_20170408 = pro.daily(start_date='',end_date='',trade_date='20170408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170408_tscode_list = list() 
for ts_code_sh in daily_20170408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170408_tscode_list.append(stock_name)
daily_20170408_addname_dataframe=pd.DataFrame()
daily_20170408_addname_dataframe['cname'] = daily_20170408_tscode_list
for table_name in daily_20170408.columns.values.tolist():
    daily_20170408_addname_dataframe[table_name] = daily_20170408[table_name]
print("daily_20170408 返回数据 row 行数 = "+str(daily_20170408.shape[0]))
daily_20170408_addname_dataframe.to_excel(daily_201704_excel_writer,'8_6',index=False)
daily_201704_excel_writer.save()
daily_20170409 = pro.daily(start_date='',end_date='',trade_date='20170409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170409_tscode_list = list() 
for ts_code_sh in daily_20170409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170409_tscode_list.append(stock_name)
daily_20170409_addname_dataframe=pd.DataFrame()
daily_20170409_addname_dataframe['cname'] = daily_20170409_tscode_list
for table_name in daily_20170409.columns.values.tolist():
    daily_20170409_addname_dataframe[table_name] = daily_20170409[table_name]
print("daily_20170409 返回数据 row 行数 = "+str(daily_20170409.shape[0]))
daily_20170409_addname_dataframe.to_excel(daily_201704_excel_writer,'9_7',index=False)
daily_201704_excel_writer.save()
daily_20170410 = pro.daily(start_date='',end_date='',trade_date='20170410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170410_tscode_list = list() 
for ts_code_sh in daily_20170410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170410_tscode_list.append(stock_name)
daily_20170410_addname_dataframe=pd.DataFrame()
daily_20170410_addname_dataframe['cname'] = daily_20170410_tscode_list
for table_name in daily_20170410.columns.values.tolist():
    daily_20170410_addname_dataframe[table_name] = daily_20170410[table_name]
print("daily_20170410 返回数据 row 行数 = "+str(daily_20170410.shape[0]))
daily_20170410_addname_dataframe.to_excel(daily_201704_excel_writer,'10_1',index=False)
daily_201704_excel_writer.save()
daily_20170411 = pro.daily(start_date='',end_date='',trade_date='20170411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170411_tscode_list = list() 
for ts_code_sh in daily_20170411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170411_tscode_list.append(stock_name)
daily_20170411_addname_dataframe=pd.DataFrame()
daily_20170411_addname_dataframe['cname'] = daily_20170411_tscode_list
for table_name in daily_20170411.columns.values.tolist():
    daily_20170411_addname_dataframe[table_name] = daily_20170411[table_name]
print("daily_20170411 返回数据 row 行数 = "+str(daily_20170411.shape[0]))
daily_20170411_addname_dataframe.to_excel(daily_201704_excel_writer,'11_2',index=False)
daily_201704_excel_writer.save()
daily_20170412 = pro.daily(start_date='',end_date='',trade_date='20170412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170412_tscode_list = list() 
for ts_code_sh in daily_20170412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170412_tscode_list.append(stock_name)
daily_20170412_addname_dataframe=pd.DataFrame()
daily_20170412_addname_dataframe['cname'] = daily_20170412_tscode_list
for table_name in daily_20170412.columns.values.tolist():
    daily_20170412_addname_dataframe[table_name] = daily_20170412[table_name]
print("daily_20170412 返回数据 row 行数 = "+str(daily_20170412.shape[0]))
daily_20170412_addname_dataframe.to_excel(daily_201704_excel_writer,'12_3',index=False)
daily_201704_excel_writer.save()
daily_20170413 = pro.daily(start_date='',end_date='',trade_date='20170413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170413_tscode_list = list() 
for ts_code_sh in daily_20170413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170413_tscode_list.append(stock_name)
daily_20170413_addname_dataframe=pd.DataFrame()
daily_20170413_addname_dataframe['cname'] = daily_20170413_tscode_list
for table_name in daily_20170413.columns.values.tolist():
    daily_20170413_addname_dataframe[table_name] = daily_20170413[table_name]
print("daily_20170413 返回数据 row 行数 = "+str(daily_20170413.shape[0]))
daily_20170413_addname_dataframe.to_excel(daily_201704_excel_writer,'13_4',index=False)
daily_201704_excel_writer.save()
daily_20170414 = pro.daily(start_date='',end_date='',trade_date='20170414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170414_tscode_list = list() 
for ts_code_sh in daily_20170414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170414_tscode_list.append(stock_name)
daily_20170414_addname_dataframe=pd.DataFrame()
daily_20170414_addname_dataframe['cname'] = daily_20170414_tscode_list
for table_name in daily_20170414.columns.values.tolist():
    daily_20170414_addname_dataframe[table_name] = daily_20170414[table_name]
print("daily_20170414 返回数据 row 行数 = "+str(daily_20170414.shape[0]))
daily_20170414_addname_dataframe.to_excel(daily_201704_excel_writer,'14_5',index=False)
daily_201704_excel_writer.save()
daily_20170415 = pro.daily(start_date='',end_date='',trade_date='20170415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170415_tscode_list = list() 
for ts_code_sh in daily_20170415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170415_tscode_list.append(stock_name)
daily_20170415_addname_dataframe=pd.DataFrame()
daily_20170415_addname_dataframe['cname'] = daily_20170415_tscode_list
for table_name in daily_20170415.columns.values.tolist():
    daily_20170415_addname_dataframe[table_name] = daily_20170415[table_name]
print("daily_20170415 返回数据 row 行数 = "+str(daily_20170415.shape[0]))
daily_20170415_addname_dataframe.to_excel(daily_201704_excel_writer,'15_6',index=False)
daily_201704_excel_writer.save()
daily_20170416 = pro.daily(start_date='',end_date='',trade_date='20170416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170416_tscode_list = list() 
for ts_code_sh in daily_20170416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170416_tscode_list.append(stock_name)
daily_20170416_addname_dataframe=pd.DataFrame()
daily_20170416_addname_dataframe['cname'] = daily_20170416_tscode_list
for table_name in daily_20170416.columns.values.tolist():
    daily_20170416_addname_dataframe[table_name] = daily_20170416[table_name]
print("daily_20170416 返回数据 row 行数 = "+str(daily_20170416.shape[0]))
daily_20170416_addname_dataframe.to_excel(daily_201704_excel_writer,'16_7',index=False)
daily_201704_excel_writer.save()
daily_20170417 = pro.daily(start_date='',end_date='',trade_date='20170417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170417_tscode_list = list() 
for ts_code_sh in daily_20170417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170417_tscode_list.append(stock_name)
daily_20170417_addname_dataframe=pd.DataFrame()
daily_20170417_addname_dataframe['cname'] = daily_20170417_tscode_list
for table_name in daily_20170417.columns.values.tolist():
    daily_20170417_addname_dataframe[table_name] = daily_20170417[table_name]
print("daily_20170417 返回数据 row 行数 = "+str(daily_20170417.shape[0]))
daily_20170417_addname_dataframe.to_excel(daily_201704_excel_writer,'17_1',index=False)
daily_201704_excel_writer.save()
daily_20170418 = pro.daily(start_date='',end_date='',trade_date='20170418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170418_tscode_list = list() 
for ts_code_sh in daily_20170418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170418_tscode_list.append(stock_name)
daily_20170418_addname_dataframe=pd.DataFrame()
daily_20170418_addname_dataframe['cname'] = daily_20170418_tscode_list
for table_name in daily_20170418.columns.values.tolist():
    daily_20170418_addname_dataframe[table_name] = daily_20170418[table_name]
print("daily_20170418 返回数据 row 行数 = "+str(daily_20170418.shape[0]))
daily_20170418_addname_dataframe.to_excel(daily_201704_excel_writer,'18_2',index=False)
daily_201704_excel_writer.save()
daily_20170419 = pro.daily(start_date='',end_date='',trade_date='20170419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170419_tscode_list = list() 
for ts_code_sh in daily_20170419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170419_tscode_list.append(stock_name)
daily_20170419_addname_dataframe=pd.DataFrame()
daily_20170419_addname_dataframe['cname'] = daily_20170419_tscode_list
for table_name in daily_20170419.columns.values.tolist():
    daily_20170419_addname_dataframe[table_name] = daily_20170419[table_name]
print("daily_20170419 返回数据 row 行数 = "+str(daily_20170419.shape[0]))
daily_20170419_addname_dataframe.to_excel(daily_201704_excel_writer,'19_3',index=False)
daily_201704_excel_writer.save()
daily_20170420 = pro.daily(start_date='',end_date='',trade_date='20170420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170420_tscode_list = list() 
for ts_code_sh in daily_20170420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170420_tscode_list.append(stock_name)
daily_20170420_addname_dataframe=pd.DataFrame()
daily_20170420_addname_dataframe['cname'] = daily_20170420_tscode_list
for table_name in daily_20170420.columns.values.tolist():
    daily_20170420_addname_dataframe[table_name] = daily_20170420[table_name]
print("daily_20170420 返回数据 row 行数 = "+str(daily_20170420.shape[0]))
daily_20170420_addname_dataframe.to_excel(daily_201704_excel_writer,'20_4',index=False)
daily_201704_excel_writer.save()
daily_20170421 = pro.daily(start_date='',end_date='',trade_date='20170421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170421_tscode_list = list() 
for ts_code_sh in daily_20170421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170421_tscode_list.append(stock_name)
daily_20170421_addname_dataframe=pd.DataFrame()
daily_20170421_addname_dataframe['cname'] = daily_20170421_tscode_list
for table_name in daily_20170421.columns.values.tolist():
    daily_20170421_addname_dataframe[table_name] = daily_20170421[table_name]
print("daily_20170421 返回数据 row 行数 = "+str(daily_20170421.shape[0]))
daily_20170421_addname_dataframe.to_excel(daily_201704_excel_writer,'21_5',index=False)
daily_201704_excel_writer.save()
daily_20170422 = pro.daily(start_date='',end_date='',trade_date='20170422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170422_tscode_list = list() 
for ts_code_sh in daily_20170422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170422_tscode_list.append(stock_name)
daily_20170422_addname_dataframe=pd.DataFrame()
daily_20170422_addname_dataframe['cname'] = daily_20170422_tscode_list
for table_name in daily_20170422.columns.values.tolist():
    daily_20170422_addname_dataframe[table_name] = daily_20170422[table_name]
print("daily_20170422 返回数据 row 行数 = "+str(daily_20170422.shape[0]))
daily_20170422_addname_dataframe.to_excel(daily_201704_excel_writer,'22_6',index=False)
daily_201704_excel_writer.save()
daily_20170423 = pro.daily(start_date='',end_date='',trade_date='20170423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170423_tscode_list = list() 
for ts_code_sh in daily_20170423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170423_tscode_list.append(stock_name)
daily_20170423_addname_dataframe=pd.DataFrame()
daily_20170423_addname_dataframe['cname'] = daily_20170423_tscode_list
for table_name in daily_20170423.columns.values.tolist():
    daily_20170423_addname_dataframe[table_name] = daily_20170423[table_name]
print("daily_20170423 返回数据 row 行数 = "+str(daily_20170423.shape[0]))
daily_20170423_addname_dataframe.to_excel(daily_201704_excel_writer,'23_7',index=False)
daily_201704_excel_writer.save()
daily_20170424 = pro.daily(start_date='',end_date='',trade_date='20170424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170424_tscode_list = list() 
for ts_code_sh in daily_20170424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170424_tscode_list.append(stock_name)
daily_20170424_addname_dataframe=pd.DataFrame()
daily_20170424_addname_dataframe['cname'] = daily_20170424_tscode_list
for table_name in daily_20170424.columns.values.tolist():
    daily_20170424_addname_dataframe[table_name] = daily_20170424[table_name]
print("daily_20170424 返回数据 row 行数 = "+str(daily_20170424.shape[0]))
daily_20170424_addname_dataframe.to_excel(daily_201704_excel_writer,'24_1',index=False)
daily_201704_excel_writer.save()
daily_20170425 = pro.daily(start_date='',end_date='',trade_date='20170425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170425_tscode_list = list() 
for ts_code_sh in daily_20170425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170425_tscode_list.append(stock_name)
daily_20170425_addname_dataframe=pd.DataFrame()
daily_20170425_addname_dataframe['cname'] = daily_20170425_tscode_list
for table_name in daily_20170425.columns.values.tolist():
    daily_20170425_addname_dataframe[table_name] = daily_20170425[table_name]
print("daily_20170425 返回数据 row 行数 = "+str(daily_20170425.shape[0]))
daily_20170425_addname_dataframe.to_excel(daily_201704_excel_writer,'25_2',index=False)
daily_201704_excel_writer.save()
daily_20170426 = pro.daily(start_date='',end_date='',trade_date='20170426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170426_tscode_list = list() 
for ts_code_sh in daily_20170426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170426_tscode_list.append(stock_name)
daily_20170426_addname_dataframe=pd.DataFrame()
daily_20170426_addname_dataframe['cname'] = daily_20170426_tscode_list
for table_name in daily_20170426.columns.values.tolist():
    daily_20170426_addname_dataframe[table_name] = daily_20170426[table_name]
print("daily_20170426 返回数据 row 行数 = "+str(daily_20170426.shape[0]))
daily_20170426_addname_dataframe.to_excel(daily_201704_excel_writer,'26_3',index=False)
daily_201704_excel_writer.save()
daily_20170427 = pro.daily(start_date='',end_date='',trade_date='20170427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170427_tscode_list = list() 
for ts_code_sh in daily_20170427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170427_tscode_list.append(stock_name)
daily_20170427_addname_dataframe=pd.DataFrame()
daily_20170427_addname_dataframe['cname'] = daily_20170427_tscode_list
for table_name in daily_20170427.columns.values.tolist():
    daily_20170427_addname_dataframe[table_name] = daily_20170427[table_name]
print("daily_20170427 返回数据 row 行数 = "+str(daily_20170427.shape[0]))
daily_20170427_addname_dataframe.to_excel(daily_201704_excel_writer,'27_4',index=False)
daily_201704_excel_writer.save()
daily_20170428 = pro.daily(start_date='',end_date='',trade_date='20170428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170428_tscode_list = list() 
for ts_code_sh in daily_20170428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170428_tscode_list.append(stock_name)
daily_20170428_addname_dataframe=pd.DataFrame()
daily_20170428_addname_dataframe['cname'] = daily_20170428_tscode_list
for table_name in daily_20170428.columns.values.tolist():
    daily_20170428_addname_dataframe[table_name] = daily_20170428[table_name]
print("daily_20170428 返回数据 row 行数 = "+str(daily_20170428.shape[0]))
daily_20170428_addname_dataframe.to_excel(daily_201704_excel_writer,'28_5',index=False)
daily_201704_excel_writer.save()
daily_20170429 = pro.daily(start_date='',end_date='',trade_date='20170429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170429_tscode_list = list() 
for ts_code_sh in daily_20170429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170429_tscode_list.append(stock_name)
daily_20170429_addname_dataframe=pd.DataFrame()
daily_20170429_addname_dataframe['cname'] = daily_20170429_tscode_list
for table_name in daily_20170429.columns.values.tolist():
    daily_20170429_addname_dataframe[table_name] = daily_20170429[table_name]
print("daily_20170429 返回数据 row 行数 = "+str(daily_20170429.shape[0]))
daily_20170429_addname_dataframe.to_excel(daily_201704_excel_writer,'29_6',index=False)
daily_201704_excel_writer.save()
daily_20170430 = pro.daily(start_date='',end_date='',trade_date='20170430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170430_tscode_list = list() 
for ts_code_sh in daily_20170430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170430_tscode_list.append(stock_name)
daily_20170430_addname_dataframe=pd.DataFrame()
daily_20170430_addname_dataframe['cname'] = daily_20170430_tscode_list
for table_name in daily_20170430.columns.values.tolist():
    daily_20170430_addname_dataframe[table_name] = daily_20170430[table_name]
print("daily_20170430 返回数据 row 行数 = "+str(daily_20170430.shape[0]))
daily_20170430_addname_dataframe.to_excel(daily_201704_excel_writer,'30_7',index=False)
daily_201704_excel_writer.save()




createexcel('daily_201705.xlsx')
daily_201705_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201705.xlsx')
daily_201705_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201705.xlsx', engine='openpyxl')
daily_201705_excel_writer.book = daily_201705_book
daily_201705_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201705_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170501")       ###  更新 记录日期
daily_20170501 = pro.daily(start_date='',end_date='',trade_date='20170501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170501_tscode_list = list() 
for ts_code_sh in daily_20170501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170501_tscode_list.append(stock_name)
daily_20170501_addname_dataframe=pd.DataFrame()
daily_20170501_addname_dataframe['cname'] = daily_20170501_tscode_list
for table_name in daily_20170501.columns.values.tolist():
    daily_20170501_addname_dataframe[table_name] = daily_20170501[table_name]
print("daily_20170501 返回数据 row 行数 = "+str(daily_20170501.shape[0]))
daily_20170501_addname_dataframe.to_excel(daily_201705_excel_writer,'1_1',index=False)
daily_201705_excel_writer.save()
daily_20170502 = pro.daily(start_date='',end_date='',trade_date='20170502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170502_tscode_list = list() 
for ts_code_sh in daily_20170502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170502_tscode_list.append(stock_name)
daily_20170502_addname_dataframe=pd.DataFrame()
daily_20170502_addname_dataframe['cname'] = daily_20170502_tscode_list
for table_name in daily_20170502.columns.values.tolist():
    daily_20170502_addname_dataframe[table_name] = daily_20170502[table_name]
print("daily_20170502 返回数据 row 行数 = "+str(daily_20170502.shape[0]))
daily_20170502_addname_dataframe.to_excel(daily_201705_excel_writer,'2_2',index=False)
daily_201705_excel_writer.save()
daily_20170503 = pro.daily(start_date='',end_date='',trade_date='20170503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170503_tscode_list = list() 
for ts_code_sh in daily_20170503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170503_tscode_list.append(stock_name)
daily_20170503_addname_dataframe=pd.DataFrame()
daily_20170503_addname_dataframe['cname'] = daily_20170503_tscode_list
for table_name in daily_20170503.columns.values.tolist():
    daily_20170503_addname_dataframe[table_name] = daily_20170503[table_name]
print("daily_20170503 返回数据 row 行数 = "+str(daily_20170503.shape[0]))
daily_20170503_addname_dataframe.to_excel(daily_201705_excel_writer,'3_3',index=False)
daily_201705_excel_writer.save()
daily_20170504 = pro.daily(start_date='',end_date='',trade_date='20170504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170504_tscode_list = list() 
for ts_code_sh in daily_20170504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170504_tscode_list.append(stock_name)
daily_20170504_addname_dataframe=pd.DataFrame()
daily_20170504_addname_dataframe['cname'] = daily_20170504_tscode_list
for table_name in daily_20170504.columns.values.tolist():
    daily_20170504_addname_dataframe[table_name] = daily_20170504[table_name]
print("daily_20170504 返回数据 row 行数 = "+str(daily_20170504.shape[0]))
daily_20170504_addname_dataframe.to_excel(daily_201705_excel_writer,'4_4',index=False)
daily_201705_excel_writer.save()
daily_20170505 = pro.daily(start_date='',end_date='',trade_date='20170505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170505_tscode_list = list() 
for ts_code_sh in daily_20170505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170505_tscode_list.append(stock_name)
daily_20170505_addname_dataframe=pd.DataFrame()
daily_20170505_addname_dataframe['cname'] = daily_20170505_tscode_list
for table_name in daily_20170505.columns.values.tolist():
    daily_20170505_addname_dataframe[table_name] = daily_20170505[table_name]
print("daily_20170505 返回数据 row 行数 = "+str(daily_20170505.shape[0]))
daily_20170505_addname_dataframe.to_excel(daily_201705_excel_writer,'5_5',index=False)
daily_201705_excel_writer.save()
daily_20170506 = pro.daily(start_date='',end_date='',trade_date='20170506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170506_tscode_list = list() 
for ts_code_sh in daily_20170506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170506_tscode_list.append(stock_name)
daily_20170506_addname_dataframe=pd.DataFrame()
daily_20170506_addname_dataframe['cname'] = daily_20170506_tscode_list
for table_name in daily_20170506.columns.values.tolist():
    daily_20170506_addname_dataframe[table_name] = daily_20170506[table_name]
print("daily_20170506 返回数据 row 行数 = "+str(daily_20170506.shape[0]))
daily_20170506_addname_dataframe.to_excel(daily_201705_excel_writer,'6_6',index=False)
daily_201705_excel_writer.save()
daily_20170507 = pro.daily(start_date='',end_date='',trade_date='20170507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170507_tscode_list = list() 
for ts_code_sh in daily_20170507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170507_tscode_list.append(stock_name)
daily_20170507_addname_dataframe=pd.DataFrame()
daily_20170507_addname_dataframe['cname'] = daily_20170507_tscode_list
for table_name in daily_20170507.columns.values.tolist():
    daily_20170507_addname_dataframe[table_name] = daily_20170507[table_name]
print("daily_20170507 返回数据 row 行数 = "+str(daily_20170507.shape[0]))
daily_20170507_addname_dataframe.to_excel(daily_201705_excel_writer,'7_7',index=False)
daily_201705_excel_writer.save()
daily_20170508 = pro.daily(start_date='',end_date='',trade_date='20170508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170508_tscode_list = list() 
for ts_code_sh in daily_20170508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170508_tscode_list.append(stock_name)
daily_20170508_addname_dataframe=pd.DataFrame()
daily_20170508_addname_dataframe['cname'] = daily_20170508_tscode_list
for table_name in daily_20170508.columns.values.tolist():
    daily_20170508_addname_dataframe[table_name] = daily_20170508[table_name]
print("daily_20170508 返回数据 row 行数 = "+str(daily_20170508.shape[0]))
daily_20170508_addname_dataframe.to_excel(daily_201705_excel_writer,'8_1',index=False)
daily_201705_excel_writer.save()
daily_20170509 = pro.daily(start_date='',end_date='',trade_date='20170509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170509_tscode_list = list() 
for ts_code_sh in daily_20170509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170509_tscode_list.append(stock_name)
daily_20170509_addname_dataframe=pd.DataFrame()
daily_20170509_addname_dataframe['cname'] = daily_20170509_tscode_list
for table_name in daily_20170509.columns.values.tolist():
    daily_20170509_addname_dataframe[table_name] = daily_20170509[table_name]
print("daily_20170509 返回数据 row 行数 = "+str(daily_20170509.shape[0]))
daily_20170509_addname_dataframe.to_excel(daily_201705_excel_writer,'9_2',index=False)
daily_201705_excel_writer.save()
daily_20170510 = pro.daily(start_date='',end_date='',trade_date='20170510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170510_tscode_list = list() 
for ts_code_sh in daily_20170510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170510_tscode_list.append(stock_name)
daily_20170510_addname_dataframe=pd.DataFrame()
daily_20170510_addname_dataframe['cname'] = daily_20170510_tscode_list
for table_name in daily_20170510.columns.values.tolist():
    daily_20170510_addname_dataframe[table_name] = daily_20170510[table_name]
print("daily_20170510 返回数据 row 行数 = "+str(daily_20170510.shape[0]))
daily_20170510_addname_dataframe.to_excel(daily_201705_excel_writer,'10_3',index=False)
daily_201705_excel_writer.save()
daily_20170511 = pro.daily(start_date='',end_date='',trade_date='20170511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170511_tscode_list = list() 
for ts_code_sh in daily_20170511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170511_tscode_list.append(stock_name)
daily_20170511_addname_dataframe=pd.DataFrame()
daily_20170511_addname_dataframe['cname'] = daily_20170511_tscode_list
for table_name in daily_20170511.columns.values.tolist():
    daily_20170511_addname_dataframe[table_name] = daily_20170511[table_name]
print("daily_20170511 返回数据 row 行数 = "+str(daily_20170511.shape[0]))
daily_20170511_addname_dataframe.to_excel(daily_201705_excel_writer,'11_4',index=False)
daily_201705_excel_writer.save()
daily_20170512 = pro.daily(start_date='',end_date='',trade_date='20170512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170512_tscode_list = list() 
for ts_code_sh in daily_20170512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170512_tscode_list.append(stock_name)
daily_20170512_addname_dataframe=pd.DataFrame()
daily_20170512_addname_dataframe['cname'] = daily_20170512_tscode_list
for table_name in daily_20170512.columns.values.tolist():
    daily_20170512_addname_dataframe[table_name] = daily_20170512[table_name]
print("daily_20170512 返回数据 row 行数 = "+str(daily_20170512.shape[0]))
daily_20170512_addname_dataframe.to_excel(daily_201705_excel_writer,'12_5',index=False)
daily_201705_excel_writer.save()
daily_20170513 = pro.daily(start_date='',end_date='',trade_date='20170513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170513_tscode_list = list() 
for ts_code_sh in daily_20170513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170513_tscode_list.append(stock_name)
daily_20170513_addname_dataframe=pd.DataFrame()
daily_20170513_addname_dataframe['cname'] = daily_20170513_tscode_list
for table_name in daily_20170513.columns.values.tolist():
    daily_20170513_addname_dataframe[table_name] = daily_20170513[table_name]
print("daily_20170513 返回数据 row 行数 = "+str(daily_20170513.shape[0]))
daily_20170513_addname_dataframe.to_excel(daily_201705_excel_writer,'13_6',index=False)
daily_201705_excel_writer.save()
daily_20170514 = pro.daily(start_date='',end_date='',trade_date='20170514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170514_tscode_list = list() 
for ts_code_sh in daily_20170514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170514_tscode_list.append(stock_name)
daily_20170514_addname_dataframe=pd.DataFrame()
daily_20170514_addname_dataframe['cname'] = daily_20170514_tscode_list
for table_name in daily_20170514.columns.values.tolist():
    daily_20170514_addname_dataframe[table_name] = daily_20170514[table_name]
print("daily_20170514 返回数据 row 行数 = "+str(daily_20170514.shape[0]))
daily_20170514_addname_dataframe.to_excel(daily_201705_excel_writer,'14_7',index=False)
daily_201705_excel_writer.save()
daily_20170515 = pro.daily(start_date='',end_date='',trade_date='20170515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170515_tscode_list = list() 
for ts_code_sh in daily_20170515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170515_tscode_list.append(stock_name)
daily_20170515_addname_dataframe=pd.DataFrame()
daily_20170515_addname_dataframe['cname'] = daily_20170515_tscode_list
for table_name in daily_20170515.columns.values.tolist():
    daily_20170515_addname_dataframe[table_name] = daily_20170515[table_name]
print("daily_20170515 返回数据 row 行数 = "+str(daily_20170515.shape[0]))
daily_20170515_addname_dataframe.to_excel(daily_201705_excel_writer,'15_1',index=False)
daily_201705_excel_writer.save()
daily_20170516 = pro.daily(start_date='',end_date='',trade_date='20170516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170516_tscode_list = list() 
for ts_code_sh in daily_20170516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170516_tscode_list.append(stock_name)
daily_20170516_addname_dataframe=pd.DataFrame()
daily_20170516_addname_dataframe['cname'] = daily_20170516_tscode_list
for table_name in daily_20170516.columns.values.tolist():
    daily_20170516_addname_dataframe[table_name] = daily_20170516[table_name]
print("daily_20170516 返回数据 row 行数 = "+str(daily_20170516.shape[0]))
daily_20170516_addname_dataframe.to_excel(daily_201705_excel_writer,'16_2',index=False)
daily_201705_excel_writer.save()
daily_20170517 = pro.daily(start_date='',end_date='',trade_date='20170517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170517_tscode_list = list() 
for ts_code_sh in daily_20170517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170517_tscode_list.append(stock_name)
daily_20170517_addname_dataframe=pd.DataFrame()
daily_20170517_addname_dataframe['cname'] = daily_20170517_tscode_list
for table_name in daily_20170517.columns.values.tolist():
    daily_20170517_addname_dataframe[table_name] = daily_20170517[table_name]
print("daily_20170517 返回数据 row 行数 = "+str(daily_20170517.shape[0]))
daily_20170517_addname_dataframe.to_excel(daily_201705_excel_writer,'17_3',index=False)
daily_201705_excel_writer.save()
daily_20170518 = pro.daily(start_date='',end_date='',trade_date='20170518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170518_tscode_list = list() 
for ts_code_sh in daily_20170518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170518_tscode_list.append(stock_name)
daily_20170518_addname_dataframe=pd.DataFrame()
daily_20170518_addname_dataframe['cname'] = daily_20170518_tscode_list
for table_name in daily_20170518.columns.values.tolist():
    daily_20170518_addname_dataframe[table_name] = daily_20170518[table_name]
print("daily_20170518 返回数据 row 行数 = "+str(daily_20170518.shape[0]))
daily_20170518_addname_dataframe.to_excel(daily_201705_excel_writer,'18_4',index=False)
daily_201705_excel_writer.save()
daily_20170519 = pro.daily(start_date='',end_date='',trade_date='20170519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170519_tscode_list = list() 
for ts_code_sh in daily_20170519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170519_tscode_list.append(stock_name)
daily_20170519_addname_dataframe=pd.DataFrame()
daily_20170519_addname_dataframe['cname'] = daily_20170519_tscode_list
for table_name in daily_20170519.columns.values.tolist():
    daily_20170519_addname_dataframe[table_name] = daily_20170519[table_name]
print("daily_20170519 返回数据 row 行数 = "+str(daily_20170519.shape[0]))
daily_20170519_addname_dataframe.to_excel(daily_201705_excel_writer,'19_5',index=False)
daily_201705_excel_writer.save()
daily_20170520 = pro.daily(start_date='',end_date='',trade_date='20170520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170520_tscode_list = list() 
for ts_code_sh in daily_20170520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170520_tscode_list.append(stock_name)
daily_20170520_addname_dataframe=pd.DataFrame()
daily_20170520_addname_dataframe['cname'] = daily_20170520_tscode_list
for table_name in daily_20170520.columns.values.tolist():
    daily_20170520_addname_dataframe[table_name] = daily_20170520[table_name]
print("daily_20170520 返回数据 row 行数 = "+str(daily_20170520.shape[0]))
daily_20170520_addname_dataframe.to_excel(daily_201705_excel_writer,'20_6',index=False)
daily_201705_excel_writer.save()
daily_20170521 = pro.daily(start_date='',end_date='',trade_date='20170521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170521_tscode_list = list() 
for ts_code_sh in daily_20170521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170521_tscode_list.append(stock_name)
daily_20170521_addname_dataframe=pd.DataFrame()
daily_20170521_addname_dataframe['cname'] = daily_20170521_tscode_list
for table_name in daily_20170521.columns.values.tolist():
    daily_20170521_addname_dataframe[table_name] = daily_20170521[table_name]
print("daily_20170521 返回数据 row 行数 = "+str(daily_20170521.shape[0]))
daily_20170521_addname_dataframe.to_excel(daily_201705_excel_writer,'21_7',index=False)
daily_201705_excel_writer.save()
daily_20170522 = pro.daily(start_date='',end_date='',trade_date='20170522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170522_tscode_list = list() 
for ts_code_sh in daily_20170522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170522_tscode_list.append(stock_name)
daily_20170522_addname_dataframe=pd.DataFrame()
daily_20170522_addname_dataframe['cname'] = daily_20170522_tscode_list
for table_name in daily_20170522.columns.values.tolist():
    daily_20170522_addname_dataframe[table_name] = daily_20170522[table_name]
print("daily_20170522 返回数据 row 行数 = "+str(daily_20170522.shape[0]))
daily_20170522_addname_dataframe.to_excel(daily_201705_excel_writer,'22_1',index=False)
daily_201705_excel_writer.save()
daily_20170523 = pro.daily(start_date='',end_date='',trade_date='20170523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170523_tscode_list = list() 
for ts_code_sh in daily_20170523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170523_tscode_list.append(stock_name)
daily_20170523_addname_dataframe=pd.DataFrame()
daily_20170523_addname_dataframe['cname'] = daily_20170523_tscode_list
for table_name in daily_20170523.columns.values.tolist():
    daily_20170523_addname_dataframe[table_name] = daily_20170523[table_name]
print("daily_20170523 返回数据 row 行数 = "+str(daily_20170523.shape[0]))
daily_20170523_addname_dataframe.to_excel(daily_201705_excel_writer,'23_2',index=False)
daily_201705_excel_writer.save()
daily_20170524 = pro.daily(start_date='',end_date='',trade_date='20170524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170524_tscode_list = list() 
for ts_code_sh in daily_20170524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170524_tscode_list.append(stock_name)
daily_20170524_addname_dataframe=pd.DataFrame()
daily_20170524_addname_dataframe['cname'] = daily_20170524_tscode_list
for table_name in daily_20170524.columns.values.tolist():
    daily_20170524_addname_dataframe[table_name] = daily_20170524[table_name]
print("daily_20170524 返回数据 row 行数 = "+str(daily_20170524.shape[0]))
daily_20170524_addname_dataframe.to_excel(daily_201705_excel_writer,'24_3',index=False)
daily_201705_excel_writer.save()
daily_20170525 = pro.daily(start_date='',end_date='',trade_date='20170525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170525_tscode_list = list() 
for ts_code_sh in daily_20170525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170525_tscode_list.append(stock_name)
daily_20170525_addname_dataframe=pd.DataFrame()
daily_20170525_addname_dataframe['cname'] = daily_20170525_tscode_list
for table_name in daily_20170525.columns.values.tolist():
    daily_20170525_addname_dataframe[table_name] = daily_20170525[table_name]
print("daily_20170525 返回数据 row 行数 = "+str(daily_20170525.shape[0]))
daily_20170525_addname_dataframe.to_excel(daily_201705_excel_writer,'25_4',index=False)
daily_201705_excel_writer.save()
daily_20170526 = pro.daily(start_date='',end_date='',trade_date='20170526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170526_tscode_list = list() 
for ts_code_sh in daily_20170526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170526_tscode_list.append(stock_name)
daily_20170526_addname_dataframe=pd.DataFrame()
daily_20170526_addname_dataframe['cname'] = daily_20170526_tscode_list
for table_name in daily_20170526.columns.values.tolist():
    daily_20170526_addname_dataframe[table_name] = daily_20170526[table_name]
print("daily_20170526 返回数据 row 行数 = "+str(daily_20170526.shape[0]))
daily_20170526_addname_dataframe.to_excel(daily_201705_excel_writer,'26_5',index=False)
daily_201705_excel_writer.save()
daily_20170527 = pro.daily(start_date='',end_date='',trade_date='20170527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170527_tscode_list = list() 
for ts_code_sh in daily_20170527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170527_tscode_list.append(stock_name)
daily_20170527_addname_dataframe=pd.DataFrame()
daily_20170527_addname_dataframe['cname'] = daily_20170527_tscode_list
for table_name in daily_20170527.columns.values.tolist():
    daily_20170527_addname_dataframe[table_name] = daily_20170527[table_name]
print("daily_20170527 返回数据 row 行数 = "+str(daily_20170527.shape[0]))
daily_20170527_addname_dataframe.to_excel(daily_201705_excel_writer,'27_6',index=False)
daily_201705_excel_writer.save()
daily_20170528 = pro.daily(start_date='',end_date='',trade_date='20170528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170528_tscode_list = list() 
for ts_code_sh in daily_20170528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170528_tscode_list.append(stock_name)
daily_20170528_addname_dataframe=pd.DataFrame()
daily_20170528_addname_dataframe['cname'] = daily_20170528_tscode_list
for table_name in daily_20170528.columns.values.tolist():
    daily_20170528_addname_dataframe[table_name] = daily_20170528[table_name]
print("daily_20170528 返回数据 row 行数 = "+str(daily_20170528.shape[0]))
daily_20170528_addname_dataframe.to_excel(daily_201705_excel_writer,'28_7',index=False)
daily_201705_excel_writer.save()
daily_20170529 = pro.daily(start_date='',end_date='',trade_date='20170529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170529_tscode_list = list() 
for ts_code_sh in daily_20170529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170529_tscode_list.append(stock_name)
daily_20170529_addname_dataframe=pd.DataFrame()
daily_20170529_addname_dataframe['cname'] = daily_20170529_tscode_list
for table_name in daily_20170529.columns.values.tolist():
    daily_20170529_addname_dataframe[table_name] = daily_20170529[table_name]
print("daily_20170529 返回数据 row 行数 = "+str(daily_20170529.shape[0]))
daily_20170529_addname_dataframe.to_excel(daily_201705_excel_writer,'29_1',index=False)
daily_201705_excel_writer.save()
daily_20170530 = pro.daily(start_date='',end_date='',trade_date='20170530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170530_tscode_list = list() 
for ts_code_sh in daily_20170530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170530_tscode_list.append(stock_name)
daily_20170530_addname_dataframe=pd.DataFrame()
daily_20170530_addname_dataframe['cname'] = daily_20170530_tscode_list
for table_name in daily_20170530.columns.values.tolist():
    daily_20170530_addname_dataframe[table_name] = daily_20170530[table_name]
print("daily_20170530 返回数据 row 行数 = "+str(daily_20170530.shape[0]))
daily_20170530_addname_dataframe.to_excel(daily_201705_excel_writer,'30_2',index=False)
daily_201705_excel_writer.save()
daily_20170531 = pro.daily(start_date='',end_date='',trade_date='20170531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170531_tscode_list = list() 
for ts_code_sh in daily_20170531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170531_tscode_list.append(stock_name)
daily_20170531_addname_dataframe=pd.DataFrame()
daily_20170531_addname_dataframe['cname'] = daily_20170531_tscode_list
for table_name in daily_20170531.columns.values.tolist():
    daily_20170531_addname_dataframe[table_name] = daily_20170531[table_name]
print("daily_20170531 返回数据 row 行数 = "+str(daily_20170531.shape[0]))
daily_20170531_addname_dataframe.to_excel(daily_201705_excel_writer,'31_3',index=False)
daily_201705_excel_writer.save()




createexcel('daily_201706.xlsx')
daily_201706_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201706.xlsx')
daily_201706_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201706.xlsx', engine='openpyxl')
daily_201706_excel_writer.book = daily_201706_book
daily_201706_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201706_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170601")       ###  更新 记录日期
daily_20170601 = pro.daily(start_date='',end_date='',trade_date='20170601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170601_tscode_list = list() 
for ts_code_sh in daily_20170601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170601_tscode_list.append(stock_name)
daily_20170601_addname_dataframe=pd.DataFrame()
daily_20170601_addname_dataframe['cname'] = daily_20170601_tscode_list
for table_name in daily_20170601.columns.values.tolist():
    daily_20170601_addname_dataframe[table_name] = daily_20170601[table_name]
print("daily_20170601 返回数据 row 行数 = "+str(daily_20170601.shape[0]))
daily_20170601_addname_dataframe.to_excel(daily_201706_excel_writer,'1_4',index=False)
daily_201706_excel_writer.save()
daily_20170602 = pro.daily(start_date='',end_date='',trade_date='20170602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170602_tscode_list = list() 
for ts_code_sh in daily_20170602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170602_tscode_list.append(stock_name)
daily_20170602_addname_dataframe=pd.DataFrame()
daily_20170602_addname_dataframe['cname'] = daily_20170602_tscode_list
for table_name in daily_20170602.columns.values.tolist():
    daily_20170602_addname_dataframe[table_name] = daily_20170602[table_name]
print("daily_20170602 返回数据 row 行数 = "+str(daily_20170602.shape[0]))
daily_20170602_addname_dataframe.to_excel(daily_201706_excel_writer,'2_5',index=False)
daily_201706_excel_writer.save()
daily_20170603 = pro.daily(start_date='',end_date='',trade_date='20170603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170603_tscode_list = list() 
for ts_code_sh in daily_20170603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170603_tscode_list.append(stock_name)
daily_20170603_addname_dataframe=pd.DataFrame()
daily_20170603_addname_dataframe['cname'] = daily_20170603_tscode_list
for table_name in daily_20170603.columns.values.tolist():
    daily_20170603_addname_dataframe[table_name] = daily_20170603[table_name]
print("daily_20170603 返回数据 row 行数 = "+str(daily_20170603.shape[0]))
daily_20170603_addname_dataframe.to_excel(daily_201706_excel_writer,'3_6',index=False)
daily_201706_excel_writer.save()
daily_20170604 = pro.daily(start_date='',end_date='',trade_date='20170604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170604_tscode_list = list() 
for ts_code_sh in daily_20170604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170604_tscode_list.append(stock_name)
daily_20170604_addname_dataframe=pd.DataFrame()
daily_20170604_addname_dataframe['cname'] = daily_20170604_tscode_list
for table_name in daily_20170604.columns.values.tolist():
    daily_20170604_addname_dataframe[table_name] = daily_20170604[table_name]
print("daily_20170604 返回数据 row 行数 = "+str(daily_20170604.shape[0]))
daily_20170604_addname_dataframe.to_excel(daily_201706_excel_writer,'4_7',index=False)
daily_201706_excel_writer.save()
daily_20170605 = pro.daily(start_date='',end_date='',trade_date='20170605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170605_tscode_list = list() 
for ts_code_sh in daily_20170605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170605_tscode_list.append(stock_name)
daily_20170605_addname_dataframe=pd.DataFrame()
daily_20170605_addname_dataframe['cname'] = daily_20170605_tscode_list
for table_name in daily_20170605.columns.values.tolist():
    daily_20170605_addname_dataframe[table_name] = daily_20170605[table_name]
print("daily_20170605 返回数据 row 行数 = "+str(daily_20170605.shape[0]))
daily_20170605_addname_dataframe.to_excel(daily_201706_excel_writer,'5_1',index=False)
daily_201706_excel_writer.save()
daily_20170606 = pro.daily(start_date='',end_date='',trade_date='20170606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170606_tscode_list = list() 
for ts_code_sh in daily_20170606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170606_tscode_list.append(stock_name)
daily_20170606_addname_dataframe=pd.DataFrame()
daily_20170606_addname_dataframe['cname'] = daily_20170606_tscode_list
for table_name in daily_20170606.columns.values.tolist():
    daily_20170606_addname_dataframe[table_name] = daily_20170606[table_name]
print("daily_20170606 返回数据 row 行数 = "+str(daily_20170606.shape[0]))
daily_20170606_addname_dataframe.to_excel(daily_201706_excel_writer,'6_2',index=False)
daily_201706_excel_writer.save()
daily_20170607 = pro.daily(start_date='',end_date='',trade_date='20170607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170607_tscode_list = list() 
for ts_code_sh in daily_20170607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170607_tscode_list.append(stock_name)
daily_20170607_addname_dataframe=pd.DataFrame()
daily_20170607_addname_dataframe['cname'] = daily_20170607_tscode_list
for table_name in daily_20170607.columns.values.tolist():
    daily_20170607_addname_dataframe[table_name] = daily_20170607[table_name]
print("daily_20170607 返回数据 row 行数 = "+str(daily_20170607.shape[0]))
daily_20170607_addname_dataframe.to_excel(daily_201706_excel_writer,'7_3',index=False)
daily_201706_excel_writer.save()
daily_20170608 = pro.daily(start_date='',end_date='',trade_date='20170608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170608_tscode_list = list() 
for ts_code_sh in daily_20170608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170608_tscode_list.append(stock_name)
daily_20170608_addname_dataframe=pd.DataFrame()
daily_20170608_addname_dataframe['cname'] = daily_20170608_tscode_list
for table_name in daily_20170608.columns.values.tolist():
    daily_20170608_addname_dataframe[table_name] = daily_20170608[table_name]
print("daily_20170608 返回数据 row 行数 = "+str(daily_20170608.shape[0]))
daily_20170608_addname_dataframe.to_excel(daily_201706_excel_writer,'8_4',index=False)
daily_201706_excel_writer.save()
daily_20170609 = pro.daily(start_date='',end_date='',trade_date='20170609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170609_tscode_list = list() 
for ts_code_sh in daily_20170609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170609_tscode_list.append(stock_name)
daily_20170609_addname_dataframe=pd.DataFrame()
daily_20170609_addname_dataframe['cname'] = daily_20170609_tscode_list
for table_name in daily_20170609.columns.values.tolist():
    daily_20170609_addname_dataframe[table_name] = daily_20170609[table_name]
print("daily_20170609 返回数据 row 行数 = "+str(daily_20170609.shape[0]))
daily_20170609_addname_dataframe.to_excel(daily_201706_excel_writer,'9_5',index=False)
daily_201706_excel_writer.save()
daily_20170610 = pro.daily(start_date='',end_date='',trade_date='20170610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170610_tscode_list = list() 
for ts_code_sh in daily_20170610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170610_tscode_list.append(stock_name)
daily_20170610_addname_dataframe=pd.DataFrame()
daily_20170610_addname_dataframe['cname'] = daily_20170610_tscode_list
for table_name in daily_20170610.columns.values.tolist():
    daily_20170610_addname_dataframe[table_name] = daily_20170610[table_name]
print("daily_20170610 返回数据 row 行数 = "+str(daily_20170610.shape[0]))
daily_20170610_addname_dataframe.to_excel(daily_201706_excel_writer,'10_6',index=False)
daily_201706_excel_writer.save()
daily_20170611 = pro.daily(start_date='',end_date='',trade_date='20170611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170611_tscode_list = list() 
for ts_code_sh in daily_20170611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170611_tscode_list.append(stock_name)
daily_20170611_addname_dataframe=pd.DataFrame()
daily_20170611_addname_dataframe['cname'] = daily_20170611_tscode_list
for table_name in daily_20170611.columns.values.tolist():
    daily_20170611_addname_dataframe[table_name] = daily_20170611[table_name]
print("daily_20170611 返回数据 row 行数 = "+str(daily_20170611.shape[0]))
daily_20170611_addname_dataframe.to_excel(daily_201706_excel_writer,'11_7',index=False)
daily_201706_excel_writer.save()
daily_20170612 = pro.daily(start_date='',end_date='',trade_date='20170612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170612_tscode_list = list() 
for ts_code_sh in daily_20170612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170612_tscode_list.append(stock_name)
daily_20170612_addname_dataframe=pd.DataFrame()
daily_20170612_addname_dataframe['cname'] = daily_20170612_tscode_list
for table_name in daily_20170612.columns.values.tolist():
    daily_20170612_addname_dataframe[table_name] = daily_20170612[table_name]
print("daily_20170612 返回数据 row 行数 = "+str(daily_20170612.shape[0]))
daily_20170612_addname_dataframe.to_excel(daily_201706_excel_writer,'12_1',index=False)
daily_201706_excel_writer.save()
daily_20170613 = pro.daily(start_date='',end_date='',trade_date='20170613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170613_tscode_list = list() 
for ts_code_sh in daily_20170613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170613_tscode_list.append(stock_name)
daily_20170613_addname_dataframe=pd.DataFrame()
daily_20170613_addname_dataframe['cname'] = daily_20170613_tscode_list
for table_name in daily_20170613.columns.values.tolist():
    daily_20170613_addname_dataframe[table_name] = daily_20170613[table_name]
print("daily_20170613 返回数据 row 行数 = "+str(daily_20170613.shape[0]))
daily_20170613_addname_dataframe.to_excel(daily_201706_excel_writer,'13_2',index=False)
daily_201706_excel_writer.save()
daily_20170614 = pro.daily(start_date='',end_date='',trade_date='20170614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170614_tscode_list = list() 
for ts_code_sh in daily_20170614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170614_tscode_list.append(stock_name)
daily_20170614_addname_dataframe=pd.DataFrame()
daily_20170614_addname_dataframe['cname'] = daily_20170614_tscode_list
for table_name in daily_20170614.columns.values.tolist():
    daily_20170614_addname_dataframe[table_name] = daily_20170614[table_name]
print("daily_20170614 返回数据 row 行数 = "+str(daily_20170614.shape[0]))
daily_20170614_addname_dataframe.to_excel(daily_201706_excel_writer,'14_3',index=False)
daily_201706_excel_writer.save()
daily_20170615 = pro.daily(start_date='',end_date='',trade_date='20170615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170615_tscode_list = list() 
for ts_code_sh in daily_20170615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170615_tscode_list.append(stock_name)
daily_20170615_addname_dataframe=pd.DataFrame()
daily_20170615_addname_dataframe['cname'] = daily_20170615_tscode_list
for table_name in daily_20170615.columns.values.tolist():
    daily_20170615_addname_dataframe[table_name] = daily_20170615[table_name]
print("daily_20170615 返回数据 row 行数 = "+str(daily_20170615.shape[0]))
daily_20170615_addname_dataframe.to_excel(daily_201706_excel_writer,'15_4',index=False)
daily_201706_excel_writer.save()
daily_20170616 = pro.daily(start_date='',end_date='',trade_date='20170616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170616_tscode_list = list() 
for ts_code_sh in daily_20170616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170616_tscode_list.append(stock_name)
daily_20170616_addname_dataframe=pd.DataFrame()
daily_20170616_addname_dataframe['cname'] = daily_20170616_tscode_list
for table_name in daily_20170616.columns.values.tolist():
    daily_20170616_addname_dataframe[table_name] = daily_20170616[table_name]
print("daily_20170616 返回数据 row 行数 = "+str(daily_20170616.shape[0]))
daily_20170616_addname_dataframe.to_excel(daily_201706_excel_writer,'16_5',index=False)
daily_201706_excel_writer.save()
daily_20170617 = pro.daily(start_date='',end_date='',trade_date='20170617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170617_tscode_list = list() 
for ts_code_sh in daily_20170617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170617_tscode_list.append(stock_name)
daily_20170617_addname_dataframe=pd.DataFrame()
daily_20170617_addname_dataframe['cname'] = daily_20170617_tscode_list
for table_name in daily_20170617.columns.values.tolist():
    daily_20170617_addname_dataframe[table_name] = daily_20170617[table_name]
print("daily_20170617 返回数据 row 行数 = "+str(daily_20170617.shape[0]))
daily_20170617_addname_dataframe.to_excel(daily_201706_excel_writer,'17_6',index=False)
daily_201706_excel_writer.save()
daily_20170618 = pro.daily(start_date='',end_date='',trade_date='20170618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170618_tscode_list = list() 
for ts_code_sh in daily_20170618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170618_tscode_list.append(stock_name)
daily_20170618_addname_dataframe=pd.DataFrame()
daily_20170618_addname_dataframe['cname'] = daily_20170618_tscode_list
for table_name in daily_20170618.columns.values.tolist():
    daily_20170618_addname_dataframe[table_name] = daily_20170618[table_name]
print("daily_20170618 返回数据 row 行数 = "+str(daily_20170618.shape[0]))
daily_20170618_addname_dataframe.to_excel(daily_201706_excel_writer,'18_7',index=False)
daily_201706_excel_writer.save()
daily_20170619 = pro.daily(start_date='',end_date='',trade_date='20170619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170619_tscode_list = list() 
for ts_code_sh in daily_20170619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170619_tscode_list.append(stock_name)
daily_20170619_addname_dataframe=pd.DataFrame()
daily_20170619_addname_dataframe['cname'] = daily_20170619_tscode_list
for table_name in daily_20170619.columns.values.tolist():
    daily_20170619_addname_dataframe[table_name] = daily_20170619[table_name]
print("daily_20170619 返回数据 row 行数 = "+str(daily_20170619.shape[0]))
daily_20170619_addname_dataframe.to_excel(daily_201706_excel_writer,'19_1',index=False)
daily_201706_excel_writer.save()
daily_20170620 = pro.daily(start_date='',end_date='',trade_date='20170620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170620_tscode_list = list() 
for ts_code_sh in daily_20170620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170620_tscode_list.append(stock_name)
daily_20170620_addname_dataframe=pd.DataFrame()
daily_20170620_addname_dataframe['cname'] = daily_20170620_tscode_list
for table_name in daily_20170620.columns.values.tolist():
    daily_20170620_addname_dataframe[table_name] = daily_20170620[table_name]
print("daily_20170620 返回数据 row 行数 = "+str(daily_20170620.shape[0]))
daily_20170620_addname_dataframe.to_excel(daily_201706_excel_writer,'20_2',index=False)
daily_201706_excel_writer.save()
daily_20170621 = pro.daily(start_date='',end_date='',trade_date='20170621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170621_tscode_list = list() 
for ts_code_sh in daily_20170621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170621_tscode_list.append(stock_name)
daily_20170621_addname_dataframe=pd.DataFrame()
daily_20170621_addname_dataframe['cname'] = daily_20170621_tscode_list
for table_name in daily_20170621.columns.values.tolist():
    daily_20170621_addname_dataframe[table_name] = daily_20170621[table_name]
print("daily_20170621 返回数据 row 行数 = "+str(daily_20170621.shape[0]))
daily_20170621_addname_dataframe.to_excel(daily_201706_excel_writer,'21_3',index=False)
daily_201706_excel_writer.save()
daily_20170622 = pro.daily(start_date='',end_date='',trade_date='20170622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170622_tscode_list = list() 
for ts_code_sh in daily_20170622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170622_tscode_list.append(stock_name)
daily_20170622_addname_dataframe=pd.DataFrame()
daily_20170622_addname_dataframe['cname'] = daily_20170622_tscode_list
for table_name in daily_20170622.columns.values.tolist():
    daily_20170622_addname_dataframe[table_name] = daily_20170622[table_name]
print("daily_20170622 返回数据 row 行数 = "+str(daily_20170622.shape[0]))
daily_20170622_addname_dataframe.to_excel(daily_201706_excel_writer,'22_4',index=False)
daily_201706_excel_writer.save()
daily_20170623 = pro.daily(start_date='',end_date='',trade_date='20170623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170623_tscode_list = list() 
for ts_code_sh in daily_20170623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170623_tscode_list.append(stock_name)
daily_20170623_addname_dataframe=pd.DataFrame()
daily_20170623_addname_dataframe['cname'] = daily_20170623_tscode_list
for table_name in daily_20170623.columns.values.tolist():
    daily_20170623_addname_dataframe[table_name] = daily_20170623[table_name]
print("daily_20170623 返回数据 row 行数 = "+str(daily_20170623.shape[0]))
daily_20170623_addname_dataframe.to_excel(daily_201706_excel_writer,'23_5',index=False)
daily_201706_excel_writer.save()
daily_20170624 = pro.daily(start_date='',end_date='',trade_date='20170624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170624_tscode_list = list() 
for ts_code_sh in daily_20170624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170624_tscode_list.append(stock_name)
daily_20170624_addname_dataframe=pd.DataFrame()
daily_20170624_addname_dataframe['cname'] = daily_20170624_tscode_list
for table_name in daily_20170624.columns.values.tolist():
    daily_20170624_addname_dataframe[table_name] = daily_20170624[table_name]
print("daily_20170624 返回数据 row 行数 = "+str(daily_20170624.shape[0]))
daily_20170624_addname_dataframe.to_excel(daily_201706_excel_writer,'24_6',index=False)
daily_201706_excel_writer.save()
daily_20170625 = pro.daily(start_date='',end_date='',trade_date='20170625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170625_tscode_list = list() 
for ts_code_sh in daily_20170625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170625_tscode_list.append(stock_name)
daily_20170625_addname_dataframe=pd.DataFrame()
daily_20170625_addname_dataframe['cname'] = daily_20170625_tscode_list
for table_name in daily_20170625.columns.values.tolist():
    daily_20170625_addname_dataframe[table_name] = daily_20170625[table_name]
print("daily_20170625 返回数据 row 行数 = "+str(daily_20170625.shape[0]))
daily_20170625_addname_dataframe.to_excel(daily_201706_excel_writer,'25_7',index=False)
daily_201706_excel_writer.save()
daily_20170626 = pro.daily(start_date='',end_date='',trade_date='20170626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170626_tscode_list = list() 
for ts_code_sh in daily_20170626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170626_tscode_list.append(stock_name)
daily_20170626_addname_dataframe=pd.DataFrame()
daily_20170626_addname_dataframe['cname'] = daily_20170626_tscode_list
for table_name in daily_20170626.columns.values.tolist():
    daily_20170626_addname_dataframe[table_name] = daily_20170626[table_name]
print("daily_20170626 返回数据 row 行数 = "+str(daily_20170626.shape[0]))
daily_20170626_addname_dataframe.to_excel(daily_201706_excel_writer,'26_1',index=False)
daily_201706_excel_writer.save()
daily_20170627 = pro.daily(start_date='',end_date='',trade_date='20170627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170627_tscode_list = list() 
for ts_code_sh in daily_20170627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170627_tscode_list.append(stock_name)
daily_20170627_addname_dataframe=pd.DataFrame()
daily_20170627_addname_dataframe['cname'] = daily_20170627_tscode_list
for table_name in daily_20170627.columns.values.tolist():
    daily_20170627_addname_dataframe[table_name] = daily_20170627[table_name]
print("daily_20170627 返回数据 row 行数 = "+str(daily_20170627.shape[0]))
daily_20170627_addname_dataframe.to_excel(daily_201706_excel_writer,'27_2',index=False)
daily_201706_excel_writer.save()
daily_20170628 = pro.daily(start_date='',end_date='',trade_date='20170628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170628_tscode_list = list() 
for ts_code_sh in daily_20170628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170628_tscode_list.append(stock_name)
daily_20170628_addname_dataframe=pd.DataFrame()
daily_20170628_addname_dataframe['cname'] = daily_20170628_tscode_list
for table_name in daily_20170628.columns.values.tolist():
    daily_20170628_addname_dataframe[table_name] = daily_20170628[table_name]
print("daily_20170628 返回数据 row 行数 = "+str(daily_20170628.shape[0]))
daily_20170628_addname_dataframe.to_excel(daily_201706_excel_writer,'28_3',index=False)
daily_201706_excel_writer.save()
daily_20170629 = pro.daily(start_date='',end_date='',trade_date='20170629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170629_tscode_list = list() 
for ts_code_sh in daily_20170629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170629_tscode_list.append(stock_name)
daily_20170629_addname_dataframe=pd.DataFrame()
daily_20170629_addname_dataframe['cname'] = daily_20170629_tscode_list
for table_name in daily_20170629.columns.values.tolist():
    daily_20170629_addname_dataframe[table_name] = daily_20170629[table_name]
print("daily_20170629 返回数据 row 行数 = "+str(daily_20170629.shape[0]))
daily_20170629_addname_dataframe.to_excel(daily_201706_excel_writer,'29_4',index=False)
daily_201706_excel_writer.save()
daily_20170630 = pro.daily(start_date='',end_date='',trade_date='20170630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170630_tscode_list = list() 
for ts_code_sh in daily_20170630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170630_tscode_list.append(stock_name)
daily_20170630_addname_dataframe=pd.DataFrame()
daily_20170630_addname_dataframe['cname'] = daily_20170630_tscode_list
for table_name in daily_20170630.columns.values.tolist():
    daily_20170630_addname_dataframe[table_name] = daily_20170630[table_name]
print("daily_20170630 返回数据 row 行数 = "+str(daily_20170630.shape[0]))
daily_20170630_addname_dataframe.to_excel(daily_201706_excel_writer,'30_5',index=False)
daily_201706_excel_writer.save()




createexcel('daily_201707.xlsx')
daily_201707_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201707.xlsx')
daily_201707_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201707.xlsx', engine='openpyxl')
daily_201707_excel_writer.book = daily_201707_book
daily_201707_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201707_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170701")       ###  更新 记录日期
daily_20170701 = pro.daily(start_date='',end_date='',trade_date='20170701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170701_tscode_list = list() 
for ts_code_sh in daily_20170701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170701_tscode_list.append(stock_name)
daily_20170701_addname_dataframe=pd.DataFrame()
daily_20170701_addname_dataframe['cname'] = daily_20170701_tscode_list
for table_name in daily_20170701.columns.values.tolist():
    daily_20170701_addname_dataframe[table_name] = daily_20170701[table_name]
print("daily_20170701 返回数据 row 行数 = "+str(daily_20170701.shape[0]))
daily_20170701_addname_dataframe.to_excel(daily_201707_excel_writer,'1_6',index=False)
daily_201707_excel_writer.save()
daily_20170702 = pro.daily(start_date='',end_date='',trade_date='20170702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170702_tscode_list = list() 
for ts_code_sh in daily_20170702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170702_tscode_list.append(stock_name)
daily_20170702_addname_dataframe=pd.DataFrame()
daily_20170702_addname_dataframe['cname'] = daily_20170702_tscode_list
for table_name in daily_20170702.columns.values.tolist():
    daily_20170702_addname_dataframe[table_name] = daily_20170702[table_name]
print("daily_20170702 返回数据 row 行数 = "+str(daily_20170702.shape[0]))
daily_20170702_addname_dataframe.to_excel(daily_201707_excel_writer,'2_7',index=False)
daily_201707_excel_writer.save()
daily_20170703 = pro.daily(start_date='',end_date='',trade_date='20170703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170703_tscode_list = list() 
for ts_code_sh in daily_20170703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170703_tscode_list.append(stock_name)
daily_20170703_addname_dataframe=pd.DataFrame()
daily_20170703_addname_dataframe['cname'] = daily_20170703_tscode_list
for table_name in daily_20170703.columns.values.tolist():
    daily_20170703_addname_dataframe[table_name] = daily_20170703[table_name]
print("daily_20170703 返回数据 row 行数 = "+str(daily_20170703.shape[0]))
daily_20170703_addname_dataframe.to_excel(daily_201707_excel_writer,'3_1',index=False)
daily_201707_excel_writer.save()
daily_20170704 = pro.daily(start_date='',end_date='',trade_date='20170704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170704_tscode_list = list() 
for ts_code_sh in daily_20170704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170704_tscode_list.append(stock_name)
daily_20170704_addname_dataframe=pd.DataFrame()
daily_20170704_addname_dataframe['cname'] = daily_20170704_tscode_list
for table_name in daily_20170704.columns.values.tolist():
    daily_20170704_addname_dataframe[table_name] = daily_20170704[table_name]
print("daily_20170704 返回数据 row 行数 = "+str(daily_20170704.shape[0]))
daily_20170704_addname_dataframe.to_excel(daily_201707_excel_writer,'4_2',index=False)
daily_201707_excel_writer.save()
daily_20170705 = pro.daily(start_date='',end_date='',trade_date='20170705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170705_tscode_list = list() 
for ts_code_sh in daily_20170705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170705_tscode_list.append(stock_name)
daily_20170705_addname_dataframe=pd.DataFrame()
daily_20170705_addname_dataframe['cname'] = daily_20170705_tscode_list
for table_name in daily_20170705.columns.values.tolist():
    daily_20170705_addname_dataframe[table_name] = daily_20170705[table_name]
print("daily_20170705 返回数据 row 行数 = "+str(daily_20170705.shape[0]))
daily_20170705_addname_dataframe.to_excel(daily_201707_excel_writer,'5_3',index=False)
daily_201707_excel_writer.save()
daily_20170706 = pro.daily(start_date='',end_date='',trade_date='20170706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170706_tscode_list = list() 
for ts_code_sh in daily_20170706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170706_tscode_list.append(stock_name)
daily_20170706_addname_dataframe=pd.DataFrame()
daily_20170706_addname_dataframe['cname'] = daily_20170706_tscode_list
for table_name in daily_20170706.columns.values.tolist():
    daily_20170706_addname_dataframe[table_name] = daily_20170706[table_name]
print("daily_20170706 返回数据 row 行数 = "+str(daily_20170706.shape[0]))
daily_20170706_addname_dataframe.to_excel(daily_201707_excel_writer,'6_4',index=False)
daily_201707_excel_writer.save()
daily_20170707 = pro.daily(start_date='',end_date='',trade_date='20170707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170707_tscode_list = list() 
for ts_code_sh in daily_20170707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170707_tscode_list.append(stock_name)
daily_20170707_addname_dataframe=pd.DataFrame()
daily_20170707_addname_dataframe['cname'] = daily_20170707_tscode_list
for table_name in daily_20170707.columns.values.tolist():
    daily_20170707_addname_dataframe[table_name] = daily_20170707[table_name]
print("daily_20170707 返回数据 row 行数 = "+str(daily_20170707.shape[0]))
daily_20170707_addname_dataframe.to_excel(daily_201707_excel_writer,'7_5',index=False)
daily_201707_excel_writer.save()
daily_20170708 = pro.daily(start_date='',end_date='',trade_date='20170708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170708_tscode_list = list() 
for ts_code_sh in daily_20170708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170708_tscode_list.append(stock_name)
daily_20170708_addname_dataframe=pd.DataFrame()
daily_20170708_addname_dataframe['cname'] = daily_20170708_tscode_list
for table_name in daily_20170708.columns.values.tolist():
    daily_20170708_addname_dataframe[table_name] = daily_20170708[table_name]
print("daily_20170708 返回数据 row 行数 = "+str(daily_20170708.shape[0]))
daily_20170708_addname_dataframe.to_excel(daily_201707_excel_writer,'8_6',index=False)
daily_201707_excel_writer.save()
daily_20170709 = pro.daily(start_date='',end_date='',trade_date='20170709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170709_tscode_list = list() 
for ts_code_sh in daily_20170709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170709_tscode_list.append(stock_name)
daily_20170709_addname_dataframe=pd.DataFrame()
daily_20170709_addname_dataframe['cname'] = daily_20170709_tscode_list
for table_name in daily_20170709.columns.values.tolist():
    daily_20170709_addname_dataframe[table_name] = daily_20170709[table_name]
print("daily_20170709 返回数据 row 行数 = "+str(daily_20170709.shape[0]))
daily_20170709_addname_dataframe.to_excel(daily_201707_excel_writer,'9_7',index=False)
daily_201707_excel_writer.save()
daily_20170710 = pro.daily(start_date='',end_date='',trade_date='20170710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170710_tscode_list = list() 
for ts_code_sh in daily_20170710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170710_tscode_list.append(stock_name)
daily_20170710_addname_dataframe=pd.DataFrame()
daily_20170710_addname_dataframe['cname'] = daily_20170710_tscode_list
for table_name in daily_20170710.columns.values.tolist():
    daily_20170710_addname_dataframe[table_name] = daily_20170710[table_name]
print("daily_20170710 返回数据 row 行数 = "+str(daily_20170710.shape[0]))
daily_20170710_addname_dataframe.to_excel(daily_201707_excel_writer,'10_1',index=False)
daily_201707_excel_writer.save()
daily_20170711 = pro.daily(start_date='',end_date='',trade_date='20170711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170711_tscode_list = list() 
for ts_code_sh in daily_20170711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170711_tscode_list.append(stock_name)
daily_20170711_addname_dataframe=pd.DataFrame()
daily_20170711_addname_dataframe['cname'] = daily_20170711_tscode_list
for table_name in daily_20170711.columns.values.tolist():
    daily_20170711_addname_dataframe[table_name] = daily_20170711[table_name]
print("daily_20170711 返回数据 row 行数 = "+str(daily_20170711.shape[0]))
daily_20170711_addname_dataframe.to_excel(daily_201707_excel_writer,'11_2',index=False)
daily_201707_excel_writer.save()
daily_20170712 = pro.daily(start_date='',end_date='',trade_date='20170712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170712_tscode_list = list() 
for ts_code_sh in daily_20170712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170712_tscode_list.append(stock_name)
daily_20170712_addname_dataframe=pd.DataFrame()
daily_20170712_addname_dataframe['cname'] = daily_20170712_tscode_list
for table_name in daily_20170712.columns.values.tolist():
    daily_20170712_addname_dataframe[table_name] = daily_20170712[table_name]
print("daily_20170712 返回数据 row 行数 = "+str(daily_20170712.shape[0]))
daily_20170712_addname_dataframe.to_excel(daily_201707_excel_writer,'12_3',index=False)
daily_201707_excel_writer.save()
daily_20170713 = pro.daily(start_date='',end_date='',trade_date='20170713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170713_tscode_list = list() 
for ts_code_sh in daily_20170713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170713_tscode_list.append(stock_name)
daily_20170713_addname_dataframe=pd.DataFrame()
daily_20170713_addname_dataframe['cname'] = daily_20170713_tscode_list
for table_name in daily_20170713.columns.values.tolist():
    daily_20170713_addname_dataframe[table_name] = daily_20170713[table_name]
print("daily_20170713 返回数据 row 行数 = "+str(daily_20170713.shape[0]))
daily_20170713_addname_dataframe.to_excel(daily_201707_excel_writer,'13_4',index=False)
daily_201707_excel_writer.save()
daily_20170714 = pro.daily(start_date='',end_date='',trade_date='20170714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170714_tscode_list = list() 
for ts_code_sh in daily_20170714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170714_tscode_list.append(stock_name)
daily_20170714_addname_dataframe=pd.DataFrame()
daily_20170714_addname_dataframe['cname'] = daily_20170714_tscode_list
for table_name in daily_20170714.columns.values.tolist():
    daily_20170714_addname_dataframe[table_name] = daily_20170714[table_name]
print("daily_20170714 返回数据 row 行数 = "+str(daily_20170714.shape[0]))
daily_20170714_addname_dataframe.to_excel(daily_201707_excel_writer,'14_5',index=False)
daily_201707_excel_writer.save()
daily_20170715 = pro.daily(start_date='',end_date='',trade_date='20170715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170715_tscode_list = list() 
for ts_code_sh in daily_20170715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170715_tscode_list.append(stock_name)
daily_20170715_addname_dataframe=pd.DataFrame()
daily_20170715_addname_dataframe['cname'] = daily_20170715_tscode_list
for table_name in daily_20170715.columns.values.tolist():
    daily_20170715_addname_dataframe[table_name] = daily_20170715[table_name]
print("daily_20170715 返回数据 row 行数 = "+str(daily_20170715.shape[0]))
daily_20170715_addname_dataframe.to_excel(daily_201707_excel_writer,'15_6',index=False)
daily_201707_excel_writer.save()
daily_20170716 = pro.daily(start_date='',end_date='',trade_date='20170716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170716_tscode_list = list() 
for ts_code_sh in daily_20170716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170716_tscode_list.append(stock_name)
daily_20170716_addname_dataframe=pd.DataFrame()
daily_20170716_addname_dataframe['cname'] = daily_20170716_tscode_list
for table_name in daily_20170716.columns.values.tolist():
    daily_20170716_addname_dataframe[table_name] = daily_20170716[table_name]
print("daily_20170716 返回数据 row 行数 = "+str(daily_20170716.shape[0]))
daily_20170716_addname_dataframe.to_excel(daily_201707_excel_writer,'16_7',index=False)
daily_201707_excel_writer.save()
daily_20170717 = pro.daily(start_date='',end_date='',trade_date='20170717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170717_tscode_list = list() 
for ts_code_sh in daily_20170717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170717_tscode_list.append(stock_name)
daily_20170717_addname_dataframe=pd.DataFrame()
daily_20170717_addname_dataframe['cname'] = daily_20170717_tscode_list
for table_name in daily_20170717.columns.values.tolist():
    daily_20170717_addname_dataframe[table_name] = daily_20170717[table_name]
print("daily_20170717 返回数据 row 行数 = "+str(daily_20170717.shape[0]))
daily_20170717_addname_dataframe.to_excel(daily_201707_excel_writer,'17_1',index=False)
daily_201707_excel_writer.save()
daily_20170718 = pro.daily(start_date='',end_date='',trade_date='20170718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170718_tscode_list = list() 
for ts_code_sh in daily_20170718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170718_tscode_list.append(stock_name)
daily_20170718_addname_dataframe=pd.DataFrame()
daily_20170718_addname_dataframe['cname'] = daily_20170718_tscode_list
for table_name in daily_20170718.columns.values.tolist():
    daily_20170718_addname_dataframe[table_name] = daily_20170718[table_name]
print("daily_20170718 返回数据 row 行数 = "+str(daily_20170718.shape[0]))
daily_20170718_addname_dataframe.to_excel(daily_201707_excel_writer,'18_2',index=False)
daily_201707_excel_writer.save()
daily_20170719 = pro.daily(start_date='',end_date='',trade_date='20170719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170719_tscode_list = list() 
for ts_code_sh in daily_20170719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170719_tscode_list.append(stock_name)
daily_20170719_addname_dataframe=pd.DataFrame()
daily_20170719_addname_dataframe['cname'] = daily_20170719_tscode_list
for table_name in daily_20170719.columns.values.tolist():
    daily_20170719_addname_dataframe[table_name] = daily_20170719[table_name]
print("daily_20170719 返回数据 row 行数 = "+str(daily_20170719.shape[0]))
daily_20170719_addname_dataframe.to_excel(daily_201707_excel_writer,'19_3',index=False)
daily_201707_excel_writer.save()
daily_20170720 = pro.daily(start_date='',end_date='',trade_date='20170720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170720_tscode_list = list() 
for ts_code_sh in daily_20170720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170720_tscode_list.append(stock_name)
daily_20170720_addname_dataframe=pd.DataFrame()
daily_20170720_addname_dataframe['cname'] = daily_20170720_tscode_list
for table_name in daily_20170720.columns.values.tolist():
    daily_20170720_addname_dataframe[table_name] = daily_20170720[table_name]
print("daily_20170720 返回数据 row 行数 = "+str(daily_20170720.shape[0]))
daily_20170720_addname_dataframe.to_excel(daily_201707_excel_writer,'20_4',index=False)
daily_201707_excel_writer.save()
daily_20170721 = pro.daily(start_date='',end_date='',trade_date='20170721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170721_tscode_list = list() 
for ts_code_sh in daily_20170721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170721_tscode_list.append(stock_name)
daily_20170721_addname_dataframe=pd.DataFrame()
daily_20170721_addname_dataframe['cname'] = daily_20170721_tscode_list
for table_name in daily_20170721.columns.values.tolist():
    daily_20170721_addname_dataframe[table_name] = daily_20170721[table_name]
print("daily_20170721 返回数据 row 行数 = "+str(daily_20170721.shape[0]))
daily_20170721_addname_dataframe.to_excel(daily_201707_excel_writer,'21_5',index=False)
daily_201707_excel_writer.save()
daily_20170722 = pro.daily(start_date='',end_date='',trade_date='20170722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170722_tscode_list = list() 
for ts_code_sh in daily_20170722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170722_tscode_list.append(stock_name)
daily_20170722_addname_dataframe=pd.DataFrame()
daily_20170722_addname_dataframe['cname'] = daily_20170722_tscode_list
for table_name in daily_20170722.columns.values.tolist():
    daily_20170722_addname_dataframe[table_name] = daily_20170722[table_name]
print("daily_20170722 返回数据 row 行数 = "+str(daily_20170722.shape[0]))
daily_20170722_addname_dataframe.to_excel(daily_201707_excel_writer,'22_6',index=False)
daily_201707_excel_writer.save()
daily_20170723 = pro.daily(start_date='',end_date='',trade_date='20170723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170723_tscode_list = list() 
for ts_code_sh in daily_20170723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170723_tscode_list.append(stock_name)
daily_20170723_addname_dataframe=pd.DataFrame()
daily_20170723_addname_dataframe['cname'] = daily_20170723_tscode_list
for table_name in daily_20170723.columns.values.tolist():
    daily_20170723_addname_dataframe[table_name] = daily_20170723[table_name]
print("daily_20170723 返回数据 row 行数 = "+str(daily_20170723.shape[0]))
daily_20170723_addname_dataframe.to_excel(daily_201707_excel_writer,'23_7',index=False)
daily_201707_excel_writer.save()
daily_20170724 = pro.daily(start_date='',end_date='',trade_date='20170724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170724_tscode_list = list() 
for ts_code_sh in daily_20170724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170724_tscode_list.append(stock_name)
daily_20170724_addname_dataframe=pd.DataFrame()
daily_20170724_addname_dataframe['cname'] = daily_20170724_tscode_list
for table_name in daily_20170724.columns.values.tolist():
    daily_20170724_addname_dataframe[table_name] = daily_20170724[table_name]
print("daily_20170724 返回数据 row 行数 = "+str(daily_20170724.shape[0]))
daily_20170724_addname_dataframe.to_excel(daily_201707_excel_writer,'24_1',index=False)
daily_201707_excel_writer.save()
daily_20170725 = pro.daily(start_date='',end_date='',trade_date='20170725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170725_tscode_list = list() 
for ts_code_sh in daily_20170725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170725_tscode_list.append(stock_name)
daily_20170725_addname_dataframe=pd.DataFrame()
daily_20170725_addname_dataframe['cname'] = daily_20170725_tscode_list
for table_name in daily_20170725.columns.values.tolist():
    daily_20170725_addname_dataframe[table_name] = daily_20170725[table_name]
print("daily_20170725 返回数据 row 行数 = "+str(daily_20170725.shape[0]))
daily_20170725_addname_dataframe.to_excel(daily_201707_excel_writer,'25_2',index=False)
daily_201707_excel_writer.save()
daily_20170726 = pro.daily(start_date='',end_date='',trade_date='20170726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170726_tscode_list = list() 
for ts_code_sh in daily_20170726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170726_tscode_list.append(stock_name)
daily_20170726_addname_dataframe=pd.DataFrame()
daily_20170726_addname_dataframe['cname'] = daily_20170726_tscode_list
for table_name in daily_20170726.columns.values.tolist():
    daily_20170726_addname_dataframe[table_name] = daily_20170726[table_name]
print("daily_20170726 返回数据 row 行数 = "+str(daily_20170726.shape[0]))
daily_20170726_addname_dataframe.to_excel(daily_201707_excel_writer,'26_3',index=False)
daily_201707_excel_writer.save()
daily_20170727 = pro.daily(start_date='',end_date='',trade_date='20170727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170727_tscode_list = list() 
for ts_code_sh in daily_20170727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170727_tscode_list.append(stock_name)
daily_20170727_addname_dataframe=pd.DataFrame()
daily_20170727_addname_dataframe['cname'] = daily_20170727_tscode_list
for table_name in daily_20170727.columns.values.tolist():
    daily_20170727_addname_dataframe[table_name] = daily_20170727[table_name]
print("daily_20170727 返回数据 row 行数 = "+str(daily_20170727.shape[0]))
daily_20170727_addname_dataframe.to_excel(daily_201707_excel_writer,'27_4',index=False)
daily_201707_excel_writer.save()
daily_20170728 = pro.daily(start_date='',end_date='',trade_date='20170728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170728_tscode_list = list() 
for ts_code_sh in daily_20170728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170728_tscode_list.append(stock_name)
daily_20170728_addname_dataframe=pd.DataFrame()
daily_20170728_addname_dataframe['cname'] = daily_20170728_tscode_list
for table_name in daily_20170728.columns.values.tolist():
    daily_20170728_addname_dataframe[table_name] = daily_20170728[table_name]
print("daily_20170728 返回数据 row 行数 = "+str(daily_20170728.shape[0]))
daily_20170728_addname_dataframe.to_excel(daily_201707_excel_writer,'28_5',index=False)
daily_201707_excel_writer.save()
daily_20170729 = pro.daily(start_date='',end_date='',trade_date='20170729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170729_tscode_list = list() 
for ts_code_sh in daily_20170729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170729_tscode_list.append(stock_name)
daily_20170729_addname_dataframe=pd.DataFrame()
daily_20170729_addname_dataframe['cname'] = daily_20170729_tscode_list
for table_name in daily_20170729.columns.values.tolist():
    daily_20170729_addname_dataframe[table_name] = daily_20170729[table_name]
print("daily_20170729 返回数据 row 行数 = "+str(daily_20170729.shape[0]))
daily_20170729_addname_dataframe.to_excel(daily_201707_excel_writer,'29_6',index=False)
daily_201707_excel_writer.save()
daily_20170730 = pro.daily(start_date='',end_date='',trade_date='20170730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170730_tscode_list = list() 
for ts_code_sh in daily_20170730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170730_tscode_list.append(stock_name)
daily_20170730_addname_dataframe=pd.DataFrame()
daily_20170730_addname_dataframe['cname'] = daily_20170730_tscode_list
for table_name in daily_20170730.columns.values.tolist():
    daily_20170730_addname_dataframe[table_name] = daily_20170730[table_name]
print("daily_20170730 返回数据 row 行数 = "+str(daily_20170730.shape[0]))
daily_20170730_addname_dataframe.to_excel(daily_201707_excel_writer,'30_7',index=False)
daily_201707_excel_writer.save()
daily_20170731 = pro.daily(start_date='',end_date='',trade_date='20170731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170731_tscode_list = list() 
for ts_code_sh in daily_20170731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170731_tscode_list.append(stock_name)
daily_20170731_addname_dataframe=pd.DataFrame()
daily_20170731_addname_dataframe['cname'] = daily_20170731_tscode_list
for table_name in daily_20170731.columns.values.tolist():
    daily_20170731_addname_dataframe[table_name] = daily_20170731[table_name]
print("daily_20170731 返回数据 row 行数 = "+str(daily_20170731.shape[0]))
daily_20170731_addname_dataframe.to_excel(daily_201707_excel_writer,'31_1',index=False)
daily_201707_excel_writer.save()




createexcel('daily_201708.xlsx')
daily_201708_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201708.xlsx')
daily_201708_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201708.xlsx', engine='openpyxl')
daily_201708_excel_writer.book = daily_201708_book
daily_201708_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201708_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170801")       ###  更新 记录日期
daily_20170801 = pro.daily(start_date='',end_date='',trade_date='20170801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170801_tscode_list = list() 
for ts_code_sh in daily_20170801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170801_tscode_list.append(stock_name)
daily_20170801_addname_dataframe=pd.DataFrame()
daily_20170801_addname_dataframe['cname'] = daily_20170801_tscode_list
for table_name in daily_20170801.columns.values.tolist():
    daily_20170801_addname_dataframe[table_name] = daily_20170801[table_name]
print("daily_20170801 返回数据 row 行数 = "+str(daily_20170801.shape[0]))
daily_20170801_addname_dataframe.to_excel(daily_201708_excel_writer,'1_2',index=False)
daily_201708_excel_writer.save()
daily_20170802 = pro.daily(start_date='',end_date='',trade_date='20170802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170802_tscode_list = list() 
for ts_code_sh in daily_20170802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170802_tscode_list.append(stock_name)
daily_20170802_addname_dataframe=pd.DataFrame()
daily_20170802_addname_dataframe['cname'] = daily_20170802_tscode_list
for table_name in daily_20170802.columns.values.tolist():
    daily_20170802_addname_dataframe[table_name] = daily_20170802[table_name]
print("daily_20170802 返回数据 row 行数 = "+str(daily_20170802.shape[0]))
daily_20170802_addname_dataframe.to_excel(daily_201708_excel_writer,'2_3',index=False)
daily_201708_excel_writer.save()
daily_20170803 = pro.daily(start_date='',end_date='',trade_date='20170803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170803_tscode_list = list() 
for ts_code_sh in daily_20170803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170803_tscode_list.append(stock_name)
daily_20170803_addname_dataframe=pd.DataFrame()
daily_20170803_addname_dataframe['cname'] = daily_20170803_tscode_list
for table_name in daily_20170803.columns.values.tolist():
    daily_20170803_addname_dataframe[table_name] = daily_20170803[table_name]
print("daily_20170803 返回数据 row 行数 = "+str(daily_20170803.shape[0]))
daily_20170803_addname_dataframe.to_excel(daily_201708_excel_writer,'3_4',index=False)
daily_201708_excel_writer.save()
daily_20170804 = pro.daily(start_date='',end_date='',trade_date='20170804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170804_tscode_list = list() 
for ts_code_sh in daily_20170804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170804_tscode_list.append(stock_name)
daily_20170804_addname_dataframe=pd.DataFrame()
daily_20170804_addname_dataframe['cname'] = daily_20170804_tscode_list
for table_name in daily_20170804.columns.values.tolist():
    daily_20170804_addname_dataframe[table_name] = daily_20170804[table_name]
print("daily_20170804 返回数据 row 行数 = "+str(daily_20170804.shape[0]))
daily_20170804_addname_dataframe.to_excel(daily_201708_excel_writer,'4_5',index=False)
daily_201708_excel_writer.save()
daily_20170805 = pro.daily(start_date='',end_date='',trade_date='20170805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170805_tscode_list = list() 
for ts_code_sh in daily_20170805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170805_tscode_list.append(stock_name)
daily_20170805_addname_dataframe=pd.DataFrame()
daily_20170805_addname_dataframe['cname'] = daily_20170805_tscode_list
for table_name in daily_20170805.columns.values.tolist():
    daily_20170805_addname_dataframe[table_name] = daily_20170805[table_name]
print("daily_20170805 返回数据 row 行数 = "+str(daily_20170805.shape[0]))
daily_20170805_addname_dataframe.to_excel(daily_201708_excel_writer,'5_6',index=False)
daily_201708_excel_writer.save()
daily_20170806 = pro.daily(start_date='',end_date='',trade_date='20170806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170806_tscode_list = list() 
for ts_code_sh in daily_20170806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170806_tscode_list.append(stock_name)
daily_20170806_addname_dataframe=pd.DataFrame()
daily_20170806_addname_dataframe['cname'] = daily_20170806_tscode_list
for table_name in daily_20170806.columns.values.tolist():
    daily_20170806_addname_dataframe[table_name] = daily_20170806[table_name]
print("daily_20170806 返回数据 row 行数 = "+str(daily_20170806.shape[0]))
daily_20170806_addname_dataframe.to_excel(daily_201708_excel_writer,'6_7',index=False)
daily_201708_excel_writer.save()
daily_20170807 = pro.daily(start_date='',end_date='',trade_date='20170807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170807_tscode_list = list() 
for ts_code_sh in daily_20170807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170807_tscode_list.append(stock_name)
daily_20170807_addname_dataframe=pd.DataFrame()
daily_20170807_addname_dataframe['cname'] = daily_20170807_tscode_list
for table_name in daily_20170807.columns.values.tolist():
    daily_20170807_addname_dataframe[table_name] = daily_20170807[table_name]
print("daily_20170807 返回数据 row 行数 = "+str(daily_20170807.shape[0]))
daily_20170807_addname_dataframe.to_excel(daily_201708_excel_writer,'7_1',index=False)
daily_201708_excel_writer.save()
daily_20170808 = pro.daily(start_date='',end_date='',trade_date='20170808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170808_tscode_list = list() 
for ts_code_sh in daily_20170808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170808_tscode_list.append(stock_name)
daily_20170808_addname_dataframe=pd.DataFrame()
daily_20170808_addname_dataframe['cname'] = daily_20170808_tscode_list
for table_name in daily_20170808.columns.values.tolist():
    daily_20170808_addname_dataframe[table_name] = daily_20170808[table_name]
print("daily_20170808 返回数据 row 行数 = "+str(daily_20170808.shape[0]))
daily_20170808_addname_dataframe.to_excel(daily_201708_excel_writer,'8_2',index=False)
daily_201708_excel_writer.save()
daily_20170809 = pro.daily(start_date='',end_date='',trade_date='20170809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170809_tscode_list = list() 
for ts_code_sh in daily_20170809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170809_tscode_list.append(stock_name)
daily_20170809_addname_dataframe=pd.DataFrame()
daily_20170809_addname_dataframe['cname'] = daily_20170809_tscode_list
for table_name in daily_20170809.columns.values.tolist():
    daily_20170809_addname_dataframe[table_name] = daily_20170809[table_name]
print("daily_20170809 返回数据 row 行数 = "+str(daily_20170809.shape[0]))
daily_20170809_addname_dataframe.to_excel(daily_201708_excel_writer,'9_3',index=False)
daily_201708_excel_writer.save()
daily_20170810 = pro.daily(start_date='',end_date='',trade_date='20170810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170810_tscode_list = list() 
for ts_code_sh in daily_20170810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170810_tscode_list.append(stock_name)
daily_20170810_addname_dataframe=pd.DataFrame()
daily_20170810_addname_dataframe['cname'] = daily_20170810_tscode_list
for table_name in daily_20170810.columns.values.tolist():
    daily_20170810_addname_dataframe[table_name] = daily_20170810[table_name]
print("daily_20170810 返回数据 row 行数 = "+str(daily_20170810.shape[0]))
daily_20170810_addname_dataframe.to_excel(daily_201708_excel_writer,'10_4',index=False)
daily_201708_excel_writer.save()
daily_20170811 = pro.daily(start_date='',end_date='',trade_date='20170811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170811_tscode_list = list() 
for ts_code_sh in daily_20170811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170811_tscode_list.append(stock_name)
daily_20170811_addname_dataframe=pd.DataFrame()
daily_20170811_addname_dataframe['cname'] = daily_20170811_tscode_list
for table_name in daily_20170811.columns.values.tolist():
    daily_20170811_addname_dataframe[table_name] = daily_20170811[table_name]
print("daily_20170811 返回数据 row 行数 = "+str(daily_20170811.shape[0]))
daily_20170811_addname_dataframe.to_excel(daily_201708_excel_writer,'11_5',index=False)
daily_201708_excel_writer.save()
daily_20170812 = pro.daily(start_date='',end_date='',trade_date='20170812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170812_tscode_list = list() 
for ts_code_sh in daily_20170812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170812_tscode_list.append(stock_name)
daily_20170812_addname_dataframe=pd.DataFrame()
daily_20170812_addname_dataframe['cname'] = daily_20170812_tscode_list
for table_name in daily_20170812.columns.values.tolist():
    daily_20170812_addname_dataframe[table_name] = daily_20170812[table_name]
print("daily_20170812 返回数据 row 行数 = "+str(daily_20170812.shape[0]))
daily_20170812_addname_dataframe.to_excel(daily_201708_excel_writer,'12_6',index=False)
daily_201708_excel_writer.save()
daily_20170813 = pro.daily(start_date='',end_date='',trade_date='20170813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170813_tscode_list = list() 
for ts_code_sh in daily_20170813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170813_tscode_list.append(stock_name)
daily_20170813_addname_dataframe=pd.DataFrame()
daily_20170813_addname_dataframe['cname'] = daily_20170813_tscode_list
for table_name in daily_20170813.columns.values.tolist():
    daily_20170813_addname_dataframe[table_name] = daily_20170813[table_name]
print("daily_20170813 返回数据 row 行数 = "+str(daily_20170813.shape[0]))
daily_20170813_addname_dataframe.to_excel(daily_201708_excel_writer,'13_7',index=False)
daily_201708_excel_writer.save()
daily_20170814 = pro.daily(start_date='',end_date='',trade_date='20170814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170814_tscode_list = list() 
for ts_code_sh in daily_20170814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170814_tscode_list.append(stock_name)
daily_20170814_addname_dataframe=pd.DataFrame()
daily_20170814_addname_dataframe['cname'] = daily_20170814_tscode_list
for table_name in daily_20170814.columns.values.tolist():
    daily_20170814_addname_dataframe[table_name] = daily_20170814[table_name]
print("daily_20170814 返回数据 row 行数 = "+str(daily_20170814.shape[0]))
daily_20170814_addname_dataframe.to_excel(daily_201708_excel_writer,'14_1',index=False)
daily_201708_excel_writer.save()
daily_20170815 = pro.daily(start_date='',end_date='',trade_date='20170815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170815_tscode_list = list() 
for ts_code_sh in daily_20170815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170815_tscode_list.append(stock_name)
daily_20170815_addname_dataframe=pd.DataFrame()
daily_20170815_addname_dataframe['cname'] = daily_20170815_tscode_list
for table_name in daily_20170815.columns.values.tolist():
    daily_20170815_addname_dataframe[table_name] = daily_20170815[table_name]
print("daily_20170815 返回数据 row 行数 = "+str(daily_20170815.shape[0]))
daily_20170815_addname_dataframe.to_excel(daily_201708_excel_writer,'15_2',index=False)
daily_201708_excel_writer.save()
daily_20170816 = pro.daily(start_date='',end_date='',trade_date='20170816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170816_tscode_list = list() 
for ts_code_sh in daily_20170816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170816_tscode_list.append(stock_name)
daily_20170816_addname_dataframe=pd.DataFrame()
daily_20170816_addname_dataframe['cname'] = daily_20170816_tscode_list
for table_name in daily_20170816.columns.values.tolist():
    daily_20170816_addname_dataframe[table_name] = daily_20170816[table_name]
print("daily_20170816 返回数据 row 行数 = "+str(daily_20170816.shape[0]))
daily_20170816_addname_dataframe.to_excel(daily_201708_excel_writer,'16_3',index=False)
daily_201708_excel_writer.save()
daily_20170817 = pro.daily(start_date='',end_date='',trade_date='20170817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170817_tscode_list = list() 
for ts_code_sh in daily_20170817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170817_tscode_list.append(stock_name)
daily_20170817_addname_dataframe=pd.DataFrame()
daily_20170817_addname_dataframe['cname'] = daily_20170817_tscode_list
for table_name in daily_20170817.columns.values.tolist():
    daily_20170817_addname_dataframe[table_name] = daily_20170817[table_name]
print("daily_20170817 返回数据 row 行数 = "+str(daily_20170817.shape[0]))
daily_20170817_addname_dataframe.to_excel(daily_201708_excel_writer,'17_4',index=False)
daily_201708_excel_writer.save()
daily_20170818 = pro.daily(start_date='',end_date='',trade_date='20170818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170818_tscode_list = list() 
for ts_code_sh in daily_20170818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170818_tscode_list.append(stock_name)
daily_20170818_addname_dataframe=pd.DataFrame()
daily_20170818_addname_dataframe['cname'] = daily_20170818_tscode_list
for table_name in daily_20170818.columns.values.tolist():
    daily_20170818_addname_dataframe[table_name] = daily_20170818[table_name]
print("daily_20170818 返回数据 row 行数 = "+str(daily_20170818.shape[0]))
daily_20170818_addname_dataframe.to_excel(daily_201708_excel_writer,'18_5',index=False)
daily_201708_excel_writer.save()
daily_20170819 = pro.daily(start_date='',end_date='',trade_date='20170819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170819_tscode_list = list() 
for ts_code_sh in daily_20170819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170819_tscode_list.append(stock_name)
daily_20170819_addname_dataframe=pd.DataFrame()
daily_20170819_addname_dataframe['cname'] = daily_20170819_tscode_list
for table_name in daily_20170819.columns.values.tolist():
    daily_20170819_addname_dataframe[table_name] = daily_20170819[table_name]
print("daily_20170819 返回数据 row 行数 = "+str(daily_20170819.shape[0]))
daily_20170819_addname_dataframe.to_excel(daily_201708_excel_writer,'19_6',index=False)
daily_201708_excel_writer.save()
daily_20170820 = pro.daily(start_date='',end_date='',trade_date='20170820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170820_tscode_list = list() 
for ts_code_sh in daily_20170820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170820_tscode_list.append(stock_name)
daily_20170820_addname_dataframe=pd.DataFrame()
daily_20170820_addname_dataframe['cname'] = daily_20170820_tscode_list
for table_name in daily_20170820.columns.values.tolist():
    daily_20170820_addname_dataframe[table_name] = daily_20170820[table_name]
print("daily_20170820 返回数据 row 行数 = "+str(daily_20170820.shape[0]))
daily_20170820_addname_dataframe.to_excel(daily_201708_excel_writer,'20_7',index=False)
daily_201708_excel_writer.save()
daily_20170821 = pro.daily(start_date='',end_date='',trade_date='20170821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170821_tscode_list = list() 
for ts_code_sh in daily_20170821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170821_tscode_list.append(stock_name)
daily_20170821_addname_dataframe=pd.DataFrame()
daily_20170821_addname_dataframe['cname'] = daily_20170821_tscode_list
for table_name in daily_20170821.columns.values.tolist():
    daily_20170821_addname_dataframe[table_name] = daily_20170821[table_name]
print("daily_20170821 返回数据 row 行数 = "+str(daily_20170821.shape[0]))
daily_20170821_addname_dataframe.to_excel(daily_201708_excel_writer,'21_1',index=False)
daily_201708_excel_writer.save()
daily_20170822 = pro.daily(start_date='',end_date='',trade_date='20170822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170822_tscode_list = list() 
for ts_code_sh in daily_20170822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170822_tscode_list.append(stock_name)
daily_20170822_addname_dataframe=pd.DataFrame()
daily_20170822_addname_dataframe['cname'] = daily_20170822_tscode_list
for table_name in daily_20170822.columns.values.tolist():
    daily_20170822_addname_dataframe[table_name] = daily_20170822[table_name]
print("daily_20170822 返回数据 row 行数 = "+str(daily_20170822.shape[0]))
daily_20170822_addname_dataframe.to_excel(daily_201708_excel_writer,'22_2',index=False)
daily_201708_excel_writer.save()
daily_20170823 = pro.daily(start_date='',end_date='',trade_date='20170823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170823_tscode_list = list() 
for ts_code_sh in daily_20170823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170823_tscode_list.append(stock_name)
daily_20170823_addname_dataframe=pd.DataFrame()
daily_20170823_addname_dataframe['cname'] = daily_20170823_tscode_list
for table_name in daily_20170823.columns.values.tolist():
    daily_20170823_addname_dataframe[table_name] = daily_20170823[table_name]
print("daily_20170823 返回数据 row 行数 = "+str(daily_20170823.shape[0]))
daily_20170823_addname_dataframe.to_excel(daily_201708_excel_writer,'23_3',index=False)
daily_201708_excel_writer.save()
daily_20170824 = pro.daily(start_date='',end_date='',trade_date='20170824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170824_tscode_list = list() 
for ts_code_sh in daily_20170824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170824_tscode_list.append(stock_name)
daily_20170824_addname_dataframe=pd.DataFrame()
daily_20170824_addname_dataframe['cname'] = daily_20170824_tscode_list
for table_name in daily_20170824.columns.values.tolist():
    daily_20170824_addname_dataframe[table_name] = daily_20170824[table_name]
print("daily_20170824 返回数据 row 行数 = "+str(daily_20170824.shape[0]))
daily_20170824_addname_dataframe.to_excel(daily_201708_excel_writer,'24_4',index=False)
daily_201708_excel_writer.save()
daily_20170825 = pro.daily(start_date='',end_date='',trade_date='20170825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170825_tscode_list = list() 
for ts_code_sh in daily_20170825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170825_tscode_list.append(stock_name)
daily_20170825_addname_dataframe=pd.DataFrame()
daily_20170825_addname_dataframe['cname'] = daily_20170825_tscode_list
for table_name in daily_20170825.columns.values.tolist():
    daily_20170825_addname_dataframe[table_name] = daily_20170825[table_name]
print("daily_20170825 返回数据 row 行数 = "+str(daily_20170825.shape[0]))
daily_20170825_addname_dataframe.to_excel(daily_201708_excel_writer,'25_5',index=False)
daily_201708_excel_writer.save()
daily_20170826 = pro.daily(start_date='',end_date='',trade_date='20170826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170826_tscode_list = list() 
for ts_code_sh in daily_20170826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170826_tscode_list.append(stock_name)
daily_20170826_addname_dataframe=pd.DataFrame()
daily_20170826_addname_dataframe['cname'] = daily_20170826_tscode_list
for table_name in daily_20170826.columns.values.tolist():
    daily_20170826_addname_dataframe[table_name] = daily_20170826[table_name]
print("daily_20170826 返回数据 row 行数 = "+str(daily_20170826.shape[0]))
daily_20170826_addname_dataframe.to_excel(daily_201708_excel_writer,'26_6',index=False)
daily_201708_excel_writer.save()
daily_20170827 = pro.daily(start_date='',end_date='',trade_date='20170827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170827_tscode_list = list() 
for ts_code_sh in daily_20170827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170827_tscode_list.append(stock_name)
daily_20170827_addname_dataframe=pd.DataFrame()
daily_20170827_addname_dataframe['cname'] = daily_20170827_tscode_list
for table_name in daily_20170827.columns.values.tolist():
    daily_20170827_addname_dataframe[table_name] = daily_20170827[table_name]
print("daily_20170827 返回数据 row 行数 = "+str(daily_20170827.shape[0]))
daily_20170827_addname_dataframe.to_excel(daily_201708_excel_writer,'27_7',index=False)
daily_201708_excel_writer.save()
daily_20170828 = pro.daily(start_date='',end_date='',trade_date='20170828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170828_tscode_list = list() 
for ts_code_sh in daily_20170828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170828_tscode_list.append(stock_name)
daily_20170828_addname_dataframe=pd.DataFrame()
daily_20170828_addname_dataframe['cname'] = daily_20170828_tscode_list
for table_name in daily_20170828.columns.values.tolist():
    daily_20170828_addname_dataframe[table_name] = daily_20170828[table_name]
print("daily_20170828 返回数据 row 行数 = "+str(daily_20170828.shape[0]))
daily_20170828_addname_dataframe.to_excel(daily_201708_excel_writer,'28_1',index=False)
daily_201708_excel_writer.save()
daily_20170829 = pro.daily(start_date='',end_date='',trade_date='20170829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170829_tscode_list = list() 
for ts_code_sh in daily_20170829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170829_tscode_list.append(stock_name)
daily_20170829_addname_dataframe=pd.DataFrame()
daily_20170829_addname_dataframe['cname'] = daily_20170829_tscode_list
for table_name in daily_20170829.columns.values.tolist():
    daily_20170829_addname_dataframe[table_name] = daily_20170829[table_name]
print("daily_20170829 返回数据 row 行数 = "+str(daily_20170829.shape[0]))
daily_20170829_addname_dataframe.to_excel(daily_201708_excel_writer,'29_2',index=False)
daily_201708_excel_writer.save()
daily_20170830 = pro.daily(start_date='',end_date='',trade_date='20170830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170830_tscode_list = list() 
for ts_code_sh in daily_20170830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170830_tscode_list.append(stock_name)
daily_20170830_addname_dataframe=pd.DataFrame()
daily_20170830_addname_dataframe['cname'] = daily_20170830_tscode_list
for table_name in daily_20170830.columns.values.tolist():
    daily_20170830_addname_dataframe[table_name] = daily_20170830[table_name]
print("daily_20170830 返回数据 row 行数 = "+str(daily_20170830.shape[0]))
daily_20170830_addname_dataframe.to_excel(daily_201708_excel_writer,'30_3',index=False)
daily_201708_excel_writer.save()
daily_20170831 = pro.daily(start_date='',end_date='',trade_date='20170831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170831_tscode_list = list() 
for ts_code_sh in daily_20170831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170831_tscode_list.append(stock_name)
daily_20170831_addname_dataframe=pd.DataFrame()
daily_20170831_addname_dataframe['cname'] = daily_20170831_tscode_list
for table_name in daily_20170831.columns.values.tolist():
    daily_20170831_addname_dataframe[table_name] = daily_20170831[table_name]
print("daily_20170831 返回数据 row 行数 = "+str(daily_20170831.shape[0]))
daily_20170831_addname_dataframe.to_excel(daily_201708_excel_writer,'31_4',index=False)
daily_201708_excel_writer.save()




createexcel('daily_201709.xlsx')
daily_201709_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201709.xlsx')
daily_201709_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201709.xlsx', engine='openpyxl')
daily_201709_excel_writer.book = daily_201709_book
daily_201709_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201709_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170901")       ###  更新 记录日期
daily_20170901 = pro.daily(start_date='',end_date='',trade_date='20170901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170901_tscode_list = list() 
for ts_code_sh in daily_20170901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170901_tscode_list.append(stock_name)
daily_20170901_addname_dataframe=pd.DataFrame()
daily_20170901_addname_dataframe['cname'] = daily_20170901_tscode_list
for table_name in daily_20170901.columns.values.tolist():
    daily_20170901_addname_dataframe[table_name] = daily_20170901[table_name]
print("daily_20170901 返回数据 row 行数 = "+str(daily_20170901.shape[0]))
daily_20170901_addname_dataframe.to_excel(daily_201709_excel_writer,'1_5',index=False)
daily_201709_excel_writer.save()
daily_20170902 = pro.daily(start_date='',end_date='',trade_date='20170902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170902_tscode_list = list() 
for ts_code_sh in daily_20170902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170902_tscode_list.append(stock_name)
daily_20170902_addname_dataframe=pd.DataFrame()
daily_20170902_addname_dataframe['cname'] = daily_20170902_tscode_list
for table_name in daily_20170902.columns.values.tolist():
    daily_20170902_addname_dataframe[table_name] = daily_20170902[table_name]
print("daily_20170902 返回数据 row 行数 = "+str(daily_20170902.shape[0]))
daily_20170902_addname_dataframe.to_excel(daily_201709_excel_writer,'2_6',index=False)
daily_201709_excel_writer.save()
daily_20170903 = pro.daily(start_date='',end_date='',trade_date='20170903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170903_tscode_list = list() 
for ts_code_sh in daily_20170903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170903_tscode_list.append(stock_name)
daily_20170903_addname_dataframe=pd.DataFrame()
daily_20170903_addname_dataframe['cname'] = daily_20170903_tscode_list
for table_name in daily_20170903.columns.values.tolist():
    daily_20170903_addname_dataframe[table_name] = daily_20170903[table_name]
print("daily_20170903 返回数据 row 行数 = "+str(daily_20170903.shape[0]))
daily_20170903_addname_dataframe.to_excel(daily_201709_excel_writer,'3_7',index=False)
daily_201709_excel_writer.save()
daily_20170904 = pro.daily(start_date='',end_date='',trade_date='20170904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170904_tscode_list = list() 
for ts_code_sh in daily_20170904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170904_tscode_list.append(stock_name)
daily_20170904_addname_dataframe=pd.DataFrame()
daily_20170904_addname_dataframe['cname'] = daily_20170904_tscode_list
for table_name in daily_20170904.columns.values.tolist():
    daily_20170904_addname_dataframe[table_name] = daily_20170904[table_name]
print("daily_20170904 返回数据 row 行数 = "+str(daily_20170904.shape[0]))
daily_20170904_addname_dataframe.to_excel(daily_201709_excel_writer,'4_1',index=False)
daily_201709_excel_writer.save()
daily_20170905 = pro.daily(start_date='',end_date='',trade_date='20170905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170905_tscode_list = list() 
for ts_code_sh in daily_20170905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170905_tscode_list.append(stock_name)
daily_20170905_addname_dataframe=pd.DataFrame()
daily_20170905_addname_dataframe['cname'] = daily_20170905_tscode_list
for table_name in daily_20170905.columns.values.tolist():
    daily_20170905_addname_dataframe[table_name] = daily_20170905[table_name]
print("daily_20170905 返回数据 row 行数 = "+str(daily_20170905.shape[0]))
daily_20170905_addname_dataframe.to_excel(daily_201709_excel_writer,'5_2',index=False)
daily_201709_excel_writer.save()
daily_20170906 = pro.daily(start_date='',end_date='',trade_date='20170906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170906_tscode_list = list() 
for ts_code_sh in daily_20170906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170906_tscode_list.append(stock_name)
daily_20170906_addname_dataframe=pd.DataFrame()
daily_20170906_addname_dataframe['cname'] = daily_20170906_tscode_list
for table_name in daily_20170906.columns.values.tolist():
    daily_20170906_addname_dataframe[table_name] = daily_20170906[table_name]
print("daily_20170906 返回数据 row 行数 = "+str(daily_20170906.shape[0]))
daily_20170906_addname_dataframe.to_excel(daily_201709_excel_writer,'6_3',index=False)
daily_201709_excel_writer.save()
daily_20170907 = pro.daily(start_date='',end_date='',trade_date='20170907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170907_tscode_list = list() 
for ts_code_sh in daily_20170907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170907_tscode_list.append(stock_name)
daily_20170907_addname_dataframe=pd.DataFrame()
daily_20170907_addname_dataframe['cname'] = daily_20170907_tscode_list
for table_name in daily_20170907.columns.values.tolist():
    daily_20170907_addname_dataframe[table_name] = daily_20170907[table_name]
print("daily_20170907 返回数据 row 行数 = "+str(daily_20170907.shape[0]))
daily_20170907_addname_dataframe.to_excel(daily_201709_excel_writer,'7_4',index=False)
daily_201709_excel_writer.save()
daily_20170908 = pro.daily(start_date='',end_date='',trade_date='20170908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170908_tscode_list = list() 
for ts_code_sh in daily_20170908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170908_tscode_list.append(stock_name)
daily_20170908_addname_dataframe=pd.DataFrame()
daily_20170908_addname_dataframe['cname'] = daily_20170908_tscode_list
for table_name in daily_20170908.columns.values.tolist():
    daily_20170908_addname_dataframe[table_name] = daily_20170908[table_name]
print("daily_20170908 返回数据 row 行数 = "+str(daily_20170908.shape[0]))
daily_20170908_addname_dataframe.to_excel(daily_201709_excel_writer,'8_5',index=False)
daily_201709_excel_writer.save()
daily_20170909 = pro.daily(start_date='',end_date='',trade_date='20170909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170909_tscode_list = list() 
for ts_code_sh in daily_20170909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170909_tscode_list.append(stock_name)
daily_20170909_addname_dataframe=pd.DataFrame()
daily_20170909_addname_dataframe['cname'] = daily_20170909_tscode_list
for table_name in daily_20170909.columns.values.tolist():
    daily_20170909_addname_dataframe[table_name] = daily_20170909[table_name]
print("daily_20170909 返回数据 row 行数 = "+str(daily_20170909.shape[0]))
daily_20170909_addname_dataframe.to_excel(daily_201709_excel_writer,'9_6',index=False)
daily_201709_excel_writer.save()
daily_20170910 = pro.daily(start_date='',end_date='',trade_date='20170910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170910_tscode_list = list() 
for ts_code_sh in daily_20170910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170910_tscode_list.append(stock_name)
daily_20170910_addname_dataframe=pd.DataFrame()
daily_20170910_addname_dataframe['cname'] = daily_20170910_tscode_list
for table_name in daily_20170910.columns.values.tolist():
    daily_20170910_addname_dataframe[table_name] = daily_20170910[table_name]
print("daily_20170910 返回数据 row 行数 = "+str(daily_20170910.shape[0]))
daily_20170910_addname_dataframe.to_excel(daily_201709_excel_writer,'10_7',index=False)
daily_201709_excel_writer.save()
daily_20170911 = pro.daily(start_date='',end_date='',trade_date='20170911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170911_tscode_list = list() 
for ts_code_sh in daily_20170911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170911_tscode_list.append(stock_name)
daily_20170911_addname_dataframe=pd.DataFrame()
daily_20170911_addname_dataframe['cname'] = daily_20170911_tscode_list
for table_name in daily_20170911.columns.values.tolist():
    daily_20170911_addname_dataframe[table_name] = daily_20170911[table_name]
print("daily_20170911 返回数据 row 行数 = "+str(daily_20170911.shape[0]))
daily_20170911_addname_dataframe.to_excel(daily_201709_excel_writer,'11_1',index=False)
daily_201709_excel_writer.save()
daily_20170912 = pro.daily(start_date='',end_date='',trade_date='20170912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170912_tscode_list = list() 
for ts_code_sh in daily_20170912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170912_tscode_list.append(stock_name)
daily_20170912_addname_dataframe=pd.DataFrame()
daily_20170912_addname_dataframe['cname'] = daily_20170912_tscode_list
for table_name in daily_20170912.columns.values.tolist():
    daily_20170912_addname_dataframe[table_name] = daily_20170912[table_name]
print("daily_20170912 返回数据 row 行数 = "+str(daily_20170912.shape[0]))
daily_20170912_addname_dataframe.to_excel(daily_201709_excel_writer,'12_2',index=False)
daily_201709_excel_writer.save()
daily_20170913 = pro.daily(start_date='',end_date='',trade_date='20170913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170913_tscode_list = list() 
for ts_code_sh in daily_20170913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170913_tscode_list.append(stock_name)
daily_20170913_addname_dataframe=pd.DataFrame()
daily_20170913_addname_dataframe['cname'] = daily_20170913_tscode_list
for table_name in daily_20170913.columns.values.tolist():
    daily_20170913_addname_dataframe[table_name] = daily_20170913[table_name]
print("daily_20170913 返回数据 row 行数 = "+str(daily_20170913.shape[0]))
daily_20170913_addname_dataframe.to_excel(daily_201709_excel_writer,'13_3',index=False)
daily_201709_excel_writer.save()
daily_20170914 = pro.daily(start_date='',end_date='',trade_date='20170914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170914_tscode_list = list() 
for ts_code_sh in daily_20170914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170914_tscode_list.append(stock_name)
daily_20170914_addname_dataframe=pd.DataFrame()
daily_20170914_addname_dataframe['cname'] = daily_20170914_tscode_list
for table_name in daily_20170914.columns.values.tolist():
    daily_20170914_addname_dataframe[table_name] = daily_20170914[table_name]
print("daily_20170914 返回数据 row 行数 = "+str(daily_20170914.shape[0]))
daily_20170914_addname_dataframe.to_excel(daily_201709_excel_writer,'14_4',index=False)
daily_201709_excel_writer.save()
daily_20170915 = pro.daily(start_date='',end_date='',trade_date='20170915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170915_tscode_list = list() 
for ts_code_sh in daily_20170915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170915_tscode_list.append(stock_name)
daily_20170915_addname_dataframe=pd.DataFrame()
daily_20170915_addname_dataframe['cname'] = daily_20170915_tscode_list
for table_name in daily_20170915.columns.values.tolist():
    daily_20170915_addname_dataframe[table_name] = daily_20170915[table_name]
print("daily_20170915 返回数据 row 行数 = "+str(daily_20170915.shape[0]))
daily_20170915_addname_dataframe.to_excel(daily_201709_excel_writer,'15_5',index=False)
daily_201709_excel_writer.save()
daily_20170916 = pro.daily(start_date='',end_date='',trade_date='20170916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170916_tscode_list = list() 
for ts_code_sh in daily_20170916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170916_tscode_list.append(stock_name)
daily_20170916_addname_dataframe=pd.DataFrame()
daily_20170916_addname_dataframe['cname'] = daily_20170916_tscode_list
for table_name in daily_20170916.columns.values.tolist():
    daily_20170916_addname_dataframe[table_name] = daily_20170916[table_name]
print("daily_20170916 返回数据 row 行数 = "+str(daily_20170916.shape[0]))
daily_20170916_addname_dataframe.to_excel(daily_201709_excel_writer,'16_6',index=False)
daily_201709_excel_writer.save()
daily_20170917 = pro.daily(start_date='',end_date='',trade_date='20170917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170917_tscode_list = list() 
for ts_code_sh in daily_20170917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170917_tscode_list.append(stock_name)
daily_20170917_addname_dataframe=pd.DataFrame()
daily_20170917_addname_dataframe['cname'] = daily_20170917_tscode_list
for table_name in daily_20170917.columns.values.tolist():
    daily_20170917_addname_dataframe[table_name] = daily_20170917[table_name]
print("daily_20170917 返回数据 row 行数 = "+str(daily_20170917.shape[0]))
daily_20170917_addname_dataframe.to_excel(daily_201709_excel_writer,'17_7',index=False)
daily_201709_excel_writer.save()
daily_20170918 = pro.daily(start_date='',end_date='',trade_date='20170918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170918_tscode_list = list() 
for ts_code_sh in daily_20170918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170918_tscode_list.append(stock_name)
daily_20170918_addname_dataframe=pd.DataFrame()
daily_20170918_addname_dataframe['cname'] = daily_20170918_tscode_list
for table_name in daily_20170918.columns.values.tolist():
    daily_20170918_addname_dataframe[table_name] = daily_20170918[table_name]
print("daily_20170918 返回数据 row 行数 = "+str(daily_20170918.shape[0]))
daily_20170918_addname_dataframe.to_excel(daily_201709_excel_writer,'18_1',index=False)
daily_201709_excel_writer.save()
daily_20170919 = pro.daily(start_date='',end_date='',trade_date='20170919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170919_tscode_list = list() 
for ts_code_sh in daily_20170919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170919_tscode_list.append(stock_name)
daily_20170919_addname_dataframe=pd.DataFrame()
daily_20170919_addname_dataframe['cname'] = daily_20170919_tscode_list
for table_name in daily_20170919.columns.values.tolist():
    daily_20170919_addname_dataframe[table_name] = daily_20170919[table_name]
print("daily_20170919 返回数据 row 行数 = "+str(daily_20170919.shape[0]))
daily_20170919_addname_dataframe.to_excel(daily_201709_excel_writer,'19_2',index=False)
daily_201709_excel_writer.save()
daily_20170920 = pro.daily(start_date='',end_date='',trade_date='20170920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170920_tscode_list = list() 
for ts_code_sh in daily_20170920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170920_tscode_list.append(stock_name)
daily_20170920_addname_dataframe=pd.DataFrame()
daily_20170920_addname_dataframe['cname'] = daily_20170920_tscode_list
for table_name in daily_20170920.columns.values.tolist():
    daily_20170920_addname_dataframe[table_name] = daily_20170920[table_name]
print("daily_20170920 返回数据 row 行数 = "+str(daily_20170920.shape[0]))
daily_20170920_addname_dataframe.to_excel(daily_201709_excel_writer,'20_3',index=False)
daily_201709_excel_writer.save()
daily_20170921 = pro.daily(start_date='',end_date='',trade_date='20170921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170921_tscode_list = list() 
for ts_code_sh in daily_20170921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170921_tscode_list.append(stock_name)
daily_20170921_addname_dataframe=pd.DataFrame()
daily_20170921_addname_dataframe['cname'] = daily_20170921_tscode_list
for table_name in daily_20170921.columns.values.tolist():
    daily_20170921_addname_dataframe[table_name] = daily_20170921[table_name]
print("daily_20170921 返回数据 row 行数 = "+str(daily_20170921.shape[0]))
daily_20170921_addname_dataframe.to_excel(daily_201709_excel_writer,'21_4',index=False)
daily_201709_excel_writer.save()
daily_20170922 = pro.daily(start_date='',end_date='',trade_date='20170922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170922_tscode_list = list() 
for ts_code_sh in daily_20170922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170922_tscode_list.append(stock_name)
daily_20170922_addname_dataframe=pd.DataFrame()
daily_20170922_addname_dataframe['cname'] = daily_20170922_tscode_list
for table_name in daily_20170922.columns.values.tolist():
    daily_20170922_addname_dataframe[table_name] = daily_20170922[table_name]
print("daily_20170922 返回数据 row 行数 = "+str(daily_20170922.shape[0]))
daily_20170922_addname_dataframe.to_excel(daily_201709_excel_writer,'22_5',index=False)
daily_201709_excel_writer.save()
daily_20170923 = pro.daily(start_date='',end_date='',trade_date='20170923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170923_tscode_list = list() 
for ts_code_sh in daily_20170923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170923_tscode_list.append(stock_name)
daily_20170923_addname_dataframe=pd.DataFrame()
daily_20170923_addname_dataframe['cname'] = daily_20170923_tscode_list
for table_name in daily_20170923.columns.values.tolist():
    daily_20170923_addname_dataframe[table_name] = daily_20170923[table_name]
print("daily_20170923 返回数据 row 行数 = "+str(daily_20170923.shape[0]))
daily_20170923_addname_dataframe.to_excel(daily_201709_excel_writer,'23_6',index=False)
daily_201709_excel_writer.save()
daily_20170924 = pro.daily(start_date='',end_date='',trade_date='20170924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170924_tscode_list = list() 
for ts_code_sh in daily_20170924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170924_tscode_list.append(stock_name)
daily_20170924_addname_dataframe=pd.DataFrame()
daily_20170924_addname_dataframe['cname'] = daily_20170924_tscode_list
for table_name in daily_20170924.columns.values.tolist():
    daily_20170924_addname_dataframe[table_name] = daily_20170924[table_name]
print("daily_20170924 返回数据 row 行数 = "+str(daily_20170924.shape[0]))
daily_20170924_addname_dataframe.to_excel(daily_201709_excel_writer,'24_7',index=False)
daily_201709_excel_writer.save()
daily_20170925 = pro.daily(start_date='',end_date='',trade_date='20170925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170925_tscode_list = list() 
for ts_code_sh in daily_20170925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170925_tscode_list.append(stock_name)
daily_20170925_addname_dataframe=pd.DataFrame()
daily_20170925_addname_dataframe['cname'] = daily_20170925_tscode_list
for table_name in daily_20170925.columns.values.tolist():
    daily_20170925_addname_dataframe[table_name] = daily_20170925[table_name]
print("daily_20170925 返回数据 row 行数 = "+str(daily_20170925.shape[0]))
daily_20170925_addname_dataframe.to_excel(daily_201709_excel_writer,'25_1',index=False)
daily_201709_excel_writer.save()
daily_20170926 = pro.daily(start_date='',end_date='',trade_date='20170926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170926_tscode_list = list() 
for ts_code_sh in daily_20170926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170926_tscode_list.append(stock_name)
daily_20170926_addname_dataframe=pd.DataFrame()
daily_20170926_addname_dataframe['cname'] = daily_20170926_tscode_list
for table_name in daily_20170926.columns.values.tolist():
    daily_20170926_addname_dataframe[table_name] = daily_20170926[table_name]
print("daily_20170926 返回数据 row 行数 = "+str(daily_20170926.shape[0]))
daily_20170926_addname_dataframe.to_excel(daily_201709_excel_writer,'26_2',index=False)
daily_201709_excel_writer.save()
daily_20170927 = pro.daily(start_date='',end_date='',trade_date='20170927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170927_tscode_list = list() 
for ts_code_sh in daily_20170927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170927_tscode_list.append(stock_name)
daily_20170927_addname_dataframe=pd.DataFrame()
daily_20170927_addname_dataframe['cname'] = daily_20170927_tscode_list
for table_name in daily_20170927.columns.values.tolist():
    daily_20170927_addname_dataframe[table_name] = daily_20170927[table_name]
print("daily_20170927 返回数据 row 行数 = "+str(daily_20170927.shape[0]))
daily_20170927_addname_dataframe.to_excel(daily_201709_excel_writer,'27_3',index=False)
daily_201709_excel_writer.save()
daily_20170928 = pro.daily(start_date='',end_date='',trade_date='20170928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170928_tscode_list = list() 
for ts_code_sh in daily_20170928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170928_tscode_list.append(stock_name)
daily_20170928_addname_dataframe=pd.DataFrame()
daily_20170928_addname_dataframe['cname'] = daily_20170928_tscode_list
for table_name in daily_20170928.columns.values.tolist():
    daily_20170928_addname_dataframe[table_name] = daily_20170928[table_name]
print("daily_20170928 返回数据 row 行数 = "+str(daily_20170928.shape[0]))
daily_20170928_addname_dataframe.to_excel(daily_201709_excel_writer,'28_4',index=False)
daily_201709_excel_writer.save()
daily_20170929 = pro.daily(start_date='',end_date='',trade_date='20170929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170929_tscode_list = list() 
for ts_code_sh in daily_20170929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170929_tscode_list.append(stock_name)
daily_20170929_addname_dataframe=pd.DataFrame()
daily_20170929_addname_dataframe['cname'] = daily_20170929_tscode_list
for table_name in daily_20170929.columns.values.tolist():
    daily_20170929_addname_dataframe[table_name] = daily_20170929[table_name]
print("daily_20170929 返回数据 row 行数 = "+str(daily_20170929.shape[0]))
daily_20170929_addname_dataframe.to_excel(daily_201709_excel_writer,'29_5',index=False)
daily_201709_excel_writer.save()
daily_20170930 = pro.daily(start_date='',end_date='',trade_date='20170930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170930_tscode_list = list() 
for ts_code_sh in daily_20170930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170930_tscode_list.append(stock_name)
daily_20170930_addname_dataframe=pd.DataFrame()
daily_20170930_addname_dataframe['cname'] = daily_20170930_tscode_list
for table_name in daily_20170930.columns.values.tolist():
    daily_20170930_addname_dataframe[table_name] = daily_20170930[table_name]
print("daily_20170930 返回数据 row 行数 = "+str(daily_20170930.shape[0]))
daily_20170930_addname_dataframe.to_excel(daily_201709_excel_writer,'30_6',index=False)
daily_201709_excel_writer.save()




createexcel('daily_201710.xlsx')
daily_201710_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201710.xlsx')
daily_201710_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201710.xlsx', engine='openpyxl')
daily_201710_excel_writer.book = daily_201710_book
daily_201710_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201710_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20171001")       ###  更新 记录日期
daily_20171001 = pro.daily(start_date='',end_date='',trade_date='20171001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171001_tscode_list = list() 
for ts_code_sh in daily_20171001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171001_tscode_list.append(stock_name)
daily_20171001_addname_dataframe=pd.DataFrame()
daily_20171001_addname_dataframe['cname'] = daily_20171001_tscode_list
for table_name in daily_20171001.columns.values.tolist():
    daily_20171001_addname_dataframe[table_name] = daily_20171001[table_name]
print("daily_20171001 返回数据 row 行数 = "+str(daily_20171001.shape[0]))
daily_20171001_addname_dataframe.to_excel(daily_201710_excel_writer,'1_7',index=False)
daily_201710_excel_writer.save()
daily_20171002 = pro.daily(start_date='',end_date='',trade_date='20171002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171002_tscode_list = list() 
for ts_code_sh in daily_20171002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171002_tscode_list.append(stock_name)
daily_20171002_addname_dataframe=pd.DataFrame()
daily_20171002_addname_dataframe['cname'] = daily_20171002_tscode_list
for table_name in daily_20171002.columns.values.tolist():
    daily_20171002_addname_dataframe[table_name] = daily_20171002[table_name]
print("daily_20171002 返回数据 row 行数 = "+str(daily_20171002.shape[0]))
daily_20171002_addname_dataframe.to_excel(daily_201710_excel_writer,'2_1',index=False)
daily_201710_excel_writer.save()
daily_20171003 = pro.daily(start_date='',end_date='',trade_date='20171003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171003_tscode_list = list() 
for ts_code_sh in daily_20171003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171003_tscode_list.append(stock_name)
daily_20171003_addname_dataframe=pd.DataFrame()
daily_20171003_addname_dataframe['cname'] = daily_20171003_tscode_list
for table_name in daily_20171003.columns.values.tolist():
    daily_20171003_addname_dataframe[table_name] = daily_20171003[table_name]
print("daily_20171003 返回数据 row 行数 = "+str(daily_20171003.shape[0]))
daily_20171003_addname_dataframe.to_excel(daily_201710_excel_writer,'3_2',index=False)
daily_201710_excel_writer.save()
daily_20171004 = pro.daily(start_date='',end_date='',trade_date='20171004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171004_tscode_list = list() 
for ts_code_sh in daily_20171004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171004_tscode_list.append(stock_name)
daily_20171004_addname_dataframe=pd.DataFrame()
daily_20171004_addname_dataframe['cname'] = daily_20171004_tscode_list
for table_name in daily_20171004.columns.values.tolist():
    daily_20171004_addname_dataframe[table_name] = daily_20171004[table_name]
print("daily_20171004 返回数据 row 行数 = "+str(daily_20171004.shape[0]))
daily_20171004_addname_dataframe.to_excel(daily_201710_excel_writer,'4_3',index=False)
daily_201710_excel_writer.save()
daily_20171005 = pro.daily(start_date='',end_date='',trade_date='20171005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171005_tscode_list = list() 
for ts_code_sh in daily_20171005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171005_tscode_list.append(stock_name)
daily_20171005_addname_dataframe=pd.DataFrame()
daily_20171005_addname_dataframe['cname'] = daily_20171005_tscode_list
for table_name in daily_20171005.columns.values.tolist():
    daily_20171005_addname_dataframe[table_name] = daily_20171005[table_name]
print("daily_20171005 返回数据 row 行数 = "+str(daily_20171005.shape[0]))
daily_20171005_addname_dataframe.to_excel(daily_201710_excel_writer,'5_4',index=False)
daily_201710_excel_writer.save()
daily_20171006 = pro.daily(start_date='',end_date='',trade_date='20171006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171006_tscode_list = list() 
for ts_code_sh in daily_20171006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171006_tscode_list.append(stock_name)
daily_20171006_addname_dataframe=pd.DataFrame()
daily_20171006_addname_dataframe['cname'] = daily_20171006_tscode_list
for table_name in daily_20171006.columns.values.tolist():
    daily_20171006_addname_dataframe[table_name] = daily_20171006[table_name]
print("daily_20171006 返回数据 row 行数 = "+str(daily_20171006.shape[0]))
daily_20171006_addname_dataframe.to_excel(daily_201710_excel_writer,'6_5',index=False)
daily_201710_excel_writer.save()
daily_20171007 = pro.daily(start_date='',end_date='',trade_date='20171007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171007_tscode_list = list() 
for ts_code_sh in daily_20171007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171007_tscode_list.append(stock_name)
daily_20171007_addname_dataframe=pd.DataFrame()
daily_20171007_addname_dataframe['cname'] = daily_20171007_tscode_list
for table_name in daily_20171007.columns.values.tolist():
    daily_20171007_addname_dataframe[table_name] = daily_20171007[table_name]
print("daily_20171007 返回数据 row 行数 = "+str(daily_20171007.shape[0]))
daily_20171007_addname_dataframe.to_excel(daily_201710_excel_writer,'7_6',index=False)
daily_201710_excel_writer.save()
daily_20171008 = pro.daily(start_date='',end_date='',trade_date='20171008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171008_tscode_list = list() 
for ts_code_sh in daily_20171008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171008_tscode_list.append(stock_name)
daily_20171008_addname_dataframe=pd.DataFrame()
daily_20171008_addname_dataframe['cname'] = daily_20171008_tscode_list
for table_name in daily_20171008.columns.values.tolist():
    daily_20171008_addname_dataframe[table_name] = daily_20171008[table_name]
print("daily_20171008 返回数据 row 行数 = "+str(daily_20171008.shape[0]))
daily_20171008_addname_dataframe.to_excel(daily_201710_excel_writer,'8_7',index=False)
daily_201710_excel_writer.save()
daily_20171009 = pro.daily(start_date='',end_date='',trade_date='20171009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171009_tscode_list = list() 
for ts_code_sh in daily_20171009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171009_tscode_list.append(stock_name)
daily_20171009_addname_dataframe=pd.DataFrame()
daily_20171009_addname_dataframe['cname'] = daily_20171009_tscode_list
for table_name in daily_20171009.columns.values.tolist():
    daily_20171009_addname_dataframe[table_name] = daily_20171009[table_name]
print("daily_20171009 返回数据 row 行数 = "+str(daily_20171009.shape[0]))
daily_20171009_addname_dataframe.to_excel(daily_201710_excel_writer,'9_1',index=False)
daily_201710_excel_writer.save()
daily_20171010 = pro.daily(start_date='',end_date='',trade_date='20171010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171010_tscode_list = list() 
for ts_code_sh in daily_20171010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171010_tscode_list.append(stock_name)
daily_20171010_addname_dataframe=pd.DataFrame()
daily_20171010_addname_dataframe['cname'] = daily_20171010_tscode_list
for table_name in daily_20171010.columns.values.tolist():
    daily_20171010_addname_dataframe[table_name] = daily_20171010[table_name]
print("daily_20171010 返回数据 row 行数 = "+str(daily_20171010.shape[0]))
daily_20171010_addname_dataframe.to_excel(daily_201710_excel_writer,'10_2',index=False)
daily_201710_excel_writer.save()
daily_20171011 = pro.daily(start_date='',end_date='',trade_date='20171011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171011_tscode_list = list() 
for ts_code_sh in daily_20171011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171011_tscode_list.append(stock_name)
daily_20171011_addname_dataframe=pd.DataFrame()
daily_20171011_addname_dataframe['cname'] = daily_20171011_tscode_list
for table_name in daily_20171011.columns.values.tolist():
    daily_20171011_addname_dataframe[table_name] = daily_20171011[table_name]
print("daily_20171011 返回数据 row 行数 = "+str(daily_20171011.shape[0]))
daily_20171011_addname_dataframe.to_excel(daily_201710_excel_writer,'11_3',index=False)
daily_201710_excel_writer.save()
daily_20171012 = pro.daily(start_date='',end_date='',trade_date='20171012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171012_tscode_list = list() 
for ts_code_sh in daily_20171012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171012_tscode_list.append(stock_name)
daily_20171012_addname_dataframe=pd.DataFrame()
daily_20171012_addname_dataframe['cname'] = daily_20171012_tscode_list
for table_name in daily_20171012.columns.values.tolist():
    daily_20171012_addname_dataframe[table_name] = daily_20171012[table_name]
print("daily_20171012 返回数据 row 行数 = "+str(daily_20171012.shape[0]))
daily_20171012_addname_dataframe.to_excel(daily_201710_excel_writer,'12_4',index=False)
daily_201710_excel_writer.save()
daily_20171013 = pro.daily(start_date='',end_date='',trade_date='20171013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171013_tscode_list = list() 
for ts_code_sh in daily_20171013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171013_tscode_list.append(stock_name)
daily_20171013_addname_dataframe=pd.DataFrame()
daily_20171013_addname_dataframe['cname'] = daily_20171013_tscode_list
for table_name in daily_20171013.columns.values.tolist():
    daily_20171013_addname_dataframe[table_name] = daily_20171013[table_name]
print("daily_20171013 返回数据 row 行数 = "+str(daily_20171013.shape[0]))
daily_20171013_addname_dataframe.to_excel(daily_201710_excel_writer,'13_5',index=False)
daily_201710_excel_writer.save()
daily_20171014 = pro.daily(start_date='',end_date='',trade_date='20171014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171014_tscode_list = list() 
for ts_code_sh in daily_20171014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171014_tscode_list.append(stock_name)
daily_20171014_addname_dataframe=pd.DataFrame()
daily_20171014_addname_dataframe['cname'] = daily_20171014_tscode_list
for table_name in daily_20171014.columns.values.tolist():
    daily_20171014_addname_dataframe[table_name] = daily_20171014[table_name]
print("daily_20171014 返回数据 row 行数 = "+str(daily_20171014.shape[0]))
daily_20171014_addname_dataframe.to_excel(daily_201710_excel_writer,'14_6',index=False)
daily_201710_excel_writer.save()
daily_20171015 = pro.daily(start_date='',end_date='',trade_date='20171015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171015_tscode_list = list() 
for ts_code_sh in daily_20171015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171015_tscode_list.append(stock_name)
daily_20171015_addname_dataframe=pd.DataFrame()
daily_20171015_addname_dataframe['cname'] = daily_20171015_tscode_list
for table_name in daily_20171015.columns.values.tolist():
    daily_20171015_addname_dataframe[table_name] = daily_20171015[table_name]
print("daily_20171015 返回数据 row 行数 = "+str(daily_20171015.shape[0]))
daily_20171015_addname_dataframe.to_excel(daily_201710_excel_writer,'15_7',index=False)
daily_201710_excel_writer.save()
daily_20171016 = pro.daily(start_date='',end_date='',trade_date='20171016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171016_tscode_list = list() 
for ts_code_sh in daily_20171016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171016_tscode_list.append(stock_name)
daily_20171016_addname_dataframe=pd.DataFrame()
daily_20171016_addname_dataframe['cname'] = daily_20171016_tscode_list
for table_name in daily_20171016.columns.values.tolist():
    daily_20171016_addname_dataframe[table_name] = daily_20171016[table_name]
print("daily_20171016 返回数据 row 行数 = "+str(daily_20171016.shape[0]))
daily_20171016_addname_dataframe.to_excel(daily_201710_excel_writer,'16_1',index=False)
daily_201710_excel_writer.save()
daily_20171017 = pro.daily(start_date='',end_date='',trade_date='20171017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171017_tscode_list = list() 
for ts_code_sh in daily_20171017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171017_tscode_list.append(stock_name)
daily_20171017_addname_dataframe=pd.DataFrame()
daily_20171017_addname_dataframe['cname'] = daily_20171017_tscode_list
for table_name in daily_20171017.columns.values.tolist():
    daily_20171017_addname_dataframe[table_name] = daily_20171017[table_name]
print("daily_20171017 返回数据 row 行数 = "+str(daily_20171017.shape[0]))
daily_20171017_addname_dataframe.to_excel(daily_201710_excel_writer,'17_2',index=False)
daily_201710_excel_writer.save()
daily_20171018 = pro.daily(start_date='',end_date='',trade_date='20171018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171018_tscode_list = list() 
for ts_code_sh in daily_20171018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171018_tscode_list.append(stock_name)
daily_20171018_addname_dataframe=pd.DataFrame()
daily_20171018_addname_dataframe['cname'] = daily_20171018_tscode_list
for table_name in daily_20171018.columns.values.tolist():
    daily_20171018_addname_dataframe[table_name] = daily_20171018[table_name]
print("daily_20171018 返回数据 row 行数 = "+str(daily_20171018.shape[0]))
daily_20171018_addname_dataframe.to_excel(daily_201710_excel_writer,'18_3',index=False)
daily_201710_excel_writer.save()
daily_20171019 = pro.daily(start_date='',end_date='',trade_date='20171019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171019_tscode_list = list() 
for ts_code_sh in daily_20171019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171019_tscode_list.append(stock_name)
daily_20171019_addname_dataframe=pd.DataFrame()
daily_20171019_addname_dataframe['cname'] = daily_20171019_tscode_list
for table_name in daily_20171019.columns.values.tolist():
    daily_20171019_addname_dataframe[table_name] = daily_20171019[table_name]
print("daily_20171019 返回数据 row 行数 = "+str(daily_20171019.shape[0]))
daily_20171019_addname_dataframe.to_excel(daily_201710_excel_writer,'19_4',index=False)
daily_201710_excel_writer.save()
daily_20171020 = pro.daily(start_date='',end_date='',trade_date='20171020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171020_tscode_list = list() 
for ts_code_sh in daily_20171020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171020_tscode_list.append(stock_name)
daily_20171020_addname_dataframe=pd.DataFrame()
daily_20171020_addname_dataframe['cname'] = daily_20171020_tscode_list
for table_name in daily_20171020.columns.values.tolist():
    daily_20171020_addname_dataframe[table_name] = daily_20171020[table_name]
print("daily_20171020 返回数据 row 行数 = "+str(daily_20171020.shape[0]))
daily_20171020_addname_dataframe.to_excel(daily_201710_excel_writer,'20_5',index=False)
daily_201710_excel_writer.save()
daily_20171021 = pro.daily(start_date='',end_date='',trade_date='20171021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171021_tscode_list = list() 
for ts_code_sh in daily_20171021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171021_tscode_list.append(stock_name)
daily_20171021_addname_dataframe=pd.DataFrame()
daily_20171021_addname_dataframe['cname'] = daily_20171021_tscode_list
for table_name in daily_20171021.columns.values.tolist():
    daily_20171021_addname_dataframe[table_name] = daily_20171021[table_name]
print("daily_20171021 返回数据 row 行数 = "+str(daily_20171021.shape[0]))
daily_20171021_addname_dataframe.to_excel(daily_201710_excel_writer,'21_6',index=False)
daily_201710_excel_writer.save()
daily_20171022 = pro.daily(start_date='',end_date='',trade_date='20171022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171022_tscode_list = list() 
for ts_code_sh in daily_20171022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171022_tscode_list.append(stock_name)
daily_20171022_addname_dataframe=pd.DataFrame()
daily_20171022_addname_dataframe['cname'] = daily_20171022_tscode_list
for table_name in daily_20171022.columns.values.tolist():
    daily_20171022_addname_dataframe[table_name] = daily_20171022[table_name]
print("daily_20171022 返回数据 row 行数 = "+str(daily_20171022.shape[0]))
daily_20171022_addname_dataframe.to_excel(daily_201710_excel_writer,'22_7',index=False)
daily_201710_excel_writer.save()
daily_20171023 = pro.daily(start_date='',end_date='',trade_date='20171023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171023_tscode_list = list() 
for ts_code_sh in daily_20171023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171023_tscode_list.append(stock_name)
daily_20171023_addname_dataframe=pd.DataFrame()
daily_20171023_addname_dataframe['cname'] = daily_20171023_tscode_list
for table_name in daily_20171023.columns.values.tolist():
    daily_20171023_addname_dataframe[table_name] = daily_20171023[table_name]
print("daily_20171023 返回数据 row 行数 = "+str(daily_20171023.shape[0]))
daily_20171023_addname_dataframe.to_excel(daily_201710_excel_writer,'23_1',index=False)
daily_201710_excel_writer.save()
daily_20171024 = pro.daily(start_date='',end_date='',trade_date='20171024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171024_tscode_list = list() 
for ts_code_sh in daily_20171024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171024_tscode_list.append(stock_name)
daily_20171024_addname_dataframe=pd.DataFrame()
daily_20171024_addname_dataframe['cname'] = daily_20171024_tscode_list
for table_name in daily_20171024.columns.values.tolist():
    daily_20171024_addname_dataframe[table_name] = daily_20171024[table_name]
print("daily_20171024 返回数据 row 行数 = "+str(daily_20171024.shape[0]))
daily_20171024_addname_dataframe.to_excel(daily_201710_excel_writer,'24_2',index=False)
daily_201710_excel_writer.save()
daily_20171025 = pro.daily(start_date='',end_date='',trade_date='20171025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171025_tscode_list = list() 
for ts_code_sh in daily_20171025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171025_tscode_list.append(stock_name)
daily_20171025_addname_dataframe=pd.DataFrame()
daily_20171025_addname_dataframe['cname'] = daily_20171025_tscode_list
for table_name in daily_20171025.columns.values.tolist():
    daily_20171025_addname_dataframe[table_name] = daily_20171025[table_name]
print("daily_20171025 返回数据 row 行数 = "+str(daily_20171025.shape[0]))
daily_20171025_addname_dataframe.to_excel(daily_201710_excel_writer,'25_3',index=False)
daily_201710_excel_writer.save()
daily_20171026 = pro.daily(start_date='',end_date='',trade_date='20171026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171026_tscode_list = list() 
for ts_code_sh in daily_20171026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171026_tscode_list.append(stock_name)
daily_20171026_addname_dataframe=pd.DataFrame()
daily_20171026_addname_dataframe['cname'] = daily_20171026_tscode_list
for table_name in daily_20171026.columns.values.tolist():
    daily_20171026_addname_dataframe[table_name] = daily_20171026[table_name]
print("daily_20171026 返回数据 row 行数 = "+str(daily_20171026.shape[0]))
daily_20171026_addname_dataframe.to_excel(daily_201710_excel_writer,'26_4',index=False)
daily_201710_excel_writer.save()
daily_20171027 = pro.daily(start_date='',end_date='',trade_date='20171027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171027_tscode_list = list() 
for ts_code_sh in daily_20171027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171027_tscode_list.append(stock_name)
daily_20171027_addname_dataframe=pd.DataFrame()
daily_20171027_addname_dataframe['cname'] = daily_20171027_tscode_list
for table_name in daily_20171027.columns.values.tolist():
    daily_20171027_addname_dataframe[table_name] = daily_20171027[table_name]
print("daily_20171027 返回数据 row 行数 = "+str(daily_20171027.shape[0]))
daily_20171027_addname_dataframe.to_excel(daily_201710_excel_writer,'27_5',index=False)
daily_201710_excel_writer.save()
daily_20171028 = pro.daily(start_date='',end_date='',trade_date='20171028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171028_tscode_list = list() 
for ts_code_sh in daily_20171028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171028_tscode_list.append(stock_name)
daily_20171028_addname_dataframe=pd.DataFrame()
daily_20171028_addname_dataframe['cname'] = daily_20171028_tscode_list
for table_name in daily_20171028.columns.values.tolist():
    daily_20171028_addname_dataframe[table_name] = daily_20171028[table_name]
print("daily_20171028 返回数据 row 行数 = "+str(daily_20171028.shape[0]))
daily_20171028_addname_dataframe.to_excel(daily_201710_excel_writer,'28_6',index=False)
daily_201710_excel_writer.save()
daily_20171029 = pro.daily(start_date='',end_date='',trade_date='20171029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171029_tscode_list = list() 
for ts_code_sh in daily_20171029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171029_tscode_list.append(stock_name)
daily_20171029_addname_dataframe=pd.DataFrame()
daily_20171029_addname_dataframe['cname'] = daily_20171029_tscode_list
for table_name in daily_20171029.columns.values.tolist():
    daily_20171029_addname_dataframe[table_name] = daily_20171029[table_name]
print("daily_20171029 返回数据 row 行数 = "+str(daily_20171029.shape[0]))
daily_20171029_addname_dataframe.to_excel(daily_201710_excel_writer,'29_7',index=False)
daily_201710_excel_writer.save()
daily_20171030 = pro.daily(start_date='',end_date='',trade_date='20171030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171030_tscode_list = list() 
for ts_code_sh in daily_20171030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171030_tscode_list.append(stock_name)
daily_20171030_addname_dataframe=pd.DataFrame()
daily_20171030_addname_dataframe['cname'] = daily_20171030_tscode_list
for table_name in daily_20171030.columns.values.tolist():
    daily_20171030_addname_dataframe[table_name] = daily_20171030[table_name]
print("daily_20171030 返回数据 row 行数 = "+str(daily_20171030.shape[0]))
daily_20171030_addname_dataframe.to_excel(daily_201710_excel_writer,'30_1',index=False)
daily_201710_excel_writer.save()
daily_20171031 = pro.daily(start_date='',end_date='',trade_date='20171031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171031_tscode_list = list() 
for ts_code_sh in daily_20171031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171031_tscode_list.append(stock_name)
daily_20171031_addname_dataframe=pd.DataFrame()
daily_20171031_addname_dataframe['cname'] = daily_20171031_tscode_list
for table_name in daily_20171031.columns.values.tolist():
    daily_20171031_addname_dataframe[table_name] = daily_20171031[table_name]
print("daily_20171031 返回数据 row 行数 = "+str(daily_20171031.shape[0]))
daily_20171031_addname_dataframe.to_excel(daily_201710_excel_writer,'31_2',index=False)
daily_201710_excel_writer.save()




createexcel('daily_201711.xlsx')
daily_201711_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201711.xlsx')
daily_201711_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201711.xlsx', engine='openpyxl')
daily_201711_excel_writer.book = daily_201711_book
daily_201711_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201711_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20171101")       ###  更新 记录日期
daily_20171101 = pro.daily(start_date='',end_date='',trade_date='20171101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171101_tscode_list = list() 
for ts_code_sh in daily_20171101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171101_tscode_list.append(stock_name)
daily_20171101_addname_dataframe=pd.DataFrame()
daily_20171101_addname_dataframe['cname'] = daily_20171101_tscode_list
for table_name in daily_20171101.columns.values.tolist():
    daily_20171101_addname_dataframe[table_name] = daily_20171101[table_name]
print("daily_20171101 返回数据 row 行数 = "+str(daily_20171101.shape[0]))
daily_20171101_addname_dataframe.to_excel(daily_201711_excel_writer,'1_3',index=False)
daily_201711_excel_writer.save()
daily_20171102 = pro.daily(start_date='',end_date='',trade_date='20171102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171102_tscode_list = list() 
for ts_code_sh in daily_20171102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171102_tscode_list.append(stock_name)
daily_20171102_addname_dataframe=pd.DataFrame()
daily_20171102_addname_dataframe['cname'] = daily_20171102_tscode_list
for table_name in daily_20171102.columns.values.tolist():
    daily_20171102_addname_dataframe[table_name] = daily_20171102[table_name]
print("daily_20171102 返回数据 row 行数 = "+str(daily_20171102.shape[0]))
daily_20171102_addname_dataframe.to_excel(daily_201711_excel_writer,'2_4',index=False)
daily_201711_excel_writer.save()
daily_20171103 = pro.daily(start_date='',end_date='',trade_date='20171103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171103_tscode_list = list() 
for ts_code_sh in daily_20171103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171103_tscode_list.append(stock_name)
daily_20171103_addname_dataframe=pd.DataFrame()
daily_20171103_addname_dataframe['cname'] = daily_20171103_tscode_list
for table_name in daily_20171103.columns.values.tolist():
    daily_20171103_addname_dataframe[table_name] = daily_20171103[table_name]
print("daily_20171103 返回数据 row 行数 = "+str(daily_20171103.shape[0]))
daily_20171103_addname_dataframe.to_excel(daily_201711_excel_writer,'3_5',index=False)
daily_201711_excel_writer.save()
daily_20171104 = pro.daily(start_date='',end_date='',trade_date='20171104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171104_tscode_list = list() 
for ts_code_sh in daily_20171104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171104_tscode_list.append(stock_name)
daily_20171104_addname_dataframe=pd.DataFrame()
daily_20171104_addname_dataframe['cname'] = daily_20171104_tscode_list
for table_name in daily_20171104.columns.values.tolist():
    daily_20171104_addname_dataframe[table_name] = daily_20171104[table_name]
print("daily_20171104 返回数据 row 行数 = "+str(daily_20171104.shape[0]))
daily_20171104_addname_dataframe.to_excel(daily_201711_excel_writer,'4_6',index=False)
daily_201711_excel_writer.save()
daily_20171105 = pro.daily(start_date='',end_date='',trade_date='20171105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171105_tscode_list = list() 
for ts_code_sh in daily_20171105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171105_tscode_list.append(stock_name)
daily_20171105_addname_dataframe=pd.DataFrame()
daily_20171105_addname_dataframe['cname'] = daily_20171105_tscode_list
for table_name in daily_20171105.columns.values.tolist():
    daily_20171105_addname_dataframe[table_name] = daily_20171105[table_name]
print("daily_20171105 返回数据 row 行数 = "+str(daily_20171105.shape[0]))
daily_20171105_addname_dataframe.to_excel(daily_201711_excel_writer,'5_7',index=False)
daily_201711_excel_writer.save()
daily_20171106 = pro.daily(start_date='',end_date='',trade_date='20171106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171106_tscode_list = list() 
for ts_code_sh in daily_20171106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171106_tscode_list.append(stock_name)
daily_20171106_addname_dataframe=pd.DataFrame()
daily_20171106_addname_dataframe['cname'] = daily_20171106_tscode_list
for table_name in daily_20171106.columns.values.tolist():
    daily_20171106_addname_dataframe[table_name] = daily_20171106[table_name]
print("daily_20171106 返回数据 row 行数 = "+str(daily_20171106.shape[0]))
daily_20171106_addname_dataframe.to_excel(daily_201711_excel_writer,'6_1',index=False)
daily_201711_excel_writer.save()
daily_20171107 = pro.daily(start_date='',end_date='',trade_date='20171107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171107_tscode_list = list() 
for ts_code_sh in daily_20171107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171107_tscode_list.append(stock_name)
daily_20171107_addname_dataframe=pd.DataFrame()
daily_20171107_addname_dataframe['cname'] = daily_20171107_tscode_list
for table_name in daily_20171107.columns.values.tolist():
    daily_20171107_addname_dataframe[table_name] = daily_20171107[table_name]
print("daily_20171107 返回数据 row 行数 = "+str(daily_20171107.shape[0]))
daily_20171107_addname_dataframe.to_excel(daily_201711_excel_writer,'7_2',index=False)
daily_201711_excel_writer.save()
daily_20171108 = pro.daily(start_date='',end_date='',trade_date='20171108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171108_tscode_list = list() 
for ts_code_sh in daily_20171108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171108_tscode_list.append(stock_name)
daily_20171108_addname_dataframe=pd.DataFrame()
daily_20171108_addname_dataframe['cname'] = daily_20171108_tscode_list
for table_name in daily_20171108.columns.values.tolist():
    daily_20171108_addname_dataframe[table_name] = daily_20171108[table_name]
print("daily_20171108 返回数据 row 行数 = "+str(daily_20171108.shape[0]))
daily_20171108_addname_dataframe.to_excel(daily_201711_excel_writer,'8_3',index=False)
daily_201711_excel_writer.save()
daily_20171109 = pro.daily(start_date='',end_date='',trade_date='20171109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171109_tscode_list = list() 
for ts_code_sh in daily_20171109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171109_tscode_list.append(stock_name)
daily_20171109_addname_dataframe=pd.DataFrame()
daily_20171109_addname_dataframe['cname'] = daily_20171109_tscode_list
for table_name in daily_20171109.columns.values.tolist():
    daily_20171109_addname_dataframe[table_name] = daily_20171109[table_name]
print("daily_20171109 返回数据 row 行数 = "+str(daily_20171109.shape[0]))
daily_20171109_addname_dataframe.to_excel(daily_201711_excel_writer,'9_4',index=False)
daily_201711_excel_writer.save()
daily_20171110 = pro.daily(start_date='',end_date='',trade_date='20171110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171110_tscode_list = list() 
for ts_code_sh in daily_20171110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171110_tscode_list.append(stock_name)
daily_20171110_addname_dataframe=pd.DataFrame()
daily_20171110_addname_dataframe['cname'] = daily_20171110_tscode_list
for table_name in daily_20171110.columns.values.tolist():
    daily_20171110_addname_dataframe[table_name] = daily_20171110[table_name]
print("daily_20171110 返回数据 row 行数 = "+str(daily_20171110.shape[0]))
daily_20171110_addname_dataframe.to_excel(daily_201711_excel_writer,'10_5',index=False)
daily_201711_excel_writer.save()
daily_20171111 = pro.daily(start_date='',end_date='',trade_date='20171111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171111_tscode_list = list() 
for ts_code_sh in daily_20171111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171111_tscode_list.append(stock_name)
daily_20171111_addname_dataframe=pd.DataFrame()
daily_20171111_addname_dataframe['cname'] = daily_20171111_tscode_list
for table_name in daily_20171111.columns.values.tolist():
    daily_20171111_addname_dataframe[table_name] = daily_20171111[table_name]
print("daily_20171111 返回数据 row 行数 = "+str(daily_20171111.shape[0]))
daily_20171111_addname_dataframe.to_excel(daily_201711_excel_writer,'11_6',index=False)
daily_201711_excel_writer.save()
daily_20171112 = pro.daily(start_date='',end_date='',trade_date='20171112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171112_tscode_list = list() 
for ts_code_sh in daily_20171112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171112_tscode_list.append(stock_name)
daily_20171112_addname_dataframe=pd.DataFrame()
daily_20171112_addname_dataframe['cname'] = daily_20171112_tscode_list
for table_name in daily_20171112.columns.values.tolist():
    daily_20171112_addname_dataframe[table_name] = daily_20171112[table_name]
print("daily_20171112 返回数据 row 行数 = "+str(daily_20171112.shape[0]))
daily_20171112_addname_dataframe.to_excel(daily_201711_excel_writer,'12_7',index=False)
daily_201711_excel_writer.save()
daily_20171113 = pro.daily(start_date='',end_date='',trade_date='20171113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171113_tscode_list = list() 
for ts_code_sh in daily_20171113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171113_tscode_list.append(stock_name)
daily_20171113_addname_dataframe=pd.DataFrame()
daily_20171113_addname_dataframe['cname'] = daily_20171113_tscode_list
for table_name in daily_20171113.columns.values.tolist():
    daily_20171113_addname_dataframe[table_name] = daily_20171113[table_name]
print("daily_20171113 返回数据 row 行数 = "+str(daily_20171113.shape[0]))
daily_20171113_addname_dataframe.to_excel(daily_201711_excel_writer,'13_1',index=False)
daily_201711_excel_writer.save()
daily_20171114 = pro.daily(start_date='',end_date='',trade_date='20171114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171114_tscode_list = list() 
for ts_code_sh in daily_20171114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171114_tscode_list.append(stock_name)
daily_20171114_addname_dataframe=pd.DataFrame()
daily_20171114_addname_dataframe['cname'] = daily_20171114_tscode_list
for table_name in daily_20171114.columns.values.tolist():
    daily_20171114_addname_dataframe[table_name] = daily_20171114[table_name]
print("daily_20171114 返回数据 row 行数 = "+str(daily_20171114.shape[0]))
daily_20171114_addname_dataframe.to_excel(daily_201711_excel_writer,'14_2',index=False)
daily_201711_excel_writer.save()
daily_20171115 = pro.daily(start_date='',end_date='',trade_date='20171115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171115_tscode_list = list() 
for ts_code_sh in daily_20171115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171115_tscode_list.append(stock_name)
daily_20171115_addname_dataframe=pd.DataFrame()
daily_20171115_addname_dataframe['cname'] = daily_20171115_tscode_list
for table_name in daily_20171115.columns.values.tolist():
    daily_20171115_addname_dataframe[table_name] = daily_20171115[table_name]
print("daily_20171115 返回数据 row 行数 = "+str(daily_20171115.shape[0]))
daily_20171115_addname_dataframe.to_excel(daily_201711_excel_writer,'15_3',index=False)
daily_201711_excel_writer.save()
daily_20171116 = pro.daily(start_date='',end_date='',trade_date='20171116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171116_tscode_list = list() 
for ts_code_sh in daily_20171116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171116_tscode_list.append(stock_name)
daily_20171116_addname_dataframe=pd.DataFrame()
daily_20171116_addname_dataframe['cname'] = daily_20171116_tscode_list
for table_name in daily_20171116.columns.values.tolist():
    daily_20171116_addname_dataframe[table_name] = daily_20171116[table_name]
print("daily_20171116 返回数据 row 行数 = "+str(daily_20171116.shape[0]))
daily_20171116_addname_dataframe.to_excel(daily_201711_excel_writer,'16_4',index=False)
daily_201711_excel_writer.save()
daily_20171117 = pro.daily(start_date='',end_date='',trade_date='20171117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171117_tscode_list = list() 
for ts_code_sh in daily_20171117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171117_tscode_list.append(stock_name)
daily_20171117_addname_dataframe=pd.DataFrame()
daily_20171117_addname_dataframe['cname'] = daily_20171117_tscode_list
for table_name in daily_20171117.columns.values.tolist():
    daily_20171117_addname_dataframe[table_name] = daily_20171117[table_name]
print("daily_20171117 返回数据 row 行数 = "+str(daily_20171117.shape[0]))
daily_20171117_addname_dataframe.to_excel(daily_201711_excel_writer,'17_5',index=False)
daily_201711_excel_writer.save()
daily_20171118 = pro.daily(start_date='',end_date='',trade_date='20171118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171118_tscode_list = list() 
for ts_code_sh in daily_20171118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171118_tscode_list.append(stock_name)
daily_20171118_addname_dataframe=pd.DataFrame()
daily_20171118_addname_dataframe['cname'] = daily_20171118_tscode_list
for table_name in daily_20171118.columns.values.tolist():
    daily_20171118_addname_dataframe[table_name] = daily_20171118[table_name]
print("daily_20171118 返回数据 row 行数 = "+str(daily_20171118.shape[0]))
daily_20171118_addname_dataframe.to_excel(daily_201711_excel_writer,'18_6',index=False)
daily_201711_excel_writer.save()
daily_20171119 = pro.daily(start_date='',end_date='',trade_date='20171119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171119_tscode_list = list() 
for ts_code_sh in daily_20171119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171119_tscode_list.append(stock_name)
daily_20171119_addname_dataframe=pd.DataFrame()
daily_20171119_addname_dataframe['cname'] = daily_20171119_tscode_list
for table_name in daily_20171119.columns.values.tolist():
    daily_20171119_addname_dataframe[table_name] = daily_20171119[table_name]
print("daily_20171119 返回数据 row 行数 = "+str(daily_20171119.shape[0]))
daily_20171119_addname_dataframe.to_excel(daily_201711_excel_writer,'19_7',index=False)
daily_201711_excel_writer.save()
daily_20171120 = pro.daily(start_date='',end_date='',trade_date='20171120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171120_tscode_list = list() 
for ts_code_sh in daily_20171120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171120_tscode_list.append(stock_name)
daily_20171120_addname_dataframe=pd.DataFrame()
daily_20171120_addname_dataframe['cname'] = daily_20171120_tscode_list
for table_name in daily_20171120.columns.values.tolist():
    daily_20171120_addname_dataframe[table_name] = daily_20171120[table_name]
print("daily_20171120 返回数据 row 行数 = "+str(daily_20171120.shape[0]))
daily_20171120_addname_dataframe.to_excel(daily_201711_excel_writer,'20_1',index=False)
daily_201711_excel_writer.save()
daily_20171121 = pro.daily(start_date='',end_date='',trade_date='20171121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171121_tscode_list = list() 
for ts_code_sh in daily_20171121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171121_tscode_list.append(stock_name)
daily_20171121_addname_dataframe=pd.DataFrame()
daily_20171121_addname_dataframe['cname'] = daily_20171121_tscode_list
for table_name in daily_20171121.columns.values.tolist():
    daily_20171121_addname_dataframe[table_name] = daily_20171121[table_name]
print("daily_20171121 返回数据 row 行数 = "+str(daily_20171121.shape[0]))
daily_20171121_addname_dataframe.to_excel(daily_201711_excel_writer,'21_2',index=False)
daily_201711_excel_writer.save()
daily_20171122 = pro.daily(start_date='',end_date='',trade_date='20171122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171122_tscode_list = list() 
for ts_code_sh in daily_20171122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171122_tscode_list.append(stock_name)
daily_20171122_addname_dataframe=pd.DataFrame()
daily_20171122_addname_dataframe['cname'] = daily_20171122_tscode_list
for table_name in daily_20171122.columns.values.tolist():
    daily_20171122_addname_dataframe[table_name] = daily_20171122[table_name]
print("daily_20171122 返回数据 row 行数 = "+str(daily_20171122.shape[0]))
daily_20171122_addname_dataframe.to_excel(daily_201711_excel_writer,'22_3',index=False)
daily_201711_excel_writer.save()
daily_20171123 = pro.daily(start_date='',end_date='',trade_date='20171123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171123_tscode_list = list() 
for ts_code_sh in daily_20171123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171123_tscode_list.append(stock_name)
daily_20171123_addname_dataframe=pd.DataFrame()
daily_20171123_addname_dataframe['cname'] = daily_20171123_tscode_list
for table_name in daily_20171123.columns.values.tolist():
    daily_20171123_addname_dataframe[table_name] = daily_20171123[table_name]
print("daily_20171123 返回数据 row 行数 = "+str(daily_20171123.shape[0]))
daily_20171123_addname_dataframe.to_excel(daily_201711_excel_writer,'23_4',index=False)
daily_201711_excel_writer.save()
daily_20171124 = pro.daily(start_date='',end_date='',trade_date='20171124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171124_tscode_list = list() 
for ts_code_sh in daily_20171124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171124_tscode_list.append(stock_name)
daily_20171124_addname_dataframe=pd.DataFrame()
daily_20171124_addname_dataframe['cname'] = daily_20171124_tscode_list
for table_name in daily_20171124.columns.values.tolist():
    daily_20171124_addname_dataframe[table_name] = daily_20171124[table_name]
print("daily_20171124 返回数据 row 行数 = "+str(daily_20171124.shape[0]))
daily_20171124_addname_dataframe.to_excel(daily_201711_excel_writer,'24_5',index=False)
daily_201711_excel_writer.save()
daily_20171125 = pro.daily(start_date='',end_date='',trade_date='20171125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171125_tscode_list = list() 
for ts_code_sh in daily_20171125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171125_tscode_list.append(stock_name)
daily_20171125_addname_dataframe=pd.DataFrame()
daily_20171125_addname_dataframe['cname'] = daily_20171125_tscode_list
for table_name in daily_20171125.columns.values.tolist():
    daily_20171125_addname_dataframe[table_name] = daily_20171125[table_name]
print("daily_20171125 返回数据 row 行数 = "+str(daily_20171125.shape[0]))
daily_20171125_addname_dataframe.to_excel(daily_201711_excel_writer,'25_6',index=False)
daily_201711_excel_writer.save()
daily_20171126 = pro.daily(start_date='',end_date='',trade_date='20171126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171126_tscode_list = list() 
for ts_code_sh in daily_20171126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171126_tscode_list.append(stock_name)
daily_20171126_addname_dataframe=pd.DataFrame()
daily_20171126_addname_dataframe['cname'] = daily_20171126_tscode_list
for table_name in daily_20171126.columns.values.tolist():
    daily_20171126_addname_dataframe[table_name] = daily_20171126[table_name]
print("daily_20171126 返回数据 row 行数 = "+str(daily_20171126.shape[0]))
daily_20171126_addname_dataframe.to_excel(daily_201711_excel_writer,'26_7',index=False)
daily_201711_excel_writer.save()
daily_20171127 = pro.daily(start_date='',end_date='',trade_date='20171127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171127_tscode_list = list() 
for ts_code_sh in daily_20171127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171127_tscode_list.append(stock_name)
daily_20171127_addname_dataframe=pd.DataFrame()
daily_20171127_addname_dataframe['cname'] = daily_20171127_tscode_list
for table_name in daily_20171127.columns.values.tolist():
    daily_20171127_addname_dataframe[table_name] = daily_20171127[table_name]
print("daily_20171127 返回数据 row 行数 = "+str(daily_20171127.shape[0]))
daily_20171127_addname_dataframe.to_excel(daily_201711_excel_writer,'27_1',index=False)
daily_201711_excel_writer.save()
daily_20171128 = pro.daily(start_date='',end_date='',trade_date='20171128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171128_tscode_list = list() 
for ts_code_sh in daily_20171128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171128_tscode_list.append(stock_name)
daily_20171128_addname_dataframe=pd.DataFrame()
daily_20171128_addname_dataframe['cname'] = daily_20171128_tscode_list
for table_name in daily_20171128.columns.values.tolist():
    daily_20171128_addname_dataframe[table_name] = daily_20171128[table_name]
print("daily_20171128 返回数据 row 行数 = "+str(daily_20171128.shape[0]))
daily_20171128_addname_dataframe.to_excel(daily_201711_excel_writer,'28_2',index=False)
daily_201711_excel_writer.save()
daily_20171129 = pro.daily(start_date='',end_date='',trade_date='20171129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171129_tscode_list = list() 
for ts_code_sh in daily_20171129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171129_tscode_list.append(stock_name)
daily_20171129_addname_dataframe=pd.DataFrame()
daily_20171129_addname_dataframe['cname'] = daily_20171129_tscode_list
for table_name in daily_20171129.columns.values.tolist():
    daily_20171129_addname_dataframe[table_name] = daily_20171129[table_name]
print("daily_20171129 返回数据 row 行数 = "+str(daily_20171129.shape[0]))
daily_20171129_addname_dataframe.to_excel(daily_201711_excel_writer,'29_3',index=False)
daily_201711_excel_writer.save()
daily_20171130 = pro.daily(start_date='',end_date='',trade_date='20171130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171130_tscode_list = list() 
for ts_code_sh in daily_20171130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171130_tscode_list.append(stock_name)
daily_20171130_addname_dataframe=pd.DataFrame()
daily_20171130_addname_dataframe['cname'] = daily_20171130_tscode_list
for table_name in daily_20171130.columns.values.tolist():
    daily_20171130_addname_dataframe[table_name] = daily_20171130[table_name]
print("daily_20171130 返回数据 row 行数 = "+str(daily_20171130.shape[0]))
daily_20171130_addname_dataframe.to_excel(daily_201711_excel_writer,'30_4',index=False)
daily_201711_excel_writer.save()




createexcel('daily_201712.xlsx')
daily_201712_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201712.xlsx')
daily_201712_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201712.xlsx', engine='openpyxl')
daily_201712_excel_writer.book = daily_201712_book
daily_201712_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201712_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20171201")       ###  更新 记录日期
daily_20171201 = pro.daily(start_date='',end_date='',trade_date='20171201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171201_tscode_list = list() 
for ts_code_sh in daily_20171201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171201_tscode_list.append(stock_name)
daily_20171201_addname_dataframe=pd.DataFrame()
daily_20171201_addname_dataframe['cname'] = daily_20171201_tscode_list
for table_name in daily_20171201.columns.values.tolist():
    daily_20171201_addname_dataframe[table_name] = daily_20171201[table_name]
print("daily_20171201 返回数据 row 行数 = "+str(daily_20171201.shape[0]))
daily_20171201_addname_dataframe.to_excel(daily_201712_excel_writer,'1_5',index=False)
daily_201712_excel_writer.save()
daily_20171202 = pro.daily(start_date='',end_date='',trade_date='20171202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171202_tscode_list = list() 
for ts_code_sh in daily_20171202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171202_tscode_list.append(stock_name)
daily_20171202_addname_dataframe=pd.DataFrame()
daily_20171202_addname_dataframe['cname'] = daily_20171202_tscode_list
for table_name in daily_20171202.columns.values.tolist():
    daily_20171202_addname_dataframe[table_name] = daily_20171202[table_name]
print("daily_20171202 返回数据 row 行数 = "+str(daily_20171202.shape[0]))
daily_20171202_addname_dataframe.to_excel(daily_201712_excel_writer,'2_6',index=False)
daily_201712_excel_writer.save()
daily_20171203 = pro.daily(start_date='',end_date='',trade_date='20171203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171203_tscode_list = list() 
for ts_code_sh in daily_20171203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171203_tscode_list.append(stock_name)
daily_20171203_addname_dataframe=pd.DataFrame()
daily_20171203_addname_dataframe['cname'] = daily_20171203_tscode_list
for table_name in daily_20171203.columns.values.tolist():
    daily_20171203_addname_dataframe[table_name] = daily_20171203[table_name]
print("daily_20171203 返回数据 row 行数 = "+str(daily_20171203.shape[0]))
daily_20171203_addname_dataframe.to_excel(daily_201712_excel_writer,'3_7',index=False)
daily_201712_excel_writer.save()
daily_20171204 = pro.daily(start_date='',end_date='',trade_date='20171204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171204_tscode_list = list() 
for ts_code_sh in daily_20171204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171204_tscode_list.append(stock_name)
daily_20171204_addname_dataframe=pd.DataFrame()
daily_20171204_addname_dataframe['cname'] = daily_20171204_tscode_list
for table_name in daily_20171204.columns.values.tolist():
    daily_20171204_addname_dataframe[table_name] = daily_20171204[table_name]
print("daily_20171204 返回数据 row 行数 = "+str(daily_20171204.shape[0]))
daily_20171204_addname_dataframe.to_excel(daily_201712_excel_writer,'4_1',index=False)
daily_201712_excel_writer.save()
daily_20171205 = pro.daily(start_date='',end_date='',trade_date='20171205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171205_tscode_list = list() 
for ts_code_sh in daily_20171205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171205_tscode_list.append(stock_name)
daily_20171205_addname_dataframe=pd.DataFrame()
daily_20171205_addname_dataframe['cname'] = daily_20171205_tscode_list
for table_name in daily_20171205.columns.values.tolist():
    daily_20171205_addname_dataframe[table_name] = daily_20171205[table_name]
print("daily_20171205 返回数据 row 行数 = "+str(daily_20171205.shape[0]))
daily_20171205_addname_dataframe.to_excel(daily_201712_excel_writer,'5_2',index=False)
daily_201712_excel_writer.save()
daily_20171206 = pro.daily(start_date='',end_date='',trade_date='20171206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171206_tscode_list = list() 
for ts_code_sh in daily_20171206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171206_tscode_list.append(stock_name)
daily_20171206_addname_dataframe=pd.DataFrame()
daily_20171206_addname_dataframe['cname'] = daily_20171206_tscode_list
for table_name in daily_20171206.columns.values.tolist():
    daily_20171206_addname_dataframe[table_name] = daily_20171206[table_name]
print("daily_20171206 返回数据 row 行数 = "+str(daily_20171206.shape[0]))
daily_20171206_addname_dataframe.to_excel(daily_201712_excel_writer,'6_3',index=False)
daily_201712_excel_writer.save()
daily_20171207 = pro.daily(start_date='',end_date='',trade_date='20171207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171207_tscode_list = list() 
for ts_code_sh in daily_20171207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171207_tscode_list.append(stock_name)
daily_20171207_addname_dataframe=pd.DataFrame()
daily_20171207_addname_dataframe['cname'] = daily_20171207_tscode_list
for table_name in daily_20171207.columns.values.tolist():
    daily_20171207_addname_dataframe[table_name] = daily_20171207[table_name]
print("daily_20171207 返回数据 row 行数 = "+str(daily_20171207.shape[0]))
daily_20171207_addname_dataframe.to_excel(daily_201712_excel_writer,'7_4',index=False)
daily_201712_excel_writer.save()
daily_20171208 = pro.daily(start_date='',end_date='',trade_date='20171208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171208_tscode_list = list() 
for ts_code_sh in daily_20171208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171208_tscode_list.append(stock_name)
daily_20171208_addname_dataframe=pd.DataFrame()
daily_20171208_addname_dataframe['cname'] = daily_20171208_tscode_list
for table_name in daily_20171208.columns.values.tolist():
    daily_20171208_addname_dataframe[table_name] = daily_20171208[table_name]
print("daily_20171208 返回数据 row 行数 = "+str(daily_20171208.shape[0]))
daily_20171208_addname_dataframe.to_excel(daily_201712_excel_writer,'8_5',index=False)
daily_201712_excel_writer.save()
daily_20171209 = pro.daily(start_date='',end_date='',trade_date='20171209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171209_tscode_list = list() 
for ts_code_sh in daily_20171209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171209_tscode_list.append(stock_name)
daily_20171209_addname_dataframe=pd.DataFrame()
daily_20171209_addname_dataframe['cname'] = daily_20171209_tscode_list
for table_name in daily_20171209.columns.values.tolist():
    daily_20171209_addname_dataframe[table_name] = daily_20171209[table_name]
print("daily_20171209 返回数据 row 行数 = "+str(daily_20171209.shape[0]))
daily_20171209_addname_dataframe.to_excel(daily_201712_excel_writer,'9_6',index=False)
daily_201712_excel_writer.save()
daily_20171210 = pro.daily(start_date='',end_date='',trade_date='20171210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171210_tscode_list = list() 
for ts_code_sh in daily_20171210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171210_tscode_list.append(stock_name)
daily_20171210_addname_dataframe=pd.DataFrame()
daily_20171210_addname_dataframe['cname'] = daily_20171210_tscode_list
for table_name in daily_20171210.columns.values.tolist():
    daily_20171210_addname_dataframe[table_name] = daily_20171210[table_name]
print("daily_20171210 返回数据 row 行数 = "+str(daily_20171210.shape[0]))
daily_20171210_addname_dataframe.to_excel(daily_201712_excel_writer,'10_7',index=False)
daily_201712_excel_writer.save()
daily_20171211 = pro.daily(start_date='',end_date='',trade_date='20171211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171211_tscode_list = list() 
for ts_code_sh in daily_20171211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171211_tscode_list.append(stock_name)
daily_20171211_addname_dataframe=pd.DataFrame()
daily_20171211_addname_dataframe['cname'] = daily_20171211_tscode_list
for table_name in daily_20171211.columns.values.tolist():
    daily_20171211_addname_dataframe[table_name] = daily_20171211[table_name]
print("daily_20171211 返回数据 row 行数 = "+str(daily_20171211.shape[0]))
daily_20171211_addname_dataframe.to_excel(daily_201712_excel_writer,'11_1',index=False)
daily_201712_excel_writer.save()
daily_20171212 = pro.daily(start_date='',end_date='',trade_date='20171212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171212_tscode_list = list() 
for ts_code_sh in daily_20171212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171212_tscode_list.append(stock_name)
daily_20171212_addname_dataframe=pd.DataFrame()
daily_20171212_addname_dataframe['cname'] = daily_20171212_tscode_list
for table_name in daily_20171212.columns.values.tolist():
    daily_20171212_addname_dataframe[table_name] = daily_20171212[table_name]
print("daily_20171212 返回数据 row 行数 = "+str(daily_20171212.shape[0]))
daily_20171212_addname_dataframe.to_excel(daily_201712_excel_writer,'12_2',index=False)
daily_201712_excel_writer.save()
daily_20171213 = pro.daily(start_date='',end_date='',trade_date='20171213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171213_tscode_list = list() 
for ts_code_sh in daily_20171213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171213_tscode_list.append(stock_name)
daily_20171213_addname_dataframe=pd.DataFrame()
daily_20171213_addname_dataframe['cname'] = daily_20171213_tscode_list
for table_name in daily_20171213.columns.values.tolist():
    daily_20171213_addname_dataframe[table_name] = daily_20171213[table_name]
print("daily_20171213 返回数据 row 行数 = "+str(daily_20171213.shape[0]))
daily_20171213_addname_dataframe.to_excel(daily_201712_excel_writer,'13_3',index=False)
daily_201712_excel_writer.save()
daily_20171214 = pro.daily(start_date='',end_date='',trade_date='20171214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171214_tscode_list = list() 
for ts_code_sh in daily_20171214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171214_tscode_list.append(stock_name)
daily_20171214_addname_dataframe=pd.DataFrame()
daily_20171214_addname_dataframe['cname'] = daily_20171214_tscode_list
for table_name in daily_20171214.columns.values.tolist():
    daily_20171214_addname_dataframe[table_name] = daily_20171214[table_name]
print("daily_20171214 返回数据 row 行数 = "+str(daily_20171214.shape[0]))
daily_20171214_addname_dataframe.to_excel(daily_201712_excel_writer,'14_4',index=False)
daily_201712_excel_writer.save()
daily_20171215 = pro.daily(start_date='',end_date='',trade_date='20171215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171215_tscode_list = list() 
for ts_code_sh in daily_20171215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171215_tscode_list.append(stock_name)
daily_20171215_addname_dataframe=pd.DataFrame()
daily_20171215_addname_dataframe['cname'] = daily_20171215_tscode_list
for table_name in daily_20171215.columns.values.tolist():
    daily_20171215_addname_dataframe[table_name] = daily_20171215[table_name]
print("daily_20171215 返回数据 row 行数 = "+str(daily_20171215.shape[0]))
daily_20171215_addname_dataframe.to_excel(daily_201712_excel_writer,'15_5',index=False)
daily_201712_excel_writer.save()
daily_20171216 = pro.daily(start_date='',end_date='',trade_date='20171216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171216_tscode_list = list() 
for ts_code_sh in daily_20171216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171216_tscode_list.append(stock_name)
daily_20171216_addname_dataframe=pd.DataFrame()
daily_20171216_addname_dataframe['cname'] = daily_20171216_tscode_list
for table_name in daily_20171216.columns.values.tolist():
    daily_20171216_addname_dataframe[table_name] = daily_20171216[table_name]
print("daily_20171216 返回数据 row 行数 = "+str(daily_20171216.shape[0]))
daily_20171216_addname_dataframe.to_excel(daily_201712_excel_writer,'16_6',index=False)
daily_201712_excel_writer.save()
daily_20171217 = pro.daily(start_date='',end_date='',trade_date='20171217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171217_tscode_list = list() 
for ts_code_sh in daily_20171217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171217_tscode_list.append(stock_name)
daily_20171217_addname_dataframe=pd.DataFrame()
daily_20171217_addname_dataframe['cname'] = daily_20171217_tscode_list
for table_name in daily_20171217.columns.values.tolist():
    daily_20171217_addname_dataframe[table_name] = daily_20171217[table_name]
print("daily_20171217 返回数据 row 行数 = "+str(daily_20171217.shape[0]))
daily_20171217_addname_dataframe.to_excel(daily_201712_excel_writer,'17_7',index=False)
daily_201712_excel_writer.save()
daily_20171218 = pro.daily(start_date='',end_date='',trade_date='20171218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171218_tscode_list = list() 
for ts_code_sh in daily_20171218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171218_tscode_list.append(stock_name)
daily_20171218_addname_dataframe=pd.DataFrame()
daily_20171218_addname_dataframe['cname'] = daily_20171218_tscode_list
for table_name in daily_20171218.columns.values.tolist():
    daily_20171218_addname_dataframe[table_name] = daily_20171218[table_name]
print("daily_20171218 返回数据 row 行数 = "+str(daily_20171218.shape[0]))
daily_20171218_addname_dataframe.to_excel(daily_201712_excel_writer,'18_1',index=False)
daily_201712_excel_writer.save()
daily_20171219 = pro.daily(start_date='',end_date='',trade_date='20171219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171219_tscode_list = list() 
for ts_code_sh in daily_20171219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171219_tscode_list.append(stock_name)
daily_20171219_addname_dataframe=pd.DataFrame()
daily_20171219_addname_dataframe['cname'] = daily_20171219_tscode_list
for table_name in daily_20171219.columns.values.tolist():
    daily_20171219_addname_dataframe[table_name] = daily_20171219[table_name]
print("daily_20171219 返回数据 row 行数 = "+str(daily_20171219.shape[0]))
daily_20171219_addname_dataframe.to_excel(daily_201712_excel_writer,'19_2',index=False)
daily_201712_excel_writer.save()
daily_20171220 = pro.daily(start_date='',end_date='',trade_date='20171220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171220_tscode_list = list() 
for ts_code_sh in daily_20171220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171220_tscode_list.append(stock_name)
daily_20171220_addname_dataframe=pd.DataFrame()
daily_20171220_addname_dataframe['cname'] = daily_20171220_tscode_list
for table_name in daily_20171220.columns.values.tolist():
    daily_20171220_addname_dataframe[table_name] = daily_20171220[table_name]
print("daily_20171220 返回数据 row 行数 = "+str(daily_20171220.shape[0]))
daily_20171220_addname_dataframe.to_excel(daily_201712_excel_writer,'20_3',index=False)
daily_201712_excel_writer.save()
daily_20171221 = pro.daily(start_date='',end_date='',trade_date='20171221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171221_tscode_list = list() 
for ts_code_sh in daily_20171221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171221_tscode_list.append(stock_name)
daily_20171221_addname_dataframe=pd.DataFrame()
daily_20171221_addname_dataframe['cname'] = daily_20171221_tscode_list
for table_name in daily_20171221.columns.values.tolist():
    daily_20171221_addname_dataframe[table_name] = daily_20171221[table_name]
print("daily_20171221 返回数据 row 行数 = "+str(daily_20171221.shape[0]))
daily_20171221_addname_dataframe.to_excel(daily_201712_excel_writer,'21_4',index=False)
daily_201712_excel_writer.save()
daily_20171222 = pro.daily(start_date='',end_date='',trade_date='20171222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171222_tscode_list = list() 
for ts_code_sh in daily_20171222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171222_tscode_list.append(stock_name)
daily_20171222_addname_dataframe=pd.DataFrame()
daily_20171222_addname_dataframe['cname'] = daily_20171222_tscode_list
for table_name in daily_20171222.columns.values.tolist():
    daily_20171222_addname_dataframe[table_name] = daily_20171222[table_name]
print("daily_20171222 返回数据 row 行数 = "+str(daily_20171222.shape[0]))
daily_20171222_addname_dataframe.to_excel(daily_201712_excel_writer,'22_5',index=False)
daily_201712_excel_writer.save()
daily_20171223 = pro.daily(start_date='',end_date='',trade_date='20171223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171223_tscode_list = list() 
for ts_code_sh in daily_20171223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171223_tscode_list.append(stock_name)
daily_20171223_addname_dataframe=pd.DataFrame()
daily_20171223_addname_dataframe['cname'] = daily_20171223_tscode_list
for table_name in daily_20171223.columns.values.tolist():
    daily_20171223_addname_dataframe[table_name] = daily_20171223[table_name]
print("daily_20171223 返回数据 row 行数 = "+str(daily_20171223.shape[0]))
daily_20171223_addname_dataframe.to_excel(daily_201712_excel_writer,'23_6',index=False)
daily_201712_excel_writer.save()
daily_20171224 = pro.daily(start_date='',end_date='',trade_date='20171224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171224_tscode_list = list() 
for ts_code_sh in daily_20171224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171224_tscode_list.append(stock_name)
daily_20171224_addname_dataframe=pd.DataFrame()
daily_20171224_addname_dataframe['cname'] = daily_20171224_tscode_list
for table_name in daily_20171224.columns.values.tolist():
    daily_20171224_addname_dataframe[table_name] = daily_20171224[table_name]
print("daily_20171224 返回数据 row 行数 = "+str(daily_20171224.shape[0]))
daily_20171224_addname_dataframe.to_excel(daily_201712_excel_writer,'24_7',index=False)
daily_201712_excel_writer.save()
daily_20171225 = pro.daily(start_date='',end_date='',trade_date='20171225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171225_tscode_list = list() 
for ts_code_sh in daily_20171225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171225_tscode_list.append(stock_name)
daily_20171225_addname_dataframe=pd.DataFrame()
daily_20171225_addname_dataframe['cname'] = daily_20171225_tscode_list
for table_name in daily_20171225.columns.values.tolist():
    daily_20171225_addname_dataframe[table_name] = daily_20171225[table_name]
print("daily_20171225 返回数据 row 行数 = "+str(daily_20171225.shape[0]))
daily_20171225_addname_dataframe.to_excel(daily_201712_excel_writer,'25_1',index=False)
daily_201712_excel_writer.save()
daily_20171226 = pro.daily(start_date='',end_date='',trade_date='20171226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171226_tscode_list = list() 
for ts_code_sh in daily_20171226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171226_tscode_list.append(stock_name)
daily_20171226_addname_dataframe=pd.DataFrame()
daily_20171226_addname_dataframe['cname'] = daily_20171226_tscode_list
for table_name in daily_20171226.columns.values.tolist():
    daily_20171226_addname_dataframe[table_name] = daily_20171226[table_name]
print("daily_20171226 返回数据 row 行数 = "+str(daily_20171226.shape[0]))
daily_20171226_addname_dataframe.to_excel(daily_201712_excel_writer,'26_2',index=False)
daily_201712_excel_writer.save()
daily_20171227 = pro.daily(start_date='',end_date='',trade_date='20171227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171227_tscode_list = list() 
for ts_code_sh in daily_20171227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171227_tscode_list.append(stock_name)
daily_20171227_addname_dataframe=pd.DataFrame()
daily_20171227_addname_dataframe['cname'] = daily_20171227_tscode_list
for table_name in daily_20171227.columns.values.tolist():
    daily_20171227_addname_dataframe[table_name] = daily_20171227[table_name]
print("daily_20171227 返回数据 row 行数 = "+str(daily_20171227.shape[0]))
daily_20171227_addname_dataframe.to_excel(daily_201712_excel_writer,'27_3',index=False)
daily_201712_excel_writer.save()
daily_20171228 = pro.daily(start_date='',end_date='',trade_date='20171228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171228_tscode_list = list() 
for ts_code_sh in daily_20171228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171228_tscode_list.append(stock_name)
daily_20171228_addname_dataframe=pd.DataFrame()
daily_20171228_addname_dataframe['cname'] = daily_20171228_tscode_list
for table_name in daily_20171228.columns.values.tolist():
    daily_20171228_addname_dataframe[table_name] = daily_20171228[table_name]
print("daily_20171228 返回数据 row 行数 = "+str(daily_20171228.shape[0]))
daily_20171228_addname_dataframe.to_excel(daily_201712_excel_writer,'28_4',index=False)
daily_201712_excel_writer.save()
daily_20171229 = pro.daily(start_date='',end_date='',trade_date='20171229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171229_tscode_list = list() 
for ts_code_sh in daily_20171229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171229_tscode_list.append(stock_name)
daily_20171229_addname_dataframe=pd.DataFrame()
daily_20171229_addname_dataframe['cname'] = daily_20171229_tscode_list
for table_name in daily_20171229.columns.values.tolist():
    daily_20171229_addname_dataframe[table_name] = daily_20171229[table_name]
print("daily_20171229 返回数据 row 行数 = "+str(daily_20171229.shape[0]))
daily_20171229_addname_dataframe.to_excel(daily_201712_excel_writer,'29_5',index=False)
daily_201712_excel_writer.save()
daily_20171230 = pro.daily(start_date='',end_date='',trade_date='20171230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171230_tscode_list = list() 
for ts_code_sh in daily_20171230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171230_tscode_list.append(stock_name)
daily_20171230_addname_dataframe=pd.DataFrame()
daily_20171230_addname_dataframe['cname'] = daily_20171230_tscode_list
for table_name in daily_20171230.columns.values.tolist():
    daily_20171230_addname_dataframe[table_name] = daily_20171230[table_name]
print("daily_20171230 返回数据 row 行数 = "+str(daily_20171230.shape[0]))
daily_20171230_addname_dataframe.to_excel(daily_201712_excel_writer,'30_6',index=False)
daily_201712_excel_writer.save()
daily_20171231 = pro.daily(start_date='',end_date='',trade_date='20171231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171231_tscode_list = list() 
for ts_code_sh in daily_20171231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171231_tscode_list.append(stock_name)
daily_20171231_addname_dataframe=pd.DataFrame()
daily_20171231_addname_dataframe['cname'] = daily_20171231_tscode_list
for table_name in daily_20171231.columns.values.tolist():
    daily_20171231_addname_dataframe[table_name] = daily_20171231[table_name]
print("daily_20171231 返回数据 row 行数 = "+str(daily_20171231.shape[0]))
daily_20171231_addname_dataframe.to_excel(daily_201712_excel_writer,'31_7',index=False)
daily_201712_excel_writer.save()




createexcel('daily_201801.xlsx')
daily_201801_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201801.xlsx')
daily_201801_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201801.xlsx', engine='openpyxl')
daily_201801_excel_writer.book = daily_201801_book
daily_201801_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201801_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180101")       ###  更新 记录日期
daily_20180101 = pro.daily(start_date='',end_date='',trade_date='20180101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180101_tscode_list = list() 
for ts_code_sh in daily_20180101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180101_tscode_list.append(stock_name)
daily_20180101_addname_dataframe=pd.DataFrame()
daily_20180101_addname_dataframe['cname'] = daily_20180101_tscode_list
for table_name in daily_20180101.columns.values.tolist():
    daily_20180101_addname_dataframe[table_name] = daily_20180101[table_name]
print("daily_20180101 返回数据 row 行数 = "+str(daily_20180101.shape[0]))
daily_20180101_addname_dataframe.to_excel(daily_201801_excel_writer,'1_1',index=False)
daily_201801_excel_writer.save()
daily_20180102 = pro.daily(start_date='',end_date='',trade_date='20180102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180102_tscode_list = list() 
for ts_code_sh in daily_20180102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180102_tscode_list.append(stock_name)
daily_20180102_addname_dataframe=pd.DataFrame()
daily_20180102_addname_dataframe['cname'] = daily_20180102_tscode_list
for table_name in daily_20180102.columns.values.tolist():
    daily_20180102_addname_dataframe[table_name] = daily_20180102[table_name]
print("daily_20180102 返回数据 row 行数 = "+str(daily_20180102.shape[0]))
daily_20180102_addname_dataframe.to_excel(daily_201801_excel_writer,'2_2',index=False)
daily_201801_excel_writer.save()
daily_20180103 = pro.daily(start_date='',end_date='',trade_date='20180103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180103_tscode_list = list() 
for ts_code_sh in daily_20180103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180103_tscode_list.append(stock_name)
daily_20180103_addname_dataframe=pd.DataFrame()
daily_20180103_addname_dataframe['cname'] = daily_20180103_tscode_list
for table_name in daily_20180103.columns.values.tolist():
    daily_20180103_addname_dataframe[table_name] = daily_20180103[table_name]
print("daily_20180103 返回数据 row 行数 = "+str(daily_20180103.shape[0]))
daily_20180103_addname_dataframe.to_excel(daily_201801_excel_writer,'3_3',index=False)
daily_201801_excel_writer.save()
daily_20180104 = pro.daily(start_date='',end_date='',trade_date='20180104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180104_tscode_list = list() 
for ts_code_sh in daily_20180104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180104_tscode_list.append(stock_name)
daily_20180104_addname_dataframe=pd.DataFrame()
daily_20180104_addname_dataframe['cname'] = daily_20180104_tscode_list
for table_name in daily_20180104.columns.values.tolist():
    daily_20180104_addname_dataframe[table_name] = daily_20180104[table_name]
print("daily_20180104 返回数据 row 行数 = "+str(daily_20180104.shape[0]))
daily_20180104_addname_dataframe.to_excel(daily_201801_excel_writer,'4_4',index=False)
daily_201801_excel_writer.save()
daily_20180105 = pro.daily(start_date='',end_date='',trade_date='20180105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180105_tscode_list = list() 
for ts_code_sh in daily_20180105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180105_tscode_list.append(stock_name)
daily_20180105_addname_dataframe=pd.DataFrame()
daily_20180105_addname_dataframe['cname'] = daily_20180105_tscode_list
for table_name in daily_20180105.columns.values.tolist():
    daily_20180105_addname_dataframe[table_name] = daily_20180105[table_name]
print("daily_20180105 返回数据 row 行数 = "+str(daily_20180105.shape[0]))
daily_20180105_addname_dataframe.to_excel(daily_201801_excel_writer,'5_5',index=False)
daily_201801_excel_writer.save()
daily_20180106 = pro.daily(start_date='',end_date='',trade_date='20180106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180106_tscode_list = list() 
for ts_code_sh in daily_20180106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180106_tscode_list.append(stock_name)
daily_20180106_addname_dataframe=pd.DataFrame()
daily_20180106_addname_dataframe['cname'] = daily_20180106_tscode_list
for table_name in daily_20180106.columns.values.tolist():
    daily_20180106_addname_dataframe[table_name] = daily_20180106[table_name]
print("daily_20180106 返回数据 row 行数 = "+str(daily_20180106.shape[0]))
daily_20180106_addname_dataframe.to_excel(daily_201801_excel_writer,'6_6',index=False)
daily_201801_excel_writer.save()
daily_20180107 = pro.daily(start_date='',end_date='',trade_date='20180107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180107_tscode_list = list() 
for ts_code_sh in daily_20180107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180107_tscode_list.append(stock_name)
daily_20180107_addname_dataframe=pd.DataFrame()
daily_20180107_addname_dataframe['cname'] = daily_20180107_tscode_list
for table_name in daily_20180107.columns.values.tolist():
    daily_20180107_addname_dataframe[table_name] = daily_20180107[table_name]
print("daily_20180107 返回数据 row 行数 = "+str(daily_20180107.shape[0]))
daily_20180107_addname_dataframe.to_excel(daily_201801_excel_writer,'7_7',index=False)
daily_201801_excel_writer.save()
daily_20180108 = pro.daily(start_date='',end_date='',trade_date='20180108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180108_tscode_list = list() 
for ts_code_sh in daily_20180108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180108_tscode_list.append(stock_name)
daily_20180108_addname_dataframe=pd.DataFrame()
daily_20180108_addname_dataframe['cname'] = daily_20180108_tscode_list
for table_name in daily_20180108.columns.values.tolist():
    daily_20180108_addname_dataframe[table_name] = daily_20180108[table_name]
print("daily_20180108 返回数据 row 行数 = "+str(daily_20180108.shape[0]))
daily_20180108_addname_dataframe.to_excel(daily_201801_excel_writer,'8_1',index=False)
daily_201801_excel_writer.save()
daily_20180109 = pro.daily(start_date='',end_date='',trade_date='20180109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180109_tscode_list = list() 
for ts_code_sh in daily_20180109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180109_tscode_list.append(stock_name)
daily_20180109_addname_dataframe=pd.DataFrame()
daily_20180109_addname_dataframe['cname'] = daily_20180109_tscode_list
for table_name in daily_20180109.columns.values.tolist():
    daily_20180109_addname_dataframe[table_name] = daily_20180109[table_name]
print("daily_20180109 返回数据 row 行数 = "+str(daily_20180109.shape[0]))
daily_20180109_addname_dataframe.to_excel(daily_201801_excel_writer,'9_2',index=False)
daily_201801_excel_writer.save()
daily_20180110 = pro.daily(start_date='',end_date='',trade_date='20180110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180110_tscode_list = list() 
for ts_code_sh in daily_20180110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180110_tscode_list.append(stock_name)
daily_20180110_addname_dataframe=pd.DataFrame()
daily_20180110_addname_dataframe['cname'] = daily_20180110_tscode_list
for table_name in daily_20180110.columns.values.tolist():
    daily_20180110_addname_dataframe[table_name] = daily_20180110[table_name]
print("daily_20180110 返回数据 row 行数 = "+str(daily_20180110.shape[0]))
daily_20180110_addname_dataframe.to_excel(daily_201801_excel_writer,'10_3',index=False)
daily_201801_excel_writer.save()
daily_20180111 = pro.daily(start_date='',end_date='',trade_date='20180111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180111_tscode_list = list() 
for ts_code_sh in daily_20180111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180111_tscode_list.append(stock_name)
daily_20180111_addname_dataframe=pd.DataFrame()
daily_20180111_addname_dataframe['cname'] = daily_20180111_tscode_list
for table_name in daily_20180111.columns.values.tolist():
    daily_20180111_addname_dataframe[table_name] = daily_20180111[table_name]
print("daily_20180111 返回数据 row 行数 = "+str(daily_20180111.shape[0]))
daily_20180111_addname_dataframe.to_excel(daily_201801_excel_writer,'11_4',index=False)
daily_201801_excel_writer.save()
daily_20180112 = pro.daily(start_date='',end_date='',trade_date='20180112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180112_tscode_list = list() 
for ts_code_sh in daily_20180112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180112_tscode_list.append(stock_name)
daily_20180112_addname_dataframe=pd.DataFrame()
daily_20180112_addname_dataframe['cname'] = daily_20180112_tscode_list
for table_name in daily_20180112.columns.values.tolist():
    daily_20180112_addname_dataframe[table_name] = daily_20180112[table_name]
print("daily_20180112 返回数据 row 行数 = "+str(daily_20180112.shape[0]))
daily_20180112_addname_dataframe.to_excel(daily_201801_excel_writer,'12_5',index=False)
daily_201801_excel_writer.save()
daily_20180113 = pro.daily(start_date='',end_date='',trade_date='20180113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180113_tscode_list = list() 
for ts_code_sh in daily_20180113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180113_tscode_list.append(stock_name)
daily_20180113_addname_dataframe=pd.DataFrame()
daily_20180113_addname_dataframe['cname'] = daily_20180113_tscode_list
for table_name in daily_20180113.columns.values.tolist():
    daily_20180113_addname_dataframe[table_name] = daily_20180113[table_name]
print("daily_20180113 返回数据 row 行数 = "+str(daily_20180113.shape[0]))
daily_20180113_addname_dataframe.to_excel(daily_201801_excel_writer,'13_6',index=False)
daily_201801_excel_writer.save()
daily_20180114 = pro.daily(start_date='',end_date='',trade_date='20180114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180114_tscode_list = list() 
for ts_code_sh in daily_20180114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180114_tscode_list.append(stock_name)
daily_20180114_addname_dataframe=pd.DataFrame()
daily_20180114_addname_dataframe['cname'] = daily_20180114_tscode_list
for table_name in daily_20180114.columns.values.tolist():
    daily_20180114_addname_dataframe[table_name] = daily_20180114[table_name]
print("daily_20180114 返回数据 row 行数 = "+str(daily_20180114.shape[0]))
daily_20180114_addname_dataframe.to_excel(daily_201801_excel_writer,'14_7',index=False)
daily_201801_excel_writer.save()
daily_20180115 = pro.daily(start_date='',end_date='',trade_date='20180115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180115_tscode_list = list() 
for ts_code_sh in daily_20180115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180115_tscode_list.append(stock_name)
daily_20180115_addname_dataframe=pd.DataFrame()
daily_20180115_addname_dataframe['cname'] = daily_20180115_tscode_list
for table_name in daily_20180115.columns.values.tolist():
    daily_20180115_addname_dataframe[table_name] = daily_20180115[table_name]
print("daily_20180115 返回数据 row 行数 = "+str(daily_20180115.shape[0]))
daily_20180115_addname_dataframe.to_excel(daily_201801_excel_writer,'15_1',index=False)
daily_201801_excel_writer.save()
daily_20180116 = pro.daily(start_date='',end_date='',trade_date='20180116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180116_tscode_list = list() 
for ts_code_sh in daily_20180116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180116_tscode_list.append(stock_name)
daily_20180116_addname_dataframe=pd.DataFrame()
daily_20180116_addname_dataframe['cname'] = daily_20180116_tscode_list
for table_name in daily_20180116.columns.values.tolist():
    daily_20180116_addname_dataframe[table_name] = daily_20180116[table_name]
print("daily_20180116 返回数据 row 行数 = "+str(daily_20180116.shape[0]))
daily_20180116_addname_dataframe.to_excel(daily_201801_excel_writer,'16_2',index=False)
daily_201801_excel_writer.save()
daily_20180117 = pro.daily(start_date='',end_date='',trade_date='20180117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180117_tscode_list = list() 
for ts_code_sh in daily_20180117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180117_tscode_list.append(stock_name)
daily_20180117_addname_dataframe=pd.DataFrame()
daily_20180117_addname_dataframe['cname'] = daily_20180117_tscode_list
for table_name in daily_20180117.columns.values.tolist():
    daily_20180117_addname_dataframe[table_name] = daily_20180117[table_name]
print("daily_20180117 返回数据 row 行数 = "+str(daily_20180117.shape[0]))
daily_20180117_addname_dataframe.to_excel(daily_201801_excel_writer,'17_3',index=False)
daily_201801_excel_writer.save()
daily_20180118 = pro.daily(start_date='',end_date='',trade_date='20180118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180118_tscode_list = list() 
for ts_code_sh in daily_20180118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180118_tscode_list.append(stock_name)
daily_20180118_addname_dataframe=pd.DataFrame()
daily_20180118_addname_dataframe['cname'] = daily_20180118_tscode_list
for table_name in daily_20180118.columns.values.tolist():
    daily_20180118_addname_dataframe[table_name] = daily_20180118[table_name]
print("daily_20180118 返回数据 row 行数 = "+str(daily_20180118.shape[0]))
daily_20180118_addname_dataframe.to_excel(daily_201801_excel_writer,'18_4',index=False)
daily_201801_excel_writer.save()
daily_20180119 = pro.daily(start_date='',end_date='',trade_date='20180119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180119_tscode_list = list() 
for ts_code_sh in daily_20180119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180119_tscode_list.append(stock_name)
daily_20180119_addname_dataframe=pd.DataFrame()
daily_20180119_addname_dataframe['cname'] = daily_20180119_tscode_list
for table_name in daily_20180119.columns.values.tolist():
    daily_20180119_addname_dataframe[table_name] = daily_20180119[table_name]
print("daily_20180119 返回数据 row 行数 = "+str(daily_20180119.shape[0]))
daily_20180119_addname_dataframe.to_excel(daily_201801_excel_writer,'19_5',index=False)
daily_201801_excel_writer.save()
daily_20180120 = pro.daily(start_date='',end_date='',trade_date='20180120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180120_tscode_list = list() 
for ts_code_sh in daily_20180120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180120_tscode_list.append(stock_name)
daily_20180120_addname_dataframe=pd.DataFrame()
daily_20180120_addname_dataframe['cname'] = daily_20180120_tscode_list
for table_name in daily_20180120.columns.values.tolist():
    daily_20180120_addname_dataframe[table_name] = daily_20180120[table_name]
print("daily_20180120 返回数据 row 行数 = "+str(daily_20180120.shape[0]))
daily_20180120_addname_dataframe.to_excel(daily_201801_excel_writer,'20_6',index=False)
daily_201801_excel_writer.save()
daily_20180121 = pro.daily(start_date='',end_date='',trade_date='20180121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180121_tscode_list = list() 
for ts_code_sh in daily_20180121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180121_tscode_list.append(stock_name)
daily_20180121_addname_dataframe=pd.DataFrame()
daily_20180121_addname_dataframe['cname'] = daily_20180121_tscode_list
for table_name in daily_20180121.columns.values.tolist():
    daily_20180121_addname_dataframe[table_name] = daily_20180121[table_name]
print("daily_20180121 返回数据 row 行数 = "+str(daily_20180121.shape[0]))
daily_20180121_addname_dataframe.to_excel(daily_201801_excel_writer,'21_7',index=False)
daily_201801_excel_writer.save()
daily_20180122 = pro.daily(start_date='',end_date='',trade_date='20180122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180122_tscode_list = list() 
for ts_code_sh in daily_20180122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180122_tscode_list.append(stock_name)
daily_20180122_addname_dataframe=pd.DataFrame()
daily_20180122_addname_dataframe['cname'] = daily_20180122_tscode_list
for table_name in daily_20180122.columns.values.tolist():
    daily_20180122_addname_dataframe[table_name] = daily_20180122[table_name]
print("daily_20180122 返回数据 row 行数 = "+str(daily_20180122.shape[0]))
daily_20180122_addname_dataframe.to_excel(daily_201801_excel_writer,'22_1',index=False)
daily_201801_excel_writer.save()
daily_20180123 = pro.daily(start_date='',end_date='',trade_date='20180123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180123_tscode_list = list() 
for ts_code_sh in daily_20180123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180123_tscode_list.append(stock_name)
daily_20180123_addname_dataframe=pd.DataFrame()
daily_20180123_addname_dataframe['cname'] = daily_20180123_tscode_list
for table_name in daily_20180123.columns.values.tolist():
    daily_20180123_addname_dataframe[table_name] = daily_20180123[table_name]
print("daily_20180123 返回数据 row 行数 = "+str(daily_20180123.shape[0]))
daily_20180123_addname_dataframe.to_excel(daily_201801_excel_writer,'23_2',index=False)
daily_201801_excel_writer.save()
daily_20180124 = pro.daily(start_date='',end_date='',trade_date='20180124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180124_tscode_list = list() 
for ts_code_sh in daily_20180124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180124_tscode_list.append(stock_name)
daily_20180124_addname_dataframe=pd.DataFrame()
daily_20180124_addname_dataframe['cname'] = daily_20180124_tscode_list
for table_name in daily_20180124.columns.values.tolist():
    daily_20180124_addname_dataframe[table_name] = daily_20180124[table_name]
print("daily_20180124 返回数据 row 行数 = "+str(daily_20180124.shape[0]))
daily_20180124_addname_dataframe.to_excel(daily_201801_excel_writer,'24_3',index=False)
daily_201801_excel_writer.save()
daily_20180125 = pro.daily(start_date='',end_date='',trade_date='20180125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180125_tscode_list = list() 
for ts_code_sh in daily_20180125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180125_tscode_list.append(stock_name)
daily_20180125_addname_dataframe=pd.DataFrame()
daily_20180125_addname_dataframe['cname'] = daily_20180125_tscode_list
for table_name in daily_20180125.columns.values.tolist():
    daily_20180125_addname_dataframe[table_name] = daily_20180125[table_name]
print("daily_20180125 返回数据 row 行数 = "+str(daily_20180125.shape[0]))
daily_20180125_addname_dataframe.to_excel(daily_201801_excel_writer,'25_4',index=False)
daily_201801_excel_writer.save()
daily_20180126 = pro.daily(start_date='',end_date='',trade_date='20180126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180126_tscode_list = list() 
for ts_code_sh in daily_20180126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180126_tscode_list.append(stock_name)
daily_20180126_addname_dataframe=pd.DataFrame()
daily_20180126_addname_dataframe['cname'] = daily_20180126_tscode_list
for table_name in daily_20180126.columns.values.tolist():
    daily_20180126_addname_dataframe[table_name] = daily_20180126[table_name]
print("daily_20180126 返回数据 row 行数 = "+str(daily_20180126.shape[0]))
daily_20180126_addname_dataframe.to_excel(daily_201801_excel_writer,'26_5',index=False)
daily_201801_excel_writer.save()
daily_20180127 = pro.daily(start_date='',end_date='',trade_date='20180127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180127_tscode_list = list() 
for ts_code_sh in daily_20180127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180127_tscode_list.append(stock_name)
daily_20180127_addname_dataframe=pd.DataFrame()
daily_20180127_addname_dataframe['cname'] = daily_20180127_tscode_list
for table_name in daily_20180127.columns.values.tolist():
    daily_20180127_addname_dataframe[table_name] = daily_20180127[table_name]
print("daily_20180127 返回数据 row 行数 = "+str(daily_20180127.shape[0]))
daily_20180127_addname_dataframe.to_excel(daily_201801_excel_writer,'27_6',index=False)
daily_201801_excel_writer.save()
daily_20180128 = pro.daily(start_date='',end_date='',trade_date='20180128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180128_tscode_list = list() 
for ts_code_sh in daily_20180128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180128_tscode_list.append(stock_name)
daily_20180128_addname_dataframe=pd.DataFrame()
daily_20180128_addname_dataframe['cname'] = daily_20180128_tscode_list
for table_name in daily_20180128.columns.values.tolist():
    daily_20180128_addname_dataframe[table_name] = daily_20180128[table_name]
print("daily_20180128 返回数据 row 行数 = "+str(daily_20180128.shape[0]))
daily_20180128_addname_dataframe.to_excel(daily_201801_excel_writer,'28_7',index=False)
daily_201801_excel_writer.save()
daily_20180129 = pro.daily(start_date='',end_date='',trade_date='20180129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180129_tscode_list = list() 
for ts_code_sh in daily_20180129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180129_tscode_list.append(stock_name)
daily_20180129_addname_dataframe=pd.DataFrame()
daily_20180129_addname_dataframe['cname'] = daily_20180129_tscode_list
for table_name in daily_20180129.columns.values.tolist():
    daily_20180129_addname_dataframe[table_name] = daily_20180129[table_name]
print("daily_20180129 返回数据 row 行数 = "+str(daily_20180129.shape[0]))
daily_20180129_addname_dataframe.to_excel(daily_201801_excel_writer,'29_1',index=False)
daily_201801_excel_writer.save()
daily_20180130 = pro.daily(start_date='',end_date='',trade_date='20180130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180130_tscode_list = list() 
for ts_code_sh in daily_20180130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180130_tscode_list.append(stock_name)
daily_20180130_addname_dataframe=pd.DataFrame()
daily_20180130_addname_dataframe['cname'] = daily_20180130_tscode_list
for table_name in daily_20180130.columns.values.tolist():
    daily_20180130_addname_dataframe[table_name] = daily_20180130[table_name]
print("daily_20180130 返回数据 row 行数 = "+str(daily_20180130.shape[0]))
daily_20180130_addname_dataframe.to_excel(daily_201801_excel_writer,'30_2',index=False)
daily_201801_excel_writer.save()
daily_20180131 = pro.daily(start_date='',end_date='',trade_date='20180131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180131_tscode_list = list() 
for ts_code_sh in daily_20180131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180131_tscode_list.append(stock_name)
daily_20180131_addname_dataframe=pd.DataFrame()
daily_20180131_addname_dataframe['cname'] = daily_20180131_tscode_list
for table_name in daily_20180131.columns.values.tolist():
    daily_20180131_addname_dataframe[table_name] = daily_20180131[table_name]
print("daily_20180131 返回数据 row 行数 = "+str(daily_20180131.shape[0]))
daily_20180131_addname_dataframe.to_excel(daily_201801_excel_writer,'31_3',index=False)
daily_201801_excel_writer.save()




createexcel('daily_201802.xlsx')
daily_201802_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201802.xlsx')
daily_201802_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201802.xlsx', engine='openpyxl')
daily_201802_excel_writer.book = daily_201802_book
daily_201802_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201802_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180201")       ###  更新 记录日期
daily_20180201 = pro.daily(start_date='',end_date='',trade_date='20180201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180201_tscode_list = list() 
for ts_code_sh in daily_20180201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180201_tscode_list.append(stock_name)
daily_20180201_addname_dataframe=pd.DataFrame()
daily_20180201_addname_dataframe['cname'] = daily_20180201_tscode_list
for table_name in daily_20180201.columns.values.tolist():
    daily_20180201_addname_dataframe[table_name] = daily_20180201[table_name]
print("daily_20180201 返回数据 row 行数 = "+str(daily_20180201.shape[0]))
daily_20180201_addname_dataframe.to_excel(daily_201802_excel_writer,'1_4',index=False)
daily_201802_excel_writer.save()
daily_20180202 = pro.daily(start_date='',end_date='',trade_date='20180202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180202_tscode_list = list() 
for ts_code_sh in daily_20180202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180202_tscode_list.append(stock_name)
daily_20180202_addname_dataframe=pd.DataFrame()
daily_20180202_addname_dataframe['cname'] = daily_20180202_tscode_list
for table_name in daily_20180202.columns.values.tolist():
    daily_20180202_addname_dataframe[table_name] = daily_20180202[table_name]
print("daily_20180202 返回数据 row 行数 = "+str(daily_20180202.shape[0]))
daily_20180202_addname_dataframe.to_excel(daily_201802_excel_writer,'2_5',index=False)
daily_201802_excel_writer.save()
daily_20180203 = pro.daily(start_date='',end_date='',trade_date='20180203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180203_tscode_list = list() 
for ts_code_sh in daily_20180203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180203_tscode_list.append(stock_name)
daily_20180203_addname_dataframe=pd.DataFrame()
daily_20180203_addname_dataframe['cname'] = daily_20180203_tscode_list
for table_name in daily_20180203.columns.values.tolist():
    daily_20180203_addname_dataframe[table_name] = daily_20180203[table_name]
print("daily_20180203 返回数据 row 行数 = "+str(daily_20180203.shape[0]))
daily_20180203_addname_dataframe.to_excel(daily_201802_excel_writer,'3_6',index=False)
daily_201802_excel_writer.save()
daily_20180204 = pro.daily(start_date='',end_date='',trade_date='20180204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180204_tscode_list = list() 
for ts_code_sh in daily_20180204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180204_tscode_list.append(stock_name)
daily_20180204_addname_dataframe=pd.DataFrame()
daily_20180204_addname_dataframe['cname'] = daily_20180204_tscode_list
for table_name in daily_20180204.columns.values.tolist():
    daily_20180204_addname_dataframe[table_name] = daily_20180204[table_name]
print("daily_20180204 返回数据 row 行数 = "+str(daily_20180204.shape[0]))
daily_20180204_addname_dataframe.to_excel(daily_201802_excel_writer,'4_7',index=False)
daily_201802_excel_writer.save()
daily_20180205 = pro.daily(start_date='',end_date='',trade_date='20180205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180205_tscode_list = list() 
for ts_code_sh in daily_20180205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180205_tscode_list.append(stock_name)
daily_20180205_addname_dataframe=pd.DataFrame()
daily_20180205_addname_dataframe['cname'] = daily_20180205_tscode_list
for table_name in daily_20180205.columns.values.tolist():
    daily_20180205_addname_dataframe[table_name] = daily_20180205[table_name]
print("daily_20180205 返回数据 row 行数 = "+str(daily_20180205.shape[0]))
daily_20180205_addname_dataframe.to_excel(daily_201802_excel_writer,'5_1',index=False)
daily_201802_excel_writer.save()
daily_20180206 = pro.daily(start_date='',end_date='',trade_date='20180206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180206_tscode_list = list() 
for ts_code_sh in daily_20180206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180206_tscode_list.append(stock_name)
daily_20180206_addname_dataframe=pd.DataFrame()
daily_20180206_addname_dataframe['cname'] = daily_20180206_tscode_list
for table_name in daily_20180206.columns.values.tolist():
    daily_20180206_addname_dataframe[table_name] = daily_20180206[table_name]
print("daily_20180206 返回数据 row 行数 = "+str(daily_20180206.shape[0]))
daily_20180206_addname_dataframe.to_excel(daily_201802_excel_writer,'6_2',index=False)
daily_201802_excel_writer.save()
daily_20180207 = pro.daily(start_date='',end_date='',trade_date='20180207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180207_tscode_list = list() 
for ts_code_sh in daily_20180207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180207_tscode_list.append(stock_name)
daily_20180207_addname_dataframe=pd.DataFrame()
daily_20180207_addname_dataframe['cname'] = daily_20180207_tscode_list
for table_name in daily_20180207.columns.values.tolist():
    daily_20180207_addname_dataframe[table_name] = daily_20180207[table_name]
print("daily_20180207 返回数据 row 行数 = "+str(daily_20180207.shape[0]))
daily_20180207_addname_dataframe.to_excel(daily_201802_excel_writer,'7_3',index=False)
daily_201802_excel_writer.save()
daily_20180208 = pro.daily(start_date='',end_date='',trade_date='20180208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180208_tscode_list = list() 
for ts_code_sh in daily_20180208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180208_tscode_list.append(stock_name)
daily_20180208_addname_dataframe=pd.DataFrame()
daily_20180208_addname_dataframe['cname'] = daily_20180208_tscode_list
for table_name in daily_20180208.columns.values.tolist():
    daily_20180208_addname_dataframe[table_name] = daily_20180208[table_name]
print("daily_20180208 返回数据 row 行数 = "+str(daily_20180208.shape[0]))
daily_20180208_addname_dataframe.to_excel(daily_201802_excel_writer,'8_4',index=False)
daily_201802_excel_writer.save()
daily_20180209 = pro.daily(start_date='',end_date='',trade_date='20180209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180209_tscode_list = list() 
for ts_code_sh in daily_20180209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180209_tscode_list.append(stock_name)
daily_20180209_addname_dataframe=pd.DataFrame()
daily_20180209_addname_dataframe['cname'] = daily_20180209_tscode_list
for table_name in daily_20180209.columns.values.tolist():
    daily_20180209_addname_dataframe[table_name] = daily_20180209[table_name]
print("daily_20180209 返回数据 row 行数 = "+str(daily_20180209.shape[0]))
daily_20180209_addname_dataframe.to_excel(daily_201802_excel_writer,'9_5',index=False)
daily_201802_excel_writer.save()
daily_20180210 = pro.daily(start_date='',end_date='',trade_date='20180210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180210_tscode_list = list() 
for ts_code_sh in daily_20180210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180210_tscode_list.append(stock_name)
daily_20180210_addname_dataframe=pd.DataFrame()
daily_20180210_addname_dataframe['cname'] = daily_20180210_tscode_list
for table_name in daily_20180210.columns.values.tolist():
    daily_20180210_addname_dataframe[table_name] = daily_20180210[table_name]
print("daily_20180210 返回数据 row 行数 = "+str(daily_20180210.shape[0]))
daily_20180210_addname_dataframe.to_excel(daily_201802_excel_writer,'10_6',index=False)
daily_201802_excel_writer.save()
daily_20180211 = pro.daily(start_date='',end_date='',trade_date='20180211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180211_tscode_list = list() 
for ts_code_sh in daily_20180211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180211_tscode_list.append(stock_name)
daily_20180211_addname_dataframe=pd.DataFrame()
daily_20180211_addname_dataframe['cname'] = daily_20180211_tscode_list
for table_name in daily_20180211.columns.values.tolist():
    daily_20180211_addname_dataframe[table_name] = daily_20180211[table_name]
print("daily_20180211 返回数据 row 行数 = "+str(daily_20180211.shape[0]))
daily_20180211_addname_dataframe.to_excel(daily_201802_excel_writer,'11_7',index=False)
daily_201802_excel_writer.save()
daily_20180212 = pro.daily(start_date='',end_date='',trade_date='20180212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180212_tscode_list = list() 
for ts_code_sh in daily_20180212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180212_tscode_list.append(stock_name)
daily_20180212_addname_dataframe=pd.DataFrame()
daily_20180212_addname_dataframe['cname'] = daily_20180212_tscode_list
for table_name in daily_20180212.columns.values.tolist():
    daily_20180212_addname_dataframe[table_name] = daily_20180212[table_name]
print("daily_20180212 返回数据 row 行数 = "+str(daily_20180212.shape[0]))
daily_20180212_addname_dataframe.to_excel(daily_201802_excel_writer,'12_1',index=False)
daily_201802_excel_writer.save()
daily_20180213 = pro.daily(start_date='',end_date='',trade_date='20180213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180213_tscode_list = list() 
for ts_code_sh in daily_20180213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180213_tscode_list.append(stock_name)
daily_20180213_addname_dataframe=pd.DataFrame()
daily_20180213_addname_dataframe['cname'] = daily_20180213_tscode_list
for table_name in daily_20180213.columns.values.tolist():
    daily_20180213_addname_dataframe[table_name] = daily_20180213[table_name]
print("daily_20180213 返回数据 row 行数 = "+str(daily_20180213.shape[0]))
daily_20180213_addname_dataframe.to_excel(daily_201802_excel_writer,'13_2',index=False)
daily_201802_excel_writer.save()
daily_20180214 = pro.daily(start_date='',end_date='',trade_date='20180214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180214_tscode_list = list() 
for ts_code_sh in daily_20180214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180214_tscode_list.append(stock_name)
daily_20180214_addname_dataframe=pd.DataFrame()
daily_20180214_addname_dataframe['cname'] = daily_20180214_tscode_list
for table_name in daily_20180214.columns.values.tolist():
    daily_20180214_addname_dataframe[table_name] = daily_20180214[table_name]
print("daily_20180214 返回数据 row 行数 = "+str(daily_20180214.shape[0]))
daily_20180214_addname_dataframe.to_excel(daily_201802_excel_writer,'14_3',index=False)
daily_201802_excel_writer.save()
daily_20180215 = pro.daily(start_date='',end_date='',trade_date='20180215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180215_tscode_list = list() 
for ts_code_sh in daily_20180215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180215_tscode_list.append(stock_name)
daily_20180215_addname_dataframe=pd.DataFrame()
daily_20180215_addname_dataframe['cname'] = daily_20180215_tscode_list
for table_name in daily_20180215.columns.values.tolist():
    daily_20180215_addname_dataframe[table_name] = daily_20180215[table_name]
print("daily_20180215 返回数据 row 行数 = "+str(daily_20180215.shape[0]))
daily_20180215_addname_dataframe.to_excel(daily_201802_excel_writer,'15_4',index=False)
daily_201802_excel_writer.save()
daily_20180216 = pro.daily(start_date='',end_date='',trade_date='20180216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180216_tscode_list = list() 
for ts_code_sh in daily_20180216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180216_tscode_list.append(stock_name)
daily_20180216_addname_dataframe=pd.DataFrame()
daily_20180216_addname_dataframe['cname'] = daily_20180216_tscode_list
for table_name in daily_20180216.columns.values.tolist():
    daily_20180216_addname_dataframe[table_name] = daily_20180216[table_name]
print("daily_20180216 返回数据 row 行数 = "+str(daily_20180216.shape[0]))
daily_20180216_addname_dataframe.to_excel(daily_201802_excel_writer,'16_5',index=False)
daily_201802_excel_writer.save()
daily_20180217 = pro.daily(start_date='',end_date='',trade_date='20180217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180217_tscode_list = list() 
for ts_code_sh in daily_20180217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180217_tscode_list.append(stock_name)
daily_20180217_addname_dataframe=pd.DataFrame()
daily_20180217_addname_dataframe['cname'] = daily_20180217_tscode_list
for table_name in daily_20180217.columns.values.tolist():
    daily_20180217_addname_dataframe[table_name] = daily_20180217[table_name]
print("daily_20180217 返回数据 row 行数 = "+str(daily_20180217.shape[0]))
daily_20180217_addname_dataframe.to_excel(daily_201802_excel_writer,'17_6',index=False)
daily_201802_excel_writer.save()
daily_20180218 = pro.daily(start_date='',end_date='',trade_date='20180218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180218_tscode_list = list() 
for ts_code_sh in daily_20180218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180218_tscode_list.append(stock_name)
daily_20180218_addname_dataframe=pd.DataFrame()
daily_20180218_addname_dataframe['cname'] = daily_20180218_tscode_list
for table_name in daily_20180218.columns.values.tolist():
    daily_20180218_addname_dataframe[table_name] = daily_20180218[table_name]
print("daily_20180218 返回数据 row 行数 = "+str(daily_20180218.shape[0]))
daily_20180218_addname_dataframe.to_excel(daily_201802_excel_writer,'18_7',index=False)
daily_201802_excel_writer.save()
daily_20180219 = pro.daily(start_date='',end_date='',trade_date='20180219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180219_tscode_list = list() 
for ts_code_sh in daily_20180219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180219_tscode_list.append(stock_name)
daily_20180219_addname_dataframe=pd.DataFrame()
daily_20180219_addname_dataframe['cname'] = daily_20180219_tscode_list
for table_name in daily_20180219.columns.values.tolist():
    daily_20180219_addname_dataframe[table_name] = daily_20180219[table_name]
print("daily_20180219 返回数据 row 行数 = "+str(daily_20180219.shape[0]))
daily_20180219_addname_dataframe.to_excel(daily_201802_excel_writer,'19_1',index=False)
daily_201802_excel_writer.save()
daily_20180220 = pro.daily(start_date='',end_date='',trade_date='20180220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180220_tscode_list = list() 
for ts_code_sh in daily_20180220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180220_tscode_list.append(stock_name)
daily_20180220_addname_dataframe=pd.DataFrame()
daily_20180220_addname_dataframe['cname'] = daily_20180220_tscode_list
for table_name in daily_20180220.columns.values.tolist():
    daily_20180220_addname_dataframe[table_name] = daily_20180220[table_name]
print("daily_20180220 返回数据 row 行数 = "+str(daily_20180220.shape[0]))
daily_20180220_addname_dataframe.to_excel(daily_201802_excel_writer,'20_2',index=False)
daily_201802_excel_writer.save()
daily_20180221 = pro.daily(start_date='',end_date='',trade_date='20180221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180221_tscode_list = list() 
for ts_code_sh in daily_20180221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180221_tscode_list.append(stock_name)
daily_20180221_addname_dataframe=pd.DataFrame()
daily_20180221_addname_dataframe['cname'] = daily_20180221_tscode_list
for table_name in daily_20180221.columns.values.tolist():
    daily_20180221_addname_dataframe[table_name] = daily_20180221[table_name]
print("daily_20180221 返回数据 row 行数 = "+str(daily_20180221.shape[0]))
daily_20180221_addname_dataframe.to_excel(daily_201802_excel_writer,'21_3',index=False)
daily_201802_excel_writer.save()
daily_20180222 = pro.daily(start_date='',end_date='',trade_date='20180222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180222_tscode_list = list() 
for ts_code_sh in daily_20180222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180222_tscode_list.append(stock_name)
daily_20180222_addname_dataframe=pd.DataFrame()
daily_20180222_addname_dataframe['cname'] = daily_20180222_tscode_list
for table_name in daily_20180222.columns.values.tolist():
    daily_20180222_addname_dataframe[table_name] = daily_20180222[table_name]
print("daily_20180222 返回数据 row 行数 = "+str(daily_20180222.shape[0]))
daily_20180222_addname_dataframe.to_excel(daily_201802_excel_writer,'22_4',index=False)
daily_201802_excel_writer.save()
daily_20180223 = pro.daily(start_date='',end_date='',trade_date='20180223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180223_tscode_list = list() 
for ts_code_sh in daily_20180223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180223_tscode_list.append(stock_name)
daily_20180223_addname_dataframe=pd.DataFrame()
daily_20180223_addname_dataframe['cname'] = daily_20180223_tscode_list
for table_name in daily_20180223.columns.values.tolist():
    daily_20180223_addname_dataframe[table_name] = daily_20180223[table_name]
print("daily_20180223 返回数据 row 行数 = "+str(daily_20180223.shape[0]))
daily_20180223_addname_dataframe.to_excel(daily_201802_excel_writer,'23_5',index=False)
daily_201802_excel_writer.save()
daily_20180224 = pro.daily(start_date='',end_date='',trade_date='20180224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180224_tscode_list = list() 
for ts_code_sh in daily_20180224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180224_tscode_list.append(stock_name)
daily_20180224_addname_dataframe=pd.DataFrame()
daily_20180224_addname_dataframe['cname'] = daily_20180224_tscode_list
for table_name in daily_20180224.columns.values.tolist():
    daily_20180224_addname_dataframe[table_name] = daily_20180224[table_name]
print("daily_20180224 返回数据 row 行数 = "+str(daily_20180224.shape[0]))
daily_20180224_addname_dataframe.to_excel(daily_201802_excel_writer,'24_6',index=False)
daily_201802_excel_writer.save()
daily_20180225 = pro.daily(start_date='',end_date='',trade_date='20180225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180225_tscode_list = list() 
for ts_code_sh in daily_20180225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180225_tscode_list.append(stock_name)
daily_20180225_addname_dataframe=pd.DataFrame()
daily_20180225_addname_dataframe['cname'] = daily_20180225_tscode_list
for table_name in daily_20180225.columns.values.tolist():
    daily_20180225_addname_dataframe[table_name] = daily_20180225[table_name]
print("daily_20180225 返回数据 row 行数 = "+str(daily_20180225.shape[0]))
daily_20180225_addname_dataframe.to_excel(daily_201802_excel_writer,'25_7',index=False)
daily_201802_excel_writer.save()
daily_20180226 = pro.daily(start_date='',end_date='',trade_date='20180226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180226_tscode_list = list() 
for ts_code_sh in daily_20180226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180226_tscode_list.append(stock_name)
daily_20180226_addname_dataframe=pd.DataFrame()
daily_20180226_addname_dataframe['cname'] = daily_20180226_tscode_list
for table_name in daily_20180226.columns.values.tolist():
    daily_20180226_addname_dataframe[table_name] = daily_20180226[table_name]
print("daily_20180226 返回数据 row 行数 = "+str(daily_20180226.shape[0]))
daily_20180226_addname_dataframe.to_excel(daily_201802_excel_writer,'26_1',index=False)
daily_201802_excel_writer.save()
daily_20180227 = pro.daily(start_date='',end_date='',trade_date='20180227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180227_tscode_list = list() 
for ts_code_sh in daily_20180227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180227_tscode_list.append(stock_name)
daily_20180227_addname_dataframe=pd.DataFrame()
daily_20180227_addname_dataframe['cname'] = daily_20180227_tscode_list
for table_name in daily_20180227.columns.values.tolist():
    daily_20180227_addname_dataframe[table_name] = daily_20180227[table_name]
print("daily_20180227 返回数据 row 行数 = "+str(daily_20180227.shape[0]))
daily_20180227_addname_dataframe.to_excel(daily_201802_excel_writer,'27_2',index=False)
daily_201802_excel_writer.save()
daily_20180228 = pro.daily(start_date='',end_date='',trade_date='20180228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180228_tscode_list = list() 
for ts_code_sh in daily_20180228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180228_tscode_list.append(stock_name)
daily_20180228_addname_dataframe=pd.DataFrame()
daily_20180228_addname_dataframe['cname'] = daily_20180228_tscode_list
for table_name in daily_20180228.columns.values.tolist():
    daily_20180228_addname_dataframe[table_name] = daily_20180228[table_name]
print("daily_20180228 返回数据 row 行数 = "+str(daily_20180228.shape[0]))
daily_20180228_addname_dataframe.to_excel(daily_201802_excel_writer,'28_3',index=False)
daily_201802_excel_writer.save()




createexcel('daily_201803.xlsx')
daily_201803_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201803.xlsx')
daily_201803_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201803.xlsx', engine='openpyxl')
daily_201803_excel_writer.book = daily_201803_book
daily_201803_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201803_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180301")       ###  更新 记录日期
daily_20180301 = pro.daily(start_date='',end_date='',trade_date='20180301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180301_tscode_list = list() 
for ts_code_sh in daily_20180301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180301_tscode_list.append(stock_name)
daily_20180301_addname_dataframe=pd.DataFrame()
daily_20180301_addname_dataframe['cname'] = daily_20180301_tscode_list
for table_name in daily_20180301.columns.values.tolist():
    daily_20180301_addname_dataframe[table_name] = daily_20180301[table_name]
print("daily_20180301 返回数据 row 行数 = "+str(daily_20180301.shape[0]))
daily_20180301_addname_dataframe.to_excel(daily_201803_excel_writer,'1_4',index=False)
daily_201803_excel_writer.save()
daily_20180302 = pro.daily(start_date='',end_date='',trade_date='20180302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180302_tscode_list = list() 
for ts_code_sh in daily_20180302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180302_tscode_list.append(stock_name)
daily_20180302_addname_dataframe=pd.DataFrame()
daily_20180302_addname_dataframe['cname'] = daily_20180302_tscode_list
for table_name in daily_20180302.columns.values.tolist():
    daily_20180302_addname_dataframe[table_name] = daily_20180302[table_name]
print("daily_20180302 返回数据 row 行数 = "+str(daily_20180302.shape[0]))
daily_20180302_addname_dataframe.to_excel(daily_201803_excel_writer,'2_5',index=False)
daily_201803_excel_writer.save()
daily_20180303 = pro.daily(start_date='',end_date='',trade_date='20180303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180303_tscode_list = list() 
for ts_code_sh in daily_20180303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180303_tscode_list.append(stock_name)
daily_20180303_addname_dataframe=pd.DataFrame()
daily_20180303_addname_dataframe['cname'] = daily_20180303_tscode_list
for table_name in daily_20180303.columns.values.tolist():
    daily_20180303_addname_dataframe[table_name] = daily_20180303[table_name]
print("daily_20180303 返回数据 row 行数 = "+str(daily_20180303.shape[0]))
daily_20180303_addname_dataframe.to_excel(daily_201803_excel_writer,'3_6',index=False)
daily_201803_excel_writer.save()
daily_20180304 = pro.daily(start_date='',end_date='',trade_date='20180304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180304_tscode_list = list() 
for ts_code_sh in daily_20180304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180304_tscode_list.append(stock_name)
daily_20180304_addname_dataframe=pd.DataFrame()
daily_20180304_addname_dataframe['cname'] = daily_20180304_tscode_list
for table_name in daily_20180304.columns.values.tolist():
    daily_20180304_addname_dataframe[table_name] = daily_20180304[table_name]
print("daily_20180304 返回数据 row 行数 = "+str(daily_20180304.shape[0]))
daily_20180304_addname_dataframe.to_excel(daily_201803_excel_writer,'4_7',index=False)
daily_201803_excel_writer.save()
daily_20180305 = pro.daily(start_date='',end_date='',trade_date='20180305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180305_tscode_list = list() 
for ts_code_sh in daily_20180305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180305_tscode_list.append(stock_name)
daily_20180305_addname_dataframe=pd.DataFrame()
daily_20180305_addname_dataframe['cname'] = daily_20180305_tscode_list
for table_name in daily_20180305.columns.values.tolist():
    daily_20180305_addname_dataframe[table_name] = daily_20180305[table_name]
print("daily_20180305 返回数据 row 行数 = "+str(daily_20180305.shape[0]))
daily_20180305_addname_dataframe.to_excel(daily_201803_excel_writer,'5_1',index=False)
daily_201803_excel_writer.save()
daily_20180306 = pro.daily(start_date='',end_date='',trade_date='20180306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180306_tscode_list = list() 
for ts_code_sh in daily_20180306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180306_tscode_list.append(stock_name)
daily_20180306_addname_dataframe=pd.DataFrame()
daily_20180306_addname_dataframe['cname'] = daily_20180306_tscode_list
for table_name in daily_20180306.columns.values.tolist():
    daily_20180306_addname_dataframe[table_name] = daily_20180306[table_name]
print("daily_20180306 返回数据 row 行数 = "+str(daily_20180306.shape[0]))
daily_20180306_addname_dataframe.to_excel(daily_201803_excel_writer,'6_2',index=False)
daily_201803_excel_writer.save()
daily_20180307 = pro.daily(start_date='',end_date='',trade_date='20180307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180307_tscode_list = list() 
for ts_code_sh in daily_20180307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180307_tscode_list.append(stock_name)
daily_20180307_addname_dataframe=pd.DataFrame()
daily_20180307_addname_dataframe['cname'] = daily_20180307_tscode_list
for table_name in daily_20180307.columns.values.tolist():
    daily_20180307_addname_dataframe[table_name] = daily_20180307[table_name]
print("daily_20180307 返回数据 row 行数 = "+str(daily_20180307.shape[0]))
daily_20180307_addname_dataframe.to_excel(daily_201803_excel_writer,'7_3',index=False)
daily_201803_excel_writer.save()
daily_20180308 = pro.daily(start_date='',end_date='',trade_date='20180308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180308_tscode_list = list() 
for ts_code_sh in daily_20180308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180308_tscode_list.append(stock_name)
daily_20180308_addname_dataframe=pd.DataFrame()
daily_20180308_addname_dataframe['cname'] = daily_20180308_tscode_list
for table_name in daily_20180308.columns.values.tolist():
    daily_20180308_addname_dataframe[table_name] = daily_20180308[table_name]
print("daily_20180308 返回数据 row 行数 = "+str(daily_20180308.shape[0]))
daily_20180308_addname_dataframe.to_excel(daily_201803_excel_writer,'8_4',index=False)
daily_201803_excel_writer.save()
daily_20180309 = pro.daily(start_date='',end_date='',trade_date='20180309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180309_tscode_list = list() 
for ts_code_sh in daily_20180309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180309_tscode_list.append(stock_name)
daily_20180309_addname_dataframe=pd.DataFrame()
daily_20180309_addname_dataframe['cname'] = daily_20180309_tscode_list
for table_name in daily_20180309.columns.values.tolist():
    daily_20180309_addname_dataframe[table_name] = daily_20180309[table_name]
print("daily_20180309 返回数据 row 行数 = "+str(daily_20180309.shape[0]))
daily_20180309_addname_dataframe.to_excel(daily_201803_excel_writer,'9_5',index=False)
daily_201803_excel_writer.save()
daily_20180310 = pro.daily(start_date='',end_date='',trade_date='20180310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180310_tscode_list = list() 
for ts_code_sh in daily_20180310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180310_tscode_list.append(stock_name)
daily_20180310_addname_dataframe=pd.DataFrame()
daily_20180310_addname_dataframe['cname'] = daily_20180310_tscode_list
for table_name in daily_20180310.columns.values.tolist():
    daily_20180310_addname_dataframe[table_name] = daily_20180310[table_name]
print("daily_20180310 返回数据 row 行数 = "+str(daily_20180310.shape[0]))
daily_20180310_addname_dataframe.to_excel(daily_201803_excel_writer,'10_6',index=False)
daily_201803_excel_writer.save()
daily_20180311 = pro.daily(start_date='',end_date='',trade_date='20180311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180311_tscode_list = list() 
for ts_code_sh in daily_20180311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180311_tscode_list.append(stock_name)
daily_20180311_addname_dataframe=pd.DataFrame()
daily_20180311_addname_dataframe['cname'] = daily_20180311_tscode_list
for table_name in daily_20180311.columns.values.tolist():
    daily_20180311_addname_dataframe[table_name] = daily_20180311[table_name]
print("daily_20180311 返回数据 row 行数 = "+str(daily_20180311.shape[0]))
daily_20180311_addname_dataframe.to_excel(daily_201803_excel_writer,'11_7',index=False)
daily_201803_excel_writer.save()
daily_20180312 = pro.daily(start_date='',end_date='',trade_date='20180312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180312_tscode_list = list() 
for ts_code_sh in daily_20180312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180312_tscode_list.append(stock_name)
daily_20180312_addname_dataframe=pd.DataFrame()
daily_20180312_addname_dataframe['cname'] = daily_20180312_tscode_list
for table_name in daily_20180312.columns.values.tolist():
    daily_20180312_addname_dataframe[table_name] = daily_20180312[table_name]
print("daily_20180312 返回数据 row 行数 = "+str(daily_20180312.shape[0]))
daily_20180312_addname_dataframe.to_excel(daily_201803_excel_writer,'12_1',index=False)
daily_201803_excel_writer.save()
daily_20180313 = pro.daily(start_date='',end_date='',trade_date='20180313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180313_tscode_list = list() 
for ts_code_sh in daily_20180313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180313_tscode_list.append(stock_name)
daily_20180313_addname_dataframe=pd.DataFrame()
daily_20180313_addname_dataframe['cname'] = daily_20180313_tscode_list
for table_name in daily_20180313.columns.values.tolist():
    daily_20180313_addname_dataframe[table_name] = daily_20180313[table_name]
print("daily_20180313 返回数据 row 行数 = "+str(daily_20180313.shape[0]))
daily_20180313_addname_dataframe.to_excel(daily_201803_excel_writer,'13_2',index=False)
daily_201803_excel_writer.save()
daily_20180314 = pro.daily(start_date='',end_date='',trade_date='20180314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180314_tscode_list = list() 
for ts_code_sh in daily_20180314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180314_tscode_list.append(stock_name)
daily_20180314_addname_dataframe=pd.DataFrame()
daily_20180314_addname_dataframe['cname'] = daily_20180314_tscode_list
for table_name in daily_20180314.columns.values.tolist():
    daily_20180314_addname_dataframe[table_name] = daily_20180314[table_name]
print("daily_20180314 返回数据 row 行数 = "+str(daily_20180314.shape[0]))
daily_20180314_addname_dataframe.to_excel(daily_201803_excel_writer,'14_3',index=False)
daily_201803_excel_writer.save()
daily_20180315 = pro.daily(start_date='',end_date='',trade_date='20180315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180315_tscode_list = list() 
for ts_code_sh in daily_20180315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180315_tscode_list.append(stock_name)
daily_20180315_addname_dataframe=pd.DataFrame()
daily_20180315_addname_dataframe['cname'] = daily_20180315_tscode_list
for table_name in daily_20180315.columns.values.tolist():
    daily_20180315_addname_dataframe[table_name] = daily_20180315[table_name]
print("daily_20180315 返回数据 row 行数 = "+str(daily_20180315.shape[0]))
daily_20180315_addname_dataframe.to_excel(daily_201803_excel_writer,'15_4',index=False)
daily_201803_excel_writer.save()
daily_20180316 = pro.daily(start_date='',end_date='',trade_date='20180316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180316_tscode_list = list() 
for ts_code_sh in daily_20180316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180316_tscode_list.append(stock_name)
daily_20180316_addname_dataframe=pd.DataFrame()
daily_20180316_addname_dataframe['cname'] = daily_20180316_tscode_list
for table_name in daily_20180316.columns.values.tolist():
    daily_20180316_addname_dataframe[table_name] = daily_20180316[table_name]
print("daily_20180316 返回数据 row 行数 = "+str(daily_20180316.shape[0]))
daily_20180316_addname_dataframe.to_excel(daily_201803_excel_writer,'16_5',index=False)
daily_201803_excel_writer.save()
daily_20180317 = pro.daily(start_date='',end_date='',trade_date='20180317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180317_tscode_list = list() 
for ts_code_sh in daily_20180317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180317_tscode_list.append(stock_name)
daily_20180317_addname_dataframe=pd.DataFrame()
daily_20180317_addname_dataframe['cname'] = daily_20180317_tscode_list
for table_name in daily_20180317.columns.values.tolist():
    daily_20180317_addname_dataframe[table_name] = daily_20180317[table_name]
print("daily_20180317 返回数据 row 行数 = "+str(daily_20180317.shape[0]))
daily_20180317_addname_dataframe.to_excel(daily_201803_excel_writer,'17_6',index=False)
daily_201803_excel_writer.save()
daily_20180318 = pro.daily(start_date='',end_date='',trade_date='20180318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180318_tscode_list = list() 
for ts_code_sh in daily_20180318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180318_tscode_list.append(stock_name)
daily_20180318_addname_dataframe=pd.DataFrame()
daily_20180318_addname_dataframe['cname'] = daily_20180318_tscode_list
for table_name in daily_20180318.columns.values.tolist():
    daily_20180318_addname_dataframe[table_name] = daily_20180318[table_name]
print("daily_20180318 返回数据 row 行数 = "+str(daily_20180318.shape[0]))
daily_20180318_addname_dataframe.to_excel(daily_201803_excel_writer,'18_7',index=False)
daily_201803_excel_writer.save()
daily_20180319 = pro.daily(start_date='',end_date='',trade_date='20180319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180319_tscode_list = list() 
for ts_code_sh in daily_20180319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180319_tscode_list.append(stock_name)
daily_20180319_addname_dataframe=pd.DataFrame()
daily_20180319_addname_dataframe['cname'] = daily_20180319_tscode_list
for table_name in daily_20180319.columns.values.tolist():
    daily_20180319_addname_dataframe[table_name] = daily_20180319[table_name]
print("daily_20180319 返回数据 row 行数 = "+str(daily_20180319.shape[0]))
daily_20180319_addname_dataframe.to_excel(daily_201803_excel_writer,'19_1',index=False)
daily_201803_excel_writer.save()
daily_20180320 = pro.daily(start_date='',end_date='',trade_date='20180320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180320_tscode_list = list() 
for ts_code_sh in daily_20180320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180320_tscode_list.append(stock_name)
daily_20180320_addname_dataframe=pd.DataFrame()
daily_20180320_addname_dataframe['cname'] = daily_20180320_tscode_list
for table_name in daily_20180320.columns.values.tolist():
    daily_20180320_addname_dataframe[table_name] = daily_20180320[table_name]
print("daily_20180320 返回数据 row 行数 = "+str(daily_20180320.shape[0]))
daily_20180320_addname_dataframe.to_excel(daily_201803_excel_writer,'20_2',index=False)
daily_201803_excel_writer.save()
daily_20180321 = pro.daily(start_date='',end_date='',trade_date='20180321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180321_tscode_list = list() 
for ts_code_sh in daily_20180321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180321_tscode_list.append(stock_name)
daily_20180321_addname_dataframe=pd.DataFrame()
daily_20180321_addname_dataframe['cname'] = daily_20180321_tscode_list
for table_name in daily_20180321.columns.values.tolist():
    daily_20180321_addname_dataframe[table_name] = daily_20180321[table_name]
print("daily_20180321 返回数据 row 行数 = "+str(daily_20180321.shape[0]))
daily_20180321_addname_dataframe.to_excel(daily_201803_excel_writer,'21_3',index=False)
daily_201803_excel_writer.save()
daily_20180322 = pro.daily(start_date='',end_date='',trade_date='20180322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180322_tscode_list = list() 
for ts_code_sh in daily_20180322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180322_tscode_list.append(stock_name)
daily_20180322_addname_dataframe=pd.DataFrame()
daily_20180322_addname_dataframe['cname'] = daily_20180322_tscode_list
for table_name in daily_20180322.columns.values.tolist():
    daily_20180322_addname_dataframe[table_name] = daily_20180322[table_name]
print("daily_20180322 返回数据 row 行数 = "+str(daily_20180322.shape[0]))
daily_20180322_addname_dataframe.to_excel(daily_201803_excel_writer,'22_4',index=False)
daily_201803_excel_writer.save()
daily_20180323 = pro.daily(start_date='',end_date='',trade_date='20180323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180323_tscode_list = list() 
for ts_code_sh in daily_20180323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180323_tscode_list.append(stock_name)
daily_20180323_addname_dataframe=pd.DataFrame()
daily_20180323_addname_dataframe['cname'] = daily_20180323_tscode_list
for table_name in daily_20180323.columns.values.tolist():
    daily_20180323_addname_dataframe[table_name] = daily_20180323[table_name]
print("daily_20180323 返回数据 row 行数 = "+str(daily_20180323.shape[0]))
daily_20180323_addname_dataframe.to_excel(daily_201803_excel_writer,'23_5',index=False)
daily_201803_excel_writer.save()
daily_20180324 = pro.daily(start_date='',end_date='',trade_date='20180324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180324_tscode_list = list() 
for ts_code_sh in daily_20180324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180324_tscode_list.append(stock_name)
daily_20180324_addname_dataframe=pd.DataFrame()
daily_20180324_addname_dataframe['cname'] = daily_20180324_tscode_list
for table_name in daily_20180324.columns.values.tolist():
    daily_20180324_addname_dataframe[table_name] = daily_20180324[table_name]
print("daily_20180324 返回数据 row 行数 = "+str(daily_20180324.shape[0]))
daily_20180324_addname_dataframe.to_excel(daily_201803_excel_writer,'24_6',index=False)
daily_201803_excel_writer.save()
daily_20180325 = pro.daily(start_date='',end_date='',trade_date='20180325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180325_tscode_list = list() 
for ts_code_sh in daily_20180325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180325_tscode_list.append(stock_name)
daily_20180325_addname_dataframe=pd.DataFrame()
daily_20180325_addname_dataframe['cname'] = daily_20180325_tscode_list
for table_name in daily_20180325.columns.values.tolist():
    daily_20180325_addname_dataframe[table_name] = daily_20180325[table_name]
print("daily_20180325 返回数据 row 行数 = "+str(daily_20180325.shape[0]))
daily_20180325_addname_dataframe.to_excel(daily_201803_excel_writer,'25_7',index=False)
daily_201803_excel_writer.save()
daily_20180326 = pro.daily(start_date='',end_date='',trade_date='20180326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180326_tscode_list = list() 
for ts_code_sh in daily_20180326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180326_tscode_list.append(stock_name)
daily_20180326_addname_dataframe=pd.DataFrame()
daily_20180326_addname_dataframe['cname'] = daily_20180326_tscode_list
for table_name in daily_20180326.columns.values.tolist():
    daily_20180326_addname_dataframe[table_name] = daily_20180326[table_name]
print("daily_20180326 返回数据 row 行数 = "+str(daily_20180326.shape[0]))
daily_20180326_addname_dataframe.to_excel(daily_201803_excel_writer,'26_1',index=False)
daily_201803_excel_writer.save()
daily_20180327 = pro.daily(start_date='',end_date='',trade_date='20180327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180327_tscode_list = list() 
for ts_code_sh in daily_20180327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180327_tscode_list.append(stock_name)
daily_20180327_addname_dataframe=pd.DataFrame()
daily_20180327_addname_dataframe['cname'] = daily_20180327_tscode_list
for table_name in daily_20180327.columns.values.tolist():
    daily_20180327_addname_dataframe[table_name] = daily_20180327[table_name]
print("daily_20180327 返回数据 row 行数 = "+str(daily_20180327.shape[0]))
daily_20180327_addname_dataframe.to_excel(daily_201803_excel_writer,'27_2',index=False)
daily_201803_excel_writer.save()
daily_20180328 = pro.daily(start_date='',end_date='',trade_date='20180328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180328_tscode_list = list() 
for ts_code_sh in daily_20180328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180328_tscode_list.append(stock_name)
daily_20180328_addname_dataframe=pd.DataFrame()
daily_20180328_addname_dataframe['cname'] = daily_20180328_tscode_list
for table_name in daily_20180328.columns.values.tolist():
    daily_20180328_addname_dataframe[table_name] = daily_20180328[table_name]
print("daily_20180328 返回数据 row 行数 = "+str(daily_20180328.shape[0]))
daily_20180328_addname_dataframe.to_excel(daily_201803_excel_writer,'28_3',index=False)
daily_201803_excel_writer.save()
daily_20180329 = pro.daily(start_date='',end_date='',trade_date='20180329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180329_tscode_list = list() 
for ts_code_sh in daily_20180329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180329_tscode_list.append(stock_name)
daily_20180329_addname_dataframe=pd.DataFrame()
daily_20180329_addname_dataframe['cname'] = daily_20180329_tscode_list
for table_name in daily_20180329.columns.values.tolist():
    daily_20180329_addname_dataframe[table_name] = daily_20180329[table_name]
print("daily_20180329 返回数据 row 行数 = "+str(daily_20180329.shape[0]))
daily_20180329_addname_dataframe.to_excel(daily_201803_excel_writer,'29_4',index=False)
daily_201803_excel_writer.save()
daily_20180330 = pro.daily(start_date='',end_date='',trade_date='20180330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180330_tscode_list = list() 
for ts_code_sh in daily_20180330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180330_tscode_list.append(stock_name)
daily_20180330_addname_dataframe=pd.DataFrame()
daily_20180330_addname_dataframe['cname'] = daily_20180330_tscode_list
for table_name in daily_20180330.columns.values.tolist():
    daily_20180330_addname_dataframe[table_name] = daily_20180330[table_name]
print("daily_20180330 返回数据 row 行数 = "+str(daily_20180330.shape[0]))
daily_20180330_addname_dataframe.to_excel(daily_201803_excel_writer,'30_5',index=False)
daily_201803_excel_writer.save()
daily_20180331 = pro.daily(start_date='',end_date='',trade_date='20180331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180331_tscode_list = list() 
for ts_code_sh in daily_20180331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180331_tscode_list.append(stock_name)
daily_20180331_addname_dataframe=pd.DataFrame()
daily_20180331_addname_dataframe['cname'] = daily_20180331_tscode_list
for table_name in daily_20180331.columns.values.tolist():
    daily_20180331_addname_dataframe[table_name] = daily_20180331[table_name]
print("daily_20180331 返回数据 row 行数 = "+str(daily_20180331.shape[0]))
daily_20180331_addname_dataframe.to_excel(daily_201803_excel_writer,'31_6',index=False)
daily_201803_excel_writer.save()




createexcel('daily_201804.xlsx')
daily_201804_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201804.xlsx')
daily_201804_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201804.xlsx', engine='openpyxl')
daily_201804_excel_writer.book = daily_201804_book
daily_201804_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201804_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180401")       ###  更新 记录日期
daily_20180401 = pro.daily(start_date='',end_date='',trade_date='20180401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180401_tscode_list = list() 
for ts_code_sh in daily_20180401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180401_tscode_list.append(stock_name)
daily_20180401_addname_dataframe=pd.DataFrame()
daily_20180401_addname_dataframe['cname'] = daily_20180401_tscode_list
for table_name in daily_20180401.columns.values.tolist():
    daily_20180401_addname_dataframe[table_name] = daily_20180401[table_name]
print("daily_20180401 返回数据 row 行数 = "+str(daily_20180401.shape[0]))
daily_20180401_addname_dataframe.to_excel(daily_201804_excel_writer,'1_7',index=False)
daily_201804_excel_writer.save()
daily_20180402 = pro.daily(start_date='',end_date='',trade_date='20180402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180402_tscode_list = list() 
for ts_code_sh in daily_20180402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180402_tscode_list.append(stock_name)
daily_20180402_addname_dataframe=pd.DataFrame()
daily_20180402_addname_dataframe['cname'] = daily_20180402_tscode_list
for table_name in daily_20180402.columns.values.tolist():
    daily_20180402_addname_dataframe[table_name] = daily_20180402[table_name]
print("daily_20180402 返回数据 row 行数 = "+str(daily_20180402.shape[0]))
daily_20180402_addname_dataframe.to_excel(daily_201804_excel_writer,'2_1',index=False)
daily_201804_excel_writer.save()
daily_20180403 = pro.daily(start_date='',end_date='',trade_date='20180403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180403_tscode_list = list() 
for ts_code_sh in daily_20180403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180403_tscode_list.append(stock_name)
daily_20180403_addname_dataframe=pd.DataFrame()
daily_20180403_addname_dataframe['cname'] = daily_20180403_tscode_list
for table_name in daily_20180403.columns.values.tolist():
    daily_20180403_addname_dataframe[table_name] = daily_20180403[table_name]
print("daily_20180403 返回数据 row 行数 = "+str(daily_20180403.shape[0]))
daily_20180403_addname_dataframe.to_excel(daily_201804_excel_writer,'3_2',index=False)
daily_201804_excel_writer.save()
daily_20180404 = pro.daily(start_date='',end_date='',trade_date='20180404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180404_tscode_list = list() 
for ts_code_sh in daily_20180404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180404_tscode_list.append(stock_name)
daily_20180404_addname_dataframe=pd.DataFrame()
daily_20180404_addname_dataframe['cname'] = daily_20180404_tscode_list
for table_name in daily_20180404.columns.values.tolist():
    daily_20180404_addname_dataframe[table_name] = daily_20180404[table_name]
print("daily_20180404 返回数据 row 行数 = "+str(daily_20180404.shape[0]))
daily_20180404_addname_dataframe.to_excel(daily_201804_excel_writer,'4_3',index=False)
daily_201804_excel_writer.save()
daily_20180405 = pro.daily(start_date='',end_date='',trade_date='20180405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180405_tscode_list = list() 
for ts_code_sh in daily_20180405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180405_tscode_list.append(stock_name)
daily_20180405_addname_dataframe=pd.DataFrame()
daily_20180405_addname_dataframe['cname'] = daily_20180405_tscode_list
for table_name in daily_20180405.columns.values.tolist():
    daily_20180405_addname_dataframe[table_name] = daily_20180405[table_name]
print("daily_20180405 返回数据 row 行数 = "+str(daily_20180405.shape[0]))
daily_20180405_addname_dataframe.to_excel(daily_201804_excel_writer,'5_4',index=False)
daily_201804_excel_writer.save()
daily_20180406 = pro.daily(start_date='',end_date='',trade_date='20180406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180406_tscode_list = list() 
for ts_code_sh in daily_20180406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180406_tscode_list.append(stock_name)
daily_20180406_addname_dataframe=pd.DataFrame()
daily_20180406_addname_dataframe['cname'] = daily_20180406_tscode_list
for table_name in daily_20180406.columns.values.tolist():
    daily_20180406_addname_dataframe[table_name] = daily_20180406[table_name]
print("daily_20180406 返回数据 row 行数 = "+str(daily_20180406.shape[0]))
daily_20180406_addname_dataframe.to_excel(daily_201804_excel_writer,'6_5',index=False)
daily_201804_excel_writer.save()
daily_20180407 = pro.daily(start_date='',end_date='',trade_date='20180407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180407_tscode_list = list() 
for ts_code_sh in daily_20180407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180407_tscode_list.append(stock_name)
daily_20180407_addname_dataframe=pd.DataFrame()
daily_20180407_addname_dataframe['cname'] = daily_20180407_tscode_list
for table_name in daily_20180407.columns.values.tolist():
    daily_20180407_addname_dataframe[table_name] = daily_20180407[table_name]
print("daily_20180407 返回数据 row 行数 = "+str(daily_20180407.shape[0]))
daily_20180407_addname_dataframe.to_excel(daily_201804_excel_writer,'7_6',index=False)
daily_201804_excel_writer.save()
daily_20180408 = pro.daily(start_date='',end_date='',trade_date='20180408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180408_tscode_list = list() 
for ts_code_sh in daily_20180408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180408_tscode_list.append(stock_name)
daily_20180408_addname_dataframe=pd.DataFrame()
daily_20180408_addname_dataframe['cname'] = daily_20180408_tscode_list
for table_name in daily_20180408.columns.values.tolist():
    daily_20180408_addname_dataframe[table_name] = daily_20180408[table_name]
print("daily_20180408 返回数据 row 行数 = "+str(daily_20180408.shape[0]))
daily_20180408_addname_dataframe.to_excel(daily_201804_excel_writer,'8_7',index=False)
daily_201804_excel_writer.save()
daily_20180409 = pro.daily(start_date='',end_date='',trade_date='20180409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180409_tscode_list = list() 
for ts_code_sh in daily_20180409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180409_tscode_list.append(stock_name)
daily_20180409_addname_dataframe=pd.DataFrame()
daily_20180409_addname_dataframe['cname'] = daily_20180409_tscode_list
for table_name in daily_20180409.columns.values.tolist():
    daily_20180409_addname_dataframe[table_name] = daily_20180409[table_name]
print("daily_20180409 返回数据 row 行数 = "+str(daily_20180409.shape[0]))
daily_20180409_addname_dataframe.to_excel(daily_201804_excel_writer,'9_1',index=False)
daily_201804_excel_writer.save()
daily_20180410 = pro.daily(start_date='',end_date='',trade_date='20180410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180410_tscode_list = list() 
for ts_code_sh in daily_20180410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180410_tscode_list.append(stock_name)
daily_20180410_addname_dataframe=pd.DataFrame()
daily_20180410_addname_dataframe['cname'] = daily_20180410_tscode_list
for table_name in daily_20180410.columns.values.tolist():
    daily_20180410_addname_dataframe[table_name] = daily_20180410[table_name]
print("daily_20180410 返回数据 row 行数 = "+str(daily_20180410.shape[0]))
daily_20180410_addname_dataframe.to_excel(daily_201804_excel_writer,'10_2',index=False)
daily_201804_excel_writer.save()
daily_20180411 = pro.daily(start_date='',end_date='',trade_date='20180411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180411_tscode_list = list() 
for ts_code_sh in daily_20180411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180411_tscode_list.append(stock_name)
daily_20180411_addname_dataframe=pd.DataFrame()
daily_20180411_addname_dataframe['cname'] = daily_20180411_tscode_list
for table_name in daily_20180411.columns.values.tolist():
    daily_20180411_addname_dataframe[table_name] = daily_20180411[table_name]
print("daily_20180411 返回数据 row 行数 = "+str(daily_20180411.shape[0]))
daily_20180411_addname_dataframe.to_excel(daily_201804_excel_writer,'11_3',index=False)
daily_201804_excel_writer.save()
daily_20180412 = pro.daily(start_date='',end_date='',trade_date='20180412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180412_tscode_list = list() 
for ts_code_sh in daily_20180412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180412_tscode_list.append(stock_name)
daily_20180412_addname_dataframe=pd.DataFrame()
daily_20180412_addname_dataframe['cname'] = daily_20180412_tscode_list
for table_name in daily_20180412.columns.values.tolist():
    daily_20180412_addname_dataframe[table_name] = daily_20180412[table_name]
print("daily_20180412 返回数据 row 行数 = "+str(daily_20180412.shape[0]))
daily_20180412_addname_dataframe.to_excel(daily_201804_excel_writer,'12_4',index=False)
daily_201804_excel_writer.save()
daily_20180413 = pro.daily(start_date='',end_date='',trade_date='20180413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180413_tscode_list = list() 
for ts_code_sh in daily_20180413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180413_tscode_list.append(stock_name)
daily_20180413_addname_dataframe=pd.DataFrame()
daily_20180413_addname_dataframe['cname'] = daily_20180413_tscode_list
for table_name in daily_20180413.columns.values.tolist():
    daily_20180413_addname_dataframe[table_name] = daily_20180413[table_name]
print("daily_20180413 返回数据 row 行数 = "+str(daily_20180413.shape[0]))
daily_20180413_addname_dataframe.to_excel(daily_201804_excel_writer,'13_5',index=False)
daily_201804_excel_writer.save()
daily_20180414 = pro.daily(start_date='',end_date='',trade_date='20180414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180414_tscode_list = list() 
for ts_code_sh in daily_20180414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180414_tscode_list.append(stock_name)
daily_20180414_addname_dataframe=pd.DataFrame()
daily_20180414_addname_dataframe['cname'] = daily_20180414_tscode_list
for table_name in daily_20180414.columns.values.tolist():
    daily_20180414_addname_dataframe[table_name] = daily_20180414[table_name]
print("daily_20180414 返回数据 row 行数 = "+str(daily_20180414.shape[0]))
daily_20180414_addname_dataframe.to_excel(daily_201804_excel_writer,'14_6',index=False)
daily_201804_excel_writer.save()
daily_20180415 = pro.daily(start_date='',end_date='',trade_date='20180415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180415_tscode_list = list() 
for ts_code_sh in daily_20180415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180415_tscode_list.append(stock_name)
daily_20180415_addname_dataframe=pd.DataFrame()
daily_20180415_addname_dataframe['cname'] = daily_20180415_tscode_list
for table_name in daily_20180415.columns.values.tolist():
    daily_20180415_addname_dataframe[table_name] = daily_20180415[table_name]
print("daily_20180415 返回数据 row 行数 = "+str(daily_20180415.shape[0]))
daily_20180415_addname_dataframe.to_excel(daily_201804_excel_writer,'15_7',index=False)
daily_201804_excel_writer.save()
daily_20180416 = pro.daily(start_date='',end_date='',trade_date='20180416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180416_tscode_list = list() 
for ts_code_sh in daily_20180416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180416_tscode_list.append(stock_name)
daily_20180416_addname_dataframe=pd.DataFrame()
daily_20180416_addname_dataframe['cname'] = daily_20180416_tscode_list
for table_name in daily_20180416.columns.values.tolist():
    daily_20180416_addname_dataframe[table_name] = daily_20180416[table_name]
print("daily_20180416 返回数据 row 行数 = "+str(daily_20180416.shape[0]))
daily_20180416_addname_dataframe.to_excel(daily_201804_excel_writer,'16_1',index=False)
daily_201804_excel_writer.save()
daily_20180417 = pro.daily(start_date='',end_date='',trade_date='20180417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180417_tscode_list = list() 
for ts_code_sh in daily_20180417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180417_tscode_list.append(stock_name)
daily_20180417_addname_dataframe=pd.DataFrame()
daily_20180417_addname_dataframe['cname'] = daily_20180417_tscode_list
for table_name in daily_20180417.columns.values.tolist():
    daily_20180417_addname_dataframe[table_name] = daily_20180417[table_name]
print("daily_20180417 返回数据 row 行数 = "+str(daily_20180417.shape[0]))
daily_20180417_addname_dataframe.to_excel(daily_201804_excel_writer,'17_2',index=False)
daily_201804_excel_writer.save()
daily_20180418 = pro.daily(start_date='',end_date='',trade_date='20180418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180418_tscode_list = list() 
for ts_code_sh in daily_20180418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180418_tscode_list.append(stock_name)
daily_20180418_addname_dataframe=pd.DataFrame()
daily_20180418_addname_dataframe['cname'] = daily_20180418_tscode_list
for table_name in daily_20180418.columns.values.tolist():
    daily_20180418_addname_dataframe[table_name] = daily_20180418[table_name]
print("daily_20180418 返回数据 row 行数 = "+str(daily_20180418.shape[0]))
daily_20180418_addname_dataframe.to_excel(daily_201804_excel_writer,'18_3',index=False)
daily_201804_excel_writer.save()
daily_20180419 = pro.daily(start_date='',end_date='',trade_date='20180419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180419_tscode_list = list() 
for ts_code_sh in daily_20180419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180419_tscode_list.append(stock_name)
daily_20180419_addname_dataframe=pd.DataFrame()
daily_20180419_addname_dataframe['cname'] = daily_20180419_tscode_list
for table_name in daily_20180419.columns.values.tolist():
    daily_20180419_addname_dataframe[table_name] = daily_20180419[table_name]
print("daily_20180419 返回数据 row 行数 = "+str(daily_20180419.shape[0]))
daily_20180419_addname_dataframe.to_excel(daily_201804_excel_writer,'19_4',index=False)
daily_201804_excel_writer.save()
daily_20180420 = pro.daily(start_date='',end_date='',trade_date='20180420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180420_tscode_list = list() 
for ts_code_sh in daily_20180420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180420_tscode_list.append(stock_name)
daily_20180420_addname_dataframe=pd.DataFrame()
daily_20180420_addname_dataframe['cname'] = daily_20180420_tscode_list
for table_name in daily_20180420.columns.values.tolist():
    daily_20180420_addname_dataframe[table_name] = daily_20180420[table_name]
print("daily_20180420 返回数据 row 行数 = "+str(daily_20180420.shape[0]))
daily_20180420_addname_dataframe.to_excel(daily_201804_excel_writer,'20_5',index=False)
daily_201804_excel_writer.save()
daily_20180421 = pro.daily(start_date='',end_date='',trade_date='20180421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180421_tscode_list = list() 
for ts_code_sh in daily_20180421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180421_tscode_list.append(stock_name)
daily_20180421_addname_dataframe=pd.DataFrame()
daily_20180421_addname_dataframe['cname'] = daily_20180421_tscode_list
for table_name in daily_20180421.columns.values.tolist():
    daily_20180421_addname_dataframe[table_name] = daily_20180421[table_name]
print("daily_20180421 返回数据 row 行数 = "+str(daily_20180421.shape[0]))
daily_20180421_addname_dataframe.to_excel(daily_201804_excel_writer,'21_6',index=False)
daily_201804_excel_writer.save()
daily_20180422 = pro.daily(start_date='',end_date='',trade_date='20180422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180422_tscode_list = list() 
for ts_code_sh in daily_20180422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180422_tscode_list.append(stock_name)
daily_20180422_addname_dataframe=pd.DataFrame()
daily_20180422_addname_dataframe['cname'] = daily_20180422_tscode_list
for table_name in daily_20180422.columns.values.tolist():
    daily_20180422_addname_dataframe[table_name] = daily_20180422[table_name]
print("daily_20180422 返回数据 row 行数 = "+str(daily_20180422.shape[0]))
daily_20180422_addname_dataframe.to_excel(daily_201804_excel_writer,'22_7',index=False)
daily_201804_excel_writer.save()
daily_20180423 = pro.daily(start_date='',end_date='',trade_date='20180423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180423_tscode_list = list() 
for ts_code_sh in daily_20180423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180423_tscode_list.append(stock_name)
daily_20180423_addname_dataframe=pd.DataFrame()
daily_20180423_addname_dataframe['cname'] = daily_20180423_tscode_list
for table_name in daily_20180423.columns.values.tolist():
    daily_20180423_addname_dataframe[table_name] = daily_20180423[table_name]
print("daily_20180423 返回数据 row 行数 = "+str(daily_20180423.shape[0]))
daily_20180423_addname_dataframe.to_excel(daily_201804_excel_writer,'23_1',index=False)
daily_201804_excel_writer.save()
daily_20180424 = pro.daily(start_date='',end_date='',trade_date='20180424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180424_tscode_list = list() 
for ts_code_sh in daily_20180424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180424_tscode_list.append(stock_name)
daily_20180424_addname_dataframe=pd.DataFrame()
daily_20180424_addname_dataframe['cname'] = daily_20180424_tscode_list
for table_name in daily_20180424.columns.values.tolist():
    daily_20180424_addname_dataframe[table_name] = daily_20180424[table_name]
print("daily_20180424 返回数据 row 行数 = "+str(daily_20180424.shape[0]))
daily_20180424_addname_dataframe.to_excel(daily_201804_excel_writer,'24_2',index=False)
daily_201804_excel_writer.save()
daily_20180425 = pro.daily(start_date='',end_date='',trade_date='20180425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180425_tscode_list = list() 
for ts_code_sh in daily_20180425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180425_tscode_list.append(stock_name)
daily_20180425_addname_dataframe=pd.DataFrame()
daily_20180425_addname_dataframe['cname'] = daily_20180425_tscode_list
for table_name in daily_20180425.columns.values.tolist():
    daily_20180425_addname_dataframe[table_name] = daily_20180425[table_name]
print("daily_20180425 返回数据 row 行数 = "+str(daily_20180425.shape[0]))
daily_20180425_addname_dataframe.to_excel(daily_201804_excel_writer,'25_3',index=False)
daily_201804_excel_writer.save()
daily_20180426 = pro.daily(start_date='',end_date='',trade_date='20180426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180426_tscode_list = list() 
for ts_code_sh in daily_20180426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180426_tscode_list.append(stock_name)
daily_20180426_addname_dataframe=pd.DataFrame()
daily_20180426_addname_dataframe['cname'] = daily_20180426_tscode_list
for table_name in daily_20180426.columns.values.tolist():
    daily_20180426_addname_dataframe[table_name] = daily_20180426[table_name]
print("daily_20180426 返回数据 row 行数 = "+str(daily_20180426.shape[0]))
daily_20180426_addname_dataframe.to_excel(daily_201804_excel_writer,'26_4',index=False)
daily_201804_excel_writer.save()
daily_20180427 = pro.daily(start_date='',end_date='',trade_date='20180427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180427_tscode_list = list() 
for ts_code_sh in daily_20180427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180427_tscode_list.append(stock_name)
daily_20180427_addname_dataframe=pd.DataFrame()
daily_20180427_addname_dataframe['cname'] = daily_20180427_tscode_list
for table_name in daily_20180427.columns.values.tolist():
    daily_20180427_addname_dataframe[table_name] = daily_20180427[table_name]
print("daily_20180427 返回数据 row 行数 = "+str(daily_20180427.shape[0]))
daily_20180427_addname_dataframe.to_excel(daily_201804_excel_writer,'27_5',index=False)
daily_201804_excel_writer.save()
daily_20180428 = pro.daily(start_date='',end_date='',trade_date='20180428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180428_tscode_list = list() 
for ts_code_sh in daily_20180428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180428_tscode_list.append(stock_name)
daily_20180428_addname_dataframe=pd.DataFrame()
daily_20180428_addname_dataframe['cname'] = daily_20180428_tscode_list
for table_name in daily_20180428.columns.values.tolist():
    daily_20180428_addname_dataframe[table_name] = daily_20180428[table_name]
print("daily_20180428 返回数据 row 行数 = "+str(daily_20180428.shape[0]))
daily_20180428_addname_dataframe.to_excel(daily_201804_excel_writer,'28_6',index=False)
daily_201804_excel_writer.save()
daily_20180429 = pro.daily(start_date='',end_date='',trade_date='20180429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180429_tscode_list = list() 
for ts_code_sh in daily_20180429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180429_tscode_list.append(stock_name)
daily_20180429_addname_dataframe=pd.DataFrame()
daily_20180429_addname_dataframe['cname'] = daily_20180429_tscode_list
for table_name in daily_20180429.columns.values.tolist():
    daily_20180429_addname_dataframe[table_name] = daily_20180429[table_name]
print("daily_20180429 返回数据 row 行数 = "+str(daily_20180429.shape[0]))
daily_20180429_addname_dataframe.to_excel(daily_201804_excel_writer,'29_7',index=False)
daily_201804_excel_writer.save()
daily_20180430 = pro.daily(start_date='',end_date='',trade_date='20180430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180430_tscode_list = list() 
for ts_code_sh in daily_20180430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180430_tscode_list.append(stock_name)
daily_20180430_addname_dataframe=pd.DataFrame()
daily_20180430_addname_dataframe['cname'] = daily_20180430_tscode_list
for table_name in daily_20180430.columns.values.tolist():
    daily_20180430_addname_dataframe[table_name] = daily_20180430[table_name]
print("daily_20180430 返回数据 row 行数 = "+str(daily_20180430.shape[0]))
daily_20180430_addname_dataframe.to_excel(daily_201804_excel_writer,'30_1',index=False)
daily_201804_excel_writer.save()




createexcel('daily_201805.xlsx')
daily_201805_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201805.xlsx')
daily_201805_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201805.xlsx', engine='openpyxl')
daily_201805_excel_writer.book = daily_201805_book
daily_201805_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201805_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180501")       ###  更新 记录日期
daily_20180501 = pro.daily(start_date='',end_date='',trade_date='20180501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180501_tscode_list = list() 
for ts_code_sh in daily_20180501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180501_tscode_list.append(stock_name)
daily_20180501_addname_dataframe=pd.DataFrame()
daily_20180501_addname_dataframe['cname'] = daily_20180501_tscode_list
for table_name in daily_20180501.columns.values.tolist():
    daily_20180501_addname_dataframe[table_name] = daily_20180501[table_name]
print("daily_20180501 返回数据 row 行数 = "+str(daily_20180501.shape[0]))
daily_20180501_addname_dataframe.to_excel(daily_201805_excel_writer,'1_2',index=False)
daily_201805_excel_writer.save()
daily_20180502 = pro.daily(start_date='',end_date='',trade_date='20180502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180502_tscode_list = list() 
for ts_code_sh in daily_20180502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180502_tscode_list.append(stock_name)
daily_20180502_addname_dataframe=pd.DataFrame()
daily_20180502_addname_dataframe['cname'] = daily_20180502_tscode_list
for table_name in daily_20180502.columns.values.tolist():
    daily_20180502_addname_dataframe[table_name] = daily_20180502[table_name]
print("daily_20180502 返回数据 row 行数 = "+str(daily_20180502.shape[0]))
daily_20180502_addname_dataframe.to_excel(daily_201805_excel_writer,'2_3',index=False)
daily_201805_excel_writer.save()
daily_20180503 = pro.daily(start_date='',end_date='',trade_date='20180503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180503_tscode_list = list() 
for ts_code_sh in daily_20180503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180503_tscode_list.append(stock_name)
daily_20180503_addname_dataframe=pd.DataFrame()
daily_20180503_addname_dataframe['cname'] = daily_20180503_tscode_list
for table_name in daily_20180503.columns.values.tolist():
    daily_20180503_addname_dataframe[table_name] = daily_20180503[table_name]
print("daily_20180503 返回数据 row 行数 = "+str(daily_20180503.shape[0]))
daily_20180503_addname_dataframe.to_excel(daily_201805_excel_writer,'3_4',index=False)
daily_201805_excel_writer.save()
daily_20180504 = pro.daily(start_date='',end_date='',trade_date='20180504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180504_tscode_list = list() 
for ts_code_sh in daily_20180504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180504_tscode_list.append(stock_name)
daily_20180504_addname_dataframe=pd.DataFrame()
daily_20180504_addname_dataframe['cname'] = daily_20180504_tscode_list
for table_name in daily_20180504.columns.values.tolist():
    daily_20180504_addname_dataframe[table_name] = daily_20180504[table_name]
print("daily_20180504 返回数据 row 行数 = "+str(daily_20180504.shape[0]))
daily_20180504_addname_dataframe.to_excel(daily_201805_excel_writer,'4_5',index=False)
daily_201805_excel_writer.save()
daily_20180505 = pro.daily(start_date='',end_date='',trade_date='20180505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180505_tscode_list = list() 
for ts_code_sh in daily_20180505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180505_tscode_list.append(stock_name)
daily_20180505_addname_dataframe=pd.DataFrame()
daily_20180505_addname_dataframe['cname'] = daily_20180505_tscode_list
for table_name in daily_20180505.columns.values.tolist():
    daily_20180505_addname_dataframe[table_name] = daily_20180505[table_name]
print("daily_20180505 返回数据 row 行数 = "+str(daily_20180505.shape[0]))
daily_20180505_addname_dataframe.to_excel(daily_201805_excel_writer,'5_6',index=False)
daily_201805_excel_writer.save()
daily_20180506 = pro.daily(start_date='',end_date='',trade_date='20180506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180506_tscode_list = list() 
for ts_code_sh in daily_20180506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180506_tscode_list.append(stock_name)
daily_20180506_addname_dataframe=pd.DataFrame()
daily_20180506_addname_dataframe['cname'] = daily_20180506_tscode_list
for table_name in daily_20180506.columns.values.tolist():
    daily_20180506_addname_dataframe[table_name] = daily_20180506[table_name]
print("daily_20180506 返回数据 row 行数 = "+str(daily_20180506.shape[0]))
daily_20180506_addname_dataframe.to_excel(daily_201805_excel_writer,'6_7',index=False)
daily_201805_excel_writer.save()
daily_20180507 = pro.daily(start_date='',end_date='',trade_date='20180507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180507_tscode_list = list() 
for ts_code_sh in daily_20180507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180507_tscode_list.append(stock_name)
daily_20180507_addname_dataframe=pd.DataFrame()
daily_20180507_addname_dataframe['cname'] = daily_20180507_tscode_list
for table_name in daily_20180507.columns.values.tolist():
    daily_20180507_addname_dataframe[table_name] = daily_20180507[table_name]
print("daily_20180507 返回数据 row 行数 = "+str(daily_20180507.shape[0]))
daily_20180507_addname_dataframe.to_excel(daily_201805_excel_writer,'7_1',index=False)
daily_201805_excel_writer.save()
daily_20180508 = pro.daily(start_date='',end_date='',trade_date='20180508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180508_tscode_list = list() 
for ts_code_sh in daily_20180508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180508_tscode_list.append(stock_name)
daily_20180508_addname_dataframe=pd.DataFrame()
daily_20180508_addname_dataframe['cname'] = daily_20180508_tscode_list
for table_name in daily_20180508.columns.values.tolist():
    daily_20180508_addname_dataframe[table_name] = daily_20180508[table_name]
print("daily_20180508 返回数据 row 行数 = "+str(daily_20180508.shape[0]))
daily_20180508_addname_dataframe.to_excel(daily_201805_excel_writer,'8_2',index=False)
daily_201805_excel_writer.save()
daily_20180509 = pro.daily(start_date='',end_date='',trade_date='20180509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180509_tscode_list = list() 
for ts_code_sh in daily_20180509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180509_tscode_list.append(stock_name)
daily_20180509_addname_dataframe=pd.DataFrame()
daily_20180509_addname_dataframe['cname'] = daily_20180509_tscode_list
for table_name in daily_20180509.columns.values.tolist():
    daily_20180509_addname_dataframe[table_name] = daily_20180509[table_name]
print("daily_20180509 返回数据 row 行数 = "+str(daily_20180509.shape[0]))
daily_20180509_addname_dataframe.to_excel(daily_201805_excel_writer,'9_3',index=False)
daily_201805_excel_writer.save()
daily_20180510 = pro.daily(start_date='',end_date='',trade_date='20180510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180510_tscode_list = list() 
for ts_code_sh in daily_20180510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180510_tscode_list.append(stock_name)
daily_20180510_addname_dataframe=pd.DataFrame()
daily_20180510_addname_dataframe['cname'] = daily_20180510_tscode_list
for table_name in daily_20180510.columns.values.tolist():
    daily_20180510_addname_dataframe[table_name] = daily_20180510[table_name]
print("daily_20180510 返回数据 row 行数 = "+str(daily_20180510.shape[0]))
daily_20180510_addname_dataframe.to_excel(daily_201805_excel_writer,'10_4',index=False)
daily_201805_excel_writer.save()
daily_20180511 = pro.daily(start_date='',end_date='',trade_date='20180511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180511_tscode_list = list() 
for ts_code_sh in daily_20180511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180511_tscode_list.append(stock_name)
daily_20180511_addname_dataframe=pd.DataFrame()
daily_20180511_addname_dataframe['cname'] = daily_20180511_tscode_list
for table_name in daily_20180511.columns.values.tolist():
    daily_20180511_addname_dataframe[table_name] = daily_20180511[table_name]
print("daily_20180511 返回数据 row 行数 = "+str(daily_20180511.shape[0]))
daily_20180511_addname_dataframe.to_excel(daily_201805_excel_writer,'11_5',index=False)
daily_201805_excel_writer.save()
daily_20180512 = pro.daily(start_date='',end_date='',trade_date='20180512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180512_tscode_list = list() 
for ts_code_sh in daily_20180512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180512_tscode_list.append(stock_name)
daily_20180512_addname_dataframe=pd.DataFrame()
daily_20180512_addname_dataframe['cname'] = daily_20180512_tscode_list
for table_name in daily_20180512.columns.values.tolist():
    daily_20180512_addname_dataframe[table_name] = daily_20180512[table_name]
print("daily_20180512 返回数据 row 行数 = "+str(daily_20180512.shape[0]))
daily_20180512_addname_dataframe.to_excel(daily_201805_excel_writer,'12_6',index=False)
daily_201805_excel_writer.save()
daily_20180513 = pro.daily(start_date='',end_date='',trade_date='20180513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180513_tscode_list = list() 
for ts_code_sh in daily_20180513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180513_tscode_list.append(stock_name)
daily_20180513_addname_dataframe=pd.DataFrame()
daily_20180513_addname_dataframe['cname'] = daily_20180513_tscode_list
for table_name in daily_20180513.columns.values.tolist():
    daily_20180513_addname_dataframe[table_name] = daily_20180513[table_name]
print("daily_20180513 返回数据 row 行数 = "+str(daily_20180513.shape[0]))
daily_20180513_addname_dataframe.to_excel(daily_201805_excel_writer,'13_7',index=False)
daily_201805_excel_writer.save()
daily_20180514 = pro.daily(start_date='',end_date='',trade_date='20180514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180514_tscode_list = list() 
for ts_code_sh in daily_20180514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180514_tscode_list.append(stock_name)
daily_20180514_addname_dataframe=pd.DataFrame()
daily_20180514_addname_dataframe['cname'] = daily_20180514_tscode_list
for table_name in daily_20180514.columns.values.tolist():
    daily_20180514_addname_dataframe[table_name] = daily_20180514[table_name]
print("daily_20180514 返回数据 row 行数 = "+str(daily_20180514.shape[0]))
daily_20180514_addname_dataframe.to_excel(daily_201805_excel_writer,'14_1',index=False)
daily_201805_excel_writer.save()
daily_20180515 = pro.daily(start_date='',end_date='',trade_date='20180515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180515_tscode_list = list() 
for ts_code_sh in daily_20180515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180515_tscode_list.append(stock_name)
daily_20180515_addname_dataframe=pd.DataFrame()
daily_20180515_addname_dataframe['cname'] = daily_20180515_tscode_list
for table_name in daily_20180515.columns.values.tolist():
    daily_20180515_addname_dataframe[table_name] = daily_20180515[table_name]
print("daily_20180515 返回数据 row 行数 = "+str(daily_20180515.shape[0]))
daily_20180515_addname_dataframe.to_excel(daily_201805_excel_writer,'15_2',index=False)
daily_201805_excel_writer.save()
daily_20180516 = pro.daily(start_date='',end_date='',trade_date='20180516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180516_tscode_list = list() 
for ts_code_sh in daily_20180516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180516_tscode_list.append(stock_name)
daily_20180516_addname_dataframe=pd.DataFrame()
daily_20180516_addname_dataframe['cname'] = daily_20180516_tscode_list
for table_name in daily_20180516.columns.values.tolist():
    daily_20180516_addname_dataframe[table_name] = daily_20180516[table_name]
print("daily_20180516 返回数据 row 行数 = "+str(daily_20180516.shape[0]))
daily_20180516_addname_dataframe.to_excel(daily_201805_excel_writer,'16_3',index=False)
daily_201805_excel_writer.save()
daily_20180517 = pro.daily(start_date='',end_date='',trade_date='20180517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180517_tscode_list = list() 
for ts_code_sh in daily_20180517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180517_tscode_list.append(stock_name)
daily_20180517_addname_dataframe=pd.DataFrame()
daily_20180517_addname_dataframe['cname'] = daily_20180517_tscode_list
for table_name in daily_20180517.columns.values.tolist():
    daily_20180517_addname_dataframe[table_name] = daily_20180517[table_name]
print("daily_20180517 返回数据 row 行数 = "+str(daily_20180517.shape[0]))
daily_20180517_addname_dataframe.to_excel(daily_201805_excel_writer,'17_4',index=False)
daily_201805_excel_writer.save()
daily_20180518 = pro.daily(start_date='',end_date='',trade_date='20180518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180518_tscode_list = list() 
for ts_code_sh in daily_20180518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180518_tscode_list.append(stock_name)
daily_20180518_addname_dataframe=pd.DataFrame()
daily_20180518_addname_dataframe['cname'] = daily_20180518_tscode_list
for table_name in daily_20180518.columns.values.tolist():
    daily_20180518_addname_dataframe[table_name] = daily_20180518[table_name]
print("daily_20180518 返回数据 row 行数 = "+str(daily_20180518.shape[0]))
daily_20180518_addname_dataframe.to_excel(daily_201805_excel_writer,'18_5',index=False)
daily_201805_excel_writer.save()
daily_20180519 = pro.daily(start_date='',end_date='',trade_date='20180519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180519_tscode_list = list() 
for ts_code_sh in daily_20180519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180519_tscode_list.append(stock_name)
daily_20180519_addname_dataframe=pd.DataFrame()
daily_20180519_addname_dataframe['cname'] = daily_20180519_tscode_list
for table_name in daily_20180519.columns.values.tolist():
    daily_20180519_addname_dataframe[table_name] = daily_20180519[table_name]
print("daily_20180519 返回数据 row 行数 = "+str(daily_20180519.shape[0]))
daily_20180519_addname_dataframe.to_excel(daily_201805_excel_writer,'19_6',index=False)
daily_201805_excel_writer.save()
daily_20180520 = pro.daily(start_date='',end_date='',trade_date='20180520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180520_tscode_list = list() 
for ts_code_sh in daily_20180520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180520_tscode_list.append(stock_name)
daily_20180520_addname_dataframe=pd.DataFrame()
daily_20180520_addname_dataframe['cname'] = daily_20180520_tscode_list
for table_name in daily_20180520.columns.values.tolist():
    daily_20180520_addname_dataframe[table_name] = daily_20180520[table_name]
print("daily_20180520 返回数据 row 行数 = "+str(daily_20180520.shape[0]))
daily_20180520_addname_dataframe.to_excel(daily_201805_excel_writer,'20_7',index=False)
daily_201805_excel_writer.save()
daily_20180521 = pro.daily(start_date='',end_date='',trade_date='20180521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180521_tscode_list = list() 
for ts_code_sh in daily_20180521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180521_tscode_list.append(stock_name)
daily_20180521_addname_dataframe=pd.DataFrame()
daily_20180521_addname_dataframe['cname'] = daily_20180521_tscode_list
for table_name in daily_20180521.columns.values.tolist():
    daily_20180521_addname_dataframe[table_name] = daily_20180521[table_name]
print("daily_20180521 返回数据 row 行数 = "+str(daily_20180521.shape[0]))
daily_20180521_addname_dataframe.to_excel(daily_201805_excel_writer,'21_1',index=False)
daily_201805_excel_writer.save()
daily_20180522 = pro.daily(start_date='',end_date='',trade_date='20180522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180522_tscode_list = list() 
for ts_code_sh in daily_20180522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180522_tscode_list.append(stock_name)
daily_20180522_addname_dataframe=pd.DataFrame()
daily_20180522_addname_dataframe['cname'] = daily_20180522_tscode_list
for table_name in daily_20180522.columns.values.tolist():
    daily_20180522_addname_dataframe[table_name] = daily_20180522[table_name]
print("daily_20180522 返回数据 row 行数 = "+str(daily_20180522.shape[0]))
daily_20180522_addname_dataframe.to_excel(daily_201805_excel_writer,'22_2',index=False)
daily_201805_excel_writer.save()
daily_20180523 = pro.daily(start_date='',end_date='',trade_date='20180523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180523_tscode_list = list() 
for ts_code_sh in daily_20180523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180523_tscode_list.append(stock_name)
daily_20180523_addname_dataframe=pd.DataFrame()
daily_20180523_addname_dataframe['cname'] = daily_20180523_tscode_list
for table_name in daily_20180523.columns.values.tolist():
    daily_20180523_addname_dataframe[table_name] = daily_20180523[table_name]
print("daily_20180523 返回数据 row 行数 = "+str(daily_20180523.shape[0]))
daily_20180523_addname_dataframe.to_excel(daily_201805_excel_writer,'23_3',index=False)
daily_201805_excel_writer.save()
daily_20180524 = pro.daily(start_date='',end_date='',trade_date='20180524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180524_tscode_list = list() 
for ts_code_sh in daily_20180524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180524_tscode_list.append(stock_name)
daily_20180524_addname_dataframe=pd.DataFrame()
daily_20180524_addname_dataframe['cname'] = daily_20180524_tscode_list
for table_name in daily_20180524.columns.values.tolist():
    daily_20180524_addname_dataframe[table_name] = daily_20180524[table_name]
print("daily_20180524 返回数据 row 行数 = "+str(daily_20180524.shape[0]))
daily_20180524_addname_dataframe.to_excel(daily_201805_excel_writer,'24_4',index=False)
daily_201805_excel_writer.save()
daily_20180525 = pro.daily(start_date='',end_date='',trade_date='20180525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180525_tscode_list = list() 
for ts_code_sh in daily_20180525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180525_tscode_list.append(stock_name)
daily_20180525_addname_dataframe=pd.DataFrame()
daily_20180525_addname_dataframe['cname'] = daily_20180525_tscode_list
for table_name in daily_20180525.columns.values.tolist():
    daily_20180525_addname_dataframe[table_name] = daily_20180525[table_name]
print("daily_20180525 返回数据 row 行数 = "+str(daily_20180525.shape[0]))
daily_20180525_addname_dataframe.to_excel(daily_201805_excel_writer,'25_5',index=False)
daily_201805_excel_writer.save()
daily_20180526 = pro.daily(start_date='',end_date='',trade_date='20180526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180526_tscode_list = list() 
for ts_code_sh in daily_20180526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180526_tscode_list.append(stock_name)
daily_20180526_addname_dataframe=pd.DataFrame()
daily_20180526_addname_dataframe['cname'] = daily_20180526_tscode_list
for table_name in daily_20180526.columns.values.tolist():
    daily_20180526_addname_dataframe[table_name] = daily_20180526[table_name]
print("daily_20180526 返回数据 row 行数 = "+str(daily_20180526.shape[0]))
daily_20180526_addname_dataframe.to_excel(daily_201805_excel_writer,'26_6',index=False)
daily_201805_excel_writer.save()
daily_20180527 = pro.daily(start_date='',end_date='',trade_date='20180527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180527_tscode_list = list() 
for ts_code_sh in daily_20180527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180527_tscode_list.append(stock_name)
daily_20180527_addname_dataframe=pd.DataFrame()
daily_20180527_addname_dataframe['cname'] = daily_20180527_tscode_list
for table_name in daily_20180527.columns.values.tolist():
    daily_20180527_addname_dataframe[table_name] = daily_20180527[table_name]
print("daily_20180527 返回数据 row 行数 = "+str(daily_20180527.shape[0]))
daily_20180527_addname_dataframe.to_excel(daily_201805_excel_writer,'27_7',index=False)
daily_201805_excel_writer.save()
daily_20180528 = pro.daily(start_date='',end_date='',trade_date='20180528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180528_tscode_list = list() 
for ts_code_sh in daily_20180528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180528_tscode_list.append(stock_name)
daily_20180528_addname_dataframe=pd.DataFrame()
daily_20180528_addname_dataframe['cname'] = daily_20180528_tscode_list
for table_name in daily_20180528.columns.values.tolist():
    daily_20180528_addname_dataframe[table_name] = daily_20180528[table_name]
print("daily_20180528 返回数据 row 行数 = "+str(daily_20180528.shape[0]))
daily_20180528_addname_dataframe.to_excel(daily_201805_excel_writer,'28_1',index=False)
daily_201805_excel_writer.save()
daily_20180529 = pro.daily(start_date='',end_date='',trade_date='20180529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180529_tscode_list = list() 
for ts_code_sh in daily_20180529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180529_tscode_list.append(stock_name)
daily_20180529_addname_dataframe=pd.DataFrame()
daily_20180529_addname_dataframe['cname'] = daily_20180529_tscode_list
for table_name in daily_20180529.columns.values.tolist():
    daily_20180529_addname_dataframe[table_name] = daily_20180529[table_name]
print("daily_20180529 返回数据 row 行数 = "+str(daily_20180529.shape[0]))
daily_20180529_addname_dataframe.to_excel(daily_201805_excel_writer,'29_2',index=False)
daily_201805_excel_writer.save()
daily_20180530 = pro.daily(start_date='',end_date='',trade_date='20180530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180530_tscode_list = list() 
for ts_code_sh in daily_20180530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180530_tscode_list.append(stock_name)
daily_20180530_addname_dataframe=pd.DataFrame()
daily_20180530_addname_dataframe['cname'] = daily_20180530_tscode_list
for table_name in daily_20180530.columns.values.tolist():
    daily_20180530_addname_dataframe[table_name] = daily_20180530[table_name]
print("daily_20180530 返回数据 row 行数 = "+str(daily_20180530.shape[0]))
daily_20180530_addname_dataframe.to_excel(daily_201805_excel_writer,'30_3',index=False)
daily_201805_excel_writer.save()
daily_20180531 = pro.daily(start_date='',end_date='',trade_date='20180531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180531_tscode_list = list() 
for ts_code_sh in daily_20180531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180531_tscode_list.append(stock_name)
daily_20180531_addname_dataframe=pd.DataFrame()
daily_20180531_addname_dataframe['cname'] = daily_20180531_tscode_list
for table_name in daily_20180531.columns.values.tolist():
    daily_20180531_addname_dataframe[table_name] = daily_20180531[table_name]
print("daily_20180531 返回数据 row 行数 = "+str(daily_20180531.shape[0]))
daily_20180531_addname_dataframe.to_excel(daily_201805_excel_writer,'31_4',index=False)
daily_201805_excel_writer.save()




createexcel('daily_201806.xlsx')
daily_201806_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201806.xlsx')
daily_201806_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201806.xlsx', engine='openpyxl')
daily_201806_excel_writer.book = daily_201806_book
daily_201806_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201806_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180601")       ###  更新 记录日期
daily_20180601 = pro.daily(start_date='',end_date='',trade_date='20180601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180601_tscode_list = list() 
for ts_code_sh in daily_20180601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180601_tscode_list.append(stock_name)
daily_20180601_addname_dataframe=pd.DataFrame()
daily_20180601_addname_dataframe['cname'] = daily_20180601_tscode_list
for table_name in daily_20180601.columns.values.tolist():
    daily_20180601_addname_dataframe[table_name] = daily_20180601[table_name]
print("daily_20180601 返回数据 row 行数 = "+str(daily_20180601.shape[0]))
daily_20180601_addname_dataframe.to_excel(daily_201806_excel_writer,'1_5',index=False)
daily_201806_excel_writer.save()
daily_20180602 = pro.daily(start_date='',end_date='',trade_date='20180602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180602_tscode_list = list() 
for ts_code_sh in daily_20180602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180602_tscode_list.append(stock_name)
daily_20180602_addname_dataframe=pd.DataFrame()
daily_20180602_addname_dataframe['cname'] = daily_20180602_tscode_list
for table_name in daily_20180602.columns.values.tolist():
    daily_20180602_addname_dataframe[table_name] = daily_20180602[table_name]
print("daily_20180602 返回数据 row 行数 = "+str(daily_20180602.shape[0]))
daily_20180602_addname_dataframe.to_excel(daily_201806_excel_writer,'2_6',index=False)
daily_201806_excel_writer.save()
daily_20180603 = pro.daily(start_date='',end_date='',trade_date='20180603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180603_tscode_list = list() 
for ts_code_sh in daily_20180603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180603_tscode_list.append(stock_name)
daily_20180603_addname_dataframe=pd.DataFrame()
daily_20180603_addname_dataframe['cname'] = daily_20180603_tscode_list
for table_name in daily_20180603.columns.values.tolist():
    daily_20180603_addname_dataframe[table_name] = daily_20180603[table_name]
print("daily_20180603 返回数据 row 行数 = "+str(daily_20180603.shape[0]))
daily_20180603_addname_dataframe.to_excel(daily_201806_excel_writer,'3_7',index=False)
daily_201806_excel_writer.save()
daily_20180604 = pro.daily(start_date='',end_date='',trade_date='20180604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180604_tscode_list = list() 
for ts_code_sh in daily_20180604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180604_tscode_list.append(stock_name)
daily_20180604_addname_dataframe=pd.DataFrame()
daily_20180604_addname_dataframe['cname'] = daily_20180604_tscode_list
for table_name in daily_20180604.columns.values.tolist():
    daily_20180604_addname_dataframe[table_name] = daily_20180604[table_name]
print("daily_20180604 返回数据 row 行数 = "+str(daily_20180604.shape[0]))
daily_20180604_addname_dataframe.to_excel(daily_201806_excel_writer,'4_1',index=False)
daily_201806_excel_writer.save()
daily_20180605 = pro.daily(start_date='',end_date='',trade_date='20180605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180605_tscode_list = list() 
for ts_code_sh in daily_20180605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180605_tscode_list.append(stock_name)
daily_20180605_addname_dataframe=pd.DataFrame()
daily_20180605_addname_dataframe['cname'] = daily_20180605_tscode_list
for table_name in daily_20180605.columns.values.tolist():
    daily_20180605_addname_dataframe[table_name] = daily_20180605[table_name]
print("daily_20180605 返回数据 row 行数 = "+str(daily_20180605.shape[0]))
daily_20180605_addname_dataframe.to_excel(daily_201806_excel_writer,'5_2',index=False)
daily_201806_excel_writer.save()
daily_20180606 = pro.daily(start_date='',end_date='',trade_date='20180606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180606_tscode_list = list() 
for ts_code_sh in daily_20180606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180606_tscode_list.append(stock_name)
daily_20180606_addname_dataframe=pd.DataFrame()
daily_20180606_addname_dataframe['cname'] = daily_20180606_tscode_list
for table_name in daily_20180606.columns.values.tolist():
    daily_20180606_addname_dataframe[table_name] = daily_20180606[table_name]
print("daily_20180606 返回数据 row 行数 = "+str(daily_20180606.shape[0]))
daily_20180606_addname_dataframe.to_excel(daily_201806_excel_writer,'6_3',index=False)
daily_201806_excel_writer.save()
daily_20180607 = pro.daily(start_date='',end_date='',trade_date='20180607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180607_tscode_list = list() 
for ts_code_sh in daily_20180607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180607_tscode_list.append(stock_name)
daily_20180607_addname_dataframe=pd.DataFrame()
daily_20180607_addname_dataframe['cname'] = daily_20180607_tscode_list
for table_name in daily_20180607.columns.values.tolist():
    daily_20180607_addname_dataframe[table_name] = daily_20180607[table_name]
print("daily_20180607 返回数据 row 行数 = "+str(daily_20180607.shape[0]))
daily_20180607_addname_dataframe.to_excel(daily_201806_excel_writer,'7_4',index=False)
daily_201806_excel_writer.save()
daily_20180608 = pro.daily(start_date='',end_date='',trade_date='20180608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180608_tscode_list = list() 
for ts_code_sh in daily_20180608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180608_tscode_list.append(stock_name)
daily_20180608_addname_dataframe=pd.DataFrame()
daily_20180608_addname_dataframe['cname'] = daily_20180608_tscode_list
for table_name in daily_20180608.columns.values.tolist():
    daily_20180608_addname_dataframe[table_name] = daily_20180608[table_name]
print("daily_20180608 返回数据 row 行数 = "+str(daily_20180608.shape[0]))
daily_20180608_addname_dataframe.to_excel(daily_201806_excel_writer,'8_5',index=False)
daily_201806_excel_writer.save()
daily_20180609 = pro.daily(start_date='',end_date='',trade_date='20180609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180609_tscode_list = list() 
for ts_code_sh in daily_20180609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180609_tscode_list.append(stock_name)
daily_20180609_addname_dataframe=pd.DataFrame()
daily_20180609_addname_dataframe['cname'] = daily_20180609_tscode_list
for table_name in daily_20180609.columns.values.tolist():
    daily_20180609_addname_dataframe[table_name] = daily_20180609[table_name]
print("daily_20180609 返回数据 row 行数 = "+str(daily_20180609.shape[0]))
daily_20180609_addname_dataframe.to_excel(daily_201806_excel_writer,'9_6',index=False)
daily_201806_excel_writer.save()
daily_20180610 = pro.daily(start_date='',end_date='',trade_date='20180610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180610_tscode_list = list() 
for ts_code_sh in daily_20180610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180610_tscode_list.append(stock_name)
daily_20180610_addname_dataframe=pd.DataFrame()
daily_20180610_addname_dataframe['cname'] = daily_20180610_tscode_list
for table_name in daily_20180610.columns.values.tolist():
    daily_20180610_addname_dataframe[table_name] = daily_20180610[table_name]
print("daily_20180610 返回数据 row 行数 = "+str(daily_20180610.shape[0]))
daily_20180610_addname_dataframe.to_excel(daily_201806_excel_writer,'10_7',index=False)
daily_201806_excel_writer.save()
daily_20180611 = pro.daily(start_date='',end_date='',trade_date='20180611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180611_tscode_list = list() 
for ts_code_sh in daily_20180611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180611_tscode_list.append(stock_name)
daily_20180611_addname_dataframe=pd.DataFrame()
daily_20180611_addname_dataframe['cname'] = daily_20180611_tscode_list
for table_name in daily_20180611.columns.values.tolist():
    daily_20180611_addname_dataframe[table_name] = daily_20180611[table_name]
print("daily_20180611 返回数据 row 行数 = "+str(daily_20180611.shape[0]))
daily_20180611_addname_dataframe.to_excel(daily_201806_excel_writer,'11_1',index=False)
daily_201806_excel_writer.save()
daily_20180612 = pro.daily(start_date='',end_date='',trade_date='20180612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180612_tscode_list = list() 
for ts_code_sh in daily_20180612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180612_tscode_list.append(stock_name)
daily_20180612_addname_dataframe=pd.DataFrame()
daily_20180612_addname_dataframe['cname'] = daily_20180612_tscode_list
for table_name in daily_20180612.columns.values.tolist():
    daily_20180612_addname_dataframe[table_name] = daily_20180612[table_name]
print("daily_20180612 返回数据 row 行数 = "+str(daily_20180612.shape[0]))
daily_20180612_addname_dataframe.to_excel(daily_201806_excel_writer,'12_2',index=False)
daily_201806_excel_writer.save()
daily_20180613 = pro.daily(start_date='',end_date='',trade_date='20180613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180613_tscode_list = list() 
for ts_code_sh in daily_20180613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180613_tscode_list.append(stock_name)
daily_20180613_addname_dataframe=pd.DataFrame()
daily_20180613_addname_dataframe['cname'] = daily_20180613_tscode_list
for table_name in daily_20180613.columns.values.tolist():
    daily_20180613_addname_dataframe[table_name] = daily_20180613[table_name]
print("daily_20180613 返回数据 row 行数 = "+str(daily_20180613.shape[0]))
daily_20180613_addname_dataframe.to_excel(daily_201806_excel_writer,'13_3',index=False)
daily_201806_excel_writer.save()
daily_20180614 = pro.daily(start_date='',end_date='',trade_date='20180614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180614_tscode_list = list() 
for ts_code_sh in daily_20180614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180614_tscode_list.append(stock_name)
daily_20180614_addname_dataframe=pd.DataFrame()
daily_20180614_addname_dataframe['cname'] = daily_20180614_tscode_list
for table_name in daily_20180614.columns.values.tolist():
    daily_20180614_addname_dataframe[table_name] = daily_20180614[table_name]
print("daily_20180614 返回数据 row 行数 = "+str(daily_20180614.shape[0]))
daily_20180614_addname_dataframe.to_excel(daily_201806_excel_writer,'14_4',index=False)
daily_201806_excel_writer.save()
daily_20180615 = pro.daily(start_date='',end_date='',trade_date='20180615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180615_tscode_list = list() 
for ts_code_sh in daily_20180615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180615_tscode_list.append(stock_name)
daily_20180615_addname_dataframe=pd.DataFrame()
daily_20180615_addname_dataframe['cname'] = daily_20180615_tscode_list
for table_name in daily_20180615.columns.values.tolist():
    daily_20180615_addname_dataframe[table_name] = daily_20180615[table_name]
print("daily_20180615 返回数据 row 行数 = "+str(daily_20180615.shape[0]))
daily_20180615_addname_dataframe.to_excel(daily_201806_excel_writer,'15_5',index=False)
daily_201806_excel_writer.save()
daily_20180616 = pro.daily(start_date='',end_date='',trade_date='20180616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180616_tscode_list = list() 
for ts_code_sh in daily_20180616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180616_tscode_list.append(stock_name)
daily_20180616_addname_dataframe=pd.DataFrame()
daily_20180616_addname_dataframe['cname'] = daily_20180616_tscode_list
for table_name in daily_20180616.columns.values.tolist():
    daily_20180616_addname_dataframe[table_name] = daily_20180616[table_name]
print("daily_20180616 返回数据 row 行数 = "+str(daily_20180616.shape[0]))
daily_20180616_addname_dataframe.to_excel(daily_201806_excel_writer,'16_6',index=False)
daily_201806_excel_writer.save()
daily_20180617 = pro.daily(start_date='',end_date='',trade_date='20180617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180617_tscode_list = list() 
for ts_code_sh in daily_20180617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180617_tscode_list.append(stock_name)
daily_20180617_addname_dataframe=pd.DataFrame()
daily_20180617_addname_dataframe['cname'] = daily_20180617_tscode_list
for table_name in daily_20180617.columns.values.tolist():
    daily_20180617_addname_dataframe[table_name] = daily_20180617[table_name]
print("daily_20180617 返回数据 row 行数 = "+str(daily_20180617.shape[0]))
daily_20180617_addname_dataframe.to_excel(daily_201806_excel_writer,'17_7',index=False)
daily_201806_excel_writer.save()
daily_20180618 = pro.daily(start_date='',end_date='',trade_date='20180618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180618_tscode_list = list() 
for ts_code_sh in daily_20180618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180618_tscode_list.append(stock_name)
daily_20180618_addname_dataframe=pd.DataFrame()
daily_20180618_addname_dataframe['cname'] = daily_20180618_tscode_list
for table_name in daily_20180618.columns.values.tolist():
    daily_20180618_addname_dataframe[table_name] = daily_20180618[table_name]
print("daily_20180618 返回数据 row 行数 = "+str(daily_20180618.shape[0]))
daily_20180618_addname_dataframe.to_excel(daily_201806_excel_writer,'18_1',index=False)
daily_201806_excel_writer.save()
daily_20180619 = pro.daily(start_date='',end_date='',trade_date='20180619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180619_tscode_list = list() 
for ts_code_sh in daily_20180619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180619_tscode_list.append(stock_name)
daily_20180619_addname_dataframe=pd.DataFrame()
daily_20180619_addname_dataframe['cname'] = daily_20180619_tscode_list
for table_name in daily_20180619.columns.values.tolist():
    daily_20180619_addname_dataframe[table_name] = daily_20180619[table_name]
print("daily_20180619 返回数据 row 行数 = "+str(daily_20180619.shape[0]))
daily_20180619_addname_dataframe.to_excel(daily_201806_excel_writer,'19_2',index=False)
daily_201806_excel_writer.save()
daily_20180620 = pro.daily(start_date='',end_date='',trade_date='20180620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180620_tscode_list = list() 
for ts_code_sh in daily_20180620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180620_tscode_list.append(stock_name)
daily_20180620_addname_dataframe=pd.DataFrame()
daily_20180620_addname_dataframe['cname'] = daily_20180620_tscode_list
for table_name in daily_20180620.columns.values.tolist():
    daily_20180620_addname_dataframe[table_name] = daily_20180620[table_name]
print("daily_20180620 返回数据 row 行数 = "+str(daily_20180620.shape[0]))
daily_20180620_addname_dataframe.to_excel(daily_201806_excel_writer,'20_3',index=False)
daily_201806_excel_writer.save()
daily_20180621 = pro.daily(start_date='',end_date='',trade_date='20180621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180621_tscode_list = list() 
for ts_code_sh in daily_20180621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180621_tscode_list.append(stock_name)
daily_20180621_addname_dataframe=pd.DataFrame()
daily_20180621_addname_dataframe['cname'] = daily_20180621_tscode_list
for table_name in daily_20180621.columns.values.tolist():
    daily_20180621_addname_dataframe[table_name] = daily_20180621[table_name]
print("daily_20180621 返回数据 row 行数 = "+str(daily_20180621.shape[0]))
daily_20180621_addname_dataframe.to_excel(daily_201806_excel_writer,'21_4',index=False)
daily_201806_excel_writer.save()
daily_20180622 = pro.daily(start_date='',end_date='',trade_date='20180622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180622_tscode_list = list() 
for ts_code_sh in daily_20180622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180622_tscode_list.append(stock_name)
daily_20180622_addname_dataframe=pd.DataFrame()
daily_20180622_addname_dataframe['cname'] = daily_20180622_tscode_list
for table_name in daily_20180622.columns.values.tolist():
    daily_20180622_addname_dataframe[table_name] = daily_20180622[table_name]
print("daily_20180622 返回数据 row 行数 = "+str(daily_20180622.shape[0]))
daily_20180622_addname_dataframe.to_excel(daily_201806_excel_writer,'22_5',index=False)
daily_201806_excel_writer.save()
daily_20180623 = pro.daily(start_date='',end_date='',trade_date='20180623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180623_tscode_list = list() 
for ts_code_sh in daily_20180623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180623_tscode_list.append(stock_name)
daily_20180623_addname_dataframe=pd.DataFrame()
daily_20180623_addname_dataframe['cname'] = daily_20180623_tscode_list
for table_name in daily_20180623.columns.values.tolist():
    daily_20180623_addname_dataframe[table_name] = daily_20180623[table_name]
print("daily_20180623 返回数据 row 行数 = "+str(daily_20180623.shape[0]))
daily_20180623_addname_dataframe.to_excel(daily_201806_excel_writer,'23_6',index=False)
daily_201806_excel_writer.save()
daily_20180624 = pro.daily(start_date='',end_date='',trade_date='20180624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180624_tscode_list = list() 
for ts_code_sh in daily_20180624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180624_tscode_list.append(stock_name)
daily_20180624_addname_dataframe=pd.DataFrame()
daily_20180624_addname_dataframe['cname'] = daily_20180624_tscode_list
for table_name in daily_20180624.columns.values.tolist():
    daily_20180624_addname_dataframe[table_name] = daily_20180624[table_name]
print("daily_20180624 返回数据 row 行数 = "+str(daily_20180624.shape[0]))
daily_20180624_addname_dataframe.to_excel(daily_201806_excel_writer,'24_7',index=False)
daily_201806_excel_writer.save()
daily_20180625 = pro.daily(start_date='',end_date='',trade_date='20180625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180625_tscode_list = list() 
for ts_code_sh in daily_20180625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180625_tscode_list.append(stock_name)
daily_20180625_addname_dataframe=pd.DataFrame()
daily_20180625_addname_dataframe['cname'] = daily_20180625_tscode_list
for table_name in daily_20180625.columns.values.tolist():
    daily_20180625_addname_dataframe[table_name] = daily_20180625[table_name]
print("daily_20180625 返回数据 row 行数 = "+str(daily_20180625.shape[0]))
daily_20180625_addname_dataframe.to_excel(daily_201806_excel_writer,'25_1',index=False)
daily_201806_excel_writer.save()
daily_20180626 = pro.daily(start_date='',end_date='',trade_date='20180626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180626_tscode_list = list() 
for ts_code_sh in daily_20180626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180626_tscode_list.append(stock_name)
daily_20180626_addname_dataframe=pd.DataFrame()
daily_20180626_addname_dataframe['cname'] = daily_20180626_tscode_list
for table_name in daily_20180626.columns.values.tolist():
    daily_20180626_addname_dataframe[table_name] = daily_20180626[table_name]
print("daily_20180626 返回数据 row 行数 = "+str(daily_20180626.shape[0]))
daily_20180626_addname_dataframe.to_excel(daily_201806_excel_writer,'26_2',index=False)
daily_201806_excel_writer.save()
daily_20180627 = pro.daily(start_date='',end_date='',trade_date='20180627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180627_tscode_list = list() 
for ts_code_sh in daily_20180627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180627_tscode_list.append(stock_name)
daily_20180627_addname_dataframe=pd.DataFrame()
daily_20180627_addname_dataframe['cname'] = daily_20180627_tscode_list
for table_name in daily_20180627.columns.values.tolist():
    daily_20180627_addname_dataframe[table_name] = daily_20180627[table_name]
print("daily_20180627 返回数据 row 行数 = "+str(daily_20180627.shape[0]))
daily_20180627_addname_dataframe.to_excel(daily_201806_excel_writer,'27_3',index=False)
daily_201806_excel_writer.save()
daily_20180628 = pro.daily(start_date='',end_date='',trade_date='20180628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180628_tscode_list = list() 
for ts_code_sh in daily_20180628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180628_tscode_list.append(stock_name)
daily_20180628_addname_dataframe=pd.DataFrame()
daily_20180628_addname_dataframe['cname'] = daily_20180628_tscode_list
for table_name in daily_20180628.columns.values.tolist():
    daily_20180628_addname_dataframe[table_name] = daily_20180628[table_name]
print("daily_20180628 返回数据 row 行数 = "+str(daily_20180628.shape[0]))
daily_20180628_addname_dataframe.to_excel(daily_201806_excel_writer,'28_4',index=False)
daily_201806_excel_writer.save()
daily_20180629 = pro.daily(start_date='',end_date='',trade_date='20180629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180629_tscode_list = list() 
for ts_code_sh in daily_20180629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180629_tscode_list.append(stock_name)
daily_20180629_addname_dataframe=pd.DataFrame()
daily_20180629_addname_dataframe['cname'] = daily_20180629_tscode_list
for table_name in daily_20180629.columns.values.tolist():
    daily_20180629_addname_dataframe[table_name] = daily_20180629[table_name]
print("daily_20180629 返回数据 row 行数 = "+str(daily_20180629.shape[0]))
daily_20180629_addname_dataframe.to_excel(daily_201806_excel_writer,'29_5',index=False)
daily_201806_excel_writer.save()
daily_20180630 = pro.daily(start_date='',end_date='',trade_date='20180630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180630_tscode_list = list() 
for ts_code_sh in daily_20180630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180630_tscode_list.append(stock_name)
daily_20180630_addname_dataframe=pd.DataFrame()
daily_20180630_addname_dataframe['cname'] = daily_20180630_tscode_list
for table_name in daily_20180630.columns.values.tolist():
    daily_20180630_addname_dataframe[table_name] = daily_20180630[table_name]
print("daily_20180630 返回数据 row 行数 = "+str(daily_20180630.shape[0]))
daily_20180630_addname_dataframe.to_excel(daily_201806_excel_writer,'30_6',index=False)
daily_201806_excel_writer.save()




createexcel('daily_201807.xlsx')
daily_201807_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201807.xlsx')
daily_201807_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201807.xlsx', engine='openpyxl')
daily_201807_excel_writer.book = daily_201807_book
daily_201807_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201807_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180701")       ###  更新 记录日期
daily_20180701 = pro.daily(start_date='',end_date='',trade_date='20180701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180701_tscode_list = list() 
for ts_code_sh in daily_20180701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180701_tscode_list.append(stock_name)
daily_20180701_addname_dataframe=pd.DataFrame()
daily_20180701_addname_dataframe['cname'] = daily_20180701_tscode_list
for table_name in daily_20180701.columns.values.tolist():
    daily_20180701_addname_dataframe[table_name] = daily_20180701[table_name]
print("daily_20180701 返回数据 row 行数 = "+str(daily_20180701.shape[0]))
daily_20180701_addname_dataframe.to_excel(daily_201807_excel_writer,'1_7',index=False)
daily_201807_excel_writer.save()
daily_20180702 = pro.daily(start_date='',end_date='',trade_date='20180702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180702_tscode_list = list() 
for ts_code_sh in daily_20180702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180702_tscode_list.append(stock_name)
daily_20180702_addname_dataframe=pd.DataFrame()
daily_20180702_addname_dataframe['cname'] = daily_20180702_tscode_list
for table_name in daily_20180702.columns.values.tolist():
    daily_20180702_addname_dataframe[table_name] = daily_20180702[table_name]
print("daily_20180702 返回数据 row 行数 = "+str(daily_20180702.shape[0]))
daily_20180702_addname_dataframe.to_excel(daily_201807_excel_writer,'2_1',index=False)
daily_201807_excel_writer.save()
daily_20180703 = pro.daily(start_date='',end_date='',trade_date='20180703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180703_tscode_list = list() 
for ts_code_sh in daily_20180703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180703_tscode_list.append(stock_name)
daily_20180703_addname_dataframe=pd.DataFrame()
daily_20180703_addname_dataframe['cname'] = daily_20180703_tscode_list
for table_name in daily_20180703.columns.values.tolist():
    daily_20180703_addname_dataframe[table_name] = daily_20180703[table_name]
print("daily_20180703 返回数据 row 行数 = "+str(daily_20180703.shape[0]))
daily_20180703_addname_dataframe.to_excel(daily_201807_excel_writer,'3_2',index=False)
daily_201807_excel_writer.save()
daily_20180704 = pro.daily(start_date='',end_date='',trade_date='20180704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180704_tscode_list = list() 
for ts_code_sh in daily_20180704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180704_tscode_list.append(stock_name)
daily_20180704_addname_dataframe=pd.DataFrame()
daily_20180704_addname_dataframe['cname'] = daily_20180704_tscode_list
for table_name in daily_20180704.columns.values.tolist():
    daily_20180704_addname_dataframe[table_name] = daily_20180704[table_name]
print("daily_20180704 返回数据 row 行数 = "+str(daily_20180704.shape[0]))
daily_20180704_addname_dataframe.to_excel(daily_201807_excel_writer,'4_3',index=False)
daily_201807_excel_writer.save()
daily_20180705 = pro.daily(start_date='',end_date='',trade_date='20180705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180705_tscode_list = list() 
for ts_code_sh in daily_20180705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180705_tscode_list.append(stock_name)
daily_20180705_addname_dataframe=pd.DataFrame()
daily_20180705_addname_dataframe['cname'] = daily_20180705_tscode_list
for table_name in daily_20180705.columns.values.tolist():
    daily_20180705_addname_dataframe[table_name] = daily_20180705[table_name]
print("daily_20180705 返回数据 row 行数 = "+str(daily_20180705.shape[0]))
daily_20180705_addname_dataframe.to_excel(daily_201807_excel_writer,'5_4',index=False)
daily_201807_excel_writer.save()
daily_20180706 = pro.daily(start_date='',end_date='',trade_date='20180706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180706_tscode_list = list() 
for ts_code_sh in daily_20180706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180706_tscode_list.append(stock_name)
daily_20180706_addname_dataframe=pd.DataFrame()
daily_20180706_addname_dataframe['cname'] = daily_20180706_tscode_list
for table_name in daily_20180706.columns.values.tolist():
    daily_20180706_addname_dataframe[table_name] = daily_20180706[table_name]
print("daily_20180706 返回数据 row 行数 = "+str(daily_20180706.shape[0]))
daily_20180706_addname_dataframe.to_excel(daily_201807_excel_writer,'6_5',index=False)
daily_201807_excel_writer.save()
daily_20180707 = pro.daily(start_date='',end_date='',trade_date='20180707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180707_tscode_list = list() 
for ts_code_sh in daily_20180707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180707_tscode_list.append(stock_name)
daily_20180707_addname_dataframe=pd.DataFrame()
daily_20180707_addname_dataframe['cname'] = daily_20180707_tscode_list
for table_name in daily_20180707.columns.values.tolist():
    daily_20180707_addname_dataframe[table_name] = daily_20180707[table_name]
print("daily_20180707 返回数据 row 行数 = "+str(daily_20180707.shape[0]))
daily_20180707_addname_dataframe.to_excel(daily_201807_excel_writer,'7_6',index=False)
daily_201807_excel_writer.save()
daily_20180708 = pro.daily(start_date='',end_date='',trade_date='20180708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180708_tscode_list = list() 
for ts_code_sh in daily_20180708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180708_tscode_list.append(stock_name)
daily_20180708_addname_dataframe=pd.DataFrame()
daily_20180708_addname_dataframe['cname'] = daily_20180708_tscode_list
for table_name in daily_20180708.columns.values.tolist():
    daily_20180708_addname_dataframe[table_name] = daily_20180708[table_name]
print("daily_20180708 返回数据 row 行数 = "+str(daily_20180708.shape[0]))
daily_20180708_addname_dataframe.to_excel(daily_201807_excel_writer,'8_7',index=False)
daily_201807_excel_writer.save()
daily_20180709 = pro.daily(start_date='',end_date='',trade_date='20180709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180709_tscode_list = list() 
for ts_code_sh in daily_20180709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180709_tscode_list.append(stock_name)
daily_20180709_addname_dataframe=pd.DataFrame()
daily_20180709_addname_dataframe['cname'] = daily_20180709_tscode_list
for table_name in daily_20180709.columns.values.tolist():
    daily_20180709_addname_dataframe[table_name] = daily_20180709[table_name]
print("daily_20180709 返回数据 row 行数 = "+str(daily_20180709.shape[0]))
daily_20180709_addname_dataframe.to_excel(daily_201807_excel_writer,'9_1',index=False)
daily_201807_excel_writer.save()
daily_20180710 = pro.daily(start_date='',end_date='',trade_date='20180710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180710_tscode_list = list() 
for ts_code_sh in daily_20180710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180710_tscode_list.append(stock_name)
daily_20180710_addname_dataframe=pd.DataFrame()
daily_20180710_addname_dataframe['cname'] = daily_20180710_tscode_list
for table_name in daily_20180710.columns.values.tolist():
    daily_20180710_addname_dataframe[table_name] = daily_20180710[table_name]
print("daily_20180710 返回数据 row 行数 = "+str(daily_20180710.shape[0]))
daily_20180710_addname_dataframe.to_excel(daily_201807_excel_writer,'10_2',index=False)
daily_201807_excel_writer.save()
daily_20180711 = pro.daily(start_date='',end_date='',trade_date='20180711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180711_tscode_list = list() 
for ts_code_sh in daily_20180711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180711_tscode_list.append(stock_name)
daily_20180711_addname_dataframe=pd.DataFrame()
daily_20180711_addname_dataframe['cname'] = daily_20180711_tscode_list
for table_name in daily_20180711.columns.values.tolist():
    daily_20180711_addname_dataframe[table_name] = daily_20180711[table_name]
print("daily_20180711 返回数据 row 行数 = "+str(daily_20180711.shape[0]))
daily_20180711_addname_dataframe.to_excel(daily_201807_excel_writer,'11_3',index=False)
daily_201807_excel_writer.save()
daily_20180712 = pro.daily(start_date='',end_date='',trade_date='20180712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180712_tscode_list = list() 
for ts_code_sh in daily_20180712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180712_tscode_list.append(stock_name)
daily_20180712_addname_dataframe=pd.DataFrame()
daily_20180712_addname_dataframe['cname'] = daily_20180712_tscode_list
for table_name in daily_20180712.columns.values.tolist():
    daily_20180712_addname_dataframe[table_name] = daily_20180712[table_name]
print("daily_20180712 返回数据 row 行数 = "+str(daily_20180712.shape[0]))
daily_20180712_addname_dataframe.to_excel(daily_201807_excel_writer,'12_4',index=False)
daily_201807_excel_writer.save()
daily_20180713 = pro.daily(start_date='',end_date='',trade_date='20180713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180713_tscode_list = list() 
for ts_code_sh in daily_20180713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180713_tscode_list.append(stock_name)
daily_20180713_addname_dataframe=pd.DataFrame()
daily_20180713_addname_dataframe['cname'] = daily_20180713_tscode_list
for table_name in daily_20180713.columns.values.tolist():
    daily_20180713_addname_dataframe[table_name] = daily_20180713[table_name]
print("daily_20180713 返回数据 row 行数 = "+str(daily_20180713.shape[0]))
daily_20180713_addname_dataframe.to_excel(daily_201807_excel_writer,'13_5',index=False)
daily_201807_excel_writer.save()
daily_20180714 = pro.daily(start_date='',end_date='',trade_date='20180714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180714_tscode_list = list() 
for ts_code_sh in daily_20180714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180714_tscode_list.append(stock_name)
daily_20180714_addname_dataframe=pd.DataFrame()
daily_20180714_addname_dataframe['cname'] = daily_20180714_tscode_list
for table_name in daily_20180714.columns.values.tolist():
    daily_20180714_addname_dataframe[table_name] = daily_20180714[table_name]
print("daily_20180714 返回数据 row 行数 = "+str(daily_20180714.shape[0]))
daily_20180714_addname_dataframe.to_excel(daily_201807_excel_writer,'14_6',index=False)
daily_201807_excel_writer.save()
daily_20180715 = pro.daily(start_date='',end_date='',trade_date='20180715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180715_tscode_list = list() 
for ts_code_sh in daily_20180715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180715_tscode_list.append(stock_name)
daily_20180715_addname_dataframe=pd.DataFrame()
daily_20180715_addname_dataframe['cname'] = daily_20180715_tscode_list
for table_name in daily_20180715.columns.values.tolist():
    daily_20180715_addname_dataframe[table_name] = daily_20180715[table_name]
print("daily_20180715 返回数据 row 行数 = "+str(daily_20180715.shape[0]))
daily_20180715_addname_dataframe.to_excel(daily_201807_excel_writer,'15_7',index=False)
daily_201807_excel_writer.save()
daily_20180716 = pro.daily(start_date='',end_date='',trade_date='20180716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180716_tscode_list = list() 
for ts_code_sh in daily_20180716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180716_tscode_list.append(stock_name)
daily_20180716_addname_dataframe=pd.DataFrame()
daily_20180716_addname_dataframe['cname'] = daily_20180716_tscode_list
for table_name in daily_20180716.columns.values.tolist():
    daily_20180716_addname_dataframe[table_name] = daily_20180716[table_name]
print("daily_20180716 返回数据 row 行数 = "+str(daily_20180716.shape[0]))
daily_20180716_addname_dataframe.to_excel(daily_201807_excel_writer,'16_1',index=False)
daily_201807_excel_writer.save()
daily_20180717 = pro.daily(start_date='',end_date='',trade_date='20180717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180717_tscode_list = list() 
for ts_code_sh in daily_20180717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180717_tscode_list.append(stock_name)
daily_20180717_addname_dataframe=pd.DataFrame()
daily_20180717_addname_dataframe['cname'] = daily_20180717_tscode_list
for table_name in daily_20180717.columns.values.tolist():
    daily_20180717_addname_dataframe[table_name] = daily_20180717[table_name]
print("daily_20180717 返回数据 row 行数 = "+str(daily_20180717.shape[0]))
daily_20180717_addname_dataframe.to_excel(daily_201807_excel_writer,'17_2',index=False)
daily_201807_excel_writer.save()
daily_20180718 = pro.daily(start_date='',end_date='',trade_date='20180718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180718_tscode_list = list() 
for ts_code_sh in daily_20180718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180718_tscode_list.append(stock_name)
daily_20180718_addname_dataframe=pd.DataFrame()
daily_20180718_addname_dataframe['cname'] = daily_20180718_tscode_list
for table_name in daily_20180718.columns.values.tolist():
    daily_20180718_addname_dataframe[table_name] = daily_20180718[table_name]
print("daily_20180718 返回数据 row 行数 = "+str(daily_20180718.shape[0]))
daily_20180718_addname_dataframe.to_excel(daily_201807_excel_writer,'18_3',index=False)
daily_201807_excel_writer.save()
daily_20180719 = pro.daily(start_date='',end_date='',trade_date='20180719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180719_tscode_list = list() 
for ts_code_sh in daily_20180719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180719_tscode_list.append(stock_name)
daily_20180719_addname_dataframe=pd.DataFrame()
daily_20180719_addname_dataframe['cname'] = daily_20180719_tscode_list
for table_name in daily_20180719.columns.values.tolist():
    daily_20180719_addname_dataframe[table_name] = daily_20180719[table_name]
print("daily_20180719 返回数据 row 行数 = "+str(daily_20180719.shape[0]))
daily_20180719_addname_dataframe.to_excel(daily_201807_excel_writer,'19_4',index=False)
daily_201807_excel_writer.save()
daily_20180720 = pro.daily(start_date='',end_date='',trade_date='20180720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180720_tscode_list = list() 
for ts_code_sh in daily_20180720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180720_tscode_list.append(stock_name)
daily_20180720_addname_dataframe=pd.DataFrame()
daily_20180720_addname_dataframe['cname'] = daily_20180720_tscode_list
for table_name in daily_20180720.columns.values.tolist():
    daily_20180720_addname_dataframe[table_name] = daily_20180720[table_name]
print("daily_20180720 返回数据 row 行数 = "+str(daily_20180720.shape[0]))
daily_20180720_addname_dataframe.to_excel(daily_201807_excel_writer,'20_5',index=False)
daily_201807_excel_writer.save()
daily_20180721 = pro.daily(start_date='',end_date='',trade_date='20180721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180721_tscode_list = list() 
for ts_code_sh in daily_20180721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180721_tscode_list.append(stock_name)
daily_20180721_addname_dataframe=pd.DataFrame()
daily_20180721_addname_dataframe['cname'] = daily_20180721_tscode_list
for table_name in daily_20180721.columns.values.tolist():
    daily_20180721_addname_dataframe[table_name] = daily_20180721[table_name]
print("daily_20180721 返回数据 row 行数 = "+str(daily_20180721.shape[0]))
daily_20180721_addname_dataframe.to_excel(daily_201807_excel_writer,'21_6',index=False)
daily_201807_excel_writer.save()
daily_20180722 = pro.daily(start_date='',end_date='',trade_date='20180722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180722_tscode_list = list() 
for ts_code_sh in daily_20180722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180722_tscode_list.append(stock_name)
daily_20180722_addname_dataframe=pd.DataFrame()
daily_20180722_addname_dataframe['cname'] = daily_20180722_tscode_list
for table_name in daily_20180722.columns.values.tolist():
    daily_20180722_addname_dataframe[table_name] = daily_20180722[table_name]
print("daily_20180722 返回数据 row 行数 = "+str(daily_20180722.shape[0]))
daily_20180722_addname_dataframe.to_excel(daily_201807_excel_writer,'22_7',index=False)
daily_201807_excel_writer.save()
daily_20180723 = pro.daily(start_date='',end_date='',trade_date='20180723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180723_tscode_list = list() 
for ts_code_sh in daily_20180723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180723_tscode_list.append(stock_name)
daily_20180723_addname_dataframe=pd.DataFrame()
daily_20180723_addname_dataframe['cname'] = daily_20180723_tscode_list
for table_name in daily_20180723.columns.values.tolist():
    daily_20180723_addname_dataframe[table_name] = daily_20180723[table_name]
print("daily_20180723 返回数据 row 行数 = "+str(daily_20180723.shape[0]))
daily_20180723_addname_dataframe.to_excel(daily_201807_excel_writer,'23_1',index=False)
daily_201807_excel_writer.save()
daily_20180724 = pro.daily(start_date='',end_date='',trade_date='20180724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180724_tscode_list = list() 
for ts_code_sh in daily_20180724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180724_tscode_list.append(stock_name)
daily_20180724_addname_dataframe=pd.DataFrame()
daily_20180724_addname_dataframe['cname'] = daily_20180724_tscode_list
for table_name in daily_20180724.columns.values.tolist():
    daily_20180724_addname_dataframe[table_name] = daily_20180724[table_name]
print("daily_20180724 返回数据 row 行数 = "+str(daily_20180724.shape[0]))
daily_20180724_addname_dataframe.to_excel(daily_201807_excel_writer,'24_2',index=False)
daily_201807_excel_writer.save()
daily_20180725 = pro.daily(start_date='',end_date='',trade_date='20180725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180725_tscode_list = list() 
for ts_code_sh in daily_20180725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180725_tscode_list.append(stock_name)
daily_20180725_addname_dataframe=pd.DataFrame()
daily_20180725_addname_dataframe['cname'] = daily_20180725_tscode_list
for table_name in daily_20180725.columns.values.tolist():
    daily_20180725_addname_dataframe[table_name] = daily_20180725[table_name]
print("daily_20180725 返回数据 row 行数 = "+str(daily_20180725.shape[0]))
daily_20180725_addname_dataframe.to_excel(daily_201807_excel_writer,'25_3',index=False)
daily_201807_excel_writer.save()
daily_20180726 = pro.daily(start_date='',end_date='',trade_date='20180726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180726_tscode_list = list() 
for ts_code_sh in daily_20180726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180726_tscode_list.append(stock_name)
daily_20180726_addname_dataframe=pd.DataFrame()
daily_20180726_addname_dataframe['cname'] = daily_20180726_tscode_list
for table_name in daily_20180726.columns.values.tolist():
    daily_20180726_addname_dataframe[table_name] = daily_20180726[table_name]
print("daily_20180726 返回数据 row 行数 = "+str(daily_20180726.shape[0]))
daily_20180726_addname_dataframe.to_excel(daily_201807_excel_writer,'26_4',index=False)
daily_201807_excel_writer.save()
daily_20180727 = pro.daily(start_date='',end_date='',trade_date='20180727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180727_tscode_list = list() 
for ts_code_sh in daily_20180727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180727_tscode_list.append(stock_name)
daily_20180727_addname_dataframe=pd.DataFrame()
daily_20180727_addname_dataframe['cname'] = daily_20180727_tscode_list
for table_name in daily_20180727.columns.values.tolist():
    daily_20180727_addname_dataframe[table_name] = daily_20180727[table_name]
print("daily_20180727 返回数据 row 行数 = "+str(daily_20180727.shape[0]))
daily_20180727_addname_dataframe.to_excel(daily_201807_excel_writer,'27_5',index=False)
daily_201807_excel_writer.save()
daily_20180728 = pro.daily(start_date='',end_date='',trade_date='20180728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180728_tscode_list = list() 
for ts_code_sh in daily_20180728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180728_tscode_list.append(stock_name)
daily_20180728_addname_dataframe=pd.DataFrame()
daily_20180728_addname_dataframe['cname'] = daily_20180728_tscode_list
for table_name in daily_20180728.columns.values.tolist():
    daily_20180728_addname_dataframe[table_name] = daily_20180728[table_name]
print("daily_20180728 返回数据 row 行数 = "+str(daily_20180728.shape[0]))
daily_20180728_addname_dataframe.to_excel(daily_201807_excel_writer,'28_6',index=False)
daily_201807_excel_writer.save()
daily_20180729 = pro.daily(start_date='',end_date='',trade_date='20180729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180729_tscode_list = list() 
for ts_code_sh in daily_20180729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180729_tscode_list.append(stock_name)
daily_20180729_addname_dataframe=pd.DataFrame()
daily_20180729_addname_dataframe['cname'] = daily_20180729_tscode_list
for table_name in daily_20180729.columns.values.tolist():
    daily_20180729_addname_dataframe[table_name] = daily_20180729[table_name]
print("daily_20180729 返回数据 row 行数 = "+str(daily_20180729.shape[0]))
daily_20180729_addname_dataframe.to_excel(daily_201807_excel_writer,'29_7',index=False)
daily_201807_excel_writer.save()
daily_20180730 = pro.daily(start_date='',end_date='',trade_date='20180730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180730_tscode_list = list() 
for ts_code_sh in daily_20180730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180730_tscode_list.append(stock_name)
daily_20180730_addname_dataframe=pd.DataFrame()
daily_20180730_addname_dataframe['cname'] = daily_20180730_tscode_list
for table_name in daily_20180730.columns.values.tolist():
    daily_20180730_addname_dataframe[table_name] = daily_20180730[table_name]
print("daily_20180730 返回数据 row 行数 = "+str(daily_20180730.shape[0]))
daily_20180730_addname_dataframe.to_excel(daily_201807_excel_writer,'30_1',index=False)
daily_201807_excel_writer.save()
daily_20180731 = pro.daily(start_date='',end_date='',trade_date='20180731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180731_tscode_list = list() 
for ts_code_sh in daily_20180731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180731_tscode_list.append(stock_name)
daily_20180731_addname_dataframe=pd.DataFrame()
daily_20180731_addname_dataframe['cname'] = daily_20180731_tscode_list
for table_name in daily_20180731.columns.values.tolist():
    daily_20180731_addname_dataframe[table_name] = daily_20180731[table_name]
print("daily_20180731 返回数据 row 行数 = "+str(daily_20180731.shape[0]))
daily_20180731_addname_dataframe.to_excel(daily_201807_excel_writer,'31_2',index=False)
daily_201807_excel_writer.save()




createexcel('daily_201808.xlsx')
daily_201808_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201808.xlsx')
daily_201808_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201808.xlsx', engine='openpyxl')
daily_201808_excel_writer.book = daily_201808_book
daily_201808_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201808_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180801")       ###  更新 记录日期
daily_20180801 = pro.daily(start_date='',end_date='',trade_date='20180801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180801_tscode_list = list() 
for ts_code_sh in daily_20180801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180801_tscode_list.append(stock_name)
daily_20180801_addname_dataframe=pd.DataFrame()
daily_20180801_addname_dataframe['cname'] = daily_20180801_tscode_list
for table_name in daily_20180801.columns.values.tolist():
    daily_20180801_addname_dataframe[table_name] = daily_20180801[table_name]
print("daily_20180801 返回数据 row 行数 = "+str(daily_20180801.shape[0]))
daily_20180801_addname_dataframe.to_excel(daily_201808_excel_writer,'1_3',index=False)
daily_201808_excel_writer.save()
daily_20180802 = pro.daily(start_date='',end_date='',trade_date='20180802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180802_tscode_list = list() 
for ts_code_sh in daily_20180802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180802_tscode_list.append(stock_name)
daily_20180802_addname_dataframe=pd.DataFrame()
daily_20180802_addname_dataframe['cname'] = daily_20180802_tscode_list
for table_name in daily_20180802.columns.values.tolist():
    daily_20180802_addname_dataframe[table_name] = daily_20180802[table_name]
print("daily_20180802 返回数据 row 行数 = "+str(daily_20180802.shape[0]))
daily_20180802_addname_dataframe.to_excel(daily_201808_excel_writer,'2_4',index=False)
daily_201808_excel_writer.save()
daily_20180803 = pro.daily(start_date='',end_date='',trade_date='20180803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180803_tscode_list = list() 
for ts_code_sh in daily_20180803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180803_tscode_list.append(stock_name)
daily_20180803_addname_dataframe=pd.DataFrame()
daily_20180803_addname_dataframe['cname'] = daily_20180803_tscode_list
for table_name in daily_20180803.columns.values.tolist():
    daily_20180803_addname_dataframe[table_name] = daily_20180803[table_name]
print("daily_20180803 返回数据 row 行数 = "+str(daily_20180803.shape[0]))
daily_20180803_addname_dataframe.to_excel(daily_201808_excel_writer,'3_5',index=False)
daily_201808_excel_writer.save()
daily_20180804 = pro.daily(start_date='',end_date='',trade_date='20180804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180804_tscode_list = list() 
for ts_code_sh in daily_20180804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180804_tscode_list.append(stock_name)
daily_20180804_addname_dataframe=pd.DataFrame()
daily_20180804_addname_dataframe['cname'] = daily_20180804_tscode_list
for table_name in daily_20180804.columns.values.tolist():
    daily_20180804_addname_dataframe[table_name] = daily_20180804[table_name]
print("daily_20180804 返回数据 row 行数 = "+str(daily_20180804.shape[0]))
daily_20180804_addname_dataframe.to_excel(daily_201808_excel_writer,'4_6',index=False)
daily_201808_excel_writer.save()
daily_20180805 = pro.daily(start_date='',end_date='',trade_date='20180805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180805_tscode_list = list() 
for ts_code_sh in daily_20180805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180805_tscode_list.append(stock_name)
daily_20180805_addname_dataframe=pd.DataFrame()
daily_20180805_addname_dataframe['cname'] = daily_20180805_tscode_list
for table_name in daily_20180805.columns.values.tolist():
    daily_20180805_addname_dataframe[table_name] = daily_20180805[table_name]
print("daily_20180805 返回数据 row 行数 = "+str(daily_20180805.shape[0]))
daily_20180805_addname_dataframe.to_excel(daily_201808_excel_writer,'5_7',index=False)
daily_201808_excel_writer.save()
daily_20180806 = pro.daily(start_date='',end_date='',trade_date='20180806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180806_tscode_list = list() 
for ts_code_sh in daily_20180806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180806_tscode_list.append(stock_name)
daily_20180806_addname_dataframe=pd.DataFrame()
daily_20180806_addname_dataframe['cname'] = daily_20180806_tscode_list
for table_name in daily_20180806.columns.values.tolist():
    daily_20180806_addname_dataframe[table_name] = daily_20180806[table_name]
print("daily_20180806 返回数据 row 行数 = "+str(daily_20180806.shape[0]))
daily_20180806_addname_dataframe.to_excel(daily_201808_excel_writer,'6_1',index=False)
daily_201808_excel_writer.save()
daily_20180807 = pro.daily(start_date='',end_date='',trade_date='20180807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180807_tscode_list = list() 
for ts_code_sh in daily_20180807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180807_tscode_list.append(stock_name)
daily_20180807_addname_dataframe=pd.DataFrame()
daily_20180807_addname_dataframe['cname'] = daily_20180807_tscode_list
for table_name in daily_20180807.columns.values.tolist():
    daily_20180807_addname_dataframe[table_name] = daily_20180807[table_name]
print("daily_20180807 返回数据 row 行数 = "+str(daily_20180807.shape[0]))
daily_20180807_addname_dataframe.to_excel(daily_201808_excel_writer,'7_2',index=False)
daily_201808_excel_writer.save()
daily_20180808 = pro.daily(start_date='',end_date='',trade_date='20180808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180808_tscode_list = list() 
for ts_code_sh in daily_20180808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180808_tscode_list.append(stock_name)
daily_20180808_addname_dataframe=pd.DataFrame()
daily_20180808_addname_dataframe['cname'] = daily_20180808_tscode_list
for table_name in daily_20180808.columns.values.tolist():
    daily_20180808_addname_dataframe[table_name] = daily_20180808[table_name]
print("daily_20180808 返回数据 row 行数 = "+str(daily_20180808.shape[0]))
daily_20180808_addname_dataframe.to_excel(daily_201808_excel_writer,'8_3',index=False)
daily_201808_excel_writer.save()
daily_20180809 = pro.daily(start_date='',end_date='',trade_date='20180809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180809_tscode_list = list() 
for ts_code_sh in daily_20180809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180809_tscode_list.append(stock_name)
daily_20180809_addname_dataframe=pd.DataFrame()
daily_20180809_addname_dataframe['cname'] = daily_20180809_tscode_list
for table_name in daily_20180809.columns.values.tolist():
    daily_20180809_addname_dataframe[table_name] = daily_20180809[table_name]
print("daily_20180809 返回数据 row 行数 = "+str(daily_20180809.shape[0]))
daily_20180809_addname_dataframe.to_excel(daily_201808_excel_writer,'9_4',index=False)
daily_201808_excel_writer.save()
daily_20180810 = pro.daily(start_date='',end_date='',trade_date='20180810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180810_tscode_list = list() 
for ts_code_sh in daily_20180810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180810_tscode_list.append(stock_name)
daily_20180810_addname_dataframe=pd.DataFrame()
daily_20180810_addname_dataframe['cname'] = daily_20180810_tscode_list
for table_name in daily_20180810.columns.values.tolist():
    daily_20180810_addname_dataframe[table_name] = daily_20180810[table_name]
print("daily_20180810 返回数据 row 行数 = "+str(daily_20180810.shape[0]))
daily_20180810_addname_dataframe.to_excel(daily_201808_excel_writer,'10_5',index=False)
daily_201808_excel_writer.save()
daily_20180811 = pro.daily(start_date='',end_date='',trade_date='20180811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180811_tscode_list = list() 
for ts_code_sh in daily_20180811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180811_tscode_list.append(stock_name)
daily_20180811_addname_dataframe=pd.DataFrame()
daily_20180811_addname_dataframe['cname'] = daily_20180811_tscode_list
for table_name in daily_20180811.columns.values.tolist():
    daily_20180811_addname_dataframe[table_name] = daily_20180811[table_name]
print("daily_20180811 返回数据 row 行数 = "+str(daily_20180811.shape[0]))
daily_20180811_addname_dataframe.to_excel(daily_201808_excel_writer,'11_6',index=False)
daily_201808_excel_writer.save()
daily_20180812 = pro.daily(start_date='',end_date='',trade_date='20180812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180812_tscode_list = list() 
for ts_code_sh in daily_20180812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180812_tscode_list.append(stock_name)
daily_20180812_addname_dataframe=pd.DataFrame()
daily_20180812_addname_dataframe['cname'] = daily_20180812_tscode_list
for table_name in daily_20180812.columns.values.tolist():
    daily_20180812_addname_dataframe[table_name] = daily_20180812[table_name]
print("daily_20180812 返回数据 row 行数 = "+str(daily_20180812.shape[0]))
daily_20180812_addname_dataframe.to_excel(daily_201808_excel_writer,'12_7',index=False)
daily_201808_excel_writer.save()
daily_20180813 = pro.daily(start_date='',end_date='',trade_date='20180813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180813_tscode_list = list() 
for ts_code_sh in daily_20180813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180813_tscode_list.append(stock_name)
daily_20180813_addname_dataframe=pd.DataFrame()
daily_20180813_addname_dataframe['cname'] = daily_20180813_tscode_list
for table_name in daily_20180813.columns.values.tolist():
    daily_20180813_addname_dataframe[table_name] = daily_20180813[table_name]
print("daily_20180813 返回数据 row 行数 = "+str(daily_20180813.shape[0]))
daily_20180813_addname_dataframe.to_excel(daily_201808_excel_writer,'13_1',index=False)
daily_201808_excel_writer.save()
daily_20180814 = pro.daily(start_date='',end_date='',trade_date='20180814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180814_tscode_list = list() 
for ts_code_sh in daily_20180814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180814_tscode_list.append(stock_name)
daily_20180814_addname_dataframe=pd.DataFrame()
daily_20180814_addname_dataframe['cname'] = daily_20180814_tscode_list
for table_name in daily_20180814.columns.values.tolist():
    daily_20180814_addname_dataframe[table_name] = daily_20180814[table_name]
print("daily_20180814 返回数据 row 行数 = "+str(daily_20180814.shape[0]))
daily_20180814_addname_dataframe.to_excel(daily_201808_excel_writer,'14_2',index=False)
daily_201808_excel_writer.save()
daily_20180815 = pro.daily(start_date='',end_date='',trade_date='20180815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180815_tscode_list = list() 
for ts_code_sh in daily_20180815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180815_tscode_list.append(stock_name)
daily_20180815_addname_dataframe=pd.DataFrame()
daily_20180815_addname_dataframe['cname'] = daily_20180815_tscode_list
for table_name in daily_20180815.columns.values.tolist():
    daily_20180815_addname_dataframe[table_name] = daily_20180815[table_name]
print("daily_20180815 返回数据 row 行数 = "+str(daily_20180815.shape[0]))
daily_20180815_addname_dataframe.to_excel(daily_201808_excel_writer,'15_3',index=False)
daily_201808_excel_writer.save()
daily_20180816 = pro.daily(start_date='',end_date='',trade_date='20180816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180816_tscode_list = list() 
for ts_code_sh in daily_20180816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180816_tscode_list.append(stock_name)
daily_20180816_addname_dataframe=pd.DataFrame()
daily_20180816_addname_dataframe['cname'] = daily_20180816_tscode_list
for table_name in daily_20180816.columns.values.tolist():
    daily_20180816_addname_dataframe[table_name] = daily_20180816[table_name]
print("daily_20180816 返回数据 row 行数 = "+str(daily_20180816.shape[0]))
daily_20180816_addname_dataframe.to_excel(daily_201808_excel_writer,'16_4',index=False)
daily_201808_excel_writer.save()
daily_20180817 = pro.daily(start_date='',end_date='',trade_date='20180817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180817_tscode_list = list() 
for ts_code_sh in daily_20180817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180817_tscode_list.append(stock_name)
daily_20180817_addname_dataframe=pd.DataFrame()
daily_20180817_addname_dataframe['cname'] = daily_20180817_tscode_list
for table_name in daily_20180817.columns.values.tolist():
    daily_20180817_addname_dataframe[table_name] = daily_20180817[table_name]
print("daily_20180817 返回数据 row 行数 = "+str(daily_20180817.shape[0]))
daily_20180817_addname_dataframe.to_excel(daily_201808_excel_writer,'17_5',index=False)
daily_201808_excel_writer.save()
daily_20180818 = pro.daily(start_date='',end_date='',trade_date='20180818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180818_tscode_list = list() 
for ts_code_sh in daily_20180818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180818_tscode_list.append(stock_name)
daily_20180818_addname_dataframe=pd.DataFrame()
daily_20180818_addname_dataframe['cname'] = daily_20180818_tscode_list
for table_name in daily_20180818.columns.values.tolist():
    daily_20180818_addname_dataframe[table_name] = daily_20180818[table_name]
print("daily_20180818 返回数据 row 行数 = "+str(daily_20180818.shape[0]))
daily_20180818_addname_dataframe.to_excel(daily_201808_excel_writer,'18_6',index=False)
daily_201808_excel_writer.save()
daily_20180819 = pro.daily(start_date='',end_date='',trade_date='20180819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180819_tscode_list = list() 
for ts_code_sh in daily_20180819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180819_tscode_list.append(stock_name)
daily_20180819_addname_dataframe=pd.DataFrame()
daily_20180819_addname_dataframe['cname'] = daily_20180819_tscode_list
for table_name in daily_20180819.columns.values.tolist():
    daily_20180819_addname_dataframe[table_name] = daily_20180819[table_name]
print("daily_20180819 返回数据 row 行数 = "+str(daily_20180819.shape[0]))
daily_20180819_addname_dataframe.to_excel(daily_201808_excel_writer,'19_7',index=False)
daily_201808_excel_writer.save()
daily_20180820 = pro.daily(start_date='',end_date='',trade_date='20180820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180820_tscode_list = list() 
for ts_code_sh in daily_20180820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180820_tscode_list.append(stock_name)
daily_20180820_addname_dataframe=pd.DataFrame()
daily_20180820_addname_dataframe['cname'] = daily_20180820_tscode_list
for table_name in daily_20180820.columns.values.tolist():
    daily_20180820_addname_dataframe[table_name] = daily_20180820[table_name]
print("daily_20180820 返回数据 row 行数 = "+str(daily_20180820.shape[0]))
daily_20180820_addname_dataframe.to_excel(daily_201808_excel_writer,'20_1',index=False)
daily_201808_excel_writer.save()
daily_20180821 = pro.daily(start_date='',end_date='',trade_date='20180821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180821_tscode_list = list() 
for ts_code_sh in daily_20180821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180821_tscode_list.append(stock_name)
daily_20180821_addname_dataframe=pd.DataFrame()
daily_20180821_addname_dataframe['cname'] = daily_20180821_tscode_list
for table_name in daily_20180821.columns.values.tolist():
    daily_20180821_addname_dataframe[table_name] = daily_20180821[table_name]
print("daily_20180821 返回数据 row 行数 = "+str(daily_20180821.shape[0]))
daily_20180821_addname_dataframe.to_excel(daily_201808_excel_writer,'21_2',index=False)
daily_201808_excel_writer.save()
daily_20180822 = pro.daily(start_date='',end_date='',trade_date='20180822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180822_tscode_list = list() 
for ts_code_sh in daily_20180822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180822_tscode_list.append(stock_name)
daily_20180822_addname_dataframe=pd.DataFrame()
daily_20180822_addname_dataframe['cname'] = daily_20180822_tscode_list
for table_name in daily_20180822.columns.values.tolist():
    daily_20180822_addname_dataframe[table_name] = daily_20180822[table_name]
print("daily_20180822 返回数据 row 行数 = "+str(daily_20180822.shape[0]))
daily_20180822_addname_dataframe.to_excel(daily_201808_excel_writer,'22_3',index=False)
daily_201808_excel_writer.save()
daily_20180823 = pro.daily(start_date='',end_date='',trade_date='20180823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180823_tscode_list = list() 
for ts_code_sh in daily_20180823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180823_tscode_list.append(stock_name)
daily_20180823_addname_dataframe=pd.DataFrame()
daily_20180823_addname_dataframe['cname'] = daily_20180823_tscode_list
for table_name in daily_20180823.columns.values.tolist():
    daily_20180823_addname_dataframe[table_name] = daily_20180823[table_name]
print("daily_20180823 返回数据 row 行数 = "+str(daily_20180823.shape[0]))
daily_20180823_addname_dataframe.to_excel(daily_201808_excel_writer,'23_4',index=False)
daily_201808_excel_writer.save()
daily_20180824 = pro.daily(start_date='',end_date='',trade_date='20180824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180824_tscode_list = list() 
for ts_code_sh in daily_20180824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180824_tscode_list.append(stock_name)
daily_20180824_addname_dataframe=pd.DataFrame()
daily_20180824_addname_dataframe['cname'] = daily_20180824_tscode_list
for table_name in daily_20180824.columns.values.tolist():
    daily_20180824_addname_dataframe[table_name] = daily_20180824[table_name]
print("daily_20180824 返回数据 row 行数 = "+str(daily_20180824.shape[0]))
daily_20180824_addname_dataframe.to_excel(daily_201808_excel_writer,'24_5',index=False)
daily_201808_excel_writer.save()
daily_20180825 = pro.daily(start_date='',end_date='',trade_date='20180825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180825_tscode_list = list() 
for ts_code_sh in daily_20180825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180825_tscode_list.append(stock_name)
daily_20180825_addname_dataframe=pd.DataFrame()
daily_20180825_addname_dataframe['cname'] = daily_20180825_tscode_list
for table_name in daily_20180825.columns.values.tolist():
    daily_20180825_addname_dataframe[table_name] = daily_20180825[table_name]
print("daily_20180825 返回数据 row 行数 = "+str(daily_20180825.shape[0]))
daily_20180825_addname_dataframe.to_excel(daily_201808_excel_writer,'25_6',index=False)
daily_201808_excel_writer.save()
daily_20180826 = pro.daily(start_date='',end_date='',trade_date='20180826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180826_tscode_list = list() 
for ts_code_sh in daily_20180826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180826_tscode_list.append(stock_name)
daily_20180826_addname_dataframe=pd.DataFrame()
daily_20180826_addname_dataframe['cname'] = daily_20180826_tscode_list
for table_name in daily_20180826.columns.values.tolist():
    daily_20180826_addname_dataframe[table_name] = daily_20180826[table_name]
print("daily_20180826 返回数据 row 行数 = "+str(daily_20180826.shape[0]))
daily_20180826_addname_dataframe.to_excel(daily_201808_excel_writer,'26_7',index=False)
daily_201808_excel_writer.save()
daily_20180827 = pro.daily(start_date='',end_date='',trade_date='20180827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180827_tscode_list = list() 
for ts_code_sh in daily_20180827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180827_tscode_list.append(stock_name)
daily_20180827_addname_dataframe=pd.DataFrame()
daily_20180827_addname_dataframe['cname'] = daily_20180827_tscode_list
for table_name in daily_20180827.columns.values.tolist():
    daily_20180827_addname_dataframe[table_name] = daily_20180827[table_name]
print("daily_20180827 返回数据 row 行数 = "+str(daily_20180827.shape[0]))
daily_20180827_addname_dataframe.to_excel(daily_201808_excel_writer,'27_1',index=False)
daily_201808_excel_writer.save()
daily_20180828 = pro.daily(start_date='',end_date='',trade_date='20180828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180828_tscode_list = list() 
for ts_code_sh in daily_20180828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180828_tscode_list.append(stock_name)
daily_20180828_addname_dataframe=pd.DataFrame()
daily_20180828_addname_dataframe['cname'] = daily_20180828_tscode_list
for table_name in daily_20180828.columns.values.tolist():
    daily_20180828_addname_dataframe[table_name] = daily_20180828[table_name]
print("daily_20180828 返回数据 row 行数 = "+str(daily_20180828.shape[0]))
daily_20180828_addname_dataframe.to_excel(daily_201808_excel_writer,'28_2',index=False)
daily_201808_excel_writer.save()
daily_20180829 = pro.daily(start_date='',end_date='',trade_date='20180829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180829_tscode_list = list() 
for ts_code_sh in daily_20180829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180829_tscode_list.append(stock_name)
daily_20180829_addname_dataframe=pd.DataFrame()
daily_20180829_addname_dataframe['cname'] = daily_20180829_tscode_list
for table_name in daily_20180829.columns.values.tolist():
    daily_20180829_addname_dataframe[table_name] = daily_20180829[table_name]
print("daily_20180829 返回数据 row 行数 = "+str(daily_20180829.shape[0]))
daily_20180829_addname_dataframe.to_excel(daily_201808_excel_writer,'29_3',index=False)
daily_201808_excel_writer.save()
daily_20180830 = pro.daily(start_date='',end_date='',trade_date='20180830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180830_tscode_list = list() 
for ts_code_sh in daily_20180830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180830_tscode_list.append(stock_name)
daily_20180830_addname_dataframe=pd.DataFrame()
daily_20180830_addname_dataframe['cname'] = daily_20180830_tscode_list
for table_name in daily_20180830.columns.values.tolist():
    daily_20180830_addname_dataframe[table_name] = daily_20180830[table_name]
print("daily_20180830 返回数据 row 行数 = "+str(daily_20180830.shape[0]))
daily_20180830_addname_dataframe.to_excel(daily_201808_excel_writer,'30_4',index=False)
daily_201808_excel_writer.save()
daily_20180831 = pro.daily(start_date='',end_date='',trade_date='20180831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180831_tscode_list = list() 
for ts_code_sh in daily_20180831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180831_tscode_list.append(stock_name)
daily_20180831_addname_dataframe=pd.DataFrame()
daily_20180831_addname_dataframe['cname'] = daily_20180831_tscode_list
for table_name in daily_20180831.columns.values.tolist():
    daily_20180831_addname_dataframe[table_name] = daily_20180831[table_name]
print("daily_20180831 返回数据 row 行数 = "+str(daily_20180831.shape[0]))
daily_20180831_addname_dataframe.to_excel(daily_201808_excel_writer,'31_5',index=False)
daily_201808_excel_writer.save()




createexcel('daily_201809.xlsx')
daily_201809_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201809.xlsx')
daily_201809_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201809.xlsx', engine='openpyxl')
daily_201809_excel_writer.book = daily_201809_book
daily_201809_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201809_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180901")       ###  更新 记录日期
daily_20180901 = pro.daily(start_date='',end_date='',trade_date='20180901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180901_tscode_list = list() 
for ts_code_sh in daily_20180901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180901_tscode_list.append(stock_name)
daily_20180901_addname_dataframe=pd.DataFrame()
daily_20180901_addname_dataframe['cname'] = daily_20180901_tscode_list
for table_name in daily_20180901.columns.values.tolist():
    daily_20180901_addname_dataframe[table_name] = daily_20180901[table_name]
print("daily_20180901 返回数据 row 行数 = "+str(daily_20180901.shape[0]))
daily_20180901_addname_dataframe.to_excel(daily_201809_excel_writer,'1_6',index=False)
daily_201809_excel_writer.save()
daily_20180902 = pro.daily(start_date='',end_date='',trade_date='20180902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180902_tscode_list = list() 
for ts_code_sh in daily_20180902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180902_tscode_list.append(stock_name)
daily_20180902_addname_dataframe=pd.DataFrame()
daily_20180902_addname_dataframe['cname'] = daily_20180902_tscode_list
for table_name in daily_20180902.columns.values.tolist():
    daily_20180902_addname_dataframe[table_name] = daily_20180902[table_name]
print("daily_20180902 返回数据 row 行数 = "+str(daily_20180902.shape[0]))
daily_20180902_addname_dataframe.to_excel(daily_201809_excel_writer,'2_7',index=False)
daily_201809_excel_writer.save()
daily_20180903 = pro.daily(start_date='',end_date='',trade_date='20180903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180903_tscode_list = list() 
for ts_code_sh in daily_20180903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180903_tscode_list.append(stock_name)
daily_20180903_addname_dataframe=pd.DataFrame()
daily_20180903_addname_dataframe['cname'] = daily_20180903_tscode_list
for table_name in daily_20180903.columns.values.tolist():
    daily_20180903_addname_dataframe[table_name] = daily_20180903[table_name]
print("daily_20180903 返回数据 row 行数 = "+str(daily_20180903.shape[0]))
daily_20180903_addname_dataframe.to_excel(daily_201809_excel_writer,'3_1',index=False)
daily_201809_excel_writer.save()
daily_20180904 = pro.daily(start_date='',end_date='',trade_date='20180904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180904_tscode_list = list() 
for ts_code_sh in daily_20180904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180904_tscode_list.append(stock_name)
daily_20180904_addname_dataframe=pd.DataFrame()
daily_20180904_addname_dataframe['cname'] = daily_20180904_tscode_list
for table_name in daily_20180904.columns.values.tolist():
    daily_20180904_addname_dataframe[table_name] = daily_20180904[table_name]
print("daily_20180904 返回数据 row 行数 = "+str(daily_20180904.shape[0]))
daily_20180904_addname_dataframe.to_excel(daily_201809_excel_writer,'4_2',index=False)
daily_201809_excel_writer.save()
daily_20180905 = pro.daily(start_date='',end_date='',trade_date='20180905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180905_tscode_list = list() 
for ts_code_sh in daily_20180905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180905_tscode_list.append(stock_name)
daily_20180905_addname_dataframe=pd.DataFrame()
daily_20180905_addname_dataframe['cname'] = daily_20180905_tscode_list
for table_name in daily_20180905.columns.values.tolist():
    daily_20180905_addname_dataframe[table_name] = daily_20180905[table_name]
print("daily_20180905 返回数据 row 行数 = "+str(daily_20180905.shape[0]))
daily_20180905_addname_dataframe.to_excel(daily_201809_excel_writer,'5_3',index=False)
daily_201809_excel_writer.save()
daily_20180906 = pro.daily(start_date='',end_date='',trade_date='20180906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180906_tscode_list = list() 
for ts_code_sh in daily_20180906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180906_tscode_list.append(stock_name)
daily_20180906_addname_dataframe=pd.DataFrame()
daily_20180906_addname_dataframe['cname'] = daily_20180906_tscode_list
for table_name in daily_20180906.columns.values.tolist():
    daily_20180906_addname_dataframe[table_name] = daily_20180906[table_name]
print("daily_20180906 返回数据 row 行数 = "+str(daily_20180906.shape[0]))
daily_20180906_addname_dataframe.to_excel(daily_201809_excel_writer,'6_4',index=False)
daily_201809_excel_writer.save()
daily_20180907 = pro.daily(start_date='',end_date='',trade_date='20180907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180907_tscode_list = list() 
for ts_code_sh in daily_20180907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180907_tscode_list.append(stock_name)
daily_20180907_addname_dataframe=pd.DataFrame()
daily_20180907_addname_dataframe['cname'] = daily_20180907_tscode_list
for table_name in daily_20180907.columns.values.tolist():
    daily_20180907_addname_dataframe[table_name] = daily_20180907[table_name]
print("daily_20180907 返回数据 row 行数 = "+str(daily_20180907.shape[0]))
daily_20180907_addname_dataframe.to_excel(daily_201809_excel_writer,'7_5',index=False)
daily_201809_excel_writer.save()
daily_20180908 = pro.daily(start_date='',end_date='',trade_date='20180908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180908_tscode_list = list() 
for ts_code_sh in daily_20180908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180908_tscode_list.append(stock_name)
daily_20180908_addname_dataframe=pd.DataFrame()
daily_20180908_addname_dataframe['cname'] = daily_20180908_tscode_list
for table_name in daily_20180908.columns.values.tolist():
    daily_20180908_addname_dataframe[table_name] = daily_20180908[table_name]
print("daily_20180908 返回数据 row 行数 = "+str(daily_20180908.shape[0]))
daily_20180908_addname_dataframe.to_excel(daily_201809_excel_writer,'8_6',index=False)
daily_201809_excel_writer.save()
daily_20180909 = pro.daily(start_date='',end_date='',trade_date='20180909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180909_tscode_list = list() 
for ts_code_sh in daily_20180909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180909_tscode_list.append(stock_name)
daily_20180909_addname_dataframe=pd.DataFrame()
daily_20180909_addname_dataframe['cname'] = daily_20180909_tscode_list
for table_name in daily_20180909.columns.values.tolist():
    daily_20180909_addname_dataframe[table_name] = daily_20180909[table_name]
print("daily_20180909 返回数据 row 行数 = "+str(daily_20180909.shape[0]))
daily_20180909_addname_dataframe.to_excel(daily_201809_excel_writer,'9_7',index=False)
daily_201809_excel_writer.save()
daily_20180910 = pro.daily(start_date='',end_date='',trade_date='20180910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180910_tscode_list = list() 
for ts_code_sh in daily_20180910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180910_tscode_list.append(stock_name)
daily_20180910_addname_dataframe=pd.DataFrame()
daily_20180910_addname_dataframe['cname'] = daily_20180910_tscode_list
for table_name in daily_20180910.columns.values.tolist():
    daily_20180910_addname_dataframe[table_name] = daily_20180910[table_name]
print("daily_20180910 返回数据 row 行数 = "+str(daily_20180910.shape[0]))
daily_20180910_addname_dataframe.to_excel(daily_201809_excel_writer,'10_1',index=False)
daily_201809_excel_writer.save()
daily_20180911 = pro.daily(start_date='',end_date='',trade_date='20180911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180911_tscode_list = list() 
for ts_code_sh in daily_20180911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180911_tscode_list.append(stock_name)
daily_20180911_addname_dataframe=pd.DataFrame()
daily_20180911_addname_dataframe['cname'] = daily_20180911_tscode_list
for table_name in daily_20180911.columns.values.tolist():
    daily_20180911_addname_dataframe[table_name] = daily_20180911[table_name]
print("daily_20180911 返回数据 row 行数 = "+str(daily_20180911.shape[0]))
daily_20180911_addname_dataframe.to_excel(daily_201809_excel_writer,'11_2',index=False)
daily_201809_excel_writer.save()
daily_20180912 = pro.daily(start_date='',end_date='',trade_date='20180912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180912_tscode_list = list() 
for ts_code_sh in daily_20180912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180912_tscode_list.append(stock_name)
daily_20180912_addname_dataframe=pd.DataFrame()
daily_20180912_addname_dataframe['cname'] = daily_20180912_tscode_list
for table_name in daily_20180912.columns.values.tolist():
    daily_20180912_addname_dataframe[table_name] = daily_20180912[table_name]
print("daily_20180912 返回数据 row 行数 = "+str(daily_20180912.shape[0]))
daily_20180912_addname_dataframe.to_excel(daily_201809_excel_writer,'12_3',index=False)
daily_201809_excel_writer.save()
daily_20180913 = pro.daily(start_date='',end_date='',trade_date='20180913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180913_tscode_list = list() 
for ts_code_sh in daily_20180913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180913_tscode_list.append(stock_name)
daily_20180913_addname_dataframe=pd.DataFrame()
daily_20180913_addname_dataframe['cname'] = daily_20180913_tscode_list
for table_name in daily_20180913.columns.values.tolist():
    daily_20180913_addname_dataframe[table_name] = daily_20180913[table_name]
print("daily_20180913 返回数据 row 行数 = "+str(daily_20180913.shape[0]))
daily_20180913_addname_dataframe.to_excel(daily_201809_excel_writer,'13_4',index=False)
daily_201809_excel_writer.save()
daily_20180914 = pro.daily(start_date='',end_date='',trade_date='20180914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180914_tscode_list = list() 
for ts_code_sh in daily_20180914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180914_tscode_list.append(stock_name)
daily_20180914_addname_dataframe=pd.DataFrame()
daily_20180914_addname_dataframe['cname'] = daily_20180914_tscode_list
for table_name in daily_20180914.columns.values.tolist():
    daily_20180914_addname_dataframe[table_name] = daily_20180914[table_name]
print("daily_20180914 返回数据 row 行数 = "+str(daily_20180914.shape[0]))
daily_20180914_addname_dataframe.to_excel(daily_201809_excel_writer,'14_5',index=False)
daily_201809_excel_writer.save()
daily_20180915 = pro.daily(start_date='',end_date='',trade_date='20180915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180915_tscode_list = list() 
for ts_code_sh in daily_20180915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180915_tscode_list.append(stock_name)
daily_20180915_addname_dataframe=pd.DataFrame()
daily_20180915_addname_dataframe['cname'] = daily_20180915_tscode_list
for table_name in daily_20180915.columns.values.tolist():
    daily_20180915_addname_dataframe[table_name] = daily_20180915[table_name]
print("daily_20180915 返回数据 row 行数 = "+str(daily_20180915.shape[0]))
daily_20180915_addname_dataframe.to_excel(daily_201809_excel_writer,'15_6',index=False)
daily_201809_excel_writer.save()
daily_20180916 = pro.daily(start_date='',end_date='',trade_date='20180916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180916_tscode_list = list() 
for ts_code_sh in daily_20180916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180916_tscode_list.append(stock_name)
daily_20180916_addname_dataframe=pd.DataFrame()
daily_20180916_addname_dataframe['cname'] = daily_20180916_tscode_list
for table_name in daily_20180916.columns.values.tolist():
    daily_20180916_addname_dataframe[table_name] = daily_20180916[table_name]
print("daily_20180916 返回数据 row 行数 = "+str(daily_20180916.shape[0]))
daily_20180916_addname_dataframe.to_excel(daily_201809_excel_writer,'16_7',index=False)
daily_201809_excel_writer.save()
daily_20180917 = pro.daily(start_date='',end_date='',trade_date='20180917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180917_tscode_list = list() 
for ts_code_sh in daily_20180917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180917_tscode_list.append(stock_name)
daily_20180917_addname_dataframe=pd.DataFrame()
daily_20180917_addname_dataframe['cname'] = daily_20180917_tscode_list
for table_name in daily_20180917.columns.values.tolist():
    daily_20180917_addname_dataframe[table_name] = daily_20180917[table_name]
print("daily_20180917 返回数据 row 行数 = "+str(daily_20180917.shape[0]))
daily_20180917_addname_dataframe.to_excel(daily_201809_excel_writer,'17_1',index=False)
daily_201809_excel_writer.save()
daily_20180918 = pro.daily(start_date='',end_date='',trade_date='20180918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180918_tscode_list = list() 
for ts_code_sh in daily_20180918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180918_tscode_list.append(stock_name)
daily_20180918_addname_dataframe=pd.DataFrame()
daily_20180918_addname_dataframe['cname'] = daily_20180918_tscode_list
for table_name in daily_20180918.columns.values.tolist():
    daily_20180918_addname_dataframe[table_name] = daily_20180918[table_name]
print("daily_20180918 返回数据 row 行数 = "+str(daily_20180918.shape[0]))
daily_20180918_addname_dataframe.to_excel(daily_201809_excel_writer,'18_2',index=False)
daily_201809_excel_writer.save()
daily_20180919 = pro.daily(start_date='',end_date='',trade_date='20180919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180919_tscode_list = list() 
for ts_code_sh in daily_20180919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180919_tscode_list.append(stock_name)
daily_20180919_addname_dataframe=pd.DataFrame()
daily_20180919_addname_dataframe['cname'] = daily_20180919_tscode_list
for table_name in daily_20180919.columns.values.tolist():
    daily_20180919_addname_dataframe[table_name] = daily_20180919[table_name]
print("daily_20180919 返回数据 row 行数 = "+str(daily_20180919.shape[0]))
daily_20180919_addname_dataframe.to_excel(daily_201809_excel_writer,'19_3',index=False)
daily_201809_excel_writer.save()
daily_20180920 = pro.daily(start_date='',end_date='',trade_date='20180920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180920_tscode_list = list() 
for ts_code_sh in daily_20180920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180920_tscode_list.append(stock_name)
daily_20180920_addname_dataframe=pd.DataFrame()
daily_20180920_addname_dataframe['cname'] = daily_20180920_tscode_list
for table_name in daily_20180920.columns.values.tolist():
    daily_20180920_addname_dataframe[table_name] = daily_20180920[table_name]
print("daily_20180920 返回数据 row 行数 = "+str(daily_20180920.shape[0]))
daily_20180920_addname_dataframe.to_excel(daily_201809_excel_writer,'20_4',index=False)
daily_201809_excel_writer.save()
daily_20180921 = pro.daily(start_date='',end_date='',trade_date='20180921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180921_tscode_list = list() 
for ts_code_sh in daily_20180921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180921_tscode_list.append(stock_name)
daily_20180921_addname_dataframe=pd.DataFrame()
daily_20180921_addname_dataframe['cname'] = daily_20180921_tscode_list
for table_name in daily_20180921.columns.values.tolist():
    daily_20180921_addname_dataframe[table_name] = daily_20180921[table_name]
print("daily_20180921 返回数据 row 行数 = "+str(daily_20180921.shape[0]))
daily_20180921_addname_dataframe.to_excel(daily_201809_excel_writer,'21_5',index=False)
daily_201809_excel_writer.save()
daily_20180922 = pro.daily(start_date='',end_date='',trade_date='20180922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180922_tscode_list = list() 
for ts_code_sh in daily_20180922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180922_tscode_list.append(stock_name)
daily_20180922_addname_dataframe=pd.DataFrame()
daily_20180922_addname_dataframe['cname'] = daily_20180922_tscode_list
for table_name in daily_20180922.columns.values.tolist():
    daily_20180922_addname_dataframe[table_name] = daily_20180922[table_name]
print("daily_20180922 返回数据 row 行数 = "+str(daily_20180922.shape[0]))
daily_20180922_addname_dataframe.to_excel(daily_201809_excel_writer,'22_6',index=False)
daily_201809_excel_writer.save()
daily_20180923 = pro.daily(start_date='',end_date='',trade_date='20180923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180923_tscode_list = list() 
for ts_code_sh in daily_20180923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180923_tscode_list.append(stock_name)
daily_20180923_addname_dataframe=pd.DataFrame()
daily_20180923_addname_dataframe['cname'] = daily_20180923_tscode_list
for table_name in daily_20180923.columns.values.tolist():
    daily_20180923_addname_dataframe[table_name] = daily_20180923[table_name]
print("daily_20180923 返回数据 row 行数 = "+str(daily_20180923.shape[0]))
daily_20180923_addname_dataframe.to_excel(daily_201809_excel_writer,'23_7',index=False)
daily_201809_excel_writer.save()
daily_20180924 = pro.daily(start_date='',end_date='',trade_date='20180924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180924_tscode_list = list() 
for ts_code_sh in daily_20180924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180924_tscode_list.append(stock_name)
daily_20180924_addname_dataframe=pd.DataFrame()
daily_20180924_addname_dataframe['cname'] = daily_20180924_tscode_list
for table_name in daily_20180924.columns.values.tolist():
    daily_20180924_addname_dataframe[table_name] = daily_20180924[table_name]
print("daily_20180924 返回数据 row 行数 = "+str(daily_20180924.shape[0]))
daily_20180924_addname_dataframe.to_excel(daily_201809_excel_writer,'24_1',index=False)
daily_201809_excel_writer.save()
daily_20180925 = pro.daily(start_date='',end_date='',trade_date='20180925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180925_tscode_list = list() 
for ts_code_sh in daily_20180925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180925_tscode_list.append(stock_name)
daily_20180925_addname_dataframe=pd.DataFrame()
daily_20180925_addname_dataframe['cname'] = daily_20180925_tscode_list
for table_name in daily_20180925.columns.values.tolist():
    daily_20180925_addname_dataframe[table_name] = daily_20180925[table_name]
print("daily_20180925 返回数据 row 行数 = "+str(daily_20180925.shape[0]))
daily_20180925_addname_dataframe.to_excel(daily_201809_excel_writer,'25_2',index=False)
daily_201809_excel_writer.save()
daily_20180926 = pro.daily(start_date='',end_date='',trade_date='20180926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180926_tscode_list = list() 
for ts_code_sh in daily_20180926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180926_tscode_list.append(stock_name)
daily_20180926_addname_dataframe=pd.DataFrame()
daily_20180926_addname_dataframe['cname'] = daily_20180926_tscode_list
for table_name in daily_20180926.columns.values.tolist():
    daily_20180926_addname_dataframe[table_name] = daily_20180926[table_name]
print("daily_20180926 返回数据 row 行数 = "+str(daily_20180926.shape[0]))
daily_20180926_addname_dataframe.to_excel(daily_201809_excel_writer,'26_3',index=False)
daily_201809_excel_writer.save()
daily_20180927 = pro.daily(start_date='',end_date='',trade_date='20180927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180927_tscode_list = list() 
for ts_code_sh in daily_20180927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180927_tscode_list.append(stock_name)
daily_20180927_addname_dataframe=pd.DataFrame()
daily_20180927_addname_dataframe['cname'] = daily_20180927_tscode_list
for table_name in daily_20180927.columns.values.tolist():
    daily_20180927_addname_dataframe[table_name] = daily_20180927[table_name]
print("daily_20180927 返回数据 row 行数 = "+str(daily_20180927.shape[0]))
daily_20180927_addname_dataframe.to_excel(daily_201809_excel_writer,'27_4',index=False)
daily_201809_excel_writer.save()
daily_20180928 = pro.daily(start_date='',end_date='',trade_date='20180928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180928_tscode_list = list() 
for ts_code_sh in daily_20180928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180928_tscode_list.append(stock_name)
daily_20180928_addname_dataframe=pd.DataFrame()
daily_20180928_addname_dataframe['cname'] = daily_20180928_tscode_list
for table_name in daily_20180928.columns.values.tolist():
    daily_20180928_addname_dataframe[table_name] = daily_20180928[table_name]
print("daily_20180928 返回数据 row 行数 = "+str(daily_20180928.shape[0]))
daily_20180928_addname_dataframe.to_excel(daily_201809_excel_writer,'28_5',index=False)
daily_201809_excel_writer.save()
daily_20180929 = pro.daily(start_date='',end_date='',trade_date='20180929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180929_tscode_list = list() 
for ts_code_sh in daily_20180929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180929_tscode_list.append(stock_name)
daily_20180929_addname_dataframe=pd.DataFrame()
daily_20180929_addname_dataframe['cname'] = daily_20180929_tscode_list
for table_name in daily_20180929.columns.values.tolist():
    daily_20180929_addname_dataframe[table_name] = daily_20180929[table_name]
print("daily_20180929 返回数据 row 行数 = "+str(daily_20180929.shape[0]))
daily_20180929_addname_dataframe.to_excel(daily_201809_excel_writer,'29_6',index=False)
daily_201809_excel_writer.save()
daily_20180930 = pro.daily(start_date='',end_date='',trade_date='20180930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180930_tscode_list = list() 
for ts_code_sh in daily_20180930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180930_tscode_list.append(stock_name)
daily_20180930_addname_dataframe=pd.DataFrame()
daily_20180930_addname_dataframe['cname'] = daily_20180930_tscode_list
for table_name in daily_20180930.columns.values.tolist():
    daily_20180930_addname_dataframe[table_name] = daily_20180930[table_name]
print("daily_20180930 返回数据 row 行数 = "+str(daily_20180930.shape[0]))
daily_20180930_addname_dataframe.to_excel(daily_201809_excel_writer,'30_7',index=False)
daily_201809_excel_writer.save()




createexcel('daily_201810.xlsx')
daily_201810_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201810.xlsx')
daily_201810_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201810.xlsx', engine='openpyxl')
daily_201810_excel_writer.book = daily_201810_book
daily_201810_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201810_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20181001")       ###  更新 记录日期
daily_20181001 = pro.daily(start_date='',end_date='',trade_date='20181001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181001_tscode_list = list() 
for ts_code_sh in daily_20181001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181001_tscode_list.append(stock_name)
daily_20181001_addname_dataframe=pd.DataFrame()
daily_20181001_addname_dataframe['cname'] = daily_20181001_tscode_list
for table_name in daily_20181001.columns.values.tolist():
    daily_20181001_addname_dataframe[table_name] = daily_20181001[table_name]
print("daily_20181001 返回数据 row 行数 = "+str(daily_20181001.shape[0]))
daily_20181001_addname_dataframe.to_excel(daily_201810_excel_writer,'1_1',index=False)
daily_201810_excel_writer.save()
daily_20181002 = pro.daily(start_date='',end_date='',trade_date='20181002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181002_tscode_list = list() 
for ts_code_sh in daily_20181002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181002_tscode_list.append(stock_name)
daily_20181002_addname_dataframe=pd.DataFrame()
daily_20181002_addname_dataframe['cname'] = daily_20181002_tscode_list
for table_name in daily_20181002.columns.values.tolist():
    daily_20181002_addname_dataframe[table_name] = daily_20181002[table_name]
print("daily_20181002 返回数据 row 行数 = "+str(daily_20181002.shape[0]))
daily_20181002_addname_dataframe.to_excel(daily_201810_excel_writer,'2_2',index=False)
daily_201810_excel_writer.save()
daily_20181003 = pro.daily(start_date='',end_date='',trade_date='20181003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181003_tscode_list = list() 
for ts_code_sh in daily_20181003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181003_tscode_list.append(stock_name)
daily_20181003_addname_dataframe=pd.DataFrame()
daily_20181003_addname_dataframe['cname'] = daily_20181003_tscode_list
for table_name in daily_20181003.columns.values.tolist():
    daily_20181003_addname_dataframe[table_name] = daily_20181003[table_name]
print("daily_20181003 返回数据 row 行数 = "+str(daily_20181003.shape[0]))
daily_20181003_addname_dataframe.to_excel(daily_201810_excel_writer,'3_3',index=False)
daily_201810_excel_writer.save()
daily_20181004 = pro.daily(start_date='',end_date='',trade_date='20181004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181004_tscode_list = list() 
for ts_code_sh in daily_20181004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181004_tscode_list.append(stock_name)
daily_20181004_addname_dataframe=pd.DataFrame()
daily_20181004_addname_dataframe['cname'] = daily_20181004_tscode_list
for table_name in daily_20181004.columns.values.tolist():
    daily_20181004_addname_dataframe[table_name] = daily_20181004[table_name]
print("daily_20181004 返回数据 row 行数 = "+str(daily_20181004.shape[0]))
daily_20181004_addname_dataframe.to_excel(daily_201810_excel_writer,'4_4',index=False)
daily_201810_excel_writer.save()
daily_20181005 = pro.daily(start_date='',end_date='',trade_date='20181005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181005_tscode_list = list() 
for ts_code_sh in daily_20181005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181005_tscode_list.append(stock_name)
daily_20181005_addname_dataframe=pd.DataFrame()
daily_20181005_addname_dataframe['cname'] = daily_20181005_tscode_list
for table_name in daily_20181005.columns.values.tolist():
    daily_20181005_addname_dataframe[table_name] = daily_20181005[table_name]
print("daily_20181005 返回数据 row 行数 = "+str(daily_20181005.shape[0]))
daily_20181005_addname_dataframe.to_excel(daily_201810_excel_writer,'5_5',index=False)
daily_201810_excel_writer.save()
daily_20181006 = pro.daily(start_date='',end_date='',trade_date='20181006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181006_tscode_list = list() 
for ts_code_sh in daily_20181006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181006_tscode_list.append(stock_name)
daily_20181006_addname_dataframe=pd.DataFrame()
daily_20181006_addname_dataframe['cname'] = daily_20181006_tscode_list
for table_name in daily_20181006.columns.values.tolist():
    daily_20181006_addname_dataframe[table_name] = daily_20181006[table_name]
print("daily_20181006 返回数据 row 行数 = "+str(daily_20181006.shape[0]))
daily_20181006_addname_dataframe.to_excel(daily_201810_excel_writer,'6_6',index=False)
daily_201810_excel_writer.save()
daily_20181007 = pro.daily(start_date='',end_date='',trade_date='20181007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181007_tscode_list = list() 
for ts_code_sh in daily_20181007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181007_tscode_list.append(stock_name)
daily_20181007_addname_dataframe=pd.DataFrame()
daily_20181007_addname_dataframe['cname'] = daily_20181007_tscode_list
for table_name in daily_20181007.columns.values.tolist():
    daily_20181007_addname_dataframe[table_name] = daily_20181007[table_name]
print("daily_20181007 返回数据 row 行数 = "+str(daily_20181007.shape[0]))
daily_20181007_addname_dataframe.to_excel(daily_201810_excel_writer,'7_7',index=False)
daily_201810_excel_writer.save()
daily_20181008 = pro.daily(start_date='',end_date='',trade_date='20181008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181008_tscode_list = list() 
for ts_code_sh in daily_20181008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181008_tscode_list.append(stock_name)
daily_20181008_addname_dataframe=pd.DataFrame()
daily_20181008_addname_dataframe['cname'] = daily_20181008_tscode_list
for table_name in daily_20181008.columns.values.tolist():
    daily_20181008_addname_dataframe[table_name] = daily_20181008[table_name]
print("daily_20181008 返回数据 row 行数 = "+str(daily_20181008.shape[0]))
daily_20181008_addname_dataframe.to_excel(daily_201810_excel_writer,'8_1',index=False)
daily_201810_excel_writer.save()
daily_20181009 = pro.daily(start_date='',end_date='',trade_date='20181009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181009_tscode_list = list() 
for ts_code_sh in daily_20181009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181009_tscode_list.append(stock_name)
daily_20181009_addname_dataframe=pd.DataFrame()
daily_20181009_addname_dataframe['cname'] = daily_20181009_tscode_list
for table_name in daily_20181009.columns.values.tolist():
    daily_20181009_addname_dataframe[table_name] = daily_20181009[table_name]
print("daily_20181009 返回数据 row 行数 = "+str(daily_20181009.shape[0]))
daily_20181009_addname_dataframe.to_excel(daily_201810_excel_writer,'9_2',index=False)
daily_201810_excel_writer.save()
daily_20181010 = pro.daily(start_date='',end_date='',trade_date='20181010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181010_tscode_list = list() 
for ts_code_sh in daily_20181010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181010_tscode_list.append(stock_name)
daily_20181010_addname_dataframe=pd.DataFrame()
daily_20181010_addname_dataframe['cname'] = daily_20181010_tscode_list
for table_name in daily_20181010.columns.values.tolist():
    daily_20181010_addname_dataframe[table_name] = daily_20181010[table_name]
print("daily_20181010 返回数据 row 行数 = "+str(daily_20181010.shape[0]))
daily_20181010_addname_dataframe.to_excel(daily_201810_excel_writer,'10_3',index=False)
daily_201810_excel_writer.save()
daily_20181011 = pro.daily(start_date='',end_date='',trade_date='20181011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181011_tscode_list = list() 
for ts_code_sh in daily_20181011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181011_tscode_list.append(stock_name)
daily_20181011_addname_dataframe=pd.DataFrame()
daily_20181011_addname_dataframe['cname'] = daily_20181011_tscode_list
for table_name in daily_20181011.columns.values.tolist():
    daily_20181011_addname_dataframe[table_name] = daily_20181011[table_name]
print("daily_20181011 返回数据 row 行数 = "+str(daily_20181011.shape[0]))
daily_20181011_addname_dataframe.to_excel(daily_201810_excel_writer,'11_4',index=False)
daily_201810_excel_writer.save()
daily_20181012 = pro.daily(start_date='',end_date='',trade_date='20181012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181012_tscode_list = list() 
for ts_code_sh in daily_20181012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181012_tscode_list.append(stock_name)
daily_20181012_addname_dataframe=pd.DataFrame()
daily_20181012_addname_dataframe['cname'] = daily_20181012_tscode_list
for table_name in daily_20181012.columns.values.tolist():
    daily_20181012_addname_dataframe[table_name] = daily_20181012[table_name]
print("daily_20181012 返回数据 row 行数 = "+str(daily_20181012.shape[0]))
daily_20181012_addname_dataframe.to_excel(daily_201810_excel_writer,'12_5',index=False)
daily_201810_excel_writer.save()
daily_20181013 = pro.daily(start_date='',end_date='',trade_date='20181013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181013_tscode_list = list() 
for ts_code_sh in daily_20181013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181013_tscode_list.append(stock_name)
daily_20181013_addname_dataframe=pd.DataFrame()
daily_20181013_addname_dataframe['cname'] = daily_20181013_tscode_list
for table_name in daily_20181013.columns.values.tolist():
    daily_20181013_addname_dataframe[table_name] = daily_20181013[table_name]
print("daily_20181013 返回数据 row 行数 = "+str(daily_20181013.shape[0]))
daily_20181013_addname_dataframe.to_excel(daily_201810_excel_writer,'13_6',index=False)
daily_201810_excel_writer.save()
daily_20181014 = pro.daily(start_date='',end_date='',trade_date='20181014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181014_tscode_list = list() 
for ts_code_sh in daily_20181014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181014_tscode_list.append(stock_name)
daily_20181014_addname_dataframe=pd.DataFrame()
daily_20181014_addname_dataframe['cname'] = daily_20181014_tscode_list
for table_name in daily_20181014.columns.values.tolist():
    daily_20181014_addname_dataframe[table_name] = daily_20181014[table_name]
print("daily_20181014 返回数据 row 行数 = "+str(daily_20181014.shape[0]))
daily_20181014_addname_dataframe.to_excel(daily_201810_excel_writer,'14_7',index=False)
daily_201810_excel_writer.save()
daily_20181015 = pro.daily(start_date='',end_date='',trade_date='20181015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181015_tscode_list = list() 
for ts_code_sh in daily_20181015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181015_tscode_list.append(stock_name)
daily_20181015_addname_dataframe=pd.DataFrame()
daily_20181015_addname_dataframe['cname'] = daily_20181015_tscode_list
for table_name in daily_20181015.columns.values.tolist():
    daily_20181015_addname_dataframe[table_name] = daily_20181015[table_name]
print("daily_20181015 返回数据 row 行数 = "+str(daily_20181015.shape[0]))
daily_20181015_addname_dataframe.to_excel(daily_201810_excel_writer,'15_1',index=False)
daily_201810_excel_writer.save()
daily_20181016 = pro.daily(start_date='',end_date='',trade_date='20181016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181016_tscode_list = list() 
for ts_code_sh in daily_20181016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181016_tscode_list.append(stock_name)
daily_20181016_addname_dataframe=pd.DataFrame()
daily_20181016_addname_dataframe['cname'] = daily_20181016_tscode_list
for table_name in daily_20181016.columns.values.tolist():
    daily_20181016_addname_dataframe[table_name] = daily_20181016[table_name]
print("daily_20181016 返回数据 row 行数 = "+str(daily_20181016.shape[0]))
daily_20181016_addname_dataframe.to_excel(daily_201810_excel_writer,'16_2',index=False)
daily_201810_excel_writer.save()
daily_20181017 = pro.daily(start_date='',end_date='',trade_date='20181017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181017_tscode_list = list() 
for ts_code_sh in daily_20181017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181017_tscode_list.append(stock_name)
daily_20181017_addname_dataframe=pd.DataFrame()
daily_20181017_addname_dataframe['cname'] = daily_20181017_tscode_list
for table_name in daily_20181017.columns.values.tolist():
    daily_20181017_addname_dataframe[table_name] = daily_20181017[table_name]
print("daily_20181017 返回数据 row 行数 = "+str(daily_20181017.shape[0]))
daily_20181017_addname_dataframe.to_excel(daily_201810_excel_writer,'17_3',index=False)
daily_201810_excel_writer.save()
daily_20181018 = pro.daily(start_date='',end_date='',trade_date='20181018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181018_tscode_list = list() 
for ts_code_sh in daily_20181018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181018_tscode_list.append(stock_name)
daily_20181018_addname_dataframe=pd.DataFrame()
daily_20181018_addname_dataframe['cname'] = daily_20181018_tscode_list
for table_name in daily_20181018.columns.values.tolist():
    daily_20181018_addname_dataframe[table_name] = daily_20181018[table_name]
print("daily_20181018 返回数据 row 行数 = "+str(daily_20181018.shape[0]))
daily_20181018_addname_dataframe.to_excel(daily_201810_excel_writer,'18_4',index=False)
daily_201810_excel_writer.save()
daily_20181019 = pro.daily(start_date='',end_date='',trade_date='20181019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181019_tscode_list = list() 
for ts_code_sh in daily_20181019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181019_tscode_list.append(stock_name)
daily_20181019_addname_dataframe=pd.DataFrame()
daily_20181019_addname_dataframe['cname'] = daily_20181019_tscode_list
for table_name in daily_20181019.columns.values.tolist():
    daily_20181019_addname_dataframe[table_name] = daily_20181019[table_name]
print("daily_20181019 返回数据 row 行数 = "+str(daily_20181019.shape[0]))
daily_20181019_addname_dataframe.to_excel(daily_201810_excel_writer,'19_5',index=False)
daily_201810_excel_writer.save()
daily_20181020 = pro.daily(start_date='',end_date='',trade_date='20181020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181020_tscode_list = list() 
for ts_code_sh in daily_20181020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181020_tscode_list.append(stock_name)
daily_20181020_addname_dataframe=pd.DataFrame()
daily_20181020_addname_dataframe['cname'] = daily_20181020_tscode_list
for table_name in daily_20181020.columns.values.tolist():
    daily_20181020_addname_dataframe[table_name] = daily_20181020[table_name]
print("daily_20181020 返回数据 row 行数 = "+str(daily_20181020.shape[0]))
daily_20181020_addname_dataframe.to_excel(daily_201810_excel_writer,'20_6',index=False)
daily_201810_excel_writer.save()
daily_20181021 = pro.daily(start_date='',end_date='',trade_date='20181021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181021_tscode_list = list() 
for ts_code_sh in daily_20181021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181021_tscode_list.append(stock_name)
daily_20181021_addname_dataframe=pd.DataFrame()
daily_20181021_addname_dataframe['cname'] = daily_20181021_tscode_list
for table_name in daily_20181021.columns.values.tolist():
    daily_20181021_addname_dataframe[table_name] = daily_20181021[table_name]
print("daily_20181021 返回数据 row 行数 = "+str(daily_20181021.shape[0]))
daily_20181021_addname_dataframe.to_excel(daily_201810_excel_writer,'21_7',index=False)
daily_201810_excel_writer.save()
daily_20181022 = pro.daily(start_date='',end_date='',trade_date='20181022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181022_tscode_list = list() 
for ts_code_sh in daily_20181022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181022_tscode_list.append(stock_name)
daily_20181022_addname_dataframe=pd.DataFrame()
daily_20181022_addname_dataframe['cname'] = daily_20181022_tscode_list
for table_name in daily_20181022.columns.values.tolist():
    daily_20181022_addname_dataframe[table_name] = daily_20181022[table_name]
print("daily_20181022 返回数据 row 行数 = "+str(daily_20181022.shape[0]))
daily_20181022_addname_dataframe.to_excel(daily_201810_excel_writer,'22_1',index=False)
daily_201810_excel_writer.save()
daily_20181023 = pro.daily(start_date='',end_date='',trade_date='20181023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181023_tscode_list = list() 
for ts_code_sh in daily_20181023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181023_tscode_list.append(stock_name)
daily_20181023_addname_dataframe=pd.DataFrame()
daily_20181023_addname_dataframe['cname'] = daily_20181023_tscode_list
for table_name in daily_20181023.columns.values.tolist():
    daily_20181023_addname_dataframe[table_name] = daily_20181023[table_name]
print("daily_20181023 返回数据 row 行数 = "+str(daily_20181023.shape[0]))
daily_20181023_addname_dataframe.to_excel(daily_201810_excel_writer,'23_2',index=False)
daily_201810_excel_writer.save()
daily_20181024 = pro.daily(start_date='',end_date='',trade_date='20181024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181024_tscode_list = list() 
for ts_code_sh in daily_20181024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181024_tscode_list.append(stock_name)
daily_20181024_addname_dataframe=pd.DataFrame()
daily_20181024_addname_dataframe['cname'] = daily_20181024_tscode_list
for table_name in daily_20181024.columns.values.tolist():
    daily_20181024_addname_dataframe[table_name] = daily_20181024[table_name]
print("daily_20181024 返回数据 row 行数 = "+str(daily_20181024.shape[0]))
daily_20181024_addname_dataframe.to_excel(daily_201810_excel_writer,'24_3',index=False)
daily_201810_excel_writer.save()
daily_20181025 = pro.daily(start_date='',end_date='',trade_date='20181025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181025_tscode_list = list() 
for ts_code_sh in daily_20181025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181025_tscode_list.append(stock_name)
daily_20181025_addname_dataframe=pd.DataFrame()
daily_20181025_addname_dataframe['cname'] = daily_20181025_tscode_list
for table_name in daily_20181025.columns.values.tolist():
    daily_20181025_addname_dataframe[table_name] = daily_20181025[table_name]
print("daily_20181025 返回数据 row 行数 = "+str(daily_20181025.shape[0]))
daily_20181025_addname_dataframe.to_excel(daily_201810_excel_writer,'25_4',index=False)
daily_201810_excel_writer.save()
daily_20181026 = pro.daily(start_date='',end_date='',trade_date='20181026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181026_tscode_list = list() 
for ts_code_sh in daily_20181026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181026_tscode_list.append(stock_name)
daily_20181026_addname_dataframe=pd.DataFrame()
daily_20181026_addname_dataframe['cname'] = daily_20181026_tscode_list
for table_name in daily_20181026.columns.values.tolist():
    daily_20181026_addname_dataframe[table_name] = daily_20181026[table_name]
print("daily_20181026 返回数据 row 行数 = "+str(daily_20181026.shape[0]))
daily_20181026_addname_dataframe.to_excel(daily_201810_excel_writer,'26_5',index=False)
daily_201810_excel_writer.save()
daily_20181027 = pro.daily(start_date='',end_date='',trade_date='20181027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181027_tscode_list = list() 
for ts_code_sh in daily_20181027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181027_tscode_list.append(stock_name)
daily_20181027_addname_dataframe=pd.DataFrame()
daily_20181027_addname_dataframe['cname'] = daily_20181027_tscode_list
for table_name in daily_20181027.columns.values.tolist():
    daily_20181027_addname_dataframe[table_name] = daily_20181027[table_name]
print("daily_20181027 返回数据 row 行数 = "+str(daily_20181027.shape[0]))
daily_20181027_addname_dataframe.to_excel(daily_201810_excel_writer,'27_6',index=False)
daily_201810_excel_writer.save()
daily_20181028 = pro.daily(start_date='',end_date='',trade_date='20181028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181028_tscode_list = list() 
for ts_code_sh in daily_20181028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181028_tscode_list.append(stock_name)
daily_20181028_addname_dataframe=pd.DataFrame()
daily_20181028_addname_dataframe['cname'] = daily_20181028_tscode_list
for table_name in daily_20181028.columns.values.tolist():
    daily_20181028_addname_dataframe[table_name] = daily_20181028[table_name]
print("daily_20181028 返回数据 row 行数 = "+str(daily_20181028.shape[0]))
daily_20181028_addname_dataframe.to_excel(daily_201810_excel_writer,'28_7',index=False)
daily_201810_excel_writer.save()
daily_20181029 = pro.daily(start_date='',end_date='',trade_date='20181029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181029_tscode_list = list() 
for ts_code_sh in daily_20181029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181029_tscode_list.append(stock_name)
daily_20181029_addname_dataframe=pd.DataFrame()
daily_20181029_addname_dataframe['cname'] = daily_20181029_tscode_list
for table_name in daily_20181029.columns.values.tolist():
    daily_20181029_addname_dataframe[table_name] = daily_20181029[table_name]
print("daily_20181029 返回数据 row 行数 = "+str(daily_20181029.shape[0]))
daily_20181029_addname_dataframe.to_excel(daily_201810_excel_writer,'29_1',index=False)
daily_201810_excel_writer.save()
daily_20181030 = pro.daily(start_date='',end_date='',trade_date='20181030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181030_tscode_list = list() 
for ts_code_sh in daily_20181030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181030_tscode_list.append(stock_name)
daily_20181030_addname_dataframe=pd.DataFrame()
daily_20181030_addname_dataframe['cname'] = daily_20181030_tscode_list
for table_name in daily_20181030.columns.values.tolist():
    daily_20181030_addname_dataframe[table_name] = daily_20181030[table_name]
print("daily_20181030 返回数据 row 行数 = "+str(daily_20181030.shape[0]))
daily_20181030_addname_dataframe.to_excel(daily_201810_excel_writer,'30_2',index=False)
daily_201810_excel_writer.save()
daily_20181031 = pro.daily(start_date='',end_date='',trade_date='20181031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181031_tscode_list = list() 
for ts_code_sh in daily_20181031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181031_tscode_list.append(stock_name)
daily_20181031_addname_dataframe=pd.DataFrame()
daily_20181031_addname_dataframe['cname'] = daily_20181031_tscode_list
for table_name in daily_20181031.columns.values.tolist():
    daily_20181031_addname_dataframe[table_name] = daily_20181031[table_name]
print("daily_20181031 返回数据 row 行数 = "+str(daily_20181031.shape[0]))
daily_20181031_addname_dataframe.to_excel(daily_201810_excel_writer,'31_3',index=False)
daily_201810_excel_writer.save()




createexcel('daily_201811.xlsx')
daily_201811_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201811.xlsx')
daily_201811_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201811.xlsx', engine='openpyxl')
daily_201811_excel_writer.book = daily_201811_book
daily_201811_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201811_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20181101")       ###  更新 记录日期
daily_20181101 = pro.daily(start_date='',end_date='',trade_date='20181101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181101_tscode_list = list() 
for ts_code_sh in daily_20181101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181101_tscode_list.append(stock_name)
daily_20181101_addname_dataframe=pd.DataFrame()
daily_20181101_addname_dataframe['cname'] = daily_20181101_tscode_list
for table_name in daily_20181101.columns.values.tolist():
    daily_20181101_addname_dataframe[table_name] = daily_20181101[table_name]
print("daily_20181101 返回数据 row 行数 = "+str(daily_20181101.shape[0]))
daily_20181101_addname_dataframe.to_excel(daily_201811_excel_writer,'1_4',index=False)
daily_201811_excel_writer.save()
daily_20181102 = pro.daily(start_date='',end_date='',trade_date='20181102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181102_tscode_list = list() 
for ts_code_sh in daily_20181102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181102_tscode_list.append(stock_name)
daily_20181102_addname_dataframe=pd.DataFrame()
daily_20181102_addname_dataframe['cname'] = daily_20181102_tscode_list
for table_name in daily_20181102.columns.values.tolist():
    daily_20181102_addname_dataframe[table_name] = daily_20181102[table_name]
print("daily_20181102 返回数据 row 行数 = "+str(daily_20181102.shape[0]))
daily_20181102_addname_dataframe.to_excel(daily_201811_excel_writer,'2_5',index=False)
daily_201811_excel_writer.save()
daily_20181103 = pro.daily(start_date='',end_date='',trade_date='20181103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181103_tscode_list = list() 
for ts_code_sh in daily_20181103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181103_tscode_list.append(stock_name)
daily_20181103_addname_dataframe=pd.DataFrame()
daily_20181103_addname_dataframe['cname'] = daily_20181103_tscode_list
for table_name in daily_20181103.columns.values.tolist():
    daily_20181103_addname_dataframe[table_name] = daily_20181103[table_name]
print("daily_20181103 返回数据 row 行数 = "+str(daily_20181103.shape[0]))
daily_20181103_addname_dataframe.to_excel(daily_201811_excel_writer,'3_6',index=False)
daily_201811_excel_writer.save()
daily_20181104 = pro.daily(start_date='',end_date='',trade_date='20181104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181104_tscode_list = list() 
for ts_code_sh in daily_20181104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181104_tscode_list.append(stock_name)
daily_20181104_addname_dataframe=pd.DataFrame()
daily_20181104_addname_dataframe['cname'] = daily_20181104_tscode_list
for table_name in daily_20181104.columns.values.tolist():
    daily_20181104_addname_dataframe[table_name] = daily_20181104[table_name]
print("daily_20181104 返回数据 row 行数 = "+str(daily_20181104.shape[0]))
daily_20181104_addname_dataframe.to_excel(daily_201811_excel_writer,'4_7',index=False)
daily_201811_excel_writer.save()
daily_20181105 = pro.daily(start_date='',end_date='',trade_date='20181105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181105_tscode_list = list() 
for ts_code_sh in daily_20181105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181105_tscode_list.append(stock_name)
daily_20181105_addname_dataframe=pd.DataFrame()
daily_20181105_addname_dataframe['cname'] = daily_20181105_tscode_list
for table_name in daily_20181105.columns.values.tolist():
    daily_20181105_addname_dataframe[table_name] = daily_20181105[table_name]
print("daily_20181105 返回数据 row 行数 = "+str(daily_20181105.shape[0]))
daily_20181105_addname_dataframe.to_excel(daily_201811_excel_writer,'5_1',index=False)
daily_201811_excel_writer.save()
daily_20181106 = pro.daily(start_date='',end_date='',trade_date='20181106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181106_tscode_list = list() 
for ts_code_sh in daily_20181106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181106_tscode_list.append(stock_name)
daily_20181106_addname_dataframe=pd.DataFrame()
daily_20181106_addname_dataframe['cname'] = daily_20181106_tscode_list
for table_name in daily_20181106.columns.values.tolist():
    daily_20181106_addname_dataframe[table_name] = daily_20181106[table_name]
print("daily_20181106 返回数据 row 行数 = "+str(daily_20181106.shape[0]))
daily_20181106_addname_dataframe.to_excel(daily_201811_excel_writer,'6_2',index=False)
daily_201811_excel_writer.save()
daily_20181107 = pro.daily(start_date='',end_date='',trade_date='20181107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181107_tscode_list = list() 
for ts_code_sh in daily_20181107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181107_tscode_list.append(stock_name)
daily_20181107_addname_dataframe=pd.DataFrame()
daily_20181107_addname_dataframe['cname'] = daily_20181107_tscode_list
for table_name in daily_20181107.columns.values.tolist():
    daily_20181107_addname_dataframe[table_name] = daily_20181107[table_name]
print("daily_20181107 返回数据 row 行数 = "+str(daily_20181107.shape[0]))
daily_20181107_addname_dataframe.to_excel(daily_201811_excel_writer,'7_3',index=False)
daily_201811_excel_writer.save()
daily_20181108 = pro.daily(start_date='',end_date='',trade_date='20181108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181108_tscode_list = list() 
for ts_code_sh in daily_20181108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181108_tscode_list.append(stock_name)
daily_20181108_addname_dataframe=pd.DataFrame()
daily_20181108_addname_dataframe['cname'] = daily_20181108_tscode_list
for table_name in daily_20181108.columns.values.tolist():
    daily_20181108_addname_dataframe[table_name] = daily_20181108[table_name]
print("daily_20181108 返回数据 row 行数 = "+str(daily_20181108.shape[0]))
daily_20181108_addname_dataframe.to_excel(daily_201811_excel_writer,'8_4',index=False)
daily_201811_excel_writer.save()
daily_20181109 = pro.daily(start_date='',end_date='',trade_date='20181109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181109_tscode_list = list() 
for ts_code_sh in daily_20181109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181109_tscode_list.append(stock_name)
daily_20181109_addname_dataframe=pd.DataFrame()
daily_20181109_addname_dataframe['cname'] = daily_20181109_tscode_list
for table_name in daily_20181109.columns.values.tolist():
    daily_20181109_addname_dataframe[table_name] = daily_20181109[table_name]
print("daily_20181109 返回数据 row 行数 = "+str(daily_20181109.shape[0]))
daily_20181109_addname_dataframe.to_excel(daily_201811_excel_writer,'9_5',index=False)
daily_201811_excel_writer.save()
daily_20181110 = pro.daily(start_date='',end_date='',trade_date='20181110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181110_tscode_list = list() 
for ts_code_sh in daily_20181110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181110_tscode_list.append(stock_name)
daily_20181110_addname_dataframe=pd.DataFrame()
daily_20181110_addname_dataframe['cname'] = daily_20181110_tscode_list
for table_name in daily_20181110.columns.values.tolist():
    daily_20181110_addname_dataframe[table_name] = daily_20181110[table_name]
print("daily_20181110 返回数据 row 行数 = "+str(daily_20181110.shape[0]))
daily_20181110_addname_dataframe.to_excel(daily_201811_excel_writer,'10_6',index=False)
daily_201811_excel_writer.save()
daily_20181111 = pro.daily(start_date='',end_date='',trade_date='20181111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181111_tscode_list = list() 
for ts_code_sh in daily_20181111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181111_tscode_list.append(stock_name)
daily_20181111_addname_dataframe=pd.DataFrame()
daily_20181111_addname_dataframe['cname'] = daily_20181111_tscode_list
for table_name in daily_20181111.columns.values.tolist():
    daily_20181111_addname_dataframe[table_name] = daily_20181111[table_name]
print("daily_20181111 返回数据 row 行数 = "+str(daily_20181111.shape[0]))
daily_20181111_addname_dataframe.to_excel(daily_201811_excel_writer,'11_7',index=False)
daily_201811_excel_writer.save()
daily_20181112 = pro.daily(start_date='',end_date='',trade_date='20181112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181112_tscode_list = list() 
for ts_code_sh in daily_20181112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181112_tscode_list.append(stock_name)
daily_20181112_addname_dataframe=pd.DataFrame()
daily_20181112_addname_dataframe['cname'] = daily_20181112_tscode_list
for table_name in daily_20181112.columns.values.tolist():
    daily_20181112_addname_dataframe[table_name] = daily_20181112[table_name]
print("daily_20181112 返回数据 row 行数 = "+str(daily_20181112.shape[0]))
daily_20181112_addname_dataframe.to_excel(daily_201811_excel_writer,'12_1',index=False)
daily_201811_excel_writer.save()
daily_20181113 = pro.daily(start_date='',end_date='',trade_date='20181113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181113_tscode_list = list() 
for ts_code_sh in daily_20181113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181113_tscode_list.append(stock_name)
daily_20181113_addname_dataframe=pd.DataFrame()
daily_20181113_addname_dataframe['cname'] = daily_20181113_tscode_list
for table_name in daily_20181113.columns.values.tolist():
    daily_20181113_addname_dataframe[table_name] = daily_20181113[table_name]
print("daily_20181113 返回数据 row 行数 = "+str(daily_20181113.shape[0]))
daily_20181113_addname_dataframe.to_excel(daily_201811_excel_writer,'13_2',index=False)
daily_201811_excel_writer.save()
daily_20181114 = pro.daily(start_date='',end_date='',trade_date='20181114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181114_tscode_list = list() 
for ts_code_sh in daily_20181114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181114_tscode_list.append(stock_name)
daily_20181114_addname_dataframe=pd.DataFrame()
daily_20181114_addname_dataframe['cname'] = daily_20181114_tscode_list
for table_name in daily_20181114.columns.values.tolist():
    daily_20181114_addname_dataframe[table_name] = daily_20181114[table_name]
print("daily_20181114 返回数据 row 行数 = "+str(daily_20181114.shape[0]))
daily_20181114_addname_dataframe.to_excel(daily_201811_excel_writer,'14_3',index=False)
daily_201811_excel_writer.save()
daily_20181115 = pro.daily(start_date='',end_date='',trade_date='20181115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181115_tscode_list = list() 
for ts_code_sh in daily_20181115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181115_tscode_list.append(stock_name)
daily_20181115_addname_dataframe=pd.DataFrame()
daily_20181115_addname_dataframe['cname'] = daily_20181115_tscode_list
for table_name in daily_20181115.columns.values.tolist():
    daily_20181115_addname_dataframe[table_name] = daily_20181115[table_name]
print("daily_20181115 返回数据 row 行数 = "+str(daily_20181115.shape[0]))
daily_20181115_addname_dataframe.to_excel(daily_201811_excel_writer,'15_4',index=False)
daily_201811_excel_writer.save()
daily_20181116 = pro.daily(start_date='',end_date='',trade_date='20181116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181116_tscode_list = list() 
for ts_code_sh in daily_20181116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181116_tscode_list.append(stock_name)
daily_20181116_addname_dataframe=pd.DataFrame()
daily_20181116_addname_dataframe['cname'] = daily_20181116_tscode_list
for table_name in daily_20181116.columns.values.tolist():
    daily_20181116_addname_dataframe[table_name] = daily_20181116[table_name]
print("daily_20181116 返回数据 row 行数 = "+str(daily_20181116.shape[0]))
daily_20181116_addname_dataframe.to_excel(daily_201811_excel_writer,'16_5',index=False)
daily_201811_excel_writer.save()
daily_20181117 = pro.daily(start_date='',end_date='',trade_date='20181117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181117_tscode_list = list() 
for ts_code_sh in daily_20181117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181117_tscode_list.append(stock_name)
daily_20181117_addname_dataframe=pd.DataFrame()
daily_20181117_addname_dataframe['cname'] = daily_20181117_tscode_list
for table_name in daily_20181117.columns.values.tolist():
    daily_20181117_addname_dataframe[table_name] = daily_20181117[table_name]
print("daily_20181117 返回数据 row 行数 = "+str(daily_20181117.shape[0]))
daily_20181117_addname_dataframe.to_excel(daily_201811_excel_writer,'17_6',index=False)
daily_201811_excel_writer.save()
daily_20181118 = pro.daily(start_date='',end_date='',trade_date='20181118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181118_tscode_list = list() 
for ts_code_sh in daily_20181118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181118_tscode_list.append(stock_name)
daily_20181118_addname_dataframe=pd.DataFrame()
daily_20181118_addname_dataframe['cname'] = daily_20181118_tscode_list
for table_name in daily_20181118.columns.values.tolist():
    daily_20181118_addname_dataframe[table_name] = daily_20181118[table_name]
print("daily_20181118 返回数据 row 行数 = "+str(daily_20181118.shape[0]))
daily_20181118_addname_dataframe.to_excel(daily_201811_excel_writer,'18_7',index=False)
daily_201811_excel_writer.save()
daily_20181119 = pro.daily(start_date='',end_date='',trade_date='20181119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181119_tscode_list = list() 
for ts_code_sh in daily_20181119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181119_tscode_list.append(stock_name)
daily_20181119_addname_dataframe=pd.DataFrame()
daily_20181119_addname_dataframe['cname'] = daily_20181119_tscode_list
for table_name in daily_20181119.columns.values.tolist():
    daily_20181119_addname_dataframe[table_name] = daily_20181119[table_name]
print("daily_20181119 返回数据 row 行数 = "+str(daily_20181119.shape[0]))
daily_20181119_addname_dataframe.to_excel(daily_201811_excel_writer,'19_1',index=False)
daily_201811_excel_writer.save()
daily_20181120 = pro.daily(start_date='',end_date='',trade_date='20181120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181120_tscode_list = list() 
for ts_code_sh in daily_20181120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181120_tscode_list.append(stock_name)
daily_20181120_addname_dataframe=pd.DataFrame()
daily_20181120_addname_dataframe['cname'] = daily_20181120_tscode_list
for table_name in daily_20181120.columns.values.tolist():
    daily_20181120_addname_dataframe[table_name] = daily_20181120[table_name]
print("daily_20181120 返回数据 row 行数 = "+str(daily_20181120.shape[0]))
daily_20181120_addname_dataframe.to_excel(daily_201811_excel_writer,'20_2',index=False)
daily_201811_excel_writer.save()
daily_20181121 = pro.daily(start_date='',end_date='',trade_date='20181121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181121_tscode_list = list() 
for ts_code_sh in daily_20181121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181121_tscode_list.append(stock_name)
daily_20181121_addname_dataframe=pd.DataFrame()
daily_20181121_addname_dataframe['cname'] = daily_20181121_tscode_list
for table_name in daily_20181121.columns.values.tolist():
    daily_20181121_addname_dataframe[table_name] = daily_20181121[table_name]
print("daily_20181121 返回数据 row 行数 = "+str(daily_20181121.shape[0]))
daily_20181121_addname_dataframe.to_excel(daily_201811_excel_writer,'21_3',index=False)
daily_201811_excel_writer.save()
daily_20181122 = pro.daily(start_date='',end_date='',trade_date='20181122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181122_tscode_list = list() 
for ts_code_sh in daily_20181122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181122_tscode_list.append(stock_name)
daily_20181122_addname_dataframe=pd.DataFrame()
daily_20181122_addname_dataframe['cname'] = daily_20181122_tscode_list
for table_name in daily_20181122.columns.values.tolist():
    daily_20181122_addname_dataframe[table_name] = daily_20181122[table_name]
print("daily_20181122 返回数据 row 行数 = "+str(daily_20181122.shape[0]))
daily_20181122_addname_dataframe.to_excel(daily_201811_excel_writer,'22_4',index=False)
daily_201811_excel_writer.save()
daily_20181123 = pro.daily(start_date='',end_date='',trade_date='20181123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181123_tscode_list = list() 
for ts_code_sh in daily_20181123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181123_tscode_list.append(stock_name)
daily_20181123_addname_dataframe=pd.DataFrame()
daily_20181123_addname_dataframe['cname'] = daily_20181123_tscode_list
for table_name in daily_20181123.columns.values.tolist():
    daily_20181123_addname_dataframe[table_name] = daily_20181123[table_name]
print("daily_20181123 返回数据 row 行数 = "+str(daily_20181123.shape[0]))
daily_20181123_addname_dataframe.to_excel(daily_201811_excel_writer,'23_5',index=False)
daily_201811_excel_writer.save()
daily_20181124 = pro.daily(start_date='',end_date='',trade_date='20181124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181124_tscode_list = list() 
for ts_code_sh in daily_20181124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181124_tscode_list.append(stock_name)
daily_20181124_addname_dataframe=pd.DataFrame()
daily_20181124_addname_dataframe['cname'] = daily_20181124_tscode_list
for table_name in daily_20181124.columns.values.tolist():
    daily_20181124_addname_dataframe[table_name] = daily_20181124[table_name]
print("daily_20181124 返回数据 row 行数 = "+str(daily_20181124.shape[0]))
daily_20181124_addname_dataframe.to_excel(daily_201811_excel_writer,'24_6',index=False)
daily_201811_excel_writer.save()
daily_20181125 = pro.daily(start_date='',end_date='',trade_date='20181125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181125_tscode_list = list() 
for ts_code_sh in daily_20181125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181125_tscode_list.append(stock_name)
daily_20181125_addname_dataframe=pd.DataFrame()
daily_20181125_addname_dataframe['cname'] = daily_20181125_tscode_list
for table_name in daily_20181125.columns.values.tolist():
    daily_20181125_addname_dataframe[table_name] = daily_20181125[table_name]
print("daily_20181125 返回数据 row 行数 = "+str(daily_20181125.shape[0]))
daily_20181125_addname_dataframe.to_excel(daily_201811_excel_writer,'25_7',index=False)
daily_201811_excel_writer.save()
daily_20181126 = pro.daily(start_date='',end_date='',trade_date='20181126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181126_tscode_list = list() 
for ts_code_sh in daily_20181126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181126_tscode_list.append(stock_name)
daily_20181126_addname_dataframe=pd.DataFrame()
daily_20181126_addname_dataframe['cname'] = daily_20181126_tscode_list
for table_name in daily_20181126.columns.values.tolist():
    daily_20181126_addname_dataframe[table_name] = daily_20181126[table_name]
print("daily_20181126 返回数据 row 行数 = "+str(daily_20181126.shape[0]))
daily_20181126_addname_dataframe.to_excel(daily_201811_excel_writer,'26_1',index=False)
daily_201811_excel_writer.save()
daily_20181127 = pro.daily(start_date='',end_date='',trade_date='20181127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181127_tscode_list = list() 
for ts_code_sh in daily_20181127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181127_tscode_list.append(stock_name)
daily_20181127_addname_dataframe=pd.DataFrame()
daily_20181127_addname_dataframe['cname'] = daily_20181127_tscode_list
for table_name in daily_20181127.columns.values.tolist():
    daily_20181127_addname_dataframe[table_name] = daily_20181127[table_name]
print("daily_20181127 返回数据 row 行数 = "+str(daily_20181127.shape[0]))
daily_20181127_addname_dataframe.to_excel(daily_201811_excel_writer,'27_2',index=False)
daily_201811_excel_writer.save()
daily_20181128 = pro.daily(start_date='',end_date='',trade_date='20181128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181128_tscode_list = list() 
for ts_code_sh in daily_20181128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181128_tscode_list.append(stock_name)
daily_20181128_addname_dataframe=pd.DataFrame()
daily_20181128_addname_dataframe['cname'] = daily_20181128_tscode_list
for table_name in daily_20181128.columns.values.tolist():
    daily_20181128_addname_dataframe[table_name] = daily_20181128[table_name]
print("daily_20181128 返回数据 row 行数 = "+str(daily_20181128.shape[0]))
daily_20181128_addname_dataframe.to_excel(daily_201811_excel_writer,'28_3',index=False)
daily_201811_excel_writer.save()
daily_20181129 = pro.daily(start_date='',end_date='',trade_date='20181129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181129_tscode_list = list() 
for ts_code_sh in daily_20181129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181129_tscode_list.append(stock_name)
daily_20181129_addname_dataframe=pd.DataFrame()
daily_20181129_addname_dataframe['cname'] = daily_20181129_tscode_list
for table_name in daily_20181129.columns.values.tolist():
    daily_20181129_addname_dataframe[table_name] = daily_20181129[table_name]
print("daily_20181129 返回数据 row 行数 = "+str(daily_20181129.shape[0]))
daily_20181129_addname_dataframe.to_excel(daily_201811_excel_writer,'29_4',index=False)
daily_201811_excel_writer.save()
daily_20181130 = pro.daily(start_date='',end_date='',trade_date='20181130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181130_tscode_list = list() 
for ts_code_sh in daily_20181130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181130_tscode_list.append(stock_name)
daily_20181130_addname_dataframe=pd.DataFrame()
daily_20181130_addname_dataframe['cname'] = daily_20181130_tscode_list
for table_name in daily_20181130.columns.values.tolist():
    daily_20181130_addname_dataframe[table_name] = daily_20181130[table_name]
print("daily_20181130 返回数据 row 行数 = "+str(daily_20181130.shape[0]))
daily_20181130_addname_dataframe.to_excel(daily_201811_excel_writer,'30_5',index=False)
daily_201811_excel_writer.save()




createexcel('daily_201812.xlsx')
daily_201812_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201812.xlsx')
daily_201812_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201812.xlsx', engine='openpyxl')
daily_201812_excel_writer.book = daily_201812_book
daily_201812_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201812_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20181201")       ###  更新 记录日期
daily_20181201 = pro.daily(start_date='',end_date='',trade_date='20181201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181201_tscode_list = list() 
for ts_code_sh in daily_20181201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181201_tscode_list.append(stock_name)
daily_20181201_addname_dataframe=pd.DataFrame()
daily_20181201_addname_dataframe['cname'] = daily_20181201_tscode_list
for table_name in daily_20181201.columns.values.tolist():
    daily_20181201_addname_dataframe[table_name] = daily_20181201[table_name]
print("daily_20181201 返回数据 row 行数 = "+str(daily_20181201.shape[0]))
daily_20181201_addname_dataframe.to_excel(daily_201812_excel_writer,'1_6',index=False)
daily_201812_excel_writer.save()
daily_20181202 = pro.daily(start_date='',end_date='',trade_date='20181202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181202_tscode_list = list() 
for ts_code_sh in daily_20181202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181202_tscode_list.append(stock_name)
daily_20181202_addname_dataframe=pd.DataFrame()
daily_20181202_addname_dataframe['cname'] = daily_20181202_tscode_list
for table_name in daily_20181202.columns.values.tolist():
    daily_20181202_addname_dataframe[table_name] = daily_20181202[table_name]
print("daily_20181202 返回数据 row 行数 = "+str(daily_20181202.shape[0]))
daily_20181202_addname_dataframe.to_excel(daily_201812_excel_writer,'2_7',index=False)
daily_201812_excel_writer.save()
daily_20181203 = pro.daily(start_date='',end_date='',trade_date='20181203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181203_tscode_list = list() 
for ts_code_sh in daily_20181203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181203_tscode_list.append(stock_name)
daily_20181203_addname_dataframe=pd.DataFrame()
daily_20181203_addname_dataframe['cname'] = daily_20181203_tscode_list
for table_name in daily_20181203.columns.values.tolist():
    daily_20181203_addname_dataframe[table_name] = daily_20181203[table_name]
print("daily_20181203 返回数据 row 行数 = "+str(daily_20181203.shape[0]))
daily_20181203_addname_dataframe.to_excel(daily_201812_excel_writer,'3_1',index=False)
daily_201812_excel_writer.save()
daily_20181204 = pro.daily(start_date='',end_date='',trade_date='20181204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181204_tscode_list = list() 
for ts_code_sh in daily_20181204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181204_tscode_list.append(stock_name)
daily_20181204_addname_dataframe=pd.DataFrame()
daily_20181204_addname_dataframe['cname'] = daily_20181204_tscode_list
for table_name in daily_20181204.columns.values.tolist():
    daily_20181204_addname_dataframe[table_name] = daily_20181204[table_name]
print("daily_20181204 返回数据 row 行数 = "+str(daily_20181204.shape[0]))
daily_20181204_addname_dataframe.to_excel(daily_201812_excel_writer,'4_2',index=False)
daily_201812_excel_writer.save()
daily_20181205 = pro.daily(start_date='',end_date='',trade_date='20181205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181205_tscode_list = list() 
for ts_code_sh in daily_20181205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181205_tscode_list.append(stock_name)
daily_20181205_addname_dataframe=pd.DataFrame()
daily_20181205_addname_dataframe['cname'] = daily_20181205_tscode_list
for table_name in daily_20181205.columns.values.tolist():
    daily_20181205_addname_dataframe[table_name] = daily_20181205[table_name]
print("daily_20181205 返回数据 row 行数 = "+str(daily_20181205.shape[0]))
daily_20181205_addname_dataframe.to_excel(daily_201812_excel_writer,'5_3',index=False)
daily_201812_excel_writer.save()
daily_20181206 = pro.daily(start_date='',end_date='',trade_date='20181206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181206_tscode_list = list() 
for ts_code_sh in daily_20181206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181206_tscode_list.append(stock_name)
daily_20181206_addname_dataframe=pd.DataFrame()
daily_20181206_addname_dataframe['cname'] = daily_20181206_tscode_list
for table_name in daily_20181206.columns.values.tolist():
    daily_20181206_addname_dataframe[table_name] = daily_20181206[table_name]
print("daily_20181206 返回数据 row 行数 = "+str(daily_20181206.shape[0]))
daily_20181206_addname_dataframe.to_excel(daily_201812_excel_writer,'6_4',index=False)
daily_201812_excel_writer.save()
daily_20181207 = pro.daily(start_date='',end_date='',trade_date='20181207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181207_tscode_list = list() 
for ts_code_sh in daily_20181207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181207_tscode_list.append(stock_name)
daily_20181207_addname_dataframe=pd.DataFrame()
daily_20181207_addname_dataframe['cname'] = daily_20181207_tscode_list
for table_name in daily_20181207.columns.values.tolist():
    daily_20181207_addname_dataframe[table_name] = daily_20181207[table_name]
print("daily_20181207 返回数据 row 行数 = "+str(daily_20181207.shape[0]))
daily_20181207_addname_dataframe.to_excel(daily_201812_excel_writer,'7_5',index=False)
daily_201812_excel_writer.save()
daily_20181208 = pro.daily(start_date='',end_date='',trade_date='20181208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181208_tscode_list = list() 
for ts_code_sh in daily_20181208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181208_tscode_list.append(stock_name)
daily_20181208_addname_dataframe=pd.DataFrame()
daily_20181208_addname_dataframe['cname'] = daily_20181208_tscode_list
for table_name in daily_20181208.columns.values.tolist():
    daily_20181208_addname_dataframe[table_name] = daily_20181208[table_name]
print("daily_20181208 返回数据 row 行数 = "+str(daily_20181208.shape[0]))
daily_20181208_addname_dataframe.to_excel(daily_201812_excel_writer,'8_6',index=False)
daily_201812_excel_writer.save()
daily_20181209 = pro.daily(start_date='',end_date='',trade_date='20181209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181209_tscode_list = list() 
for ts_code_sh in daily_20181209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181209_tscode_list.append(stock_name)
daily_20181209_addname_dataframe=pd.DataFrame()
daily_20181209_addname_dataframe['cname'] = daily_20181209_tscode_list
for table_name in daily_20181209.columns.values.tolist():
    daily_20181209_addname_dataframe[table_name] = daily_20181209[table_name]
print("daily_20181209 返回数据 row 行数 = "+str(daily_20181209.shape[0]))
daily_20181209_addname_dataframe.to_excel(daily_201812_excel_writer,'9_7',index=False)
daily_201812_excel_writer.save()
daily_20181210 = pro.daily(start_date='',end_date='',trade_date='20181210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181210_tscode_list = list() 
for ts_code_sh in daily_20181210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181210_tscode_list.append(stock_name)
daily_20181210_addname_dataframe=pd.DataFrame()
daily_20181210_addname_dataframe['cname'] = daily_20181210_tscode_list
for table_name in daily_20181210.columns.values.tolist():
    daily_20181210_addname_dataframe[table_name] = daily_20181210[table_name]
print("daily_20181210 返回数据 row 行数 = "+str(daily_20181210.shape[0]))
daily_20181210_addname_dataframe.to_excel(daily_201812_excel_writer,'10_1',index=False)
daily_201812_excel_writer.save()
daily_20181211 = pro.daily(start_date='',end_date='',trade_date='20181211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181211_tscode_list = list() 
for ts_code_sh in daily_20181211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181211_tscode_list.append(stock_name)
daily_20181211_addname_dataframe=pd.DataFrame()
daily_20181211_addname_dataframe['cname'] = daily_20181211_tscode_list
for table_name in daily_20181211.columns.values.tolist():
    daily_20181211_addname_dataframe[table_name] = daily_20181211[table_name]
print("daily_20181211 返回数据 row 行数 = "+str(daily_20181211.shape[0]))
daily_20181211_addname_dataframe.to_excel(daily_201812_excel_writer,'11_2',index=False)
daily_201812_excel_writer.save()
daily_20181212 = pro.daily(start_date='',end_date='',trade_date='20181212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181212_tscode_list = list() 
for ts_code_sh in daily_20181212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181212_tscode_list.append(stock_name)
daily_20181212_addname_dataframe=pd.DataFrame()
daily_20181212_addname_dataframe['cname'] = daily_20181212_tscode_list
for table_name in daily_20181212.columns.values.tolist():
    daily_20181212_addname_dataframe[table_name] = daily_20181212[table_name]
print("daily_20181212 返回数据 row 行数 = "+str(daily_20181212.shape[0]))
daily_20181212_addname_dataframe.to_excel(daily_201812_excel_writer,'12_3',index=False)
daily_201812_excel_writer.save()
daily_20181213 = pro.daily(start_date='',end_date='',trade_date='20181213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181213_tscode_list = list() 
for ts_code_sh in daily_20181213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181213_tscode_list.append(stock_name)
daily_20181213_addname_dataframe=pd.DataFrame()
daily_20181213_addname_dataframe['cname'] = daily_20181213_tscode_list
for table_name in daily_20181213.columns.values.tolist():
    daily_20181213_addname_dataframe[table_name] = daily_20181213[table_name]
print("daily_20181213 返回数据 row 行数 = "+str(daily_20181213.shape[0]))
daily_20181213_addname_dataframe.to_excel(daily_201812_excel_writer,'13_4',index=False)
daily_201812_excel_writer.save()
daily_20181214 = pro.daily(start_date='',end_date='',trade_date='20181214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181214_tscode_list = list() 
for ts_code_sh in daily_20181214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181214_tscode_list.append(stock_name)
daily_20181214_addname_dataframe=pd.DataFrame()
daily_20181214_addname_dataframe['cname'] = daily_20181214_tscode_list
for table_name in daily_20181214.columns.values.tolist():
    daily_20181214_addname_dataframe[table_name] = daily_20181214[table_name]
print("daily_20181214 返回数据 row 行数 = "+str(daily_20181214.shape[0]))
daily_20181214_addname_dataframe.to_excel(daily_201812_excel_writer,'14_5',index=False)
daily_201812_excel_writer.save()
daily_20181215 = pro.daily(start_date='',end_date='',trade_date='20181215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181215_tscode_list = list() 
for ts_code_sh in daily_20181215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181215_tscode_list.append(stock_name)
daily_20181215_addname_dataframe=pd.DataFrame()
daily_20181215_addname_dataframe['cname'] = daily_20181215_tscode_list
for table_name in daily_20181215.columns.values.tolist():
    daily_20181215_addname_dataframe[table_name] = daily_20181215[table_name]
print("daily_20181215 返回数据 row 行数 = "+str(daily_20181215.shape[0]))
daily_20181215_addname_dataframe.to_excel(daily_201812_excel_writer,'15_6',index=False)
daily_201812_excel_writer.save()
daily_20181216 = pro.daily(start_date='',end_date='',trade_date='20181216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181216_tscode_list = list() 
for ts_code_sh in daily_20181216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181216_tscode_list.append(stock_name)
daily_20181216_addname_dataframe=pd.DataFrame()
daily_20181216_addname_dataframe['cname'] = daily_20181216_tscode_list
for table_name in daily_20181216.columns.values.tolist():
    daily_20181216_addname_dataframe[table_name] = daily_20181216[table_name]
print("daily_20181216 返回数据 row 行数 = "+str(daily_20181216.shape[0]))
daily_20181216_addname_dataframe.to_excel(daily_201812_excel_writer,'16_7',index=False)
daily_201812_excel_writer.save()
daily_20181217 = pro.daily(start_date='',end_date='',trade_date='20181217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181217_tscode_list = list() 
for ts_code_sh in daily_20181217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181217_tscode_list.append(stock_name)
daily_20181217_addname_dataframe=pd.DataFrame()
daily_20181217_addname_dataframe['cname'] = daily_20181217_tscode_list
for table_name in daily_20181217.columns.values.tolist():
    daily_20181217_addname_dataframe[table_name] = daily_20181217[table_name]
print("daily_20181217 返回数据 row 行数 = "+str(daily_20181217.shape[0]))
daily_20181217_addname_dataframe.to_excel(daily_201812_excel_writer,'17_1',index=False)
daily_201812_excel_writer.save()
daily_20181218 = pro.daily(start_date='',end_date='',trade_date='20181218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181218_tscode_list = list() 
for ts_code_sh in daily_20181218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181218_tscode_list.append(stock_name)
daily_20181218_addname_dataframe=pd.DataFrame()
daily_20181218_addname_dataframe['cname'] = daily_20181218_tscode_list
for table_name in daily_20181218.columns.values.tolist():
    daily_20181218_addname_dataframe[table_name] = daily_20181218[table_name]
print("daily_20181218 返回数据 row 行数 = "+str(daily_20181218.shape[0]))
daily_20181218_addname_dataframe.to_excel(daily_201812_excel_writer,'18_2',index=False)
daily_201812_excel_writer.save()
daily_20181219 = pro.daily(start_date='',end_date='',trade_date='20181219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181219_tscode_list = list() 
for ts_code_sh in daily_20181219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181219_tscode_list.append(stock_name)
daily_20181219_addname_dataframe=pd.DataFrame()
daily_20181219_addname_dataframe['cname'] = daily_20181219_tscode_list
for table_name in daily_20181219.columns.values.tolist():
    daily_20181219_addname_dataframe[table_name] = daily_20181219[table_name]
print("daily_20181219 返回数据 row 行数 = "+str(daily_20181219.shape[0]))
daily_20181219_addname_dataframe.to_excel(daily_201812_excel_writer,'19_3',index=False)
daily_201812_excel_writer.save()
daily_20181220 = pro.daily(start_date='',end_date='',trade_date='20181220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181220_tscode_list = list() 
for ts_code_sh in daily_20181220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181220_tscode_list.append(stock_name)
daily_20181220_addname_dataframe=pd.DataFrame()
daily_20181220_addname_dataframe['cname'] = daily_20181220_tscode_list
for table_name in daily_20181220.columns.values.tolist():
    daily_20181220_addname_dataframe[table_name] = daily_20181220[table_name]
print("daily_20181220 返回数据 row 行数 = "+str(daily_20181220.shape[0]))
daily_20181220_addname_dataframe.to_excel(daily_201812_excel_writer,'20_4',index=False)
daily_201812_excel_writer.save()
daily_20181221 = pro.daily(start_date='',end_date='',trade_date='20181221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181221_tscode_list = list() 
for ts_code_sh in daily_20181221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181221_tscode_list.append(stock_name)
daily_20181221_addname_dataframe=pd.DataFrame()
daily_20181221_addname_dataframe['cname'] = daily_20181221_tscode_list
for table_name in daily_20181221.columns.values.tolist():
    daily_20181221_addname_dataframe[table_name] = daily_20181221[table_name]
print("daily_20181221 返回数据 row 行数 = "+str(daily_20181221.shape[0]))
daily_20181221_addname_dataframe.to_excel(daily_201812_excel_writer,'21_5',index=False)
daily_201812_excel_writer.save()
daily_20181222 = pro.daily(start_date='',end_date='',trade_date='20181222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181222_tscode_list = list() 
for ts_code_sh in daily_20181222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181222_tscode_list.append(stock_name)
daily_20181222_addname_dataframe=pd.DataFrame()
daily_20181222_addname_dataframe['cname'] = daily_20181222_tscode_list
for table_name in daily_20181222.columns.values.tolist():
    daily_20181222_addname_dataframe[table_name] = daily_20181222[table_name]
print("daily_20181222 返回数据 row 行数 = "+str(daily_20181222.shape[0]))
daily_20181222_addname_dataframe.to_excel(daily_201812_excel_writer,'22_6',index=False)
daily_201812_excel_writer.save()
daily_20181223 = pro.daily(start_date='',end_date='',trade_date='20181223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181223_tscode_list = list() 
for ts_code_sh in daily_20181223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181223_tscode_list.append(stock_name)
daily_20181223_addname_dataframe=pd.DataFrame()
daily_20181223_addname_dataframe['cname'] = daily_20181223_tscode_list
for table_name in daily_20181223.columns.values.tolist():
    daily_20181223_addname_dataframe[table_name] = daily_20181223[table_name]
print("daily_20181223 返回数据 row 行数 = "+str(daily_20181223.shape[0]))
daily_20181223_addname_dataframe.to_excel(daily_201812_excel_writer,'23_7',index=False)
daily_201812_excel_writer.save()
daily_20181224 = pro.daily(start_date='',end_date='',trade_date='20181224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181224_tscode_list = list() 
for ts_code_sh in daily_20181224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181224_tscode_list.append(stock_name)
daily_20181224_addname_dataframe=pd.DataFrame()
daily_20181224_addname_dataframe['cname'] = daily_20181224_tscode_list
for table_name in daily_20181224.columns.values.tolist():
    daily_20181224_addname_dataframe[table_name] = daily_20181224[table_name]
print("daily_20181224 返回数据 row 行数 = "+str(daily_20181224.shape[0]))
daily_20181224_addname_dataframe.to_excel(daily_201812_excel_writer,'24_1',index=False)
daily_201812_excel_writer.save()
daily_20181225 = pro.daily(start_date='',end_date='',trade_date='20181225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181225_tscode_list = list() 
for ts_code_sh in daily_20181225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181225_tscode_list.append(stock_name)
daily_20181225_addname_dataframe=pd.DataFrame()
daily_20181225_addname_dataframe['cname'] = daily_20181225_tscode_list
for table_name in daily_20181225.columns.values.tolist():
    daily_20181225_addname_dataframe[table_name] = daily_20181225[table_name]
print("daily_20181225 返回数据 row 行数 = "+str(daily_20181225.shape[0]))
daily_20181225_addname_dataframe.to_excel(daily_201812_excel_writer,'25_2',index=False)
daily_201812_excel_writer.save()
daily_20181226 = pro.daily(start_date='',end_date='',trade_date='20181226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181226_tscode_list = list() 
for ts_code_sh in daily_20181226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181226_tscode_list.append(stock_name)
daily_20181226_addname_dataframe=pd.DataFrame()
daily_20181226_addname_dataframe['cname'] = daily_20181226_tscode_list
for table_name in daily_20181226.columns.values.tolist():
    daily_20181226_addname_dataframe[table_name] = daily_20181226[table_name]
print("daily_20181226 返回数据 row 行数 = "+str(daily_20181226.shape[0]))
daily_20181226_addname_dataframe.to_excel(daily_201812_excel_writer,'26_3',index=False)
daily_201812_excel_writer.save()
daily_20181227 = pro.daily(start_date='',end_date='',trade_date='20181227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181227_tscode_list = list() 
for ts_code_sh in daily_20181227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181227_tscode_list.append(stock_name)
daily_20181227_addname_dataframe=pd.DataFrame()
daily_20181227_addname_dataframe['cname'] = daily_20181227_tscode_list
for table_name in daily_20181227.columns.values.tolist():
    daily_20181227_addname_dataframe[table_name] = daily_20181227[table_name]
print("daily_20181227 返回数据 row 行数 = "+str(daily_20181227.shape[0]))
daily_20181227_addname_dataframe.to_excel(daily_201812_excel_writer,'27_4',index=False)
daily_201812_excel_writer.save()
daily_20181228 = pro.daily(start_date='',end_date='',trade_date='20181228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181228_tscode_list = list() 
for ts_code_sh in daily_20181228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181228_tscode_list.append(stock_name)
daily_20181228_addname_dataframe=pd.DataFrame()
daily_20181228_addname_dataframe['cname'] = daily_20181228_tscode_list
for table_name in daily_20181228.columns.values.tolist():
    daily_20181228_addname_dataframe[table_name] = daily_20181228[table_name]
print("daily_20181228 返回数据 row 行数 = "+str(daily_20181228.shape[0]))
daily_20181228_addname_dataframe.to_excel(daily_201812_excel_writer,'28_5',index=False)
daily_201812_excel_writer.save()
daily_20181229 = pro.daily(start_date='',end_date='',trade_date='20181229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181229_tscode_list = list() 
for ts_code_sh in daily_20181229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181229_tscode_list.append(stock_name)
daily_20181229_addname_dataframe=pd.DataFrame()
daily_20181229_addname_dataframe['cname'] = daily_20181229_tscode_list
for table_name in daily_20181229.columns.values.tolist():
    daily_20181229_addname_dataframe[table_name] = daily_20181229[table_name]
print("daily_20181229 返回数据 row 行数 = "+str(daily_20181229.shape[0]))
daily_20181229_addname_dataframe.to_excel(daily_201812_excel_writer,'29_6',index=False)
daily_201812_excel_writer.save()
daily_20181230 = pro.daily(start_date='',end_date='',trade_date='20181230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181230_tscode_list = list() 
for ts_code_sh in daily_20181230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181230_tscode_list.append(stock_name)
daily_20181230_addname_dataframe=pd.DataFrame()
daily_20181230_addname_dataframe['cname'] = daily_20181230_tscode_list
for table_name in daily_20181230.columns.values.tolist():
    daily_20181230_addname_dataframe[table_name] = daily_20181230[table_name]
print("daily_20181230 返回数据 row 行数 = "+str(daily_20181230.shape[0]))
daily_20181230_addname_dataframe.to_excel(daily_201812_excel_writer,'30_7',index=False)
daily_201812_excel_writer.save()
daily_20181231 = pro.daily(start_date='',end_date='',trade_date='20181231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181231_tscode_list = list() 
for ts_code_sh in daily_20181231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181231_tscode_list.append(stock_name)
daily_20181231_addname_dataframe=pd.DataFrame()
daily_20181231_addname_dataframe['cname'] = daily_20181231_tscode_list
for table_name in daily_20181231.columns.values.tolist():
    daily_20181231_addname_dataframe[table_name] = daily_20181231[table_name]
print("daily_20181231 返回数据 row 行数 = "+str(daily_20181231.shape[0]))
daily_20181231_addname_dataframe.to_excel(daily_201812_excel_writer,'31_1',index=False)
daily_201812_excel_writer.save()




createexcel('daily_201901.xlsx')
daily_201901_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201901.xlsx')
daily_201901_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201901.xlsx', engine='openpyxl')
daily_201901_excel_writer.book = daily_201901_book
daily_201901_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201901_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190101")       ###  更新 记录日期
daily_20190101 = pro.daily(start_date='',end_date='',trade_date='20190101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190101_tscode_list = list() 
for ts_code_sh in daily_20190101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190101_tscode_list.append(stock_name)
daily_20190101_addname_dataframe=pd.DataFrame()
daily_20190101_addname_dataframe['cname'] = daily_20190101_tscode_list
for table_name in daily_20190101.columns.values.tolist():
    daily_20190101_addname_dataframe[table_name] = daily_20190101[table_name]
print("daily_20190101 返回数据 row 行数 = "+str(daily_20190101.shape[0]))
daily_20190101_addname_dataframe.to_excel(daily_201901_excel_writer,'1_2',index=False)
daily_201901_excel_writer.save()
daily_20190102 = pro.daily(start_date='',end_date='',trade_date='20190102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190102_tscode_list = list() 
for ts_code_sh in daily_20190102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190102_tscode_list.append(stock_name)
daily_20190102_addname_dataframe=pd.DataFrame()
daily_20190102_addname_dataframe['cname'] = daily_20190102_tscode_list
for table_name in daily_20190102.columns.values.tolist():
    daily_20190102_addname_dataframe[table_name] = daily_20190102[table_name]
print("daily_20190102 返回数据 row 行数 = "+str(daily_20190102.shape[0]))
daily_20190102_addname_dataframe.to_excel(daily_201901_excel_writer,'2_3',index=False)
daily_201901_excel_writer.save()
daily_20190103 = pro.daily(start_date='',end_date='',trade_date='20190103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190103_tscode_list = list() 
for ts_code_sh in daily_20190103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190103_tscode_list.append(stock_name)
daily_20190103_addname_dataframe=pd.DataFrame()
daily_20190103_addname_dataframe['cname'] = daily_20190103_tscode_list
for table_name in daily_20190103.columns.values.tolist():
    daily_20190103_addname_dataframe[table_name] = daily_20190103[table_name]
print("daily_20190103 返回数据 row 行数 = "+str(daily_20190103.shape[0]))
daily_20190103_addname_dataframe.to_excel(daily_201901_excel_writer,'3_4',index=False)
daily_201901_excel_writer.save()
daily_20190104 = pro.daily(start_date='',end_date='',trade_date='20190104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190104_tscode_list = list() 
for ts_code_sh in daily_20190104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190104_tscode_list.append(stock_name)
daily_20190104_addname_dataframe=pd.DataFrame()
daily_20190104_addname_dataframe['cname'] = daily_20190104_tscode_list
for table_name in daily_20190104.columns.values.tolist():
    daily_20190104_addname_dataframe[table_name] = daily_20190104[table_name]
print("daily_20190104 返回数据 row 行数 = "+str(daily_20190104.shape[0]))
daily_20190104_addname_dataframe.to_excel(daily_201901_excel_writer,'4_5',index=False)
daily_201901_excel_writer.save()
daily_20190105 = pro.daily(start_date='',end_date='',trade_date='20190105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190105_tscode_list = list() 
for ts_code_sh in daily_20190105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190105_tscode_list.append(stock_name)
daily_20190105_addname_dataframe=pd.DataFrame()
daily_20190105_addname_dataframe['cname'] = daily_20190105_tscode_list
for table_name in daily_20190105.columns.values.tolist():
    daily_20190105_addname_dataframe[table_name] = daily_20190105[table_name]
print("daily_20190105 返回数据 row 行数 = "+str(daily_20190105.shape[0]))
daily_20190105_addname_dataframe.to_excel(daily_201901_excel_writer,'5_6',index=False)
daily_201901_excel_writer.save()
daily_20190106 = pro.daily(start_date='',end_date='',trade_date='20190106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190106_tscode_list = list() 
for ts_code_sh in daily_20190106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190106_tscode_list.append(stock_name)
daily_20190106_addname_dataframe=pd.DataFrame()
daily_20190106_addname_dataframe['cname'] = daily_20190106_tscode_list
for table_name in daily_20190106.columns.values.tolist():
    daily_20190106_addname_dataframe[table_name] = daily_20190106[table_name]
print("daily_20190106 返回数据 row 行数 = "+str(daily_20190106.shape[0]))
daily_20190106_addname_dataframe.to_excel(daily_201901_excel_writer,'6_7',index=False)
daily_201901_excel_writer.save()
daily_20190107 = pro.daily(start_date='',end_date='',trade_date='20190107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190107_tscode_list = list() 
for ts_code_sh in daily_20190107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190107_tscode_list.append(stock_name)
daily_20190107_addname_dataframe=pd.DataFrame()
daily_20190107_addname_dataframe['cname'] = daily_20190107_tscode_list
for table_name in daily_20190107.columns.values.tolist():
    daily_20190107_addname_dataframe[table_name] = daily_20190107[table_name]
print("daily_20190107 返回数据 row 行数 = "+str(daily_20190107.shape[0]))
daily_20190107_addname_dataframe.to_excel(daily_201901_excel_writer,'7_1',index=False)
daily_201901_excel_writer.save()
daily_20190108 = pro.daily(start_date='',end_date='',trade_date='20190108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190108_tscode_list = list() 
for ts_code_sh in daily_20190108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190108_tscode_list.append(stock_name)
daily_20190108_addname_dataframe=pd.DataFrame()
daily_20190108_addname_dataframe['cname'] = daily_20190108_tscode_list
for table_name in daily_20190108.columns.values.tolist():
    daily_20190108_addname_dataframe[table_name] = daily_20190108[table_name]
print("daily_20190108 返回数据 row 行数 = "+str(daily_20190108.shape[0]))
daily_20190108_addname_dataframe.to_excel(daily_201901_excel_writer,'8_2',index=False)
daily_201901_excel_writer.save()
daily_20190109 = pro.daily(start_date='',end_date='',trade_date='20190109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190109_tscode_list = list() 
for ts_code_sh in daily_20190109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190109_tscode_list.append(stock_name)
daily_20190109_addname_dataframe=pd.DataFrame()
daily_20190109_addname_dataframe['cname'] = daily_20190109_tscode_list
for table_name in daily_20190109.columns.values.tolist():
    daily_20190109_addname_dataframe[table_name] = daily_20190109[table_name]
print("daily_20190109 返回数据 row 行数 = "+str(daily_20190109.shape[0]))
daily_20190109_addname_dataframe.to_excel(daily_201901_excel_writer,'9_3',index=False)
daily_201901_excel_writer.save()
daily_20190110 = pro.daily(start_date='',end_date='',trade_date='20190110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190110_tscode_list = list() 
for ts_code_sh in daily_20190110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190110_tscode_list.append(stock_name)
daily_20190110_addname_dataframe=pd.DataFrame()
daily_20190110_addname_dataframe['cname'] = daily_20190110_tscode_list
for table_name in daily_20190110.columns.values.tolist():
    daily_20190110_addname_dataframe[table_name] = daily_20190110[table_name]
print("daily_20190110 返回数据 row 行数 = "+str(daily_20190110.shape[0]))
daily_20190110_addname_dataframe.to_excel(daily_201901_excel_writer,'10_4',index=False)
daily_201901_excel_writer.save()
daily_20190111 = pro.daily(start_date='',end_date='',trade_date='20190111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190111_tscode_list = list() 
for ts_code_sh in daily_20190111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190111_tscode_list.append(stock_name)
daily_20190111_addname_dataframe=pd.DataFrame()
daily_20190111_addname_dataframe['cname'] = daily_20190111_tscode_list
for table_name in daily_20190111.columns.values.tolist():
    daily_20190111_addname_dataframe[table_name] = daily_20190111[table_name]
print("daily_20190111 返回数据 row 行数 = "+str(daily_20190111.shape[0]))
daily_20190111_addname_dataframe.to_excel(daily_201901_excel_writer,'11_5',index=False)
daily_201901_excel_writer.save()
daily_20190112 = pro.daily(start_date='',end_date='',trade_date='20190112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190112_tscode_list = list() 
for ts_code_sh in daily_20190112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190112_tscode_list.append(stock_name)
daily_20190112_addname_dataframe=pd.DataFrame()
daily_20190112_addname_dataframe['cname'] = daily_20190112_tscode_list
for table_name in daily_20190112.columns.values.tolist():
    daily_20190112_addname_dataframe[table_name] = daily_20190112[table_name]
print("daily_20190112 返回数据 row 行数 = "+str(daily_20190112.shape[0]))
daily_20190112_addname_dataframe.to_excel(daily_201901_excel_writer,'12_6',index=False)
daily_201901_excel_writer.save()
daily_20190113 = pro.daily(start_date='',end_date='',trade_date='20190113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190113_tscode_list = list() 
for ts_code_sh in daily_20190113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190113_tscode_list.append(stock_name)
daily_20190113_addname_dataframe=pd.DataFrame()
daily_20190113_addname_dataframe['cname'] = daily_20190113_tscode_list
for table_name in daily_20190113.columns.values.tolist():
    daily_20190113_addname_dataframe[table_name] = daily_20190113[table_name]
print("daily_20190113 返回数据 row 行数 = "+str(daily_20190113.shape[0]))
daily_20190113_addname_dataframe.to_excel(daily_201901_excel_writer,'13_7',index=False)
daily_201901_excel_writer.save()
daily_20190114 = pro.daily(start_date='',end_date='',trade_date='20190114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190114_tscode_list = list() 
for ts_code_sh in daily_20190114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190114_tscode_list.append(stock_name)
daily_20190114_addname_dataframe=pd.DataFrame()
daily_20190114_addname_dataframe['cname'] = daily_20190114_tscode_list
for table_name in daily_20190114.columns.values.tolist():
    daily_20190114_addname_dataframe[table_name] = daily_20190114[table_name]
print("daily_20190114 返回数据 row 行数 = "+str(daily_20190114.shape[0]))
daily_20190114_addname_dataframe.to_excel(daily_201901_excel_writer,'14_1',index=False)
daily_201901_excel_writer.save()
daily_20190115 = pro.daily(start_date='',end_date='',trade_date='20190115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190115_tscode_list = list() 
for ts_code_sh in daily_20190115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190115_tscode_list.append(stock_name)
daily_20190115_addname_dataframe=pd.DataFrame()
daily_20190115_addname_dataframe['cname'] = daily_20190115_tscode_list
for table_name in daily_20190115.columns.values.tolist():
    daily_20190115_addname_dataframe[table_name] = daily_20190115[table_name]
print("daily_20190115 返回数据 row 行数 = "+str(daily_20190115.shape[0]))
daily_20190115_addname_dataframe.to_excel(daily_201901_excel_writer,'15_2',index=False)
daily_201901_excel_writer.save()
daily_20190116 = pro.daily(start_date='',end_date='',trade_date='20190116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190116_tscode_list = list() 
for ts_code_sh in daily_20190116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190116_tscode_list.append(stock_name)
daily_20190116_addname_dataframe=pd.DataFrame()
daily_20190116_addname_dataframe['cname'] = daily_20190116_tscode_list
for table_name in daily_20190116.columns.values.tolist():
    daily_20190116_addname_dataframe[table_name] = daily_20190116[table_name]
print("daily_20190116 返回数据 row 行数 = "+str(daily_20190116.shape[0]))
daily_20190116_addname_dataframe.to_excel(daily_201901_excel_writer,'16_3',index=False)
daily_201901_excel_writer.save()
daily_20190117 = pro.daily(start_date='',end_date='',trade_date='20190117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190117_tscode_list = list() 
for ts_code_sh in daily_20190117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190117_tscode_list.append(stock_name)
daily_20190117_addname_dataframe=pd.DataFrame()
daily_20190117_addname_dataframe['cname'] = daily_20190117_tscode_list
for table_name in daily_20190117.columns.values.tolist():
    daily_20190117_addname_dataframe[table_name] = daily_20190117[table_name]
print("daily_20190117 返回数据 row 行数 = "+str(daily_20190117.shape[0]))
daily_20190117_addname_dataframe.to_excel(daily_201901_excel_writer,'17_4',index=False)
daily_201901_excel_writer.save()
daily_20190118 = pro.daily(start_date='',end_date='',trade_date='20190118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190118_tscode_list = list() 
for ts_code_sh in daily_20190118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190118_tscode_list.append(stock_name)
daily_20190118_addname_dataframe=pd.DataFrame()
daily_20190118_addname_dataframe['cname'] = daily_20190118_tscode_list
for table_name in daily_20190118.columns.values.tolist():
    daily_20190118_addname_dataframe[table_name] = daily_20190118[table_name]
print("daily_20190118 返回数据 row 行数 = "+str(daily_20190118.shape[0]))
daily_20190118_addname_dataframe.to_excel(daily_201901_excel_writer,'18_5',index=False)
daily_201901_excel_writer.save()
daily_20190119 = pro.daily(start_date='',end_date='',trade_date='20190119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190119_tscode_list = list() 
for ts_code_sh in daily_20190119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190119_tscode_list.append(stock_name)
daily_20190119_addname_dataframe=pd.DataFrame()
daily_20190119_addname_dataframe['cname'] = daily_20190119_tscode_list
for table_name in daily_20190119.columns.values.tolist():
    daily_20190119_addname_dataframe[table_name] = daily_20190119[table_name]
print("daily_20190119 返回数据 row 行数 = "+str(daily_20190119.shape[0]))
daily_20190119_addname_dataframe.to_excel(daily_201901_excel_writer,'19_6',index=False)
daily_201901_excel_writer.save()
daily_20190120 = pro.daily(start_date='',end_date='',trade_date='20190120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190120_tscode_list = list() 
for ts_code_sh in daily_20190120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190120_tscode_list.append(stock_name)
daily_20190120_addname_dataframe=pd.DataFrame()
daily_20190120_addname_dataframe['cname'] = daily_20190120_tscode_list
for table_name in daily_20190120.columns.values.tolist():
    daily_20190120_addname_dataframe[table_name] = daily_20190120[table_name]
print("daily_20190120 返回数据 row 行数 = "+str(daily_20190120.shape[0]))
daily_20190120_addname_dataframe.to_excel(daily_201901_excel_writer,'20_7',index=False)
daily_201901_excel_writer.save()
daily_20190121 = pro.daily(start_date='',end_date='',trade_date='20190121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190121_tscode_list = list() 
for ts_code_sh in daily_20190121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190121_tscode_list.append(stock_name)
daily_20190121_addname_dataframe=pd.DataFrame()
daily_20190121_addname_dataframe['cname'] = daily_20190121_tscode_list
for table_name in daily_20190121.columns.values.tolist():
    daily_20190121_addname_dataframe[table_name] = daily_20190121[table_name]
print("daily_20190121 返回数据 row 行数 = "+str(daily_20190121.shape[0]))
daily_20190121_addname_dataframe.to_excel(daily_201901_excel_writer,'21_1',index=False)
daily_201901_excel_writer.save()
daily_20190122 = pro.daily(start_date='',end_date='',trade_date='20190122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190122_tscode_list = list() 
for ts_code_sh in daily_20190122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190122_tscode_list.append(stock_name)
daily_20190122_addname_dataframe=pd.DataFrame()
daily_20190122_addname_dataframe['cname'] = daily_20190122_tscode_list
for table_name in daily_20190122.columns.values.tolist():
    daily_20190122_addname_dataframe[table_name] = daily_20190122[table_name]
print("daily_20190122 返回数据 row 行数 = "+str(daily_20190122.shape[0]))
daily_20190122_addname_dataframe.to_excel(daily_201901_excel_writer,'22_2',index=False)
daily_201901_excel_writer.save()
daily_20190123 = pro.daily(start_date='',end_date='',trade_date='20190123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190123_tscode_list = list() 
for ts_code_sh in daily_20190123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190123_tscode_list.append(stock_name)
daily_20190123_addname_dataframe=pd.DataFrame()
daily_20190123_addname_dataframe['cname'] = daily_20190123_tscode_list
for table_name in daily_20190123.columns.values.tolist():
    daily_20190123_addname_dataframe[table_name] = daily_20190123[table_name]
print("daily_20190123 返回数据 row 行数 = "+str(daily_20190123.shape[0]))
daily_20190123_addname_dataframe.to_excel(daily_201901_excel_writer,'23_3',index=False)
daily_201901_excel_writer.save()
daily_20190124 = pro.daily(start_date='',end_date='',trade_date='20190124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190124_tscode_list = list() 
for ts_code_sh in daily_20190124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190124_tscode_list.append(stock_name)
daily_20190124_addname_dataframe=pd.DataFrame()
daily_20190124_addname_dataframe['cname'] = daily_20190124_tscode_list
for table_name in daily_20190124.columns.values.tolist():
    daily_20190124_addname_dataframe[table_name] = daily_20190124[table_name]
print("daily_20190124 返回数据 row 行数 = "+str(daily_20190124.shape[0]))
daily_20190124_addname_dataframe.to_excel(daily_201901_excel_writer,'24_4',index=False)
daily_201901_excel_writer.save()
daily_20190125 = pro.daily(start_date='',end_date='',trade_date='20190125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190125_tscode_list = list() 
for ts_code_sh in daily_20190125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190125_tscode_list.append(stock_name)
daily_20190125_addname_dataframe=pd.DataFrame()
daily_20190125_addname_dataframe['cname'] = daily_20190125_tscode_list
for table_name in daily_20190125.columns.values.tolist():
    daily_20190125_addname_dataframe[table_name] = daily_20190125[table_name]
print("daily_20190125 返回数据 row 行数 = "+str(daily_20190125.shape[0]))
daily_20190125_addname_dataframe.to_excel(daily_201901_excel_writer,'25_5',index=False)
daily_201901_excel_writer.save()
daily_20190126 = pro.daily(start_date='',end_date='',trade_date='20190126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190126_tscode_list = list() 
for ts_code_sh in daily_20190126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190126_tscode_list.append(stock_name)
daily_20190126_addname_dataframe=pd.DataFrame()
daily_20190126_addname_dataframe['cname'] = daily_20190126_tscode_list
for table_name in daily_20190126.columns.values.tolist():
    daily_20190126_addname_dataframe[table_name] = daily_20190126[table_name]
print("daily_20190126 返回数据 row 行数 = "+str(daily_20190126.shape[0]))
daily_20190126_addname_dataframe.to_excel(daily_201901_excel_writer,'26_6',index=False)
daily_201901_excel_writer.save()
daily_20190127 = pro.daily(start_date='',end_date='',trade_date='20190127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190127_tscode_list = list() 
for ts_code_sh in daily_20190127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190127_tscode_list.append(stock_name)
daily_20190127_addname_dataframe=pd.DataFrame()
daily_20190127_addname_dataframe['cname'] = daily_20190127_tscode_list
for table_name in daily_20190127.columns.values.tolist():
    daily_20190127_addname_dataframe[table_name] = daily_20190127[table_name]
print("daily_20190127 返回数据 row 行数 = "+str(daily_20190127.shape[0]))
daily_20190127_addname_dataframe.to_excel(daily_201901_excel_writer,'27_7',index=False)
daily_201901_excel_writer.save()
daily_20190128 = pro.daily(start_date='',end_date='',trade_date='20190128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190128_tscode_list = list() 
for ts_code_sh in daily_20190128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190128_tscode_list.append(stock_name)
daily_20190128_addname_dataframe=pd.DataFrame()
daily_20190128_addname_dataframe['cname'] = daily_20190128_tscode_list
for table_name in daily_20190128.columns.values.tolist():
    daily_20190128_addname_dataframe[table_name] = daily_20190128[table_name]
print("daily_20190128 返回数据 row 行数 = "+str(daily_20190128.shape[0]))
daily_20190128_addname_dataframe.to_excel(daily_201901_excel_writer,'28_1',index=False)
daily_201901_excel_writer.save()
daily_20190129 = pro.daily(start_date='',end_date='',trade_date='20190129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190129_tscode_list = list() 
for ts_code_sh in daily_20190129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190129_tscode_list.append(stock_name)
daily_20190129_addname_dataframe=pd.DataFrame()
daily_20190129_addname_dataframe['cname'] = daily_20190129_tscode_list
for table_name in daily_20190129.columns.values.tolist():
    daily_20190129_addname_dataframe[table_name] = daily_20190129[table_name]
print("daily_20190129 返回数据 row 行数 = "+str(daily_20190129.shape[0]))
daily_20190129_addname_dataframe.to_excel(daily_201901_excel_writer,'29_2',index=False)
daily_201901_excel_writer.save()
daily_20190130 = pro.daily(start_date='',end_date='',trade_date='20190130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190130_tscode_list = list() 
for ts_code_sh in daily_20190130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190130_tscode_list.append(stock_name)
daily_20190130_addname_dataframe=pd.DataFrame()
daily_20190130_addname_dataframe['cname'] = daily_20190130_tscode_list
for table_name in daily_20190130.columns.values.tolist():
    daily_20190130_addname_dataframe[table_name] = daily_20190130[table_name]
print("daily_20190130 返回数据 row 行数 = "+str(daily_20190130.shape[0]))
daily_20190130_addname_dataframe.to_excel(daily_201901_excel_writer,'30_3',index=False)
daily_201901_excel_writer.save()
daily_20190131 = pro.daily(start_date='',end_date='',trade_date='20190131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190131_tscode_list = list() 
for ts_code_sh in daily_20190131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190131_tscode_list.append(stock_name)
daily_20190131_addname_dataframe=pd.DataFrame()
daily_20190131_addname_dataframe['cname'] = daily_20190131_tscode_list
for table_name in daily_20190131.columns.values.tolist():
    daily_20190131_addname_dataframe[table_name] = daily_20190131[table_name]
print("daily_20190131 返回数据 row 行数 = "+str(daily_20190131.shape[0]))
daily_20190131_addname_dataframe.to_excel(daily_201901_excel_writer,'31_4',index=False)
daily_201901_excel_writer.save()




createexcel('daily_201902.xlsx')
daily_201902_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201902.xlsx')
daily_201902_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201902.xlsx', engine='openpyxl')
daily_201902_excel_writer.book = daily_201902_book
daily_201902_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201902_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190201")       ###  更新 记录日期
daily_20190201 = pro.daily(start_date='',end_date='',trade_date='20190201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190201_tscode_list = list() 
for ts_code_sh in daily_20190201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190201_tscode_list.append(stock_name)
daily_20190201_addname_dataframe=pd.DataFrame()
daily_20190201_addname_dataframe['cname'] = daily_20190201_tscode_list
for table_name in daily_20190201.columns.values.tolist():
    daily_20190201_addname_dataframe[table_name] = daily_20190201[table_name]
print("daily_20190201 返回数据 row 行数 = "+str(daily_20190201.shape[0]))
daily_20190201_addname_dataframe.to_excel(daily_201902_excel_writer,'1_5',index=False)
daily_201902_excel_writer.save()
daily_20190202 = pro.daily(start_date='',end_date='',trade_date='20190202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190202_tscode_list = list() 
for ts_code_sh in daily_20190202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190202_tscode_list.append(stock_name)
daily_20190202_addname_dataframe=pd.DataFrame()
daily_20190202_addname_dataframe['cname'] = daily_20190202_tscode_list
for table_name in daily_20190202.columns.values.tolist():
    daily_20190202_addname_dataframe[table_name] = daily_20190202[table_name]
print("daily_20190202 返回数据 row 行数 = "+str(daily_20190202.shape[0]))
daily_20190202_addname_dataframe.to_excel(daily_201902_excel_writer,'2_6',index=False)
daily_201902_excel_writer.save()
daily_20190203 = pro.daily(start_date='',end_date='',trade_date='20190203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190203_tscode_list = list() 
for ts_code_sh in daily_20190203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190203_tscode_list.append(stock_name)
daily_20190203_addname_dataframe=pd.DataFrame()
daily_20190203_addname_dataframe['cname'] = daily_20190203_tscode_list
for table_name in daily_20190203.columns.values.tolist():
    daily_20190203_addname_dataframe[table_name] = daily_20190203[table_name]
print("daily_20190203 返回数据 row 行数 = "+str(daily_20190203.shape[0]))
daily_20190203_addname_dataframe.to_excel(daily_201902_excel_writer,'3_7',index=False)
daily_201902_excel_writer.save()
daily_20190204 = pro.daily(start_date='',end_date='',trade_date='20190204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190204_tscode_list = list() 
for ts_code_sh in daily_20190204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190204_tscode_list.append(stock_name)
daily_20190204_addname_dataframe=pd.DataFrame()
daily_20190204_addname_dataframe['cname'] = daily_20190204_tscode_list
for table_name in daily_20190204.columns.values.tolist():
    daily_20190204_addname_dataframe[table_name] = daily_20190204[table_name]
print("daily_20190204 返回数据 row 行数 = "+str(daily_20190204.shape[0]))
daily_20190204_addname_dataframe.to_excel(daily_201902_excel_writer,'4_1',index=False)
daily_201902_excel_writer.save()
daily_20190205 = pro.daily(start_date='',end_date='',trade_date='20190205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190205_tscode_list = list() 
for ts_code_sh in daily_20190205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190205_tscode_list.append(stock_name)
daily_20190205_addname_dataframe=pd.DataFrame()
daily_20190205_addname_dataframe['cname'] = daily_20190205_tscode_list
for table_name in daily_20190205.columns.values.tolist():
    daily_20190205_addname_dataframe[table_name] = daily_20190205[table_name]
print("daily_20190205 返回数据 row 行数 = "+str(daily_20190205.shape[0]))
daily_20190205_addname_dataframe.to_excel(daily_201902_excel_writer,'5_2',index=False)
daily_201902_excel_writer.save()
daily_20190206 = pro.daily(start_date='',end_date='',trade_date='20190206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190206_tscode_list = list() 
for ts_code_sh in daily_20190206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190206_tscode_list.append(stock_name)
daily_20190206_addname_dataframe=pd.DataFrame()
daily_20190206_addname_dataframe['cname'] = daily_20190206_tscode_list
for table_name in daily_20190206.columns.values.tolist():
    daily_20190206_addname_dataframe[table_name] = daily_20190206[table_name]
print("daily_20190206 返回数据 row 行数 = "+str(daily_20190206.shape[0]))
daily_20190206_addname_dataframe.to_excel(daily_201902_excel_writer,'6_3',index=False)
daily_201902_excel_writer.save()
daily_20190207 = pro.daily(start_date='',end_date='',trade_date='20190207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190207_tscode_list = list() 
for ts_code_sh in daily_20190207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190207_tscode_list.append(stock_name)
daily_20190207_addname_dataframe=pd.DataFrame()
daily_20190207_addname_dataframe['cname'] = daily_20190207_tscode_list
for table_name in daily_20190207.columns.values.tolist():
    daily_20190207_addname_dataframe[table_name] = daily_20190207[table_name]
print("daily_20190207 返回数据 row 行数 = "+str(daily_20190207.shape[0]))
daily_20190207_addname_dataframe.to_excel(daily_201902_excel_writer,'7_4',index=False)
daily_201902_excel_writer.save()
daily_20190208 = pro.daily(start_date='',end_date='',trade_date='20190208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190208_tscode_list = list() 
for ts_code_sh in daily_20190208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190208_tscode_list.append(stock_name)
daily_20190208_addname_dataframe=pd.DataFrame()
daily_20190208_addname_dataframe['cname'] = daily_20190208_tscode_list
for table_name in daily_20190208.columns.values.tolist():
    daily_20190208_addname_dataframe[table_name] = daily_20190208[table_name]
print("daily_20190208 返回数据 row 行数 = "+str(daily_20190208.shape[0]))
daily_20190208_addname_dataframe.to_excel(daily_201902_excel_writer,'8_5',index=False)
daily_201902_excel_writer.save()
daily_20190209 = pro.daily(start_date='',end_date='',trade_date='20190209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190209_tscode_list = list() 
for ts_code_sh in daily_20190209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190209_tscode_list.append(stock_name)
daily_20190209_addname_dataframe=pd.DataFrame()
daily_20190209_addname_dataframe['cname'] = daily_20190209_tscode_list
for table_name in daily_20190209.columns.values.tolist():
    daily_20190209_addname_dataframe[table_name] = daily_20190209[table_name]
print("daily_20190209 返回数据 row 行数 = "+str(daily_20190209.shape[0]))
daily_20190209_addname_dataframe.to_excel(daily_201902_excel_writer,'9_6',index=False)
daily_201902_excel_writer.save()
daily_20190210 = pro.daily(start_date='',end_date='',trade_date='20190210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190210_tscode_list = list() 
for ts_code_sh in daily_20190210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190210_tscode_list.append(stock_name)
daily_20190210_addname_dataframe=pd.DataFrame()
daily_20190210_addname_dataframe['cname'] = daily_20190210_tscode_list
for table_name in daily_20190210.columns.values.tolist():
    daily_20190210_addname_dataframe[table_name] = daily_20190210[table_name]
print("daily_20190210 返回数据 row 行数 = "+str(daily_20190210.shape[0]))
daily_20190210_addname_dataframe.to_excel(daily_201902_excel_writer,'10_7',index=False)
daily_201902_excel_writer.save()
daily_20190211 = pro.daily(start_date='',end_date='',trade_date='20190211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190211_tscode_list = list() 
for ts_code_sh in daily_20190211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190211_tscode_list.append(stock_name)
daily_20190211_addname_dataframe=pd.DataFrame()
daily_20190211_addname_dataframe['cname'] = daily_20190211_tscode_list
for table_name in daily_20190211.columns.values.tolist():
    daily_20190211_addname_dataframe[table_name] = daily_20190211[table_name]
print("daily_20190211 返回数据 row 行数 = "+str(daily_20190211.shape[0]))
daily_20190211_addname_dataframe.to_excel(daily_201902_excel_writer,'11_1',index=False)
daily_201902_excel_writer.save()
daily_20190212 = pro.daily(start_date='',end_date='',trade_date='20190212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190212_tscode_list = list() 
for ts_code_sh in daily_20190212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190212_tscode_list.append(stock_name)
daily_20190212_addname_dataframe=pd.DataFrame()
daily_20190212_addname_dataframe['cname'] = daily_20190212_tscode_list
for table_name in daily_20190212.columns.values.tolist():
    daily_20190212_addname_dataframe[table_name] = daily_20190212[table_name]
print("daily_20190212 返回数据 row 行数 = "+str(daily_20190212.shape[0]))
daily_20190212_addname_dataframe.to_excel(daily_201902_excel_writer,'12_2',index=False)
daily_201902_excel_writer.save()
daily_20190213 = pro.daily(start_date='',end_date='',trade_date='20190213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190213_tscode_list = list() 
for ts_code_sh in daily_20190213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190213_tscode_list.append(stock_name)
daily_20190213_addname_dataframe=pd.DataFrame()
daily_20190213_addname_dataframe['cname'] = daily_20190213_tscode_list
for table_name in daily_20190213.columns.values.tolist():
    daily_20190213_addname_dataframe[table_name] = daily_20190213[table_name]
print("daily_20190213 返回数据 row 行数 = "+str(daily_20190213.shape[0]))
daily_20190213_addname_dataframe.to_excel(daily_201902_excel_writer,'13_3',index=False)
daily_201902_excel_writer.save()
daily_20190214 = pro.daily(start_date='',end_date='',trade_date='20190214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190214_tscode_list = list() 
for ts_code_sh in daily_20190214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190214_tscode_list.append(stock_name)
daily_20190214_addname_dataframe=pd.DataFrame()
daily_20190214_addname_dataframe['cname'] = daily_20190214_tscode_list
for table_name in daily_20190214.columns.values.tolist():
    daily_20190214_addname_dataframe[table_name] = daily_20190214[table_name]
print("daily_20190214 返回数据 row 行数 = "+str(daily_20190214.shape[0]))
daily_20190214_addname_dataframe.to_excel(daily_201902_excel_writer,'14_4',index=False)
daily_201902_excel_writer.save()
daily_20190215 = pro.daily(start_date='',end_date='',trade_date='20190215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190215_tscode_list = list() 
for ts_code_sh in daily_20190215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190215_tscode_list.append(stock_name)
daily_20190215_addname_dataframe=pd.DataFrame()
daily_20190215_addname_dataframe['cname'] = daily_20190215_tscode_list
for table_name in daily_20190215.columns.values.tolist():
    daily_20190215_addname_dataframe[table_name] = daily_20190215[table_name]
print("daily_20190215 返回数据 row 行数 = "+str(daily_20190215.shape[0]))
daily_20190215_addname_dataframe.to_excel(daily_201902_excel_writer,'15_5',index=False)
daily_201902_excel_writer.save()
daily_20190216 = pro.daily(start_date='',end_date='',trade_date='20190216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190216_tscode_list = list() 
for ts_code_sh in daily_20190216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190216_tscode_list.append(stock_name)
daily_20190216_addname_dataframe=pd.DataFrame()
daily_20190216_addname_dataframe['cname'] = daily_20190216_tscode_list
for table_name in daily_20190216.columns.values.tolist():
    daily_20190216_addname_dataframe[table_name] = daily_20190216[table_name]
print("daily_20190216 返回数据 row 行数 = "+str(daily_20190216.shape[0]))
daily_20190216_addname_dataframe.to_excel(daily_201902_excel_writer,'16_6',index=False)
daily_201902_excel_writer.save()
daily_20190217 = pro.daily(start_date='',end_date='',trade_date='20190217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190217_tscode_list = list() 
for ts_code_sh in daily_20190217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190217_tscode_list.append(stock_name)
daily_20190217_addname_dataframe=pd.DataFrame()
daily_20190217_addname_dataframe['cname'] = daily_20190217_tscode_list
for table_name in daily_20190217.columns.values.tolist():
    daily_20190217_addname_dataframe[table_name] = daily_20190217[table_name]
print("daily_20190217 返回数据 row 行数 = "+str(daily_20190217.shape[0]))
daily_20190217_addname_dataframe.to_excel(daily_201902_excel_writer,'17_7',index=False)
daily_201902_excel_writer.save()
daily_20190218 = pro.daily(start_date='',end_date='',trade_date='20190218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190218_tscode_list = list() 
for ts_code_sh in daily_20190218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190218_tscode_list.append(stock_name)
daily_20190218_addname_dataframe=pd.DataFrame()
daily_20190218_addname_dataframe['cname'] = daily_20190218_tscode_list
for table_name in daily_20190218.columns.values.tolist():
    daily_20190218_addname_dataframe[table_name] = daily_20190218[table_name]
print("daily_20190218 返回数据 row 行数 = "+str(daily_20190218.shape[0]))
daily_20190218_addname_dataframe.to_excel(daily_201902_excel_writer,'18_1',index=False)
daily_201902_excel_writer.save()
daily_20190219 = pro.daily(start_date='',end_date='',trade_date='20190219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190219_tscode_list = list() 
for ts_code_sh in daily_20190219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190219_tscode_list.append(stock_name)
daily_20190219_addname_dataframe=pd.DataFrame()
daily_20190219_addname_dataframe['cname'] = daily_20190219_tscode_list
for table_name in daily_20190219.columns.values.tolist():
    daily_20190219_addname_dataframe[table_name] = daily_20190219[table_name]
print("daily_20190219 返回数据 row 行数 = "+str(daily_20190219.shape[0]))
daily_20190219_addname_dataframe.to_excel(daily_201902_excel_writer,'19_2',index=False)
daily_201902_excel_writer.save()
daily_20190220 = pro.daily(start_date='',end_date='',trade_date='20190220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190220_tscode_list = list() 
for ts_code_sh in daily_20190220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190220_tscode_list.append(stock_name)
daily_20190220_addname_dataframe=pd.DataFrame()
daily_20190220_addname_dataframe['cname'] = daily_20190220_tscode_list
for table_name in daily_20190220.columns.values.tolist():
    daily_20190220_addname_dataframe[table_name] = daily_20190220[table_name]
print("daily_20190220 返回数据 row 行数 = "+str(daily_20190220.shape[0]))
daily_20190220_addname_dataframe.to_excel(daily_201902_excel_writer,'20_3',index=False)
daily_201902_excel_writer.save()
daily_20190221 = pro.daily(start_date='',end_date='',trade_date='20190221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190221_tscode_list = list() 
for ts_code_sh in daily_20190221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190221_tscode_list.append(stock_name)
daily_20190221_addname_dataframe=pd.DataFrame()
daily_20190221_addname_dataframe['cname'] = daily_20190221_tscode_list
for table_name in daily_20190221.columns.values.tolist():
    daily_20190221_addname_dataframe[table_name] = daily_20190221[table_name]
print("daily_20190221 返回数据 row 行数 = "+str(daily_20190221.shape[0]))
daily_20190221_addname_dataframe.to_excel(daily_201902_excel_writer,'21_4',index=False)
daily_201902_excel_writer.save()
daily_20190222 = pro.daily(start_date='',end_date='',trade_date='20190222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190222_tscode_list = list() 
for ts_code_sh in daily_20190222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190222_tscode_list.append(stock_name)
daily_20190222_addname_dataframe=pd.DataFrame()
daily_20190222_addname_dataframe['cname'] = daily_20190222_tscode_list
for table_name in daily_20190222.columns.values.tolist():
    daily_20190222_addname_dataframe[table_name] = daily_20190222[table_name]
print("daily_20190222 返回数据 row 行数 = "+str(daily_20190222.shape[0]))
daily_20190222_addname_dataframe.to_excel(daily_201902_excel_writer,'22_5',index=False)
daily_201902_excel_writer.save()
daily_20190223 = pro.daily(start_date='',end_date='',trade_date='20190223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190223_tscode_list = list() 
for ts_code_sh in daily_20190223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190223_tscode_list.append(stock_name)
daily_20190223_addname_dataframe=pd.DataFrame()
daily_20190223_addname_dataframe['cname'] = daily_20190223_tscode_list
for table_name in daily_20190223.columns.values.tolist():
    daily_20190223_addname_dataframe[table_name] = daily_20190223[table_name]
print("daily_20190223 返回数据 row 行数 = "+str(daily_20190223.shape[0]))
daily_20190223_addname_dataframe.to_excel(daily_201902_excel_writer,'23_6',index=False)
daily_201902_excel_writer.save()
daily_20190224 = pro.daily(start_date='',end_date='',trade_date='20190224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190224_tscode_list = list() 
for ts_code_sh in daily_20190224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190224_tscode_list.append(stock_name)
daily_20190224_addname_dataframe=pd.DataFrame()
daily_20190224_addname_dataframe['cname'] = daily_20190224_tscode_list
for table_name in daily_20190224.columns.values.tolist():
    daily_20190224_addname_dataframe[table_name] = daily_20190224[table_name]
print("daily_20190224 返回数据 row 行数 = "+str(daily_20190224.shape[0]))
daily_20190224_addname_dataframe.to_excel(daily_201902_excel_writer,'24_7',index=False)
daily_201902_excel_writer.save()
daily_20190225 = pro.daily(start_date='',end_date='',trade_date='20190225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190225_tscode_list = list() 
for ts_code_sh in daily_20190225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190225_tscode_list.append(stock_name)
daily_20190225_addname_dataframe=pd.DataFrame()
daily_20190225_addname_dataframe['cname'] = daily_20190225_tscode_list
for table_name in daily_20190225.columns.values.tolist():
    daily_20190225_addname_dataframe[table_name] = daily_20190225[table_name]
print("daily_20190225 返回数据 row 行数 = "+str(daily_20190225.shape[0]))
daily_20190225_addname_dataframe.to_excel(daily_201902_excel_writer,'25_1',index=False)
daily_201902_excel_writer.save()
daily_20190226 = pro.daily(start_date='',end_date='',trade_date='20190226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190226_tscode_list = list() 
for ts_code_sh in daily_20190226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190226_tscode_list.append(stock_name)
daily_20190226_addname_dataframe=pd.DataFrame()
daily_20190226_addname_dataframe['cname'] = daily_20190226_tscode_list
for table_name in daily_20190226.columns.values.tolist():
    daily_20190226_addname_dataframe[table_name] = daily_20190226[table_name]
print("daily_20190226 返回数据 row 行数 = "+str(daily_20190226.shape[0]))
daily_20190226_addname_dataframe.to_excel(daily_201902_excel_writer,'26_2',index=False)
daily_201902_excel_writer.save()
daily_20190227 = pro.daily(start_date='',end_date='',trade_date='20190227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190227_tscode_list = list() 
for ts_code_sh in daily_20190227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190227_tscode_list.append(stock_name)
daily_20190227_addname_dataframe=pd.DataFrame()
daily_20190227_addname_dataframe['cname'] = daily_20190227_tscode_list
for table_name in daily_20190227.columns.values.tolist():
    daily_20190227_addname_dataframe[table_name] = daily_20190227[table_name]
print("daily_20190227 返回数据 row 行数 = "+str(daily_20190227.shape[0]))
daily_20190227_addname_dataframe.to_excel(daily_201902_excel_writer,'27_3',index=False)
daily_201902_excel_writer.save()
daily_20190228 = pro.daily(start_date='',end_date='',trade_date='20190228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190228_tscode_list = list() 
for ts_code_sh in daily_20190228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190228_tscode_list.append(stock_name)
daily_20190228_addname_dataframe=pd.DataFrame()
daily_20190228_addname_dataframe['cname'] = daily_20190228_tscode_list
for table_name in daily_20190228.columns.values.tolist():
    daily_20190228_addname_dataframe[table_name] = daily_20190228[table_name]
print("daily_20190228 返回数据 row 行数 = "+str(daily_20190228.shape[0]))
daily_20190228_addname_dataframe.to_excel(daily_201902_excel_writer,'28_4',index=False)
daily_201902_excel_writer.save()




createexcel('daily_201903.xlsx')
daily_201903_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201903.xlsx')
daily_201903_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201903.xlsx', engine='openpyxl')
daily_201903_excel_writer.book = daily_201903_book
daily_201903_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201903_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190301")       ###  更新 记录日期
daily_20190301 = pro.daily(start_date='',end_date='',trade_date='20190301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190301_tscode_list = list() 
for ts_code_sh in daily_20190301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190301_tscode_list.append(stock_name)
daily_20190301_addname_dataframe=pd.DataFrame()
daily_20190301_addname_dataframe['cname'] = daily_20190301_tscode_list
for table_name in daily_20190301.columns.values.tolist():
    daily_20190301_addname_dataframe[table_name] = daily_20190301[table_name]
print("daily_20190301 返回数据 row 行数 = "+str(daily_20190301.shape[0]))
daily_20190301_addname_dataframe.to_excel(daily_201903_excel_writer,'1_5',index=False)
daily_201903_excel_writer.save()
daily_20190302 = pro.daily(start_date='',end_date='',trade_date='20190302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190302_tscode_list = list() 
for ts_code_sh in daily_20190302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190302_tscode_list.append(stock_name)
daily_20190302_addname_dataframe=pd.DataFrame()
daily_20190302_addname_dataframe['cname'] = daily_20190302_tscode_list
for table_name in daily_20190302.columns.values.tolist():
    daily_20190302_addname_dataframe[table_name] = daily_20190302[table_name]
print("daily_20190302 返回数据 row 行数 = "+str(daily_20190302.shape[0]))
daily_20190302_addname_dataframe.to_excel(daily_201903_excel_writer,'2_6',index=False)
daily_201903_excel_writer.save()
daily_20190303 = pro.daily(start_date='',end_date='',trade_date='20190303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190303_tscode_list = list() 
for ts_code_sh in daily_20190303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190303_tscode_list.append(stock_name)
daily_20190303_addname_dataframe=pd.DataFrame()
daily_20190303_addname_dataframe['cname'] = daily_20190303_tscode_list
for table_name in daily_20190303.columns.values.tolist():
    daily_20190303_addname_dataframe[table_name] = daily_20190303[table_name]
print("daily_20190303 返回数据 row 行数 = "+str(daily_20190303.shape[0]))
daily_20190303_addname_dataframe.to_excel(daily_201903_excel_writer,'3_7',index=False)
daily_201903_excel_writer.save()
daily_20190304 = pro.daily(start_date='',end_date='',trade_date='20190304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190304_tscode_list = list() 
for ts_code_sh in daily_20190304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190304_tscode_list.append(stock_name)
daily_20190304_addname_dataframe=pd.DataFrame()
daily_20190304_addname_dataframe['cname'] = daily_20190304_tscode_list
for table_name in daily_20190304.columns.values.tolist():
    daily_20190304_addname_dataframe[table_name] = daily_20190304[table_name]
print("daily_20190304 返回数据 row 行数 = "+str(daily_20190304.shape[0]))
daily_20190304_addname_dataframe.to_excel(daily_201903_excel_writer,'4_1',index=False)
daily_201903_excel_writer.save()
daily_20190305 = pro.daily(start_date='',end_date='',trade_date='20190305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190305_tscode_list = list() 
for ts_code_sh in daily_20190305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190305_tscode_list.append(stock_name)
daily_20190305_addname_dataframe=pd.DataFrame()
daily_20190305_addname_dataframe['cname'] = daily_20190305_tscode_list
for table_name in daily_20190305.columns.values.tolist():
    daily_20190305_addname_dataframe[table_name] = daily_20190305[table_name]
print("daily_20190305 返回数据 row 行数 = "+str(daily_20190305.shape[0]))
daily_20190305_addname_dataframe.to_excel(daily_201903_excel_writer,'5_2',index=False)
daily_201903_excel_writer.save()
daily_20190306 = pro.daily(start_date='',end_date='',trade_date='20190306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190306_tscode_list = list() 
for ts_code_sh in daily_20190306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190306_tscode_list.append(stock_name)
daily_20190306_addname_dataframe=pd.DataFrame()
daily_20190306_addname_dataframe['cname'] = daily_20190306_tscode_list
for table_name in daily_20190306.columns.values.tolist():
    daily_20190306_addname_dataframe[table_name] = daily_20190306[table_name]
print("daily_20190306 返回数据 row 行数 = "+str(daily_20190306.shape[0]))
daily_20190306_addname_dataframe.to_excel(daily_201903_excel_writer,'6_3',index=False)
daily_201903_excel_writer.save()
daily_20190307 = pro.daily(start_date='',end_date='',trade_date='20190307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190307_tscode_list = list() 
for ts_code_sh in daily_20190307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190307_tscode_list.append(stock_name)
daily_20190307_addname_dataframe=pd.DataFrame()
daily_20190307_addname_dataframe['cname'] = daily_20190307_tscode_list
for table_name in daily_20190307.columns.values.tolist():
    daily_20190307_addname_dataframe[table_name] = daily_20190307[table_name]
print("daily_20190307 返回数据 row 行数 = "+str(daily_20190307.shape[0]))
daily_20190307_addname_dataframe.to_excel(daily_201903_excel_writer,'7_4',index=False)
daily_201903_excel_writer.save()
daily_20190308 = pro.daily(start_date='',end_date='',trade_date='20190308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190308_tscode_list = list() 
for ts_code_sh in daily_20190308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190308_tscode_list.append(stock_name)
daily_20190308_addname_dataframe=pd.DataFrame()
daily_20190308_addname_dataframe['cname'] = daily_20190308_tscode_list
for table_name in daily_20190308.columns.values.tolist():
    daily_20190308_addname_dataframe[table_name] = daily_20190308[table_name]
print("daily_20190308 返回数据 row 行数 = "+str(daily_20190308.shape[0]))
daily_20190308_addname_dataframe.to_excel(daily_201903_excel_writer,'8_5',index=False)
daily_201903_excel_writer.save()
daily_20190309 = pro.daily(start_date='',end_date='',trade_date='20190309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190309_tscode_list = list() 
for ts_code_sh in daily_20190309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190309_tscode_list.append(stock_name)
daily_20190309_addname_dataframe=pd.DataFrame()
daily_20190309_addname_dataframe['cname'] = daily_20190309_tscode_list
for table_name in daily_20190309.columns.values.tolist():
    daily_20190309_addname_dataframe[table_name] = daily_20190309[table_name]
print("daily_20190309 返回数据 row 行数 = "+str(daily_20190309.shape[0]))
daily_20190309_addname_dataframe.to_excel(daily_201903_excel_writer,'9_6',index=False)
daily_201903_excel_writer.save()
daily_20190310 = pro.daily(start_date='',end_date='',trade_date='20190310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190310_tscode_list = list() 
for ts_code_sh in daily_20190310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190310_tscode_list.append(stock_name)
daily_20190310_addname_dataframe=pd.DataFrame()
daily_20190310_addname_dataframe['cname'] = daily_20190310_tscode_list
for table_name in daily_20190310.columns.values.tolist():
    daily_20190310_addname_dataframe[table_name] = daily_20190310[table_name]
print("daily_20190310 返回数据 row 行数 = "+str(daily_20190310.shape[0]))
daily_20190310_addname_dataframe.to_excel(daily_201903_excel_writer,'10_7',index=False)
daily_201903_excel_writer.save()
daily_20190311 = pro.daily(start_date='',end_date='',trade_date='20190311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190311_tscode_list = list() 
for ts_code_sh in daily_20190311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190311_tscode_list.append(stock_name)
daily_20190311_addname_dataframe=pd.DataFrame()
daily_20190311_addname_dataframe['cname'] = daily_20190311_tscode_list
for table_name in daily_20190311.columns.values.tolist():
    daily_20190311_addname_dataframe[table_name] = daily_20190311[table_name]
print("daily_20190311 返回数据 row 行数 = "+str(daily_20190311.shape[0]))
daily_20190311_addname_dataframe.to_excel(daily_201903_excel_writer,'11_1',index=False)
daily_201903_excel_writer.save()
daily_20190312 = pro.daily(start_date='',end_date='',trade_date='20190312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190312_tscode_list = list() 
for ts_code_sh in daily_20190312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190312_tscode_list.append(stock_name)
daily_20190312_addname_dataframe=pd.DataFrame()
daily_20190312_addname_dataframe['cname'] = daily_20190312_tscode_list
for table_name in daily_20190312.columns.values.tolist():
    daily_20190312_addname_dataframe[table_name] = daily_20190312[table_name]
print("daily_20190312 返回数据 row 行数 = "+str(daily_20190312.shape[0]))
daily_20190312_addname_dataframe.to_excel(daily_201903_excel_writer,'12_2',index=False)
daily_201903_excel_writer.save()
daily_20190313 = pro.daily(start_date='',end_date='',trade_date='20190313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190313_tscode_list = list() 
for ts_code_sh in daily_20190313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190313_tscode_list.append(stock_name)
daily_20190313_addname_dataframe=pd.DataFrame()
daily_20190313_addname_dataframe['cname'] = daily_20190313_tscode_list
for table_name in daily_20190313.columns.values.tolist():
    daily_20190313_addname_dataframe[table_name] = daily_20190313[table_name]
print("daily_20190313 返回数据 row 行数 = "+str(daily_20190313.shape[0]))
daily_20190313_addname_dataframe.to_excel(daily_201903_excel_writer,'13_3',index=False)
daily_201903_excel_writer.save()
daily_20190314 = pro.daily(start_date='',end_date='',trade_date='20190314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190314_tscode_list = list() 
for ts_code_sh in daily_20190314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190314_tscode_list.append(stock_name)
daily_20190314_addname_dataframe=pd.DataFrame()
daily_20190314_addname_dataframe['cname'] = daily_20190314_tscode_list
for table_name in daily_20190314.columns.values.tolist():
    daily_20190314_addname_dataframe[table_name] = daily_20190314[table_name]
print("daily_20190314 返回数据 row 行数 = "+str(daily_20190314.shape[0]))
daily_20190314_addname_dataframe.to_excel(daily_201903_excel_writer,'14_4',index=False)
daily_201903_excel_writer.save()
daily_20190315 = pro.daily(start_date='',end_date='',trade_date='20190315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190315_tscode_list = list() 
for ts_code_sh in daily_20190315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190315_tscode_list.append(stock_name)
daily_20190315_addname_dataframe=pd.DataFrame()
daily_20190315_addname_dataframe['cname'] = daily_20190315_tscode_list
for table_name in daily_20190315.columns.values.tolist():
    daily_20190315_addname_dataframe[table_name] = daily_20190315[table_name]
print("daily_20190315 返回数据 row 行数 = "+str(daily_20190315.shape[0]))
daily_20190315_addname_dataframe.to_excel(daily_201903_excel_writer,'15_5',index=False)
daily_201903_excel_writer.save()
daily_20190316 = pro.daily(start_date='',end_date='',trade_date='20190316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190316_tscode_list = list() 
for ts_code_sh in daily_20190316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190316_tscode_list.append(stock_name)
daily_20190316_addname_dataframe=pd.DataFrame()
daily_20190316_addname_dataframe['cname'] = daily_20190316_tscode_list
for table_name in daily_20190316.columns.values.tolist():
    daily_20190316_addname_dataframe[table_name] = daily_20190316[table_name]
print("daily_20190316 返回数据 row 行数 = "+str(daily_20190316.shape[0]))
daily_20190316_addname_dataframe.to_excel(daily_201903_excel_writer,'16_6',index=False)
daily_201903_excel_writer.save()
daily_20190317 = pro.daily(start_date='',end_date='',trade_date='20190317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190317_tscode_list = list() 
for ts_code_sh in daily_20190317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190317_tscode_list.append(stock_name)
daily_20190317_addname_dataframe=pd.DataFrame()
daily_20190317_addname_dataframe['cname'] = daily_20190317_tscode_list
for table_name in daily_20190317.columns.values.tolist():
    daily_20190317_addname_dataframe[table_name] = daily_20190317[table_name]
print("daily_20190317 返回数据 row 行数 = "+str(daily_20190317.shape[0]))
daily_20190317_addname_dataframe.to_excel(daily_201903_excel_writer,'17_7',index=False)
daily_201903_excel_writer.save()
daily_20190318 = pro.daily(start_date='',end_date='',trade_date='20190318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190318_tscode_list = list() 
for ts_code_sh in daily_20190318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190318_tscode_list.append(stock_name)
daily_20190318_addname_dataframe=pd.DataFrame()
daily_20190318_addname_dataframe['cname'] = daily_20190318_tscode_list
for table_name in daily_20190318.columns.values.tolist():
    daily_20190318_addname_dataframe[table_name] = daily_20190318[table_name]
print("daily_20190318 返回数据 row 行数 = "+str(daily_20190318.shape[0]))
daily_20190318_addname_dataframe.to_excel(daily_201903_excel_writer,'18_1',index=False)
daily_201903_excel_writer.save()
daily_20190319 = pro.daily(start_date='',end_date='',trade_date='20190319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190319_tscode_list = list() 
for ts_code_sh in daily_20190319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190319_tscode_list.append(stock_name)
daily_20190319_addname_dataframe=pd.DataFrame()
daily_20190319_addname_dataframe['cname'] = daily_20190319_tscode_list
for table_name in daily_20190319.columns.values.tolist():
    daily_20190319_addname_dataframe[table_name] = daily_20190319[table_name]
print("daily_20190319 返回数据 row 行数 = "+str(daily_20190319.shape[0]))
daily_20190319_addname_dataframe.to_excel(daily_201903_excel_writer,'19_2',index=False)
daily_201903_excel_writer.save()
daily_20190320 = pro.daily(start_date='',end_date='',trade_date='20190320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190320_tscode_list = list() 
for ts_code_sh in daily_20190320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190320_tscode_list.append(stock_name)
daily_20190320_addname_dataframe=pd.DataFrame()
daily_20190320_addname_dataframe['cname'] = daily_20190320_tscode_list
for table_name in daily_20190320.columns.values.tolist():
    daily_20190320_addname_dataframe[table_name] = daily_20190320[table_name]
print("daily_20190320 返回数据 row 行数 = "+str(daily_20190320.shape[0]))
daily_20190320_addname_dataframe.to_excel(daily_201903_excel_writer,'20_3',index=False)
daily_201903_excel_writer.save()
daily_20190321 = pro.daily(start_date='',end_date='',trade_date='20190321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190321_tscode_list = list() 
for ts_code_sh in daily_20190321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190321_tscode_list.append(stock_name)
daily_20190321_addname_dataframe=pd.DataFrame()
daily_20190321_addname_dataframe['cname'] = daily_20190321_tscode_list
for table_name in daily_20190321.columns.values.tolist():
    daily_20190321_addname_dataframe[table_name] = daily_20190321[table_name]
print("daily_20190321 返回数据 row 行数 = "+str(daily_20190321.shape[0]))
daily_20190321_addname_dataframe.to_excel(daily_201903_excel_writer,'21_4',index=False)
daily_201903_excel_writer.save()
daily_20190322 = pro.daily(start_date='',end_date='',trade_date='20190322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190322_tscode_list = list() 
for ts_code_sh in daily_20190322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190322_tscode_list.append(stock_name)
daily_20190322_addname_dataframe=pd.DataFrame()
daily_20190322_addname_dataframe['cname'] = daily_20190322_tscode_list
for table_name in daily_20190322.columns.values.tolist():
    daily_20190322_addname_dataframe[table_name] = daily_20190322[table_name]
print("daily_20190322 返回数据 row 行数 = "+str(daily_20190322.shape[0]))
daily_20190322_addname_dataframe.to_excel(daily_201903_excel_writer,'22_5',index=False)
daily_201903_excel_writer.save()
daily_20190323 = pro.daily(start_date='',end_date='',trade_date='20190323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190323_tscode_list = list() 
for ts_code_sh in daily_20190323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190323_tscode_list.append(stock_name)
daily_20190323_addname_dataframe=pd.DataFrame()
daily_20190323_addname_dataframe['cname'] = daily_20190323_tscode_list
for table_name in daily_20190323.columns.values.tolist():
    daily_20190323_addname_dataframe[table_name] = daily_20190323[table_name]
print("daily_20190323 返回数据 row 行数 = "+str(daily_20190323.shape[0]))
daily_20190323_addname_dataframe.to_excel(daily_201903_excel_writer,'23_6',index=False)
daily_201903_excel_writer.save()
daily_20190324 = pro.daily(start_date='',end_date='',trade_date='20190324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190324_tscode_list = list() 
for ts_code_sh in daily_20190324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190324_tscode_list.append(stock_name)
daily_20190324_addname_dataframe=pd.DataFrame()
daily_20190324_addname_dataframe['cname'] = daily_20190324_tscode_list
for table_name in daily_20190324.columns.values.tolist():
    daily_20190324_addname_dataframe[table_name] = daily_20190324[table_name]
print("daily_20190324 返回数据 row 行数 = "+str(daily_20190324.shape[0]))
daily_20190324_addname_dataframe.to_excel(daily_201903_excel_writer,'24_7',index=False)
daily_201903_excel_writer.save()
daily_20190325 = pro.daily(start_date='',end_date='',trade_date='20190325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190325_tscode_list = list() 
for ts_code_sh in daily_20190325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190325_tscode_list.append(stock_name)
daily_20190325_addname_dataframe=pd.DataFrame()
daily_20190325_addname_dataframe['cname'] = daily_20190325_tscode_list
for table_name in daily_20190325.columns.values.tolist():
    daily_20190325_addname_dataframe[table_name] = daily_20190325[table_name]
print("daily_20190325 返回数据 row 行数 = "+str(daily_20190325.shape[0]))
daily_20190325_addname_dataframe.to_excel(daily_201903_excel_writer,'25_1',index=False)
daily_201903_excel_writer.save()
daily_20190326 = pro.daily(start_date='',end_date='',trade_date='20190326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190326_tscode_list = list() 
for ts_code_sh in daily_20190326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190326_tscode_list.append(stock_name)
daily_20190326_addname_dataframe=pd.DataFrame()
daily_20190326_addname_dataframe['cname'] = daily_20190326_tscode_list
for table_name in daily_20190326.columns.values.tolist():
    daily_20190326_addname_dataframe[table_name] = daily_20190326[table_name]
print("daily_20190326 返回数据 row 行数 = "+str(daily_20190326.shape[0]))
daily_20190326_addname_dataframe.to_excel(daily_201903_excel_writer,'26_2',index=False)
daily_201903_excel_writer.save()
daily_20190327 = pro.daily(start_date='',end_date='',trade_date='20190327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190327_tscode_list = list() 
for ts_code_sh in daily_20190327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190327_tscode_list.append(stock_name)
daily_20190327_addname_dataframe=pd.DataFrame()
daily_20190327_addname_dataframe['cname'] = daily_20190327_tscode_list
for table_name in daily_20190327.columns.values.tolist():
    daily_20190327_addname_dataframe[table_name] = daily_20190327[table_name]
print("daily_20190327 返回数据 row 行数 = "+str(daily_20190327.shape[0]))
daily_20190327_addname_dataframe.to_excel(daily_201903_excel_writer,'27_3',index=False)
daily_201903_excel_writer.save()
daily_20190328 = pro.daily(start_date='',end_date='',trade_date='20190328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190328_tscode_list = list() 
for ts_code_sh in daily_20190328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190328_tscode_list.append(stock_name)
daily_20190328_addname_dataframe=pd.DataFrame()
daily_20190328_addname_dataframe['cname'] = daily_20190328_tscode_list
for table_name in daily_20190328.columns.values.tolist():
    daily_20190328_addname_dataframe[table_name] = daily_20190328[table_name]
print("daily_20190328 返回数据 row 行数 = "+str(daily_20190328.shape[0]))
daily_20190328_addname_dataframe.to_excel(daily_201903_excel_writer,'28_4',index=False)
daily_201903_excel_writer.save()
daily_20190329 = pro.daily(start_date='',end_date='',trade_date='20190329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190329_tscode_list = list() 
for ts_code_sh in daily_20190329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190329_tscode_list.append(stock_name)
daily_20190329_addname_dataframe=pd.DataFrame()
daily_20190329_addname_dataframe['cname'] = daily_20190329_tscode_list
for table_name in daily_20190329.columns.values.tolist():
    daily_20190329_addname_dataframe[table_name] = daily_20190329[table_name]
print("daily_20190329 返回数据 row 行数 = "+str(daily_20190329.shape[0]))
daily_20190329_addname_dataframe.to_excel(daily_201903_excel_writer,'29_5',index=False)
daily_201903_excel_writer.save()
daily_20190330 = pro.daily(start_date='',end_date='',trade_date='20190330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190330_tscode_list = list() 
for ts_code_sh in daily_20190330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190330_tscode_list.append(stock_name)
daily_20190330_addname_dataframe=pd.DataFrame()
daily_20190330_addname_dataframe['cname'] = daily_20190330_tscode_list
for table_name in daily_20190330.columns.values.tolist():
    daily_20190330_addname_dataframe[table_name] = daily_20190330[table_name]
print("daily_20190330 返回数据 row 行数 = "+str(daily_20190330.shape[0]))
daily_20190330_addname_dataframe.to_excel(daily_201903_excel_writer,'30_6',index=False)
daily_201903_excel_writer.save()
daily_20190331 = pro.daily(start_date='',end_date='',trade_date='20190331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190331_tscode_list = list() 
for ts_code_sh in daily_20190331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190331_tscode_list.append(stock_name)
daily_20190331_addname_dataframe=pd.DataFrame()
daily_20190331_addname_dataframe['cname'] = daily_20190331_tscode_list
for table_name in daily_20190331.columns.values.tolist():
    daily_20190331_addname_dataframe[table_name] = daily_20190331[table_name]
print("daily_20190331 返回数据 row 行数 = "+str(daily_20190331.shape[0]))
daily_20190331_addname_dataframe.to_excel(daily_201903_excel_writer,'31_7',index=False)
daily_201903_excel_writer.save()




createexcel('daily_201904.xlsx')
daily_201904_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201904.xlsx')
daily_201904_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201904.xlsx', engine='openpyxl')
daily_201904_excel_writer.book = daily_201904_book
daily_201904_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201904_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190401")       ###  更新 记录日期
daily_20190401 = pro.daily(start_date='',end_date='',trade_date='20190401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190401_tscode_list = list() 
for ts_code_sh in daily_20190401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190401_tscode_list.append(stock_name)
daily_20190401_addname_dataframe=pd.DataFrame()
daily_20190401_addname_dataframe['cname'] = daily_20190401_tscode_list
for table_name in daily_20190401.columns.values.tolist():
    daily_20190401_addname_dataframe[table_name] = daily_20190401[table_name]
print("daily_20190401 返回数据 row 行数 = "+str(daily_20190401.shape[0]))
daily_20190401_addname_dataframe.to_excel(daily_201904_excel_writer,'1_1',index=False)
daily_201904_excel_writer.save()
daily_20190402 = pro.daily(start_date='',end_date='',trade_date='20190402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190402_tscode_list = list() 
for ts_code_sh in daily_20190402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190402_tscode_list.append(stock_name)
daily_20190402_addname_dataframe=pd.DataFrame()
daily_20190402_addname_dataframe['cname'] = daily_20190402_tscode_list
for table_name in daily_20190402.columns.values.tolist():
    daily_20190402_addname_dataframe[table_name] = daily_20190402[table_name]
print("daily_20190402 返回数据 row 行数 = "+str(daily_20190402.shape[0]))
daily_20190402_addname_dataframe.to_excel(daily_201904_excel_writer,'2_2',index=False)
daily_201904_excel_writer.save()
daily_20190403 = pro.daily(start_date='',end_date='',trade_date='20190403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190403_tscode_list = list() 
for ts_code_sh in daily_20190403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190403_tscode_list.append(stock_name)
daily_20190403_addname_dataframe=pd.DataFrame()
daily_20190403_addname_dataframe['cname'] = daily_20190403_tscode_list
for table_name in daily_20190403.columns.values.tolist():
    daily_20190403_addname_dataframe[table_name] = daily_20190403[table_name]
print("daily_20190403 返回数据 row 行数 = "+str(daily_20190403.shape[0]))
daily_20190403_addname_dataframe.to_excel(daily_201904_excel_writer,'3_3',index=False)
daily_201904_excel_writer.save()
daily_20190404 = pro.daily(start_date='',end_date='',trade_date='20190404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190404_tscode_list = list() 
for ts_code_sh in daily_20190404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190404_tscode_list.append(stock_name)
daily_20190404_addname_dataframe=pd.DataFrame()
daily_20190404_addname_dataframe['cname'] = daily_20190404_tscode_list
for table_name in daily_20190404.columns.values.tolist():
    daily_20190404_addname_dataframe[table_name] = daily_20190404[table_name]
print("daily_20190404 返回数据 row 行数 = "+str(daily_20190404.shape[0]))
daily_20190404_addname_dataframe.to_excel(daily_201904_excel_writer,'4_4',index=False)
daily_201904_excel_writer.save()
daily_20190405 = pro.daily(start_date='',end_date='',trade_date='20190405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190405_tscode_list = list() 
for ts_code_sh in daily_20190405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190405_tscode_list.append(stock_name)
daily_20190405_addname_dataframe=pd.DataFrame()
daily_20190405_addname_dataframe['cname'] = daily_20190405_tscode_list
for table_name in daily_20190405.columns.values.tolist():
    daily_20190405_addname_dataframe[table_name] = daily_20190405[table_name]
print("daily_20190405 返回数据 row 行数 = "+str(daily_20190405.shape[0]))
daily_20190405_addname_dataframe.to_excel(daily_201904_excel_writer,'5_5',index=False)
daily_201904_excel_writer.save()
daily_20190406 = pro.daily(start_date='',end_date='',trade_date='20190406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190406_tscode_list = list() 
for ts_code_sh in daily_20190406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190406_tscode_list.append(stock_name)
daily_20190406_addname_dataframe=pd.DataFrame()
daily_20190406_addname_dataframe['cname'] = daily_20190406_tscode_list
for table_name in daily_20190406.columns.values.tolist():
    daily_20190406_addname_dataframe[table_name] = daily_20190406[table_name]
print("daily_20190406 返回数据 row 行数 = "+str(daily_20190406.shape[0]))
daily_20190406_addname_dataframe.to_excel(daily_201904_excel_writer,'6_6',index=False)
daily_201904_excel_writer.save()
daily_20190407 = pro.daily(start_date='',end_date='',trade_date='20190407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190407_tscode_list = list() 
for ts_code_sh in daily_20190407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190407_tscode_list.append(stock_name)
daily_20190407_addname_dataframe=pd.DataFrame()
daily_20190407_addname_dataframe['cname'] = daily_20190407_tscode_list
for table_name in daily_20190407.columns.values.tolist():
    daily_20190407_addname_dataframe[table_name] = daily_20190407[table_name]
print("daily_20190407 返回数据 row 行数 = "+str(daily_20190407.shape[0]))
daily_20190407_addname_dataframe.to_excel(daily_201904_excel_writer,'7_7',index=False)
daily_201904_excel_writer.save()
daily_20190408 = pro.daily(start_date='',end_date='',trade_date='20190408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190408_tscode_list = list() 
for ts_code_sh in daily_20190408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190408_tscode_list.append(stock_name)
daily_20190408_addname_dataframe=pd.DataFrame()
daily_20190408_addname_dataframe['cname'] = daily_20190408_tscode_list
for table_name in daily_20190408.columns.values.tolist():
    daily_20190408_addname_dataframe[table_name] = daily_20190408[table_name]
print("daily_20190408 返回数据 row 行数 = "+str(daily_20190408.shape[0]))
daily_20190408_addname_dataframe.to_excel(daily_201904_excel_writer,'8_1',index=False)
daily_201904_excel_writer.save()
daily_20190409 = pro.daily(start_date='',end_date='',trade_date='20190409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190409_tscode_list = list() 
for ts_code_sh in daily_20190409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190409_tscode_list.append(stock_name)
daily_20190409_addname_dataframe=pd.DataFrame()
daily_20190409_addname_dataframe['cname'] = daily_20190409_tscode_list
for table_name in daily_20190409.columns.values.tolist():
    daily_20190409_addname_dataframe[table_name] = daily_20190409[table_name]
print("daily_20190409 返回数据 row 行数 = "+str(daily_20190409.shape[0]))
daily_20190409_addname_dataframe.to_excel(daily_201904_excel_writer,'9_2',index=False)
daily_201904_excel_writer.save()
daily_20190410 = pro.daily(start_date='',end_date='',trade_date='20190410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190410_tscode_list = list() 
for ts_code_sh in daily_20190410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190410_tscode_list.append(stock_name)
daily_20190410_addname_dataframe=pd.DataFrame()
daily_20190410_addname_dataframe['cname'] = daily_20190410_tscode_list
for table_name in daily_20190410.columns.values.tolist():
    daily_20190410_addname_dataframe[table_name] = daily_20190410[table_name]
print("daily_20190410 返回数据 row 行数 = "+str(daily_20190410.shape[0]))
daily_20190410_addname_dataframe.to_excel(daily_201904_excel_writer,'10_3',index=False)
daily_201904_excel_writer.save()
daily_20190411 = pro.daily(start_date='',end_date='',trade_date='20190411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190411_tscode_list = list() 
for ts_code_sh in daily_20190411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190411_tscode_list.append(stock_name)
daily_20190411_addname_dataframe=pd.DataFrame()
daily_20190411_addname_dataframe['cname'] = daily_20190411_tscode_list
for table_name in daily_20190411.columns.values.tolist():
    daily_20190411_addname_dataframe[table_name] = daily_20190411[table_name]
print("daily_20190411 返回数据 row 行数 = "+str(daily_20190411.shape[0]))
daily_20190411_addname_dataframe.to_excel(daily_201904_excel_writer,'11_4',index=False)
daily_201904_excel_writer.save()
daily_20190412 = pro.daily(start_date='',end_date='',trade_date='20190412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190412_tscode_list = list() 
for ts_code_sh in daily_20190412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190412_tscode_list.append(stock_name)
daily_20190412_addname_dataframe=pd.DataFrame()
daily_20190412_addname_dataframe['cname'] = daily_20190412_tscode_list
for table_name in daily_20190412.columns.values.tolist():
    daily_20190412_addname_dataframe[table_name] = daily_20190412[table_name]
print("daily_20190412 返回数据 row 行数 = "+str(daily_20190412.shape[0]))
daily_20190412_addname_dataframe.to_excel(daily_201904_excel_writer,'12_5',index=False)
daily_201904_excel_writer.save()
daily_20190413 = pro.daily(start_date='',end_date='',trade_date='20190413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190413_tscode_list = list() 
for ts_code_sh in daily_20190413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190413_tscode_list.append(stock_name)
daily_20190413_addname_dataframe=pd.DataFrame()
daily_20190413_addname_dataframe['cname'] = daily_20190413_tscode_list
for table_name in daily_20190413.columns.values.tolist():
    daily_20190413_addname_dataframe[table_name] = daily_20190413[table_name]
print("daily_20190413 返回数据 row 行数 = "+str(daily_20190413.shape[0]))
daily_20190413_addname_dataframe.to_excel(daily_201904_excel_writer,'13_6',index=False)
daily_201904_excel_writer.save()
daily_20190414 = pro.daily(start_date='',end_date='',trade_date='20190414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190414_tscode_list = list() 
for ts_code_sh in daily_20190414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190414_tscode_list.append(stock_name)
daily_20190414_addname_dataframe=pd.DataFrame()
daily_20190414_addname_dataframe['cname'] = daily_20190414_tscode_list
for table_name in daily_20190414.columns.values.tolist():
    daily_20190414_addname_dataframe[table_name] = daily_20190414[table_name]
print("daily_20190414 返回数据 row 行数 = "+str(daily_20190414.shape[0]))
daily_20190414_addname_dataframe.to_excel(daily_201904_excel_writer,'14_7',index=False)
daily_201904_excel_writer.save()
daily_20190415 = pro.daily(start_date='',end_date='',trade_date='20190415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190415_tscode_list = list() 
for ts_code_sh in daily_20190415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190415_tscode_list.append(stock_name)
daily_20190415_addname_dataframe=pd.DataFrame()
daily_20190415_addname_dataframe['cname'] = daily_20190415_tscode_list
for table_name in daily_20190415.columns.values.tolist():
    daily_20190415_addname_dataframe[table_name] = daily_20190415[table_name]
print("daily_20190415 返回数据 row 行数 = "+str(daily_20190415.shape[0]))
daily_20190415_addname_dataframe.to_excel(daily_201904_excel_writer,'15_1',index=False)
daily_201904_excel_writer.save()
daily_20190416 = pro.daily(start_date='',end_date='',trade_date='20190416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190416_tscode_list = list() 
for ts_code_sh in daily_20190416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190416_tscode_list.append(stock_name)
daily_20190416_addname_dataframe=pd.DataFrame()
daily_20190416_addname_dataframe['cname'] = daily_20190416_tscode_list
for table_name in daily_20190416.columns.values.tolist():
    daily_20190416_addname_dataframe[table_name] = daily_20190416[table_name]
print("daily_20190416 返回数据 row 行数 = "+str(daily_20190416.shape[0]))
daily_20190416_addname_dataframe.to_excel(daily_201904_excel_writer,'16_2',index=False)
daily_201904_excel_writer.save()
daily_20190417 = pro.daily(start_date='',end_date='',trade_date='20190417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190417_tscode_list = list() 
for ts_code_sh in daily_20190417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190417_tscode_list.append(stock_name)
daily_20190417_addname_dataframe=pd.DataFrame()
daily_20190417_addname_dataframe['cname'] = daily_20190417_tscode_list
for table_name in daily_20190417.columns.values.tolist():
    daily_20190417_addname_dataframe[table_name] = daily_20190417[table_name]
print("daily_20190417 返回数据 row 行数 = "+str(daily_20190417.shape[0]))
daily_20190417_addname_dataframe.to_excel(daily_201904_excel_writer,'17_3',index=False)
daily_201904_excel_writer.save()
daily_20190418 = pro.daily(start_date='',end_date='',trade_date='20190418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190418_tscode_list = list() 
for ts_code_sh in daily_20190418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190418_tscode_list.append(stock_name)
daily_20190418_addname_dataframe=pd.DataFrame()
daily_20190418_addname_dataframe['cname'] = daily_20190418_tscode_list
for table_name in daily_20190418.columns.values.tolist():
    daily_20190418_addname_dataframe[table_name] = daily_20190418[table_name]
print("daily_20190418 返回数据 row 行数 = "+str(daily_20190418.shape[0]))
daily_20190418_addname_dataframe.to_excel(daily_201904_excel_writer,'18_4',index=False)
daily_201904_excel_writer.save()
daily_20190419 = pro.daily(start_date='',end_date='',trade_date='20190419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190419_tscode_list = list() 
for ts_code_sh in daily_20190419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190419_tscode_list.append(stock_name)
daily_20190419_addname_dataframe=pd.DataFrame()
daily_20190419_addname_dataframe['cname'] = daily_20190419_tscode_list
for table_name in daily_20190419.columns.values.tolist():
    daily_20190419_addname_dataframe[table_name] = daily_20190419[table_name]
print("daily_20190419 返回数据 row 行数 = "+str(daily_20190419.shape[0]))
daily_20190419_addname_dataframe.to_excel(daily_201904_excel_writer,'19_5',index=False)
daily_201904_excel_writer.save()
daily_20190420 = pro.daily(start_date='',end_date='',trade_date='20190420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190420_tscode_list = list() 
for ts_code_sh in daily_20190420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190420_tscode_list.append(stock_name)
daily_20190420_addname_dataframe=pd.DataFrame()
daily_20190420_addname_dataframe['cname'] = daily_20190420_tscode_list
for table_name in daily_20190420.columns.values.tolist():
    daily_20190420_addname_dataframe[table_name] = daily_20190420[table_name]
print("daily_20190420 返回数据 row 行数 = "+str(daily_20190420.shape[0]))
daily_20190420_addname_dataframe.to_excel(daily_201904_excel_writer,'20_6',index=False)
daily_201904_excel_writer.save()
daily_20190421 = pro.daily(start_date='',end_date='',trade_date='20190421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190421_tscode_list = list() 
for ts_code_sh in daily_20190421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190421_tscode_list.append(stock_name)
daily_20190421_addname_dataframe=pd.DataFrame()
daily_20190421_addname_dataframe['cname'] = daily_20190421_tscode_list
for table_name in daily_20190421.columns.values.tolist():
    daily_20190421_addname_dataframe[table_name] = daily_20190421[table_name]
print("daily_20190421 返回数据 row 行数 = "+str(daily_20190421.shape[0]))
daily_20190421_addname_dataframe.to_excel(daily_201904_excel_writer,'21_7',index=False)
daily_201904_excel_writer.save()
daily_20190422 = pro.daily(start_date='',end_date='',trade_date='20190422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190422_tscode_list = list() 
for ts_code_sh in daily_20190422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190422_tscode_list.append(stock_name)
daily_20190422_addname_dataframe=pd.DataFrame()
daily_20190422_addname_dataframe['cname'] = daily_20190422_tscode_list
for table_name in daily_20190422.columns.values.tolist():
    daily_20190422_addname_dataframe[table_name] = daily_20190422[table_name]
print("daily_20190422 返回数据 row 行数 = "+str(daily_20190422.shape[0]))
daily_20190422_addname_dataframe.to_excel(daily_201904_excel_writer,'22_1',index=False)
daily_201904_excel_writer.save()
daily_20190423 = pro.daily(start_date='',end_date='',trade_date='20190423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190423_tscode_list = list() 
for ts_code_sh in daily_20190423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190423_tscode_list.append(stock_name)
daily_20190423_addname_dataframe=pd.DataFrame()
daily_20190423_addname_dataframe['cname'] = daily_20190423_tscode_list
for table_name in daily_20190423.columns.values.tolist():
    daily_20190423_addname_dataframe[table_name] = daily_20190423[table_name]
print("daily_20190423 返回数据 row 行数 = "+str(daily_20190423.shape[0]))
daily_20190423_addname_dataframe.to_excel(daily_201904_excel_writer,'23_2',index=False)
daily_201904_excel_writer.save()
daily_20190424 = pro.daily(start_date='',end_date='',trade_date='20190424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190424_tscode_list = list() 
for ts_code_sh in daily_20190424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190424_tscode_list.append(stock_name)
daily_20190424_addname_dataframe=pd.DataFrame()
daily_20190424_addname_dataframe['cname'] = daily_20190424_tscode_list
for table_name in daily_20190424.columns.values.tolist():
    daily_20190424_addname_dataframe[table_name] = daily_20190424[table_name]
print("daily_20190424 返回数据 row 行数 = "+str(daily_20190424.shape[0]))
daily_20190424_addname_dataframe.to_excel(daily_201904_excel_writer,'24_3',index=False)
daily_201904_excel_writer.save()
daily_20190425 = pro.daily(start_date='',end_date='',trade_date='20190425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190425_tscode_list = list() 
for ts_code_sh in daily_20190425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190425_tscode_list.append(stock_name)
daily_20190425_addname_dataframe=pd.DataFrame()
daily_20190425_addname_dataframe['cname'] = daily_20190425_tscode_list
for table_name in daily_20190425.columns.values.tolist():
    daily_20190425_addname_dataframe[table_name] = daily_20190425[table_name]
print("daily_20190425 返回数据 row 行数 = "+str(daily_20190425.shape[0]))
daily_20190425_addname_dataframe.to_excel(daily_201904_excel_writer,'25_4',index=False)
daily_201904_excel_writer.save()
daily_20190426 = pro.daily(start_date='',end_date='',trade_date='20190426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190426_tscode_list = list() 
for ts_code_sh in daily_20190426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190426_tscode_list.append(stock_name)
daily_20190426_addname_dataframe=pd.DataFrame()
daily_20190426_addname_dataframe['cname'] = daily_20190426_tscode_list
for table_name in daily_20190426.columns.values.tolist():
    daily_20190426_addname_dataframe[table_name] = daily_20190426[table_name]
print("daily_20190426 返回数据 row 行数 = "+str(daily_20190426.shape[0]))
daily_20190426_addname_dataframe.to_excel(daily_201904_excel_writer,'26_5',index=False)
daily_201904_excel_writer.save()
daily_20190427 = pro.daily(start_date='',end_date='',trade_date='20190427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190427_tscode_list = list() 
for ts_code_sh in daily_20190427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190427_tscode_list.append(stock_name)
daily_20190427_addname_dataframe=pd.DataFrame()
daily_20190427_addname_dataframe['cname'] = daily_20190427_tscode_list
for table_name in daily_20190427.columns.values.tolist():
    daily_20190427_addname_dataframe[table_name] = daily_20190427[table_name]
print("daily_20190427 返回数据 row 行数 = "+str(daily_20190427.shape[0]))
daily_20190427_addname_dataframe.to_excel(daily_201904_excel_writer,'27_6',index=False)
daily_201904_excel_writer.save()
daily_20190428 = pro.daily(start_date='',end_date='',trade_date='20190428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190428_tscode_list = list() 
for ts_code_sh in daily_20190428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190428_tscode_list.append(stock_name)
daily_20190428_addname_dataframe=pd.DataFrame()
daily_20190428_addname_dataframe['cname'] = daily_20190428_tscode_list
for table_name in daily_20190428.columns.values.tolist():
    daily_20190428_addname_dataframe[table_name] = daily_20190428[table_name]
print("daily_20190428 返回数据 row 行数 = "+str(daily_20190428.shape[0]))
daily_20190428_addname_dataframe.to_excel(daily_201904_excel_writer,'28_7',index=False)
daily_201904_excel_writer.save()
daily_20190429 = pro.daily(start_date='',end_date='',trade_date='20190429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190429_tscode_list = list() 
for ts_code_sh in daily_20190429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190429_tscode_list.append(stock_name)
daily_20190429_addname_dataframe=pd.DataFrame()
daily_20190429_addname_dataframe['cname'] = daily_20190429_tscode_list
for table_name in daily_20190429.columns.values.tolist():
    daily_20190429_addname_dataframe[table_name] = daily_20190429[table_name]
print("daily_20190429 返回数据 row 行数 = "+str(daily_20190429.shape[0]))
daily_20190429_addname_dataframe.to_excel(daily_201904_excel_writer,'29_1',index=False)
daily_201904_excel_writer.save()
daily_20190430 = pro.daily(start_date='',end_date='',trade_date='20190430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190430_tscode_list = list() 
for ts_code_sh in daily_20190430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190430_tscode_list.append(stock_name)
daily_20190430_addname_dataframe=pd.DataFrame()
daily_20190430_addname_dataframe['cname'] = daily_20190430_tscode_list
for table_name in daily_20190430.columns.values.tolist():
    daily_20190430_addname_dataframe[table_name] = daily_20190430[table_name]
print("daily_20190430 返回数据 row 行数 = "+str(daily_20190430.shape[0]))
daily_20190430_addname_dataframe.to_excel(daily_201904_excel_writer,'30_2',index=False)
daily_201904_excel_writer.save()




createexcel('daily_201905.xlsx')
daily_201905_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201905.xlsx')
daily_201905_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201905.xlsx', engine='openpyxl')
daily_201905_excel_writer.book = daily_201905_book
daily_201905_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201905_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190501")       ###  更新 记录日期
daily_20190501 = pro.daily(start_date='',end_date='',trade_date='20190501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190501_tscode_list = list() 
for ts_code_sh in daily_20190501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190501_tscode_list.append(stock_name)
daily_20190501_addname_dataframe=pd.DataFrame()
daily_20190501_addname_dataframe['cname'] = daily_20190501_tscode_list
for table_name in daily_20190501.columns.values.tolist():
    daily_20190501_addname_dataframe[table_name] = daily_20190501[table_name]
print("daily_20190501 返回数据 row 行数 = "+str(daily_20190501.shape[0]))
daily_20190501_addname_dataframe.to_excel(daily_201905_excel_writer,'1_3',index=False)
daily_201905_excel_writer.save()
daily_20190502 = pro.daily(start_date='',end_date='',trade_date='20190502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190502_tscode_list = list() 
for ts_code_sh in daily_20190502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190502_tscode_list.append(stock_name)
daily_20190502_addname_dataframe=pd.DataFrame()
daily_20190502_addname_dataframe['cname'] = daily_20190502_tscode_list
for table_name in daily_20190502.columns.values.tolist():
    daily_20190502_addname_dataframe[table_name] = daily_20190502[table_name]
print("daily_20190502 返回数据 row 行数 = "+str(daily_20190502.shape[0]))
daily_20190502_addname_dataframe.to_excel(daily_201905_excel_writer,'2_4',index=False)
daily_201905_excel_writer.save()
daily_20190503 = pro.daily(start_date='',end_date='',trade_date='20190503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190503_tscode_list = list() 
for ts_code_sh in daily_20190503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190503_tscode_list.append(stock_name)
daily_20190503_addname_dataframe=pd.DataFrame()
daily_20190503_addname_dataframe['cname'] = daily_20190503_tscode_list
for table_name in daily_20190503.columns.values.tolist():
    daily_20190503_addname_dataframe[table_name] = daily_20190503[table_name]
print("daily_20190503 返回数据 row 行数 = "+str(daily_20190503.shape[0]))
daily_20190503_addname_dataframe.to_excel(daily_201905_excel_writer,'3_5',index=False)
daily_201905_excel_writer.save()
daily_20190504 = pro.daily(start_date='',end_date='',trade_date='20190504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190504_tscode_list = list() 
for ts_code_sh in daily_20190504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190504_tscode_list.append(stock_name)
daily_20190504_addname_dataframe=pd.DataFrame()
daily_20190504_addname_dataframe['cname'] = daily_20190504_tscode_list
for table_name in daily_20190504.columns.values.tolist():
    daily_20190504_addname_dataframe[table_name] = daily_20190504[table_name]
print("daily_20190504 返回数据 row 行数 = "+str(daily_20190504.shape[0]))
daily_20190504_addname_dataframe.to_excel(daily_201905_excel_writer,'4_6',index=False)
daily_201905_excel_writer.save()
daily_20190505 = pro.daily(start_date='',end_date='',trade_date='20190505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190505_tscode_list = list() 
for ts_code_sh in daily_20190505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190505_tscode_list.append(stock_name)
daily_20190505_addname_dataframe=pd.DataFrame()
daily_20190505_addname_dataframe['cname'] = daily_20190505_tscode_list
for table_name in daily_20190505.columns.values.tolist():
    daily_20190505_addname_dataframe[table_name] = daily_20190505[table_name]
print("daily_20190505 返回数据 row 行数 = "+str(daily_20190505.shape[0]))
daily_20190505_addname_dataframe.to_excel(daily_201905_excel_writer,'5_7',index=False)
daily_201905_excel_writer.save()
daily_20190506 = pro.daily(start_date='',end_date='',trade_date='20190506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190506_tscode_list = list() 
for ts_code_sh in daily_20190506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190506_tscode_list.append(stock_name)
daily_20190506_addname_dataframe=pd.DataFrame()
daily_20190506_addname_dataframe['cname'] = daily_20190506_tscode_list
for table_name in daily_20190506.columns.values.tolist():
    daily_20190506_addname_dataframe[table_name] = daily_20190506[table_name]
print("daily_20190506 返回数据 row 行数 = "+str(daily_20190506.shape[0]))
daily_20190506_addname_dataframe.to_excel(daily_201905_excel_writer,'6_1',index=False)
daily_201905_excel_writer.save()
daily_20190507 = pro.daily(start_date='',end_date='',trade_date='20190507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190507_tscode_list = list() 
for ts_code_sh in daily_20190507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190507_tscode_list.append(stock_name)
daily_20190507_addname_dataframe=pd.DataFrame()
daily_20190507_addname_dataframe['cname'] = daily_20190507_tscode_list
for table_name in daily_20190507.columns.values.tolist():
    daily_20190507_addname_dataframe[table_name] = daily_20190507[table_name]
print("daily_20190507 返回数据 row 行数 = "+str(daily_20190507.shape[0]))
daily_20190507_addname_dataframe.to_excel(daily_201905_excel_writer,'7_2',index=False)
daily_201905_excel_writer.save()
daily_20190508 = pro.daily(start_date='',end_date='',trade_date='20190508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190508_tscode_list = list() 
for ts_code_sh in daily_20190508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190508_tscode_list.append(stock_name)
daily_20190508_addname_dataframe=pd.DataFrame()
daily_20190508_addname_dataframe['cname'] = daily_20190508_tscode_list
for table_name in daily_20190508.columns.values.tolist():
    daily_20190508_addname_dataframe[table_name] = daily_20190508[table_name]
print("daily_20190508 返回数据 row 行数 = "+str(daily_20190508.shape[0]))
daily_20190508_addname_dataframe.to_excel(daily_201905_excel_writer,'8_3',index=False)
daily_201905_excel_writer.save()
daily_20190509 = pro.daily(start_date='',end_date='',trade_date='20190509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190509_tscode_list = list() 
for ts_code_sh in daily_20190509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190509_tscode_list.append(stock_name)
daily_20190509_addname_dataframe=pd.DataFrame()
daily_20190509_addname_dataframe['cname'] = daily_20190509_tscode_list
for table_name in daily_20190509.columns.values.tolist():
    daily_20190509_addname_dataframe[table_name] = daily_20190509[table_name]
print("daily_20190509 返回数据 row 行数 = "+str(daily_20190509.shape[0]))
daily_20190509_addname_dataframe.to_excel(daily_201905_excel_writer,'9_4',index=False)
daily_201905_excel_writer.save()
daily_20190510 = pro.daily(start_date='',end_date='',trade_date='20190510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190510_tscode_list = list() 
for ts_code_sh in daily_20190510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190510_tscode_list.append(stock_name)
daily_20190510_addname_dataframe=pd.DataFrame()
daily_20190510_addname_dataframe['cname'] = daily_20190510_tscode_list
for table_name in daily_20190510.columns.values.tolist():
    daily_20190510_addname_dataframe[table_name] = daily_20190510[table_name]
print("daily_20190510 返回数据 row 行数 = "+str(daily_20190510.shape[0]))
daily_20190510_addname_dataframe.to_excel(daily_201905_excel_writer,'10_5',index=False)
daily_201905_excel_writer.save()
daily_20190511 = pro.daily(start_date='',end_date='',trade_date='20190511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190511_tscode_list = list() 
for ts_code_sh in daily_20190511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190511_tscode_list.append(stock_name)
daily_20190511_addname_dataframe=pd.DataFrame()
daily_20190511_addname_dataframe['cname'] = daily_20190511_tscode_list
for table_name in daily_20190511.columns.values.tolist():
    daily_20190511_addname_dataframe[table_name] = daily_20190511[table_name]
print("daily_20190511 返回数据 row 行数 = "+str(daily_20190511.shape[0]))
daily_20190511_addname_dataframe.to_excel(daily_201905_excel_writer,'11_6',index=False)
daily_201905_excel_writer.save()
daily_20190512 = pro.daily(start_date='',end_date='',trade_date='20190512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190512_tscode_list = list() 
for ts_code_sh in daily_20190512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190512_tscode_list.append(stock_name)
daily_20190512_addname_dataframe=pd.DataFrame()
daily_20190512_addname_dataframe['cname'] = daily_20190512_tscode_list
for table_name in daily_20190512.columns.values.tolist():
    daily_20190512_addname_dataframe[table_name] = daily_20190512[table_name]
print("daily_20190512 返回数据 row 行数 = "+str(daily_20190512.shape[0]))
daily_20190512_addname_dataframe.to_excel(daily_201905_excel_writer,'12_7',index=False)
daily_201905_excel_writer.save()
daily_20190513 = pro.daily(start_date='',end_date='',trade_date='20190513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190513_tscode_list = list() 
for ts_code_sh in daily_20190513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190513_tscode_list.append(stock_name)
daily_20190513_addname_dataframe=pd.DataFrame()
daily_20190513_addname_dataframe['cname'] = daily_20190513_tscode_list
for table_name in daily_20190513.columns.values.tolist():
    daily_20190513_addname_dataframe[table_name] = daily_20190513[table_name]
print("daily_20190513 返回数据 row 行数 = "+str(daily_20190513.shape[0]))
daily_20190513_addname_dataframe.to_excel(daily_201905_excel_writer,'13_1',index=False)
daily_201905_excel_writer.save()
daily_20190514 = pro.daily(start_date='',end_date='',trade_date='20190514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190514_tscode_list = list() 
for ts_code_sh in daily_20190514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190514_tscode_list.append(stock_name)
daily_20190514_addname_dataframe=pd.DataFrame()
daily_20190514_addname_dataframe['cname'] = daily_20190514_tscode_list
for table_name in daily_20190514.columns.values.tolist():
    daily_20190514_addname_dataframe[table_name] = daily_20190514[table_name]
print("daily_20190514 返回数据 row 行数 = "+str(daily_20190514.shape[0]))
daily_20190514_addname_dataframe.to_excel(daily_201905_excel_writer,'14_2',index=False)
daily_201905_excel_writer.save()
daily_20190515 = pro.daily(start_date='',end_date='',trade_date='20190515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190515_tscode_list = list() 
for ts_code_sh in daily_20190515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190515_tscode_list.append(stock_name)
daily_20190515_addname_dataframe=pd.DataFrame()
daily_20190515_addname_dataframe['cname'] = daily_20190515_tscode_list
for table_name in daily_20190515.columns.values.tolist():
    daily_20190515_addname_dataframe[table_name] = daily_20190515[table_name]
print("daily_20190515 返回数据 row 行数 = "+str(daily_20190515.shape[0]))
daily_20190515_addname_dataframe.to_excel(daily_201905_excel_writer,'15_3',index=False)
daily_201905_excel_writer.save()
daily_20190516 = pro.daily(start_date='',end_date='',trade_date='20190516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190516_tscode_list = list() 
for ts_code_sh in daily_20190516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190516_tscode_list.append(stock_name)
daily_20190516_addname_dataframe=pd.DataFrame()
daily_20190516_addname_dataframe['cname'] = daily_20190516_tscode_list
for table_name in daily_20190516.columns.values.tolist():
    daily_20190516_addname_dataframe[table_name] = daily_20190516[table_name]
print("daily_20190516 返回数据 row 行数 = "+str(daily_20190516.shape[0]))
daily_20190516_addname_dataframe.to_excel(daily_201905_excel_writer,'16_4',index=False)
daily_201905_excel_writer.save()
daily_20190517 = pro.daily(start_date='',end_date='',trade_date='20190517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190517_tscode_list = list() 
for ts_code_sh in daily_20190517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190517_tscode_list.append(stock_name)
daily_20190517_addname_dataframe=pd.DataFrame()
daily_20190517_addname_dataframe['cname'] = daily_20190517_tscode_list
for table_name in daily_20190517.columns.values.tolist():
    daily_20190517_addname_dataframe[table_name] = daily_20190517[table_name]
print("daily_20190517 返回数据 row 行数 = "+str(daily_20190517.shape[0]))
daily_20190517_addname_dataframe.to_excel(daily_201905_excel_writer,'17_5',index=False)
daily_201905_excel_writer.save()
daily_20190518 = pro.daily(start_date='',end_date='',trade_date='20190518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190518_tscode_list = list() 
for ts_code_sh in daily_20190518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190518_tscode_list.append(stock_name)
daily_20190518_addname_dataframe=pd.DataFrame()
daily_20190518_addname_dataframe['cname'] = daily_20190518_tscode_list
for table_name in daily_20190518.columns.values.tolist():
    daily_20190518_addname_dataframe[table_name] = daily_20190518[table_name]
print("daily_20190518 返回数据 row 行数 = "+str(daily_20190518.shape[0]))
daily_20190518_addname_dataframe.to_excel(daily_201905_excel_writer,'18_6',index=False)
daily_201905_excel_writer.save()
daily_20190519 = pro.daily(start_date='',end_date='',trade_date='20190519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190519_tscode_list = list() 
for ts_code_sh in daily_20190519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190519_tscode_list.append(stock_name)
daily_20190519_addname_dataframe=pd.DataFrame()
daily_20190519_addname_dataframe['cname'] = daily_20190519_tscode_list
for table_name in daily_20190519.columns.values.tolist():
    daily_20190519_addname_dataframe[table_name] = daily_20190519[table_name]
print("daily_20190519 返回数据 row 行数 = "+str(daily_20190519.shape[0]))
daily_20190519_addname_dataframe.to_excel(daily_201905_excel_writer,'19_7',index=False)
daily_201905_excel_writer.save()
daily_20190520 = pro.daily(start_date='',end_date='',trade_date='20190520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190520_tscode_list = list() 
for ts_code_sh in daily_20190520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190520_tscode_list.append(stock_name)
daily_20190520_addname_dataframe=pd.DataFrame()
daily_20190520_addname_dataframe['cname'] = daily_20190520_tscode_list
for table_name in daily_20190520.columns.values.tolist():
    daily_20190520_addname_dataframe[table_name] = daily_20190520[table_name]
print("daily_20190520 返回数据 row 行数 = "+str(daily_20190520.shape[0]))
daily_20190520_addname_dataframe.to_excel(daily_201905_excel_writer,'20_1',index=False)
daily_201905_excel_writer.save()
daily_20190521 = pro.daily(start_date='',end_date='',trade_date='20190521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190521_tscode_list = list() 
for ts_code_sh in daily_20190521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190521_tscode_list.append(stock_name)
daily_20190521_addname_dataframe=pd.DataFrame()
daily_20190521_addname_dataframe['cname'] = daily_20190521_tscode_list
for table_name in daily_20190521.columns.values.tolist():
    daily_20190521_addname_dataframe[table_name] = daily_20190521[table_name]
print("daily_20190521 返回数据 row 行数 = "+str(daily_20190521.shape[0]))
daily_20190521_addname_dataframe.to_excel(daily_201905_excel_writer,'21_2',index=False)
daily_201905_excel_writer.save()
daily_20190522 = pro.daily(start_date='',end_date='',trade_date='20190522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190522_tscode_list = list() 
for ts_code_sh in daily_20190522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190522_tscode_list.append(stock_name)
daily_20190522_addname_dataframe=pd.DataFrame()
daily_20190522_addname_dataframe['cname'] = daily_20190522_tscode_list
for table_name in daily_20190522.columns.values.tolist():
    daily_20190522_addname_dataframe[table_name] = daily_20190522[table_name]
print("daily_20190522 返回数据 row 行数 = "+str(daily_20190522.shape[0]))
daily_20190522_addname_dataframe.to_excel(daily_201905_excel_writer,'22_3',index=False)
daily_201905_excel_writer.save()
daily_20190523 = pro.daily(start_date='',end_date='',trade_date='20190523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190523_tscode_list = list() 
for ts_code_sh in daily_20190523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190523_tscode_list.append(stock_name)
daily_20190523_addname_dataframe=pd.DataFrame()
daily_20190523_addname_dataframe['cname'] = daily_20190523_tscode_list
for table_name in daily_20190523.columns.values.tolist():
    daily_20190523_addname_dataframe[table_name] = daily_20190523[table_name]
print("daily_20190523 返回数据 row 行数 = "+str(daily_20190523.shape[0]))
daily_20190523_addname_dataframe.to_excel(daily_201905_excel_writer,'23_4',index=False)
daily_201905_excel_writer.save()
daily_20190524 = pro.daily(start_date='',end_date='',trade_date='20190524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190524_tscode_list = list() 
for ts_code_sh in daily_20190524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190524_tscode_list.append(stock_name)
daily_20190524_addname_dataframe=pd.DataFrame()
daily_20190524_addname_dataframe['cname'] = daily_20190524_tscode_list
for table_name in daily_20190524.columns.values.tolist():
    daily_20190524_addname_dataframe[table_name] = daily_20190524[table_name]
print("daily_20190524 返回数据 row 行数 = "+str(daily_20190524.shape[0]))
daily_20190524_addname_dataframe.to_excel(daily_201905_excel_writer,'24_5',index=False)
daily_201905_excel_writer.save()
daily_20190525 = pro.daily(start_date='',end_date='',trade_date='20190525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190525_tscode_list = list() 
for ts_code_sh in daily_20190525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190525_tscode_list.append(stock_name)
daily_20190525_addname_dataframe=pd.DataFrame()
daily_20190525_addname_dataframe['cname'] = daily_20190525_tscode_list
for table_name in daily_20190525.columns.values.tolist():
    daily_20190525_addname_dataframe[table_name] = daily_20190525[table_name]
print("daily_20190525 返回数据 row 行数 = "+str(daily_20190525.shape[0]))
daily_20190525_addname_dataframe.to_excel(daily_201905_excel_writer,'25_6',index=False)
daily_201905_excel_writer.save()
daily_20190526 = pro.daily(start_date='',end_date='',trade_date='20190526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190526_tscode_list = list() 
for ts_code_sh in daily_20190526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190526_tscode_list.append(stock_name)
daily_20190526_addname_dataframe=pd.DataFrame()
daily_20190526_addname_dataframe['cname'] = daily_20190526_tscode_list
for table_name in daily_20190526.columns.values.tolist():
    daily_20190526_addname_dataframe[table_name] = daily_20190526[table_name]
print("daily_20190526 返回数据 row 行数 = "+str(daily_20190526.shape[0]))
daily_20190526_addname_dataframe.to_excel(daily_201905_excel_writer,'26_7',index=False)
daily_201905_excel_writer.save()
daily_20190527 = pro.daily(start_date='',end_date='',trade_date='20190527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190527_tscode_list = list() 
for ts_code_sh in daily_20190527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190527_tscode_list.append(stock_name)
daily_20190527_addname_dataframe=pd.DataFrame()
daily_20190527_addname_dataframe['cname'] = daily_20190527_tscode_list
for table_name in daily_20190527.columns.values.tolist():
    daily_20190527_addname_dataframe[table_name] = daily_20190527[table_name]
print("daily_20190527 返回数据 row 行数 = "+str(daily_20190527.shape[0]))
daily_20190527_addname_dataframe.to_excel(daily_201905_excel_writer,'27_1',index=False)
daily_201905_excel_writer.save()
daily_20190528 = pro.daily(start_date='',end_date='',trade_date='20190528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190528_tscode_list = list() 
for ts_code_sh in daily_20190528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190528_tscode_list.append(stock_name)
daily_20190528_addname_dataframe=pd.DataFrame()
daily_20190528_addname_dataframe['cname'] = daily_20190528_tscode_list
for table_name in daily_20190528.columns.values.tolist():
    daily_20190528_addname_dataframe[table_name] = daily_20190528[table_name]
print("daily_20190528 返回数据 row 行数 = "+str(daily_20190528.shape[0]))
daily_20190528_addname_dataframe.to_excel(daily_201905_excel_writer,'28_2',index=False)
daily_201905_excel_writer.save()
daily_20190529 = pro.daily(start_date='',end_date='',trade_date='20190529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190529_tscode_list = list() 
for ts_code_sh in daily_20190529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190529_tscode_list.append(stock_name)
daily_20190529_addname_dataframe=pd.DataFrame()
daily_20190529_addname_dataframe['cname'] = daily_20190529_tscode_list
for table_name in daily_20190529.columns.values.tolist():
    daily_20190529_addname_dataframe[table_name] = daily_20190529[table_name]
print("daily_20190529 返回数据 row 行数 = "+str(daily_20190529.shape[0]))
daily_20190529_addname_dataframe.to_excel(daily_201905_excel_writer,'29_3',index=False)
daily_201905_excel_writer.save()
daily_20190530 = pro.daily(start_date='',end_date='',trade_date='20190530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190530_tscode_list = list() 
for ts_code_sh in daily_20190530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190530_tscode_list.append(stock_name)
daily_20190530_addname_dataframe=pd.DataFrame()
daily_20190530_addname_dataframe['cname'] = daily_20190530_tscode_list
for table_name in daily_20190530.columns.values.tolist():
    daily_20190530_addname_dataframe[table_name] = daily_20190530[table_name]
print("daily_20190530 返回数据 row 行数 = "+str(daily_20190530.shape[0]))
daily_20190530_addname_dataframe.to_excel(daily_201905_excel_writer,'30_4',index=False)
daily_201905_excel_writer.save()
daily_20190531 = pro.daily(start_date='',end_date='',trade_date='20190531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190531_tscode_list = list() 
for ts_code_sh in daily_20190531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190531_tscode_list.append(stock_name)
daily_20190531_addname_dataframe=pd.DataFrame()
daily_20190531_addname_dataframe['cname'] = daily_20190531_tscode_list
for table_name in daily_20190531.columns.values.tolist():
    daily_20190531_addname_dataframe[table_name] = daily_20190531[table_name]
print("daily_20190531 返回数据 row 行数 = "+str(daily_20190531.shape[0]))
daily_20190531_addname_dataframe.to_excel(daily_201905_excel_writer,'31_5',index=False)
daily_201905_excel_writer.save()




createexcel('daily_201906.xlsx')
daily_201906_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201906.xlsx')
daily_201906_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201906.xlsx', engine='openpyxl')
daily_201906_excel_writer.book = daily_201906_book
daily_201906_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201906_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190601")       ###  更新 记录日期
daily_20190601 = pro.daily(start_date='',end_date='',trade_date='20190601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190601_tscode_list = list() 
for ts_code_sh in daily_20190601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190601_tscode_list.append(stock_name)
daily_20190601_addname_dataframe=pd.DataFrame()
daily_20190601_addname_dataframe['cname'] = daily_20190601_tscode_list
for table_name in daily_20190601.columns.values.tolist():
    daily_20190601_addname_dataframe[table_name] = daily_20190601[table_name]
print("daily_20190601 返回数据 row 行数 = "+str(daily_20190601.shape[0]))
daily_20190601_addname_dataframe.to_excel(daily_201906_excel_writer,'1_6',index=False)
daily_201906_excel_writer.save()
daily_20190602 = pro.daily(start_date='',end_date='',trade_date='20190602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190602_tscode_list = list() 
for ts_code_sh in daily_20190602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190602_tscode_list.append(stock_name)
daily_20190602_addname_dataframe=pd.DataFrame()
daily_20190602_addname_dataframe['cname'] = daily_20190602_tscode_list
for table_name in daily_20190602.columns.values.tolist():
    daily_20190602_addname_dataframe[table_name] = daily_20190602[table_name]
print("daily_20190602 返回数据 row 行数 = "+str(daily_20190602.shape[0]))
daily_20190602_addname_dataframe.to_excel(daily_201906_excel_writer,'2_7',index=False)
daily_201906_excel_writer.save()
daily_20190603 = pro.daily(start_date='',end_date='',trade_date='20190603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190603_tscode_list = list() 
for ts_code_sh in daily_20190603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190603_tscode_list.append(stock_name)
daily_20190603_addname_dataframe=pd.DataFrame()
daily_20190603_addname_dataframe['cname'] = daily_20190603_tscode_list
for table_name in daily_20190603.columns.values.tolist():
    daily_20190603_addname_dataframe[table_name] = daily_20190603[table_name]
print("daily_20190603 返回数据 row 行数 = "+str(daily_20190603.shape[0]))
daily_20190603_addname_dataframe.to_excel(daily_201906_excel_writer,'3_1',index=False)
daily_201906_excel_writer.save()
daily_20190604 = pro.daily(start_date='',end_date='',trade_date='20190604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190604_tscode_list = list() 
for ts_code_sh in daily_20190604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190604_tscode_list.append(stock_name)
daily_20190604_addname_dataframe=pd.DataFrame()
daily_20190604_addname_dataframe['cname'] = daily_20190604_tscode_list
for table_name in daily_20190604.columns.values.tolist():
    daily_20190604_addname_dataframe[table_name] = daily_20190604[table_name]
print("daily_20190604 返回数据 row 行数 = "+str(daily_20190604.shape[0]))
daily_20190604_addname_dataframe.to_excel(daily_201906_excel_writer,'4_2',index=False)
daily_201906_excel_writer.save()
daily_20190605 = pro.daily(start_date='',end_date='',trade_date='20190605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190605_tscode_list = list() 
for ts_code_sh in daily_20190605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190605_tscode_list.append(stock_name)
daily_20190605_addname_dataframe=pd.DataFrame()
daily_20190605_addname_dataframe['cname'] = daily_20190605_tscode_list
for table_name in daily_20190605.columns.values.tolist():
    daily_20190605_addname_dataframe[table_name] = daily_20190605[table_name]
print("daily_20190605 返回数据 row 行数 = "+str(daily_20190605.shape[0]))
daily_20190605_addname_dataframe.to_excel(daily_201906_excel_writer,'5_3',index=False)
daily_201906_excel_writer.save()
daily_20190606 = pro.daily(start_date='',end_date='',trade_date='20190606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190606_tscode_list = list() 
for ts_code_sh in daily_20190606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190606_tscode_list.append(stock_name)
daily_20190606_addname_dataframe=pd.DataFrame()
daily_20190606_addname_dataframe['cname'] = daily_20190606_tscode_list
for table_name in daily_20190606.columns.values.tolist():
    daily_20190606_addname_dataframe[table_name] = daily_20190606[table_name]
print("daily_20190606 返回数据 row 行数 = "+str(daily_20190606.shape[0]))
daily_20190606_addname_dataframe.to_excel(daily_201906_excel_writer,'6_4',index=False)
daily_201906_excel_writer.save()
daily_20190607 = pro.daily(start_date='',end_date='',trade_date='20190607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190607_tscode_list = list() 
for ts_code_sh in daily_20190607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190607_tscode_list.append(stock_name)
daily_20190607_addname_dataframe=pd.DataFrame()
daily_20190607_addname_dataframe['cname'] = daily_20190607_tscode_list
for table_name in daily_20190607.columns.values.tolist():
    daily_20190607_addname_dataframe[table_name] = daily_20190607[table_name]
print("daily_20190607 返回数据 row 行数 = "+str(daily_20190607.shape[0]))
daily_20190607_addname_dataframe.to_excel(daily_201906_excel_writer,'7_5',index=False)
daily_201906_excel_writer.save()
daily_20190608 = pro.daily(start_date='',end_date='',trade_date='20190608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190608_tscode_list = list() 
for ts_code_sh in daily_20190608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190608_tscode_list.append(stock_name)
daily_20190608_addname_dataframe=pd.DataFrame()
daily_20190608_addname_dataframe['cname'] = daily_20190608_tscode_list
for table_name in daily_20190608.columns.values.tolist():
    daily_20190608_addname_dataframe[table_name] = daily_20190608[table_name]
print("daily_20190608 返回数据 row 行数 = "+str(daily_20190608.shape[0]))
daily_20190608_addname_dataframe.to_excel(daily_201906_excel_writer,'8_6',index=False)
daily_201906_excel_writer.save()
daily_20190609 = pro.daily(start_date='',end_date='',trade_date='20190609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190609_tscode_list = list() 
for ts_code_sh in daily_20190609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190609_tscode_list.append(stock_name)
daily_20190609_addname_dataframe=pd.DataFrame()
daily_20190609_addname_dataframe['cname'] = daily_20190609_tscode_list
for table_name in daily_20190609.columns.values.tolist():
    daily_20190609_addname_dataframe[table_name] = daily_20190609[table_name]
print("daily_20190609 返回数据 row 行数 = "+str(daily_20190609.shape[0]))
daily_20190609_addname_dataframe.to_excel(daily_201906_excel_writer,'9_7',index=False)
daily_201906_excel_writer.save()
daily_20190610 = pro.daily(start_date='',end_date='',trade_date='20190610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190610_tscode_list = list() 
for ts_code_sh in daily_20190610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190610_tscode_list.append(stock_name)
daily_20190610_addname_dataframe=pd.DataFrame()
daily_20190610_addname_dataframe['cname'] = daily_20190610_tscode_list
for table_name in daily_20190610.columns.values.tolist():
    daily_20190610_addname_dataframe[table_name] = daily_20190610[table_name]
print("daily_20190610 返回数据 row 行数 = "+str(daily_20190610.shape[0]))
daily_20190610_addname_dataframe.to_excel(daily_201906_excel_writer,'10_1',index=False)
daily_201906_excel_writer.save()
daily_20190611 = pro.daily(start_date='',end_date='',trade_date='20190611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190611_tscode_list = list() 
for ts_code_sh in daily_20190611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190611_tscode_list.append(stock_name)
daily_20190611_addname_dataframe=pd.DataFrame()
daily_20190611_addname_dataframe['cname'] = daily_20190611_tscode_list
for table_name in daily_20190611.columns.values.tolist():
    daily_20190611_addname_dataframe[table_name] = daily_20190611[table_name]
print("daily_20190611 返回数据 row 行数 = "+str(daily_20190611.shape[0]))
daily_20190611_addname_dataframe.to_excel(daily_201906_excel_writer,'11_2',index=False)
daily_201906_excel_writer.save()
daily_20190612 = pro.daily(start_date='',end_date='',trade_date='20190612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190612_tscode_list = list() 
for ts_code_sh in daily_20190612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190612_tscode_list.append(stock_name)
daily_20190612_addname_dataframe=pd.DataFrame()
daily_20190612_addname_dataframe['cname'] = daily_20190612_tscode_list
for table_name in daily_20190612.columns.values.tolist():
    daily_20190612_addname_dataframe[table_name] = daily_20190612[table_name]
print("daily_20190612 返回数据 row 行数 = "+str(daily_20190612.shape[0]))
daily_20190612_addname_dataframe.to_excel(daily_201906_excel_writer,'12_3',index=False)
daily_201906_excel_writer.save()
daily_20190613 = pro.daily(start_date='',end_date='',trade_date='20190613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190613_tscode_list = list() 
for ts_code_sh in daily_20190613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190613_tscode_list.append(stock_name)
daily_20190613_addname_dataframe=pd.DataFrame()
daily_20190613_addname_dataframe['cname'] = daily_20190613_tscode_list
for table_name in daily_20190613.columns.values.tolist():
    daily_20190613_addname_dataframe[table_name] = daily_20190613[table_name]
print("daily_20190613 返回数据 row 行数 = "+str(daily_20190613.shape[0]))
daily_20190613_addname_dataframe.to_excel(daily_201906_excel_writer,'13_4',index=False)
daily_201906_excel_writer.save()
daily_20190614 = pro.daily(start_date='',end_date='',trade_date='20190614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190614_tscode_list = list() 
for ts_code_sh in daily_20190614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190614_tscode_list.append(stock_name)
daily_20190614_addname_dataframe=pd.DataFrame()
daily_20190614_addname_dataframe['cname'] = daily_20190614_tscode_list
for table_name in daily_20190614.columns.values.tolist():
    daily_20190614_addname_dataframe[table_name] = daily_20190614[table_name]
print("daily_20190614 返回数据 row 行数 = "+str(daily_20190614.shape[0]))
daily_20190614_addname_dataframe.to_excel(daily_201906_excel_writer,'14_5',index=False)
daily_201906_excel_writer.save()
daily_20190615 = pro.daily(start_date='',end_date='',trade_date='20190615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190615_tscode_list = list() 
for ts_code_sh in daily_20190615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190615_tscode_list.append(stock_name)
daily_20190615_addname_dataframe=pd.DataFrame()
daily_20190615_addname_dataframe['cname'] = daily_20190615_tscode_list
for table_name in daily_20190615.columns.values.tolist():
    daily_20190615_addname_dataframe[table_name] = daily_20190615[table_name]
print("daily_20190615 返回数据 row 行数 = "+str(daily_20190615.shape[0]))
daily_20190615_addname_dataframe.to_excel(daily_201906_excel_writer,'15_6',index=False)
daily_201906_excel_writer.save()
daily_20190616 = pro.daily(start_date='',end_date='',trade_date='20190616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190616_tscode_list = list() 
for ts_code_sh in daily_20190616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190616_tscode_list.append(stock_name)
daily_20190616_addname_dataframe=pd.DataFrame()
daily_20190616_addname_dataframe['cname'] = daily_20190616_tscode_list
for table_name in daily_20190616.columns.values.tolist():
    daily_20190616_addname_dataframe[table_name] = daily_20190616[table_name]
print("daily_20190616 返回数据 row 行数 = "+str(daily_20190616.shape[0]))
daily_20190616_addname_dataframe.to_excel(daily_201906_excel_writer,'16_7',index=False)
daily_201906_excel_writer.save()
daily_20190617 = pro.daily(start_date='',end_date='',trade_date='20190617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190617_tscode_list = list() 
for ts_code_sh in daily_20190617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190617_tscode_list.append(stock_name)
daily_20190617_addname_dataframe=pd.DataFrame()
daily_20190617_addname_dataframe['cname'] = daily_20190617_tscode_list
for table_name in daily_20190617.columns.values.tolist():
    daily_20190617_addname_dataframe[table_name] = daily_20190617[table_name]
print("daily_20190617 返回数据 row 行数 = "+str(daily_20190617.shape[0]))
daily_20190617_addname_dataframe.to_excel(daily_201906_excel_writer,'17_1',index=False)
daily_201906_excel_writer.save()
daily_20190618 = pro.daily(start_date='',end_date='',trade_date='20190618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190618_tscode_list = list() 
for ts_code_sh in daily_20190618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190618_tscode_list.append(stock_name)
daily_20190618_addname_dataframe=pd.DataFrame()
daily_20190618_addname_dataframe['cname'] = daily_20190618_tscode_list
for table_name in daily_20190618.columns.values.tolist():
    daily_20190618_addname_dataframe[table_name] = daily_20190618[table_name]
print("daily_20190618 返回数据 row 行数 = "+str(daily_20190618.shape[0]))
daily_20190618_addname_dataframe.to_excel(daily_201906_excel_writer,'18_2',index=False)
daily_201906_excel_writer.save()
daily_20190619 = pro.daily(start_date='',end_date='',trade_date='20190619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190619_tscode_list = list() 
for ts_code_sh in daily_20190619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190619_tscode_list.append(stock_name)
daily_20190619_addname_dataframe=pd.DataFrame()
daily_20190619_addname_dataframe['cname'] = daily_20190619_tscode_list
for table_name in daily_20190619.columns.values.tolist():
    daily_20190619_addname_dataframe[table_name] = daily_20190619[table_name]
print("daily_20190619 返回数据 row 行数 = "+str(daily_20190619.shape[0]))
daily_20190619_addname_dataframe.to_excel(daily_201906_excel_writer,'19_3',index=False)
daily_201906_excel_writer.save()
daily_20190620 = pro.daily(start_date='',end_date='',trade_date='20190620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190620_tscode_list = list() 
for ts_code_sh in daily_20190620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190620_tscode_list.append(stock_name)
daily_20190620_addname_dataframe=pd.DataFrame()
daily_20190620_addname_dataframe['cname'] = daily_20190620_tscode_list
for table_name in daily_20190620.columns.values.tolist():
    daily_20190620_addname_dataframe[table_name] = daily_20190620[table_name]
print("daily_20190620 返回数据 row 行数 = "+str(daily_20190620.shape[0]))
daily_20190620_addname_dataframe.to_excel(daily_201906_excel_writer,'20_4',index=False)
daily_201906_excel_writer.save()
daily_20190621 = pro.daily(start_date='',end_date='',trade_date='20190621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190621_tscode_list = list() 
for ts_code_sh in daily_20190621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190621_tscode_list.append(stock_name)
daily_20190621_addname_dataframe=pd.DataFrame()
daily_20190621_addname_dataframe['cname'] = daily_20190621_tscode_list
for table_name in daily_20190621.columns.values.tolist():
    daily_20190621_addname_dataframe[table_name] = daily_20190621[table_name]
print("daily_20190621 返回数据 row 行数 = "+str(daily_20190621.shape[0]))
daily_20190621_addname_dataframe.to_excel(daily_201906_excel_writer,'21_5',index=False)
daily_201906_excel_writer.save()
daily_20190622 = pro.daily(start_date='',end_date='',trade_date='20190622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190622_tscode_list = list() 
for ts_code_sh in daily_20190622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190622_tscode_list.append(stock_name)
daily_20190622_addname_dataframe=pd.DataFrame()
daily_20190622_addname_dataframe['cname'] = daily_20190622_tscode_list
for table_name in daily_20190622.columns.values.tolist():
    daily_20190622_addname_dataframe[table_name] = daily_20190622[table_name]
print("daily_20190622 返回数据 row 行数 = "+str(daily_20190622.shape[0]))
daily_20190622_addname_dataframe.to_excel(daily_201906_excel_writer,'22_6',index=False)
daily_201906_excel_writer.save()
daily_20190623 = pro.daily(start_date='',end_date='',trade_date='20190623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190623_tscode_list = list() 
for ts_code_sh in daily_20190623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190623_tscode_list.append(stock_name)
daily_20190623_addname_dataframe=pd.DataFrame()
daily_20190623_addname_dataframe['cname'] = daily_20190623_tscode_list
for table_name in daily_20190623.columns.values.tolist():
    daily_20190623_addname_dataframe[table_name] = daily_20190623[table_name]
print("daily_20190623 返回数据 row 行数 = "+str(daily_20190623.shape[0]))
daily_20190623_addname_dataframe.to_excel(daily_201906_excel_writer,'23_7',index=False)
daily_201906_excel_writer.save()
daily_20190624 = pro.daily(start_date='',end_date='',trade_date='20190624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190624_tscode_list = list() 
for ts_code_sh in daily_20190624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190624_tscode_list.append(stock_name)
daily_20190624_addname_dataframe=pd.DataFrame()
daily_20190624_addname_dataframe['cname'] = daily_20190624_tscode_list
for table_name in daily_20190624.columns.values.tolist():
    daily_20190624_addname_dataframe[table_name] = daily_20190624[table_name]
print("daily_20190624 返回数据 row 行数 = "+str(daily_20190624.shape[0]))
daily_20190624_addname_dataframe.to_excel(daily_201906_excel_writer,'24_1',index=False)
daily_201906_excel_writer.save()
daily_20190625 = pro.daily(start_date='',end_date='',trade_date='20190625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190625_tscode_list = list() 
for ts_code_sh in daily_20190625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190625_tscode_list.append(stock_name)
daily_20190625_addname_dataframe=pd.DataFrame()
daily_20190625_addname_dataframe['cname'] = daily_20190625_tscode_list
for table_name in daily_20190625.columns.values.tolist():
    daily_20190625_addname_dataframe[table_name] = daily_20190625[table_name]
print("daily_20190625 返回数据 row 行数 = "+str(daily_20190625.shape[0]))
daily_20190625_addname_dataframe.to_excel(daily_201906_excel_writer,'25_2',index=False)
daily_201906_excel_writer.save()
daily_20190626 = pro.daily(start_date='',end_date='',trade_date='20190626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190626_tscode_list = list() 
for ts_code_sh in daily_20190626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190626_tscode_list.append(stock_name)
daily_20190626_addname_dataframe=pd.DataFrame()
daily_20190626_addname_dataframe['cname'] = daily_20190626_tscode_list
for table_name in daily_20190626.columns.values.tolist():
    daily_20190626_addname_dataframe[table_name] = daily_20190626[table_name]
print("daily_20190626 返回数据 row 行数 = "+str(daily_20190626.shape[0]))
daily_20190626_addname_dataframe.to_excel(daily_201906_excel_writer,'26_3',index=False)
daily_201906_excel_writer.save()
daily_20190627 = pro.daily(start_date='',end_date='',trade_date='20190627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190627_tscode_list = list() 
for ts_code_sh in daily_20190627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190627_tscode_list.append(stock_name)
daily_20190627_addname_dataframe=pd.DataFrame()
daily_20190627_addname_dataframe['cname'] = daily_20190627_tscode_list
for table_name in daily_20190627.columns.values.tolist():
    daily_20190627_addname_dataframe[table_name] = daily_20190627[table_name]
print("daily_20190627 返回数据 row 行数 = "+str(daily_20190627.shape[0]))
daily_20190627_addname_dataframe.to_excel(daily_201906_excel_writer,'27_4',index=False)
daily_201906_excel_writer.save()
daily_20190628 = pro.daily(start_date='',end_date='',trade_date='20190628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190628_tscode_list = list() 
for ts_code_sh in daily_20190628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190628_tscode_list.append(stock_name)
daily_20190628_addname_dataframe=pd.DataFrame()
daily_20190628_addname_dataframe['cname'] = daily_20190628_tscode_list
for table_name in daily_20190628.columns.values.tolist():
    daily_20190628_addname_dataframe[table_name] = daily_20190628[table_name]
print("daily_20190628 返回数据 row 行数 = "+str(daily_20190628.shape[0]))
daily_20190628_addname_dataframe.to_excel(daily_201906_excel_writer,'28_5',index=False)
daily_201906_excel_writer.save()
daily_20190629 = pro.daily(start_date='',end_date='',trade_date='20190629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190629_tscode_list = list() 
for ts_code_sh in daily_20190629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190629_tscode_list.append(stock_name)
daily_20190629_addname_dataframe=pd.DataFrame()
daily_20190629_addname_dataframe['cname'] = daily_20190629_tscode_list
for table_name in daily_20190629.columns.values.tolist():
    daily_20190629_addname_dataframe[table_name] = daily_20190629[table_name]
print("daily_20190629 返回数据 row 行数 = "+str(daily_20190629.shape[0]))
daily_20190629_addname_dataframe.to_excel(daily_201906_excel_writer,'29_6',index=False)
daily_201906_excel_writer.save()
daily_20190630 = pro.daily(start_date='',end_date='',trade_date='20190630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190630_tscode_list = list() 
for ts_code_sh in daily_20190630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190630_tscode_list.append(stock_name)
daily_20190630_addname_dataframe=pd.DataFrame()
daily_20190630_addname_dataframe['cname'] = daily_20190630_tscode_list
for table_name in daily_20190630.columns.values.tolist():
    daily_20190630_addname_dataframe[table_name] = daily_20190630[table_name]
print("daily_20190630 返回数据 row 行数 = "+str(daily_20190630.shape[0]))
daily_20190630_addname_dataframe.to_excel(daily_201906_excel_writer,'30_7',index=False)
daily_201906_excel_writer.save()




createexcel('daily_201907.xlsx')
daily_201907_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201907.xlsx')
daily_201907_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201907.xlsx', engine='openpyxl')
daily_201907_excel_writer.book = daily_201907_book
daily_201907_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201907_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190701")       ###  更新 记录日期
daily_20190701 = pro.daily(start_date='',end_date='',trade_date='20190701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190701_tscode_list = list() 
for ts_code_sh in daily_20190701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190701_tscode_list.append(stock_name)
daily_20190701_addname_dataframe=pd.DataFrame()
daily_20190701_addname_dataframe['cname'] = daily_20190701_tscode_list
for table_name in daily_20190701.columns.values.tolist():
    daily_20190701_addname_dataframe[table_name] = daily_20190701[table_name]
print("daily_20190701 返回数据 row 行数 = "+str(daily_20190701.shape[0]))
daily_20190701_addname_dataframe.to_excel(daily_201907_excel_writer,'1_1',index=False)
daily_201907_excel_writer.save()
daily_20190702 = pro.daily(start_date='',end_date='',trade_date='20190702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190702_tscode_list = list() 
for ts_code_sh in daily_20190702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190702_tscode_list.append(stock_name)
daily_20190702_addname_dataframe=pd.DataFrame()
daily_20190702_addname_dataframe['cname'] = daily_20190702_tscode_list
for table_name in daily_20190702.columns.values.tolist():
    daily_20190702_addname_dataframe[table_name] = daily_20190702[table_name]
print("daily_20190702 返回数据 row 行数 = "+str(daily_20190702.shape[0]))
daily_20190702_addname_dataframe.to_excel(daily_201907_excel_writer,'2_2',index=False)
daily_201907_excel_writer.save()
daily_20190703 = pro.daily(start_date='',end_date='',trade_date='20190703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190703_tscode_list = list() 
for ts_code_sh in daily_20190703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190703_tscode_list.append(stock_name)
daily_20190703_addname_dataframe=pd.DataFrame()
daily_20190703_addname_dataframe['cname'] = daily_20190703_tscode_list
for table_name in daily_20190703.columns.values.tolist():
    daily_20190703_addname_dataframe[table_name] = daily_20190703[table_name]
print("daily_20190703 返回数据 row 行数 = "+str(daily_20190703.shape[0]))
daily_20190703_addname_dataframe.to_excel(daily_201907_excel_writer,'3_3',index=False)
daily_201907_excel_writer.save()
daily_20190704 = pro.daily(start_date='',end_date='',trade_date='20190704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190704_tscode_list = list() 
for ts_code_sh in daily_20190704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190704_tscode_list.append(stock_name)
daily_20190704_addname_dataframe=pd.DataFrame()
daily_20190704_addname_dataframe['cname'] = daily_20190704_tscode_list
for table_name in daily_20190704.columns.values.tolist():
    daily_20190704_addname_dataframe[table_name] = daily_20190704[table_name]
print("daily_20190704 返回数据 row 行数 = "+str(daily_20190704.shape[0]))
daily_20190704_addname_dataframe.to_excel(daily_201907_excel_writer,'4_4',index=False)
daily_201907_excel_writer.save()
daily_20190705 = pro.daily(start_date='',end_date='',trade_date='20190705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190705_tscode_list = list() 
for ts_code_sh in daily_20190705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190705_tscode_list.append(stock_name)
daily_20190705_addname_dataframe=pd.DataFrame()
daily_20190705_addname_dataframe['cname'] = daily_20190705_tscode_list
for table_name in daily_20190705.columns.values.tolist():
    daily_20190705_addname_dataframe[table_name] = daily_20190705[table_name]
print("daily_20190705 返回数据 row 行数 = "+str(daily_20190705.shape[0]))
daily_20190705_addname_dataframe.to_excel(daily_201907_excel_writer,'5_5',index=False)
daily_201907_excel_writer.save()
daily_20190706 = pro.daily(start_date='',end_date='',trade_date='20190706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190706_tscode_list = list() 
for ts_code_sh in daily_20190706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190706_tscode_list.append(stock_name)
daily_20190706_addname_dataframe=pd.DataFrame()
daily_20190706_addname_dataframe['cname'] = daily_20190706_tscode_list
for table_name in daily_20190706.columns.values.tolist():
    daily_20190706_addname_dataframe[table_name] = daily_20190706[table_name]
print("daily_20190706 返回数据 row 行数 = "+str(daily_20190706.shape[0]))
daily_20190706_addname_dataframe.to_excel(daily_201907_excel_writer,'6_6',index=False)
daily_201907_excel_writer.save()
daily_20190707 = pro.daily(start_date='',end_date='',trade_date='20190707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190707_tscode_list = list() 
for ts_code_sh in daily_20190707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190707_tscode_list.append(stock_name)
daily_20190707_addname_dataframe=pd.DataFrame()
daily_20190707_addname_dataframe['cname'] = daily_20190707_tscode_list
for table_name in daily_20190707.columns.values.tolist():
    daily_20190707_addname_dataframe[table_name] = daily_20190707[table_name]
print("daily_20190707 返回数据 row 行数 = "+str(daily_20190707.shape[0]))
daily_20190707_addname_dataframe.to_excel(daily_201907_excel_writer,'7_7',index=False)
daily_201907_excel_writer.save()
daily_20190708 = pro.daily(start_date='',end_date='',trade_date='20190708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190708_tscode_list = list() 
for ts_code_sh in daily_20190708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190708_tscode_list.append(stock_name)
daily_20190708_addname_dataframe=pd.DataFrame()
daily_20190708_addname_dataframe['cname'] = daily_20190708_tscode_list
for table_name in daily_20190708.columns.values.tolist():
    daily_20190708_addname_dataframe[table_name] = daily_20190708[table_name]
print("daily_20190708 返回数据 row 行数 = "+str(daily_20190708.shape[0]))
daily_20190708_addname_dataframe.to_excel(daily_201907_excel_writer,'8_1',index=False)
daily_201907_excel_writer.save()
daily_20190709 = pro.daily(start_date='',end_date='',trade_date='20190709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190709_tscode_list = list() 
for ts_code_sh in daily_20190709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190709_tscode_list.append(stock_name)
daily_20190709_addname_dataframe=pd.DataFrame()
daily_20190709_addname_dataframe['cname'] = daily_20190709_tscode_list
for table_name in daily_20190709.columns.values.tolist():
    daily_20190709_addname_dataframe[table_name] = daily_20190709[table_name]
print("daily_20190709 返回数据 row 行数 = "+str(daily_20190709.shape[0]))
daily_20190709_addname_dataframe.to_excel(daily_201907_excel_writer,'9_2',index=False)
daily_201907_excel_writer.save()
daily_20190710 = pro.daily(start_date='',end_date='',trade_date='20190710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190710_tscode_list = list() 
for ts_code_sh in daily_20190710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190710_tscode_list.append(stock_name)
daily_20190710_addname_dataframe=pd.DataFrame()
daily_20190710_addname_dataframe['cname'] = daily_20190710_tscode_list
for table_name in daily_20190710.columns.values.tolist():
    daily_20190710_addname_dataframe[table_name] = daily_20190710[table_name]
print("daily_20190710 返回数据 row 行数 = "+str(daily_20190710.shape[0]))
daily_20190710_addname_dataframe.to_excel(daily_201907_excel_writer,'10_3',index=False)
daily_201907_excel_writer.save()
daily_20190711 = pro.daily(start_date='',end_date='',trade_date='20190711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190711_tscode_list = list() 
for ts_code_sh in daily_20190711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190711_tscode_list.append(stock_name)
daily_20190711_addname_dataframe=pd.DataFrame()
daily_20190711_addname_dataframe['cname'] = daily_20190711_tscode_list
for table_name in daily_20190711.columns.values.tolist():
    daily_20190711_addname_dataframe[table_name] = daily_20190711[table_name]
print("daily_20190711 返回数据 row 行数 = "+str(daily_20190711.shape[0]))
daily_20190711_addname_dataframe.to_excel(daily_201907_excel_writer,'11_4',index=False)
daily_201907_excel_writer.save()
daily_20190712 = pro.daily(start_date='',end_date='',trade_date='20190712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190712_tscode_list = list() 
for ts_code_sh in daily_20190712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190712_tscode_list.append(stock_name)
daily_20190712_addname_dataframe=pd.DataFrame()
daily_20190712_addname_dataframe['cname'] = daily_20190712_tscode_list
for table_name in daily_20190712.columns.values.tolist():
    daily_20190712_addname_dataframe[table_name] = daily_20190712[table_name]
print("daily_20190712 返回数据 row 行数 = "+str(daily_20190712.shape[0]))
daily_20190712_addname_dataframe.to_excel(daily_201907_excel_writer,'12_5',index=False)
daily_201907_excel_writer.save()
daily_20190713 = pro.daily(start_date='',end_date='',trade_date='20190713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190713_tscode_list = list() 
for ts_code_sh in daily_20190713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190713_tscode_list.append(stock_name)
daily_20190713_addname_dataframe=pd.DataFrame()
daily_20190713_addname_dataframe['cname'] = daily_20190713_tscode_list
for table_name in daily_20190713.columns.values.tolist():
    daily_20190713_addname_dataframe[table_name] = daily_20190713[table_name]
print("daily_20190713 返回数据 row 行数 = "+str(daily_20190713.shape[0]))
daily_20190713_addname_dataframe.to_excel(daily_201907_excel_writer,'13_6',index=False)
daily_201907_excel_writer.save()
daily_20190714 = pro.daily(start_date='',end_date='',trade_date='20190714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190714_tscode_list = list() 
for ts_code_sh in daily_20190714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190714_tscode_list.append(stock_name)
daily_20190714_addname_dataframe=pd.DataFrame()
daily_20190714_addname_dataframe['cname'] = daily_20190714_tscode_list
for table_name in daily_20190714.columns.values.tolist():
    daily_20190714_addname_dataframe[table_name] = daily_20190714[table_name]
print("daily_20190714 返回数据 row 行数 = "+str(daily_20190714.shape[0]))
daily_20190714_addname_dataframe.to_excel(daily_201907_excel_writer,'14_7',index=False)
daily_201907_excel_writer.save()
daily_20190715 = pro.daily(start_date='',end_date='',trade_date='20190715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190715_tscode_list = list() 
for ts_code_sh in daily_20190715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190715_tscode_list.append(stock_name)
daily_20190715_addname_dataframe=pd.DataFrame()
daily_20190715_addname_dataframe['cname'] = daily_20190715_tscode_list
for table_name in daily_20190715.columns.values.tolist():
    daily_20190715_addname_dataframe[table_name] = daily_20190715[table_name]
print("daily_20190715 返回数据 row 行数 = "+str(daily_20190715.shape[0]))
daily_20190715_addname_dataframe.to_excel(daily_201907_excel_writer,'15_1',index=False)
daily_201907_excel_writer.save()
daily_20190716 = pro.daily(start_date='',end_date='',trade_date='20190716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190716_tscode_list = list() 
for ts_code_sh in daily_20190716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190716_tscode_list.append(stock_name)
daily_20190716_addname_dataframe=pd.DataFrame()
daily_20190716_addname_dataframe['cname'] = daily_20190716_tscode_list
for table_name in daily_20190716.columns.values.tolist():
    daily_20190716_addname_dataframe[table_name] = daily_20190716[table_name]
print("daily_20190716 返回数据 row 行数 = "+str(daily_20190716.shape[0]))
daily_20190716_addname_dataframe.to_excel(daily_201907_excel_writer,'16_2',index=False)
daily_201907_excel_writer.save()
daily_20190717 = pro.daily(start_date='',end_date='',trade_date='20190717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190717_tscode_list = list() 
for ts_code_sh in daily_20190717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190717_tscode_list.append(stock_name)
daily_20190717_addname_dataframe=pd.DataFrame()
daily_20190717_addname_dataframe['cname'] = daily_20190717_tscode_list
for table_name in daily_20190717.columns.values.tolist():
    daily_20190717_addname_dataframe[table_name] = daily_20190717[table_name]
print("daily_20190717 返回数据 row 行数 = "+str(daily_20190717.shape[0]))
daily_20190717_addname_dataframe.to_excel(daily_201907_excel_writer,'17_3',index=False)
daily_201907_excel_writer.save()
daily_20190718 = pro.daily(start_date='',end_date='',trade_date='20190718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190718_tscode_list = list() 
for ts_code_sh in daily_20190718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190718_tscode_list.append(stock_name)
daily_20190718_addname_dataframe=pd.DataFrame()
daily_20190718_addname_dataframe['cname'] = daily_20190718_tscode_list
for table_name in daily_20190718.columns.values.tolist():
    daily_20190718_addname_dataframe[table_name] = daily_20190718[table_name]
print("daily_20190718 返回数据 row 行数 = "+str(daily_20190718.shape[0]))
daily_20190718_addname_dataframe.to_excel(daily_201907_excel_writer,'18_4',index=False)
daily_201907_excel_writer.save()
daily_20190719 = pro.daily(start_date='',end_date='',trade_date='20190719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190719_tscode_list = list() 
for ts_code_sh in daily_20190719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190719_tscode_list.append(stock_name)
daily_20190719_addname_dataframe=pd.DataFrame()
daily_20190719_addname_dataframe['cname'] = daily_20190719_tscode_list
for table_name in daily_20190719.columns.values.tolist():
    daily_20190719_addname_dataframe[table_name] = daily_20190719[table_name]
print("daily_20190719 返回数据 row 行数 = "+str(daily_20190719.shape[0]))
daily_20190719_addname_dataframe.to_excel(daily_201907_excel_writer,'19_5',index=False)
daily_201907_excel_writer.save()
daily_20190720 = pro.daily(start_date='',end_date='',trade_date='20190720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190720_tscode_list = list() 
for ts_code_sh in daily_20190720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190720_tscode_list.append(stock_name)
daily_20190720_addname_dataframe=pd.DataFrame()
daily_20190720_addname_dataframe['cname'] = daily_20190720_tscode_list
for table_name in daily_20190720.columns.values.tolist():
    daily_20190720_addname_dataframe[table_name] = daily_20190720[table_name]
print("daily_20190720 返回数据 row 行数 = "+str(daily_20190720.shape[0]))
daily_20190720_addname_dataframe.to_excel(daily_201907_excel_writer,'20_6',index=False)
daily_201907_excel_writer.save()
daily_20190721 = pro.daily(start_date='',end_date='',trade_date='20190721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190721_tscode_list = list() 
for ts_code_sh in daily_20190721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190721_tscode_list.append(stock_name)
daily_20190721_addname_dataframe=pd.DataFrame()
daily_20190721_addname_dataframe['cname'] = daily_20190721_tscode_list
for table_name in daily_20190721.columns.values.tolist():
    daily_20190721_addname_dataframe[table_name] = daily_20190721[table_name]
print("daily_20190721 返回数据 row 行数 = "+str(daily_20190721.shape[0]))
daily_20190721_addname_dataframe.to_excel(daily_201907_excel_writer,'21_7',index=False)
daily_201907_excel_writer.save()
daily_20190722 = pro.daily(start_date='',end_date='',trade_date='20190722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190722_tscode_list = list() 
for ts_code_sh in daily_20190722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190722_tscode_list.append(stock_name)
daily_20190722_addname_dataframe=pd.DataFrame()
daily_20190722_addname_dataframe['cname'] = daily_20190722_tscode_list
for table_name in daily_20190722.columns.values.tolist():
    daily_20190722_addname_dataframe[table_name] = daily_20190722[table_name]
print("daily_20190722 返回数据 row 行数 = "+str(daily_20190722.shape[0]))
daily_20190722_addname_dataframe.to_excel(daily_201907_excel_writer,'22_1',index=False)
daily_201907_excel_writer.save()
daily_20190723 = pro.daily(start_date='',end_date='',trade_date='20190723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190723_tscode_list = list() 
for ts_code_sh in daily_20190723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190723_tscode_list.append(stock_name)
daily_20190723_addname_dataframe=pd.DataFrame()
daily_20190723_addname_dataframe['cname'] = daily_20190723_tscode_list
for table_name in daily_20190723.columns.values.tolist():
    daily_20190723_addname_dataframe[table_name] = daily_20190723[table_name]
print("daily_20190723 返回数据 row 行数 = "+str(daily_20190723.shape[0]))
daily_20190723_addname_dataframe.to_excel(daily_201907_excel_writer,'23_2',index=False)
daily_201907_excel_writer.save()
daily_20190724 = pro.daily(start_date='',end_date='',trade_date='20190724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190724_tscode_list = list() 
for ts_code_sh in daily_20190724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190724_tscode_list.append(stock_name)
daily_20190724_addname_dataframe=pd.DataFrame()
daily_20190724_addname_dataframe['cname'] = daily_20190724_tscode_list
for table_name in daily_20190724.columns.values.tolist():
    daily_20190724_addname_dataframe[table_name] = daily_20190724[table_name]
print("daily_20190724 返回数据 row 行数 = "+str(daily_20190724.shape[0]))
daily_20190724_addname_dataframe.to_excel(daily_201907_excel_writer,'24_3',index=False)
daily_201907_excel_writer.save()
daily_20190725 = pro.daily(start_date='',end_date='',trade_date='20190725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190725_tscode_list = list() 
for ts_code_sh in daily_20190725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190725_tscode_list.append(stock_name)
daily_20190725_addname_dataframe=pd.DataFrame()
daily_20190725_addname_dataframe['cname'] = daily_20190725_tscode_list
for table_name in daily_20190725.columns.values.tolist():
    daily_20190725_addname_dataframe[table_name] = daily_20190725[table_name]
print("daily_20190725 返回数据 row 行数 = "+str(daily_20190725.shape[0]))
daily_20190725_addname_dataframe.to_excel(daily_201907_excel_writer,'25_4',index=False)
daily_201907_excel_writer.save()
daily_20190726 = pro.daily(start_date='',end_date='',trade_date='20190726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190726_tscode_list = list() 
for ts_code_sh in daily_20190726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190726_tscode_list.append(stock_name)
daily_20190726_addname_dataframe=pd.DataFrame()
daily_20190726_addname_dataframe['cname'] = daily_20190726_tscode_list
for table_name in daily_20190726.columns.values.tolist():
    daily_20190726_addname_dataframe[table_name] = daily_20190726[table_name]
print("daily_20190726 返回数据 row 行数 = "+str(daily_20190726.shape[0]))
daily_20190726_addname_dataframe.to_excel(daily_201907_excel_writer,'26_5',index=False)
daily_201907_excel_writer.save()
daily_20190727 = pro.daily(start_date='',end_date='',trade_date='20190727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190727_tscode_list = list() 
for ts_code_sh in daily_20190727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190727_tscode_list.append(stock_name)
daily_20190727_addname_dataframe=pd.DataFrame()
daily_20190727_addname_dataframe['cname'] = daily_20190727_tscode_list
for table_name in daily_20190727.columns.values.tolist():
    daily_20190727_addname_dataframe[table_name] = daily_20190727[table_name]
print("daily_20190727 返回数据 row 行数 = "+str(daily_20190727.shape[0]))
daily_20190727_addname_dataframe.to_excel(daily_201907_excel_writer,'27_6',index=False)
daily_201907_excel_writer.save()
daily_20190728 = pro.daily(start_date='',end_date='',trade_date='20190728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190728_tscode_list = list() 
for ts_code_sh in daily_20190728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190728_tscode_list.append(stock_name)
daily_20190728_addname_dataframe=pd.DataFrame()
daily_20190728_addname_dataframe['cname'] = daily_20190728_tscode_list
for table_name in daily_20190728.columns.values.tolist():
    daily_20190728_addname_dataframe[table_name] = daily_20190728[table_name]
print("daily_20190728 返回数据 row 行数 = "+str(daily_20190728.shape[0]))
daily_20190728_addname_dataframe.to_excel(daily_201907_excel_writer,'28_7',index=False)
daily_201907_excel_writer.save()
daily_20190729 = pro.daily(start_date='',end_date='',trade_date='20190729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190729_tscode_list = list() 
for ts_code_sh in daily_20190729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190729_tscode_list.append(stock_name)
daily_20190729_addname_dataframe=pd.DataFrame()
daily_20190729_addname_dataframe['cname'] = daily_20190729_tscode_list
for table_name in daily_20190729.columns.values.tolist():
    daily_20190729_addname_dataframe[table_name] = daily_20190729[table_name]
print("daily_20190729 返回数据 row 行数 = "+str(daily_20190729.shape[0]))
daily_20190729_addname_dataframe.to_excel(daily_201907_excel_writer,'29_1',index=False)
daily_201907_excel_writer.save()
daily_20190730 = pro.daily(start_date='',end_date='',trade_date='20190730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190730_tscode_list = list() 
for ts_code_sh in daily_20190730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190730_tscode_list.append(stock_name)
daily_20190730_addname_dataframe=pd.DataFrame()
daily_20190730_addname_dataframe['cname'] = daily_20190730_tscode_list
for table_name in daily_20190730.columns.values.tolist():
    daily_20190730_addname_dataframe[table_name] = daily_20190730[table_name]
print("daily_20190730 返回数据 row 行数 = "+str(daily_20190730.shape[0]))
daily_20190730_addname_dataframe.to_excel(daily_201907_excel_writer,'30_2',index=False)
daily_201907_excel_writer.save()
daily_20190731 = pro.daily(start_date='',end_date='',trade_date='20190731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190731_tscode_list = list() 
for ts_code_sh in daily_20190731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190731_tscode_list.append(stock_name)
daily_20190731_addname_dataframe=pd.DataFrame()
daily_20190731_addname_dataframe['cname'] = daily_20190731_tscode_list
for table_name in daily_20190731.columns.values.tolist():
    daily_20190731_addname_dataframe[table_name] = daily_20190731[table_name]
print("daily_20190731 返回数据 row 行数 = "+str(daily_20190731.shape[0]))
daily_20190731_addname_dataframe.to_excel(daily_201907_excel_writer,'31_3',index=False)
daily_201907_excel_writer.save()




createexcel('daily_201908.xlsx')
daily_201908_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201908.xlsx')
daily_201908_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201908.xlsx', engine='openpyxl')
daily_201908_excel_writer.book = daily_201908_book
daily_201908_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201908_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190801")       ###  更新 记录日期
daily_20190801 = pro.daily(start_date='',end_date='',trade_date='20190801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190801_tscode_list = list() 
for ts_code_sh in daily_20190801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190801_tscode_list.append(stock_name)
daily_20190801_addname_dataframe=pd.DataFrame()
daily_20190801_addname_dataframe['cname'] = daily_20190801_tscode_list
for table_name in daily_20190801.columns.values.tolist():
    daily_20190801_addname_dataframe[table_name] = daily_20190801[table_name]
print("daily_20190801 返回数据 row 行数 = "+str(daily_20190801.shape[0]))
daily_20190801_addname_dataframe.to_excel(daily_201908_excel_writer,'1_4',index=False)
daily_201908_excel_writer.save()
daily_20190802 = pro.daily(start_date='',end_date='',trade_date='20190802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190802_tscode_list = list() 
for ts_code_sh in daily_20190802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190802_tscode_list.append(stock_name)
daily_20190802_addname_dataframe=pd.DataFrame()
daily_20190802_addname_dataframe['cname'] = daily_20190802_tscode_list
for table_name in daily_20190802.columns.values.tolist():
    daily_20190802_addname_dataframe[table_name] = daily_20190802[table_name]
print("daily_20190802 返回数据 row 行数 = "+str(daily_20190802.shape[0]))
daily_20190802_addname_dataframe.to_excel(daily_201908_excel_writer,'2_5',index=False)
daily_201908_excel_writer.save()
daily_20190803 = pro.daily(start_date='',end_date='',trade_date='20190803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190803_tscode_list = list() 
for ts_code_sh in daily_20190803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190803_tscode_list.append(stock_name)
daily_20190803_addname_dataframe=pd.DataFrame()
daily_20190803_addname_dataframe['cname'] = daily_20190803_tscode_list
for table_name in daily_20190803.columns.values.tolist():
    daily_20190803_addname_dataframe[table_name] = daily_20190803[table_name]
print("daily_20190803 返回数据 row 行数 = "+str(daily_20190803.shape[0]))
daily_20190803_addname_dataframe.to_excel(daily_201908_excel_writer,'3_6',index=False)
daily_201908_excel_writer.save()
daily_20190804 = pro.daily(start_date='',end_date='',trade_date='20190804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190804_tscode_list = list() 
for ts_code_sh in daily_20190804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190804_tscode_list.append(stock_name)
daily_20190804_addname_dataframe=pd.DataFrame()
daily_20190804_addname_dataframe['cname'] = daily_20190804_tscode_list
for table_name in daily_20190804.columns.values.tolist():
    daily_20190804_addname_dataframe[table_name] = daily_20190804[table_name]
print("daily_20190804 返回数据 row 行数 = "+str(daily_20190804.shape[0]))
daily_20190804_addname_dataframe.to_excel(daily_201908_excel_writer,'4_7',index=False)
daily_201908_excel_writer.save()
daily_20190805 = pro.daily(start_date='',end_date='',trade_date='20190805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190805_tscode_list = list() 
for ts_code_sh in daily_20190805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190805_tscode_list.append(stock_name)
daily_20190805_addname_dataframe=pd.DataFrame()
daily_20190805_addname_dataframe['cname'] = daily_20190805_tscode_list
for table_name in daily_20190805.columns.values.tolist():
    daily_20190805_addname_dataframe[table_name] = daily_20190805[table_name]
print("daily_20190805 返回数据 row 行数 = "+str(daily_20190805.shape[0]))
daily_20190805_addname_dataframe.to_excel(daily_201908_excel_writer,'5_1',index=False)
daily_201908_excel_writer.save()
daily_20190806 = pro.daily(start_date='',end_date='',trade_date='20190806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190806_tscode_list = list() 
for ts_code_sh in daily_20190806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190806_tscode_list.append(stock_name)
daily_20190806_addname_dataframe=pd.DataFrame()
daily_20190806_addname_dataframe['cname'] = daily_20190806_tscode_list
for table_name in daily_20190806.columns.values.tolist():
    daily_20190806_addname_dataframe[table_name] = daily_20190806[table_name]
print("daily_20190806 返回数据 row 行数 = "+str(daily_20190806.shape[0]))
daily_20190806_addname_dataframe.to_excel(daily_201908_excel_writer,'6_2',index=False)
daily_201908_excel_writer.save()
daily_20190807 = pro.daily(start_date='',end_date='',trade_date='20190807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190807_tscode_list = list() 
for ts_code_sh in daily_20190807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190807_tscode_list.append(stock_name)
daily_20190807_addname_dataframe=pd.DataFrame()
daily_20190807_addname_dataframe['cname'] = daily_20190807_tscode_list
for table_name in daily_20190807.columns.values.tolist():
    daily_20190807_addname_dataframe[table_name] = daily_20190807[table_name]
print("daily_20190807 返回数据 row 行数 = "+str(daily_20190807.shape[0]))
daily_20190807_addname_dataframe.to_excel(daily_201908_excel_writer,'7_3',index=False)
daily_201908_excel_writer.save()
daily_20190808 = pro.daily(start_date='',end_date='',trade_date='20190808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190808_tscode_list = list() 
for ts_code_sh in daily_20190808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190808_tscode_list.append(stock_name)
daily_20190808_addname_dataframe=pd.DataFrame()
daily_20190808_addname_dataframe['cname'] = daily_20190808_tscode_list
for table_name in daily_20190808.columns.values.tolist():
    daily_20190808_addname_dataframe[table_name] = daily_20190808[table_name]
print("daily_20190808 返回数据 row 行数 = "+str(daily_20190808.shape[0]))
daily_20190808_addname_dataframe.to_excel(daily_201908_excel_writer,'8_4',index=False)
daily_201908_excel_writer.save()
daily_20190809 = pro.daily(start_date='',end_date='',trade_date='20190809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190809_tscode_list = list() 
for ts_code_sh in daily_20190809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190809_tscode_list.append(stock_name)
daily_20190809_addname_dataframe=pd.DataFrame()
daily_20190809_addname_dataframe['cname'] = daily_20190809_tscode_list
for table_name in daily_20190809.columns.values.tolist():
    daily_20190809_addname_dataframe[table_name] = daily_20190809[table_name]
print("daily_20190809 返回数据 row 行数 = "+str(daily_20190809.shape[0]))
daily_20190809_addname_dataframe.to_excel(daily_201908_excel_writer,'9_5',index=False)
daily_201908_excel_writer.save()
daily_20190810 = pro.daily(start_date='',end_date='',trade_date='20190810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190810_tscode_list = list() 
for ts_code_sh in daily_20190810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190810_tscode_list.append(stock_name)
daily_20190810_addname_dataframe=pd.DataFrame()
daily_20190810_addname_dataframe['cname'] = daily_20190810_tscode_list
for table_name in daily_20190810.columns.values.tolist():
    daily_20190810_addname_dataframe[table_name] = daily_20190810[table_name]
print("daily_20190810 返回数据 row 行数 = "+str(daily_20190810.shape[0]))
daily_20190810_addname_dataframe.to_excel(daily_201908_excel_writer,'10_6',index=False)
daily_201908_excel_writer.save()
daily_20190811 = pro.daily(start_date='',end_date='',trade_date='20190811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190811_tscode_list = list() 
for ts_code_sh in daily_20190811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190811_tscode_list.append(stock_name)
daily_20190811_addname_dataframe=pd.DataFrame()
daily_20190811_addname_dataframe['cname'] = daily_20190811_tscode_list
for table_name in daily_20190811.columns.values.tolist():
    daily_20190811_addname_dataframe[table_name] = daily_20190811[table_name]
print("daily_20190811 返回数据 row 行数 = "+str(daily_20190811.shape[0]))
daily_20190811_addname_dataframe.to_excel(daily_201908_excel_writer,'11_7',index=False)
daily_201908_excel_writer.save()
daily_20190812 = pro.daily(start_date='',end_date='',trade_date='20190812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190812_tscode_list = list() 
for ts_code_sh in daily_20190812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190812_tscode_list.append(stock_name)
daily_20190812_addname_dataframe=pd.DataFrame()
daily_20190812_addname_dataframe['cname'] = daily_20190812_tscode_list
for table_name in daily_20190812.columns.values.tolist():
    daily_20190812_addname_dataframe[table_name] = daily_20190812[table_name]
print("daily_20190812 返回数据 row 行数 = "+str(daily_20190812.shape[0]))
daily_20190812_addname_dataframe.to_excel(daily_201908_excel_writer,'12_1',index=False)
daily_201908_excel_writer.save()
daily_20190813 = pro.daily(start_date='',end_date='',trade_date='20190813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190813_tscode_list = list() 
for ts_code_sh in daily_20190813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190813_tscode_list.append(stock_name)
daily_20190813_addname_dataframe=pd.DataFrame()
daily_20190813_addname_dataframe['cname'] = daily_20190813_tscode_list
for table_name in daily_20190813.columns.values.tolist():
    daily_20190813_addname_dataframe[table_name] = daily_20190813[table_name]
print("daily_20190813 返回数据 row 行数 = "+str(daily_20190813.shape[0]))
daily_20190813_addname_dataframe.to_excel(daily_201908_excel_writer,'13_2',index=False)
daily_201908_excel_writer.save()
daily_20190814 = pro.daily(start_date='',end_date='',trade_date='20190814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190814_tscode_list = list() 
for ts_code_sh in daily_20190814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190814_tscode_list.append(stock_name)
daily_20190814_addname_dataframe=pd.DataFrame()
daily_20190814_addname_dataframe['cname'] = daily_20190814_tscode_list
for table_name in daily_20190814.columns.values.tolist():
    daily_20190814_addname_dataframe[table_name] = daily_20190814[table_name]
print("daily_20190814 返回数据 row 行数 = "+str(daily_20190814.shape[0]))
daily_20190814_addname_dataframe.to_excel(daily_201908_excel_writer,'14_3',index=False)
daily_201908_excel_writer.save()
daily_20190815 = pro.daily(start_date='',end_date='',trade_date='20190815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190815_tscode_list = list() 
for ts_code_sh in daily_20190815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190815_tscode_list.append(stock_name)
daily_20190815_addname_dataframe=pd.DataFrame()
daily_20190815_addname_dataframe['cname'] = daily_20190815_tscode_list
for table_name in daily_20190815.columns.values.tolist():
    daily_20190815_addname_dataframe[table_name] = daily_20190815[table_name]
print("daily_20190815 返回数据 row 行数 = "+str(daily_20190815.shape[0]))
daily_20190815_addname_dataframe.to_excel(daily_201908_excel_writer,'15_4',index=False)
daily_201908_excel_writer.save()
daily_20190816 = pro.daily(start_date='',end_date='',trade_date='20190816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190816_tscode_list = list() 
for ts_code_sh in daily_20190816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190816_tscode_list.append(stock_name)
daily_20190816_addname_dataframe=pd.DataFrame()
daily_20190816_addname_dataframe['cname'] = daily_20190816_tscode_list
for table_name in daily_20190816.columns.values.tolist():
    daily_20190816_addname_dataframe[table_name] = daily_20190816[table_name]
print("daily_20190816 返回数据 row 行数 = "+str(daily_20190816.shape[0]))
daily_20190816_addname_dataframe.to_excel(daily_201908_excel_writer,'16_5',index=False)
daily_201908_excel_writer.save()
daily_20190817 = pro.daily(start_date='',end_date='',trade_date='20190817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190817_tscode_list = list() 
for ts_code_sh in daily_20190817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190817_tscode_list.append(stock_name)
daily_20190817_addname_dataframe=pd.DataFrame()
daily_20190817_addname_dataframe['cname'] = daily_20190817_tscode_list
for table_name in daily_20190817.columns.values.tolist():
    daily_20190817_addname_dataframe[table_name] = daily_20190817[table_name]
print("daily_20190817 返回数据 row 行数 = "+str(daily_20190817.shape[0]))
daily_20190817_addname_dataframe.to_excel(daily_201908_excel_writer,'17_6',index=False)
daily_201908_excel_writer.save()
daily_20190818 = pro.daily(start_date='',end_date='',trade_date='20190818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190818_tscode_list = list() 
for ts_code_sh in daily_20190818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190818_tscode_list.append(stock_name)
daily_20190818_addname_dataframe=pd.DataFrame()
daily_20190818_addname_dataframe['cname'] = daily_20190818_tscode_list
for table_name in daily_20190818.columns.values.tolist():
    daily_20190818_addname_dataframe[table_name] = daily_20190818[table_name]
print("daily_20190818 返回数据 row 行数 = "+str(daily_20190818.shape[0]))
daily_20190818_addname_dataframe.to_excel(daily_201908_excel_writer,'18_7',index=False)
daily_201908_excel_writer.save()
daily_20190819 = pro.daily(start_date='',end_date='',trade_date='20190819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190819_tscode_list = list() 
for ts_code_sh in daily_20190819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190819_tscode_list.append(stock_name)
daily_20190819_addname_dataframe=pd.DataFrame()
daily_20190819_addname_dataframe['cname'] = daily_20190819_tscode_list
for table_name in daily_20190819.columns.values.tolist():
    daily_20190819_addname_dataframe[table_name] = daily_20190819[table_name]
print("daily_20190819 返回数据 row 行数 = "+str(daily_20190819.shape[0]))
daily_20190819_addname_dataframe.to_excel(daily_201908_excel_writer,'19_1',index=False)
daily_201908_excel_writer.save()
daily_20190820 = pro.daily(start_date='',end_date='',trade_date='20190820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190820_tscode_list = list() 
for ts_code_sh in daily_20190820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190820_tscode_list.append(stock_name)
daily_20190820_addname_dataframe=pd.DataFrame()
daily_20190820_addname_dataframe['cname'] = daily_20190820_tscode_list
for table_name in daily_20190820.columns.values.tolist():
    daily_20190820_addname_dataframe[table_name] = daily_20190820[table_name]
print("daily_20190820 返回数据 row 行数 = "+str(daily_20190820.shape[0]))
daily_20190820_addname_dataframe.to_excel(daily_201908_excel_writer,'20_2',index=False)
daily_201908_excel_writer.save()
daily_20190821 = pro.daily(start_date='',end_date='',trade_date='20190821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190821_tscode_list = list() 
for ts_code_sh in daily_20190821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190821_tscode_list.append(stock_name)
daily_20190821_addname_dataframe=pd.DataFrame()
daily_20190821_addname_dataframe['cname'] = daily_20190821_tscode_list
for table_name in daily_20190821.columns.values.tolist():
    daily_20190821_addname_dataframe[table_name] = daily_20190821[table_name]
print("daily_20190821 返回数据 row 行数 = "+str(daily_20190821.shape[0]))
daily_20190821_addname_dataframe.to_excel(daily_201908_excel_writer,'21_3',index=False)
daily_201908_excel_writer.save()
daily_20190822 = pro.daily(start_date='',end_date='',trade_date='20190822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190822_tscode_list = list() 
for ts_code_sh in daily_20190822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190822_tscode_list.append(stock_name)
daily_20190822_addname_dataframe=pd.DataFrame()
daily_20190822_addname_dataframe['cname'] = daily_20190822_tscode_list
for table_name in daily_20190822.columns.values.tolist():
    daily_20190822_addname_dataframe[table_name] = daily_20190822[table_name]
print("daily_20190822 返回数据 row 行数 = "+str(daily_20190822.shape[0]))
daily_20190822_addname_dataframe.to_excel(daily_201908_excel_writer,'22_4',index=False)
daily_201908_excel_writer.save()
daily_20190823 = pro.daily(start_date='',end_date='',trade_date='20190823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190823_tscode_list = list() 
for ts_code_sh in daily_20190823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190823_tscode_list.append(stock_name)
daily_20190823_addname_dataframe=pd.DataFrame()
daily_20190823_addname_dataframe['cname'] = daily_20190823_tscode_list
for table_name in daily_20190823.columns.values.tolist():
    daily_20190823_addname_dataframe[table_name] = daily_20190823[table_name]
print("daily_20190823 返回数据 row 行数 = "+str(daily_20190823.shape[0]))
daily_20190823_addname_dataframe.to_excel(daily_201908_excel_writer,'23_5',index=False)
daily_201908_excel_writer.save()
daily_20190824 = pro.daily(start_date='',end_date='',trade_date='20190824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190824_tscode_list = list() 
for ts_code_sh in daily_20190824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190824_tscode_list.append(stock_name)
daily_20190824_addname_dataframe=pd.DataFrame()
daily_20190824_addname_dataframe['cname'] = daily_20190824_tscode_list
for table_name in daily_20190824.columns.values.tolist():
    daily_20190824_addname_dataframe[table_name] = daily_20190824[table_name]
print("daily_20190824 返回数据 row 行数 = "+str(daily_20190824.shape[0]))
daily_20190824_addname_dataframe.to_excel(daily_201908_excel_writer,'24_6',index=False)
daily_201908_excel_writer.save()
daily_20190825 = pro.daily(start_date='',end_date='',trade_date='20190825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190825_tscode_list = list() 
for ts_code_sh in daily_20190825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190825_tscode_list.append(stock_name)
daily_20190825_addname_dataframe=pd.DataFrame()
daily_20190825_addname_dataframe['cname'] = daily_20190825_tscode_list
for table_name in daily_20190825.columns.values.tolist():
    daily_20190825_addname_dataframe[table_name] = daily_20190825[table_name]
print("daily_20190825 返回数据 row 行数 = "+str(daily_20190825.shape[0]))
daily_20190825_addname_dataframe.to_excel(daily_201908_excel_writer,'25_7',index=False)
daily_201908_excel_writer.save()
daily_20190826 = pro.daily(start_date='',end_date='',trade_date='20190826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190826_tscode_list = list() 
for ts_code_sh in daily_20190826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190826_tscode_list.append(stock_name)
daily_20190826_addname_dataframe=pd.DataFrame()
daily_20190826_addname_dataframe['cname'] = daily_20190826_tscode_list
for table_name in daily_20190826.columns.values.tolist():
    daily_20190826_addname_dataframe[table_name] = daily_20190826[table_name]
print("daily_20190826 返回数据 row 行数 = "+str(daily_20190826.shape[0]))
daily_20190826_addname_dataframe.to_excel(daily_201908_excel_writer,'26_1',index=False)
daily_201908_excel_writer.save()
daily_20190827 = pro.daily(start_date='',end_date='',trade_date='20190827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190827_tscode_list = list() 
for ts_code_sh in daily_20190827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190827_tscode_list.append(stock_name)
daily_20190827_addname_dataframe=pd.DataFrame()
daily_20190827_addname_dataframe['cname'] = daily_20190827_tscode_list
for table_name in daily_20190827.columns.values.tolist():
    daily_20190827_addname_dataframe[table_name] = daily_20190827[table_name]
print("daily_20190827 返回数据 row 行数 = "+str(daily_20190827.shape[0]))
daily_20190827_addname_dataframe.to_excel(daily_201908_excel_writer,'27_2',index=False)
daily_201908_excel_writer.save()
daily_20190828 = pro.daily(start_date='',end_date='',trade_date='20190828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190828_tscode_list = list() 
for ts_code_sh in daily_20190828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190828_tscode_list.append(stock_name)
daily_20190828_addname_dataframe=pd.DataFrame()
daily_20190828_addname_dataframe['cname'] = daily_20190828_tscode_list
for table_name in daily_20190828.columns.values.tolist():
    daily_20190828_addname_dataframe[table_name] = daily_20190828[table_name]
print("daily_20190828 返回数据 row 行数 = "+str(daily_20190828.shape[0]))
daily_20190828_addname_dataframe.to_excel(daily_201908_excel_writer,'28_3',index=False)
daily_201908_excel_writer.save()
daily_20190829 = pro.daily(start_date='',end_date='',trade_date='20190829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190829_tscode_list = list() 
for ts_code_sh in daily_20190829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190829_tscode_list.append(stock_name)
daily_20190829_addname_dataframe=pd.DataFrame()
daily_20190829_addname_dataframe['cname'] = daily_20190829_tscode_list
for table_name in daily_20190829.columns.values.tolist():
    daily_20190829_addname_dataframe[table_name] = daily_20190829[table_name]
print("daily_20190829 返回数据 row 行数 = "+str(daily_20190829.shape[0]))
daily_20190829_addname_dataframe.to_excel(daily_201908_excel_writer,'29_4',index=False)
daily_201908_excel_writer.save()
daily_20190830 = pro.daily(start_date='',end_date='',trade_date='20190830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190830_tscode_list = list() 
for ts_code_sh in daily_20190830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190830_tscode_list.append(stock_name)
daily_20190830_addname_dataframe=pd.DataFrame()
daily_20190830_addname_dataframe['cname'] = daily_20190830_tscode_list
for table_name in daily_20190830.columns.values.tolist():
    daily_20190830_addname_dataframe[table_name] = daily_20190830[table_name]
print("daily_20190830 返回数据 row 行数 = "+str(daily_20190830.shape[0]))
daily_20190830_addname_dataframe.to_excel(daily_201908_excel_writer,'30_5',index=False)
daily_201908_excel_writer.save()
daily_20190831 = pro.daily(start_date='',end_date='',trade_date='20190831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190831_tscode_list = list() 
for ts_code_sh in daily_20190831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190831_tscode_list.append(stock_name)
daily_20190831_addname_dataframe=pd.DataFrame()
daily_20190831_addname_dataframe['cname'] = daily_20190831_tscode_list
for table_name in daily_20190831.columns.values.tolist():
    daily_20190831_addname_dataframe[table_name] = daily_20190831[table_name]
print("daily_20190831 返回数据 row 行数 = "+str(daily_20190831.shape[0]))
daily_20190831_addname_dataframe.to_excel(daily_201908_excel_writer,'31_6',index=False)
daily_201908_excel_writer.save()




createexcel('daily_201909.xlsx')
daily_201909_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201909.xlsx')
daily_201909_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201909.xlsx', engine='openpyxl')
daily_201909_excel_writer.book = daily_201909_book
daily_201909_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201909_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190901")       ###  更新 记录日期
daily_20190901 = pro.daily(start_date='',end_date='',trade_date='20190901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190901_tscode_list = list() 
for ts_code_sh in daily_20190901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190901_tscode_list.append(stock_name)
daily_20190901_addname_dataframe=pd.DataFrame()
daily_20190901_addname_dataframe['cname'] = daily_20190901_tscode_list
for table_name in daily_20190901.columns.values.tolist():
    daily_20190901_addname_dataframe[table_name] = daily_20190901[table_name]
print("daily_20190901 返回数据 row 行数 = "+str(daily_20190901.shape[0]))
daily_20190901_addname_dataframe.to_excel(daily_201909_excel_writer,'1_7',index=False)
daily_201909_excel_writer.save()
daily_20190902 = pro.daily(start_date='',end_date='',trade_date='20190902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190902_tscode_list = list() 
for ts_code_sh in daily_20190902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190902_tscode_list.append(stock_name)
daily_20190902_addname_dataframe=pd.DataFrame()
daily_20190902_addname_dataframe['cname'] = daily_20190902_tscode_list
for table_name in daily_20190902.columns.values.tolist():
    daily_20190902_addname_dataframe[table_name] = daily_20190902[table_name]
print("daily_20190902 返回数据 row 行数 = "+str(daily_20190902.shape[0]))
daily_20190902_addname_dataframe.to_excel(daily_201909_excel_writer,'2_1',index=False)
daily_201909_excel_writer.save()
daily_20190903 = pro.daily(start_date='',end_date='',trade_date='20190903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190903_tscode_list = list() 
for ts_code_sh in daily_20190903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190903_tscode_list.append(stock_name)
daily_20190903_addname_dataframe=pd.DataFrame()
daily_20190903_addname_dataframe['cname'] = daily_20190903_tscode_list
for table_name in daily_20190903.columns.values.tolist():
    daily_20190903_addname_dataframe[table_name] = daily_20190903[table_name]
print("daily_20190903 返回数据 row 行数 = "+str(daily_20190903.shape[0]))
daily_20190903_addname_dataframe.to_excel(daily_201909_excel_writer,'3_2',index=False)
daily_201909_excel_writer.save()
daily_20190904 = pro.daily(start_date='',end_date='',trade_date='20190904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190904_tscode_list = list() 
for ts_code_sh in daily_20190904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190904_tscode_list.append(stock_name)
daily_20190904_addname_dataframe=pd.DataFrame()
daily_20190904_addname_dataframe['cname'] = daily_20190904_tscode_list
for table_name in daily_20190904.columns.values.tolist():
    daily_20190904_addname_dataframe[table_name] = daily_20190904[table_name]
print("daily_20190904 返回数据 row 行数 = "+str(daily_20190904.shape[0]))
daily_20190904_addname_dataframe.to_excel(daily_201909_excel_writer,'4_3',index=False)
daily_201909_excel_writer.save()
daily_20190905 = pro.daily(start_date='',end_date='',trade_date='20190905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190905_tscode_list = list() 
for ts_code_sh in daily_20190905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190905_tscode_list.append(stock_name)
daily_20190905_addname_dataframe=pd.DataFrame()
daily_20190905_addname_dataframe['cname'] = daily_20190905_tscode_list
for table_name in daily_20190905.columns.values.tolist():
    daily_20190905_addname_dataframe[table_name] = daily_20190905[table_name]
print("daily_20190905 返回数据 row 行数 = "+str(daily_20190905.shape[0]))
daily_20190905_addname_dataframe.to_excel(daily_201909_excel_writer,'5_4',index=False)
daily_201909_excel_writer.save()
daily_20190906 = pro.daily(start_date='',end_date='',trade_date='20190906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190906_tscode_list = list() 
for ts_code_sh in daily_20190906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190906_tscode_list.append(stock_name)
daily_20190906_addname_dataframe=pd.DataFrame()
daily_20190906_addname_dataframe['cname'] = daily_20190906_tscode_list
for table_name in daily_20190906.columns.values.tolist():
    daily_20190906_addname_dataframe[table_name] = daily_20190906[table_name]
print("daily_20190906 返回数据 row 行数 = "+str(daily_20190906.shape[0]))
daily_20190906_addname_dataframe.to_excel(daily_201909_excel_writer,'6_5',index=False)
daily_201909_excel_writer.save()
daily_20190907 = pro.daily(start_date='',end_date='',trade_date='20190907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190907_tscode_list = list() 
for ts_code_sh in daily_20190907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190907_tscode_list.append(stock_name)
daily_20190907_addname_dataframe=pd.DataFrame()
daily_20190907_addname_dataframe['cname'] = daily_20190907_tscode_list
for table_name in daily_20190907.columns.values.tolist():
    daily_20190907_addname_dataframe[table_name] = daily_20190907[table_name]
print("daily_20190907 返回数据 row 行数 = "+str(daily_20190907.shape[0]))
daily_20190907_addname_dataframe.to_excel(daily_201909_excel_writer,'7_6',index=False)
daily_201909_excel_writer.save()
daily_20190908 = pro.daily(start_date='',end_date='',trade_date='20190908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190908_tscode_list = list() 
for ts_code_sh in daily_20190908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190908_tscode_list.append(stock_name)
daily_20190908_addname_dataframe=pd.DataFrame()
daily_20190908_addname_dataframe['cname'] = daily_20190908_tscode_list
for table_name in daily_20190908.columns.values.tolist():
    daily_20190908_addname_dataframe[table_name] = daily_20190908[table_name]
print("daily_20190908 返回数据 row 行数 = "+str(daily_20190908.shape[0]))
daily_20190908_addname_dataframe.to_excel(daily_201909_excel_writer,'8_7',index=False)
daily_201909_excel_writer.save()
daily_20190909 = pro.daily(start_date='',end_date='',trade_date='20190909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190909_tscode_list = list() 
for ts_code_sh in daily_20190909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190909_tscode_list.append(stock_name)
daily_20190909_addname_dataframe=pd.DataFrame()
daily_20190909_addname_dataframe['cname'] = daily_20190909_tscode_list
for table_name in daily_20190909.columns.values.tolist():
    daily_20190909_addname_dataframe[table_name] = daily_20190909[table_name]
print("daily_20190909 返回数据 row 行数 = "+str(daily_20190909.shape[0]))
daily_20190909_addname_dataframe.to_excel(daily_201909_excel_writer,'9_1',index=False)
daily_201909_excel_writer.save()
daily_20190910 = pro.daily(start_date='',end_date='',trade_date='20190910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190910_tscode_list = list() 
for ts_code_sh in daily_20190910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190910_tscode_list.append(stock_name)
daily_20190910_addname_dataframe=pd.DataFrame()
daily_20190910_addname_dataframe['cname'] = daily_20190910_tscode_list
for table_name in daily_20190910.columns.values.tolist():
    daily_20190910_addname_dataframe[table_name] = daily_20190910[table_name]
print("daily_20190910 返回数据 row 行数 = "+str(daily_20190910.shape[0]))
daily_20190910_addname_dataframe.to_excel(daily_201909_excel_writer,'10_2',index=False)
daily_201909_excel_writer.save()
daily_20190911 = pro.daily(start_date='',end_date='',trade_date='20190911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190911_tscode_list = list() 
for ts_code_sh in daily_20190911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190911_tscode_list.append(stock_name)
daily_20190911_addname_dataframe=pd.DataFrame()
daily_20190911_addname_dataframe['cname'] = daily_20190911_tscode_list
for table_name in daily_20190911.columns.values.tolist():
    daily_20190911_addname_dataframe[table_name] = daily_20190911[table_name]
print("daily_20190911 返回数据 row 行数 = "+str(daily_20190911.shape[0]))
daily_20190911_addname_dataframe.to_excel(daily_201909_excel_writer,'11_3',index=False)
daily_201909_excel_writer.save()
daily_20190912 = pro.daily(start_date='',end_date='',trade_date='20190912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190912_tscode_list = list() 
for ts_code_sh in daily_20190912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190912_tscode_list.append(stock_name)
daily_20190912_addname_dataframe=pd.DataFrame()
daily_20190912_addname_dataframe['cname'] = daily_20190912_tscode_list
for table_name in daily_20190912.columns.values.tolist():
    daily_20190912_addname_dataframe[table_name] = daily_20190912[table_name]
print("daily_20190912 返回数据 row 行数 = "+str(daily_20190912.shape[0]))
daily_20190912_addname_dataframe.to_excel(daily_201909_excel_writer,'12_4',index=False)
daily_201909_excel_writer.save()
daily_20190913 = pro.daily(start_date='',end_date='',trade_date='20190913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190913_tscode_list = list() 
for ts_code_sh in daily_20190913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190913_tscode_list.append(stock_name)
daily_20190913_addname_dataframe=pd.DataFrame()
daily_20190913_addname_dataframe['cname'] = daily_20190913_tscode_list
for table_name in daily_20190913.columns.values.tolist():
    daily_20190913_addname_dataframe[table_name] = daily_20190913[table_name]
print("daily_20190913 返回数据 row 行数 = "+str(daily_20190913.shape[0]))
daily_20190913_addname_dataframe.to_excel(daily_201909_excel_writer,'13_5',index=False)
daily_201909_excel_writer.save()
daily_20190914 = pro.daily(start_date='',end_date='',trade_date='20190914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190914_tscode_list = list() 
for ts_code_sh in daily_20190914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190914_tscode_list.append(stock_name)
daily_20190914_addname_dataframe=pd.DataFrame()
daily_20190914_addname_dataframe['cname'] = daily_20190914_tscode_list
for table_name in daily_20190914.columns.values.tolist():
    daily_20190914_addname_dataframe[table_name] = daily_20190914[table_name]
print("daily_20190914 返回数据 row 行数 = "+str(daily_20190914.shape[0]))
daily_20190914_addname_dataframe.to_excel(daily_201909_excel_writer,'14_6',index=False)
daily_201909_excel_writer.save()
daily_20190915 = pro.daily(start_date='',end_date='',trade_date='20190915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190915_tscode_list = list() 
for ts_code_sh in daily_20190915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190915_tscode_list.append(stock_name)
daily_20190915_addname_dataframe=pd.DataFrame()
daily_20190915_addname_dataframe['cname'] = daily_20190915_tscode_list
for table_name in daily_20190915.columns.values.tolist():
    daily_20190915_addname_dataframe[table_name] = daily_20190915[table_name]
print("daily_20190915 返回数据 row 行数 = "+str(daily_20190915.shape[0]))
daily_20190915_addname_dataframe.to_excel(daily_201909_excel_writer,'15_7',index=False)
daily_201909_excel_writer.save()
daily_20190916 = pro.daily(start_date='',end_date='',trade_date='20190916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190916_tscode_list = list() 
for ts_code_sh in daily_20190916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190916_tscode_list.append(stock_name)
daily_20190916_addname_dataframe=pd.DataFrame()
daily_20190916_addname_dataframe['cname'] = daily_20190916_tscode_list
for table_name in daily_20190916.columns.values.tolist():
    daily_20190916_addname_dataframe[table_name] = daily_20190916[table_name]
print("daily_20190916 返回数据 row 行数 = "+str(daily_20190916.shape[0]))
daily_20190916_addname_dataframe.to_excel(daily_201909_excel_writer,'16_1',index=False)
daily_201909_excel_writer.save()
daily_20190917 = pro.daily(start_date='',end_date='',trade_date='20190917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190917_tscode_list = list() 
for ts_code_sh in daily_20190917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190917_tscode_list.append(stock_name)
daily_20190917_addname_dataframe=pd.DataFrame()
daily_20190917_addname_dataframe['cname'] = daily_20190917_tscode_list
for table_name in daily_20190917.columns.values.tolist():
    daily_20190917_addname_dataframe[table_name] = daily_20190917[table_name]
print("daily_20190917 返回数据 row 行数 = "+str(daily_20190917.shape[0]))
daily_20190917_addname_dataframe.to_excel(daily_201909_excel_writer,'17_2',index=False)
daily_201909_excel_writer.save()
daily_20190918 = pro.daily(start_date='',end_date='',trade_date='20190918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190918_tscode_list = list() 
for ts_code_sh in daily_20190918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190918_tscode_list.append(stock_name)
daily_20190918_addname_dataframe=pd.DataFrame()
daily_20190918_addname_dataframe['cname'] = daily_20190918_tscode_list
for table_name in daily_20190918.columns.values.tolist():
    daily_20190918_addname_dataframe[table_name] = daily_20190918[table_name]
print("daily_20190918 返回数据 row 行数 = "+str(daily_20190918.shape[0]))
daily_20190918_addname_dataframe.to_excel(daily_201909_excel_writer,'18_3',index=False)
daily_201909_excel_writer.save()
daily_20190919 = pro.daily(start_date='',end_date='',trade_date='20190919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190919_tscode_list = list() 
for ts_code_sh in daily_20190919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190919_tscode_list.append(stock_name)
daily_20190919_addname_dataframe=pd.DataFrame()
daily_20190919_addname_dataframe['cname'] = daily_20190919_tscode_list
for table_name in daily_20190919.columns.values.tolist():
    daily_20190919_addname_dataframe[table_name] = daily_20190919[table_name]
print("daily_20190919 返回数据 row 行数 = "+str(daily_20190919.shape[0]))
daily_20190919_addname_dataframe.to_excel(daily_201909_excel_writer,'19_4',index=False)
daily_201909_excel_writer.save()
daily_20190920 = pro.daily(start_date='',end_date='',trade_date='20190920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190920_tscode_list = list() 
for ts_code_sh in daily_20190920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190920_tscode_list.append(stock_name)
daily_20190920_addname_dataframe=pd.DataFrame()
daily_20190920_addname_dataframe['cname'] = daily_20190920_tscode_list
for table_name in daily_20190920.columns.values.tolist():
    daily_20190920_addname_dataframe[table_name] = daily_20190920[table_name]
print("daily_20190920 返回数据 row 行数 = "+str(daily_20190920.shape[0]))
daily_20190920_addname_dataframe.to_excel(daily_201909_excel_writer,'20_5',index=False)
daily_201909_excel_writer.save()
daily_20190921 = pro.daily(start_date='',end_date='',trade_date='20190921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190921_tscode_list = list() 
for ts_code_sh in daily_20190921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190921_tscode_list.append(stock_name)
daily_20190921_addname_dataframe=pd.DataFrame()
daily_20190921_addname_dataframe['cname'] = daily_20190921_tscode_list
for table_name in daily_20190921.columns.values.tolist():
    daily_20190921_addname_dataframe[table_name] = daily_20190921[table_name]
print("daily_20190921 返回数据 row 行数 = "+str(daily_20190921.shape[0]))
daily_20190921_addname_dataframe.to_excel(daily_201909_excel_writer,'21_6',index=False)
daily_201909_excel_writer.save()
daily_20190922 = pro.daily(start_date='',end_date='',trade_date='20190922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190922_tscode_list = list() 
for ts_code_sh in daily_20190922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190922_tscode_list.append(stock_name)
daily_20190922_addname_dataframe=pd.DataFrame()
daily_20190922_addname_dataframe['cname'] = daily_20190922_tscode_list
for table_name in daily_20190922.columns.values.tolist():
    daily_20190922_addname_dataframe[table_name] = daily_20190922[table_name]
print("daily_20190922 返回数据 row 行数 = "+str(daily_20190922.shape[0]))
daily_20190922_addname_dataframe.to_excel(daily_201909_excel_writer,'22_7',index=False)
daily_201909_excel_writer.save()
daily_20190923 = pro.daily(start_date='',end_date='',trade_date='20190923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190923_tscode_list = list() 
for ts_code_sh in daily_20190923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190923_tscode_list.append(stock_name)
daily_20190923_addname_dataframe=pd.DataFrame()
daily_20190923_addname_dataframe['cname'] = daily_20190923_tscode_list
for table_name in daily_20190923.columns.values.tolist():
    daily_20190923_addname_dataframe[table_name] = daily_20190923[table_name]
print("daily_20190923 返回数据 row 行数 = "+str(daily_20190923.shape[0]))
daily_20190923_addname_dataframe.to_excel(daily_201909_excel_writer,'23_1',index=False)
daily_201909_excel_writer.save()
daily_20190924 = pro.daily(start_date='',end_date='',trade_date='20190924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190924_tscode_list = list() 
for ts_code_sh in daily_20190924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190924_tscode_list.append(stock_name)
daily_20190924_addname_dataframe=pd.DataFrame()
daily_20190924_addname_dataframe['cname'] = daily_20190924_tscode_list
for table_name in daily_20190924.columns.values.tolist():
    daily_20190924_addname_dataframe[table_name] = daily_20190924[table_name]
print("daily_20190924 返回数据 row 行数 = "+str(daily_20190924.shape[0]))
daily_20190924_addname_dataframe.to_excel(daily_201909_excel_writer,'24_2',index=False)
daily_201909_excel_writer.save()
daily_20190925 = pro.daily(start_date='',end_date='',trade_date='20190925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190925_tscode_list = list() 
for ts_code_sh in daily_20190925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190925_tscode_list.append(stock_name)
daily_20190925_addname_dataframe=pd.DataFrame()
daily_20190925_addname_dataframe['cname'] = daily_20190925_tscode_list
for table_name in daily_20190925.columns.values.tolist():
    daily_20190925_addname_dataframe[table_name] = daily_20190925[table_name]
print("daily_20190925 返回数据 row 行数 = "+str(daily_20190925.shape[0]))
daily_20190925_addname_dataframe.to_excel(daily_201909_excel_writer,'25_3',index=False)
daily_201909_excel_writer.save()
daily_20190926 = pro.daily(start_date='',end_date='',trade_date='20190926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190926_tscode_list = list() 
for ts_code_sh in daily_20190926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190926_tscode_list.append(stock_name)
daily_20190926_addname_dataframe=pd.DataFrame()
daily_20190926_addname_dataframe['cname'] = daily_20190926_tscode_list
for table_name in daily_20190926.columns.values.tolist():
    daily_20190926_addname_dataframe[table_name] = daily_20190926[table_name]
print("daily_20190926 返回数据 row 行数 = "+str(daily_20190926.shape[0]))
daily_20190926_addname_dataframe.to_excel(daily_201909_excel_writer,'26_4',index=False)
daily_201909_excel_writer.save()
daily_20190927 = pro.daily(start_date='',end_date='',trade_date='20190927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190927_tscode_list = list() 
for ts_code_sh in daily_20190927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190927_tscode_list.append(stock_name)
daily_20190927_addname_dataframe=pd.DataFrame()
daily_20190927_addname_dataframe['cname'] = daily_20190927_tscode_list
for table_name in daily_20190927.columns.values.tolist():
    daily_20190927_addname_dataframe[table_name] = daily_20190927[table_name]
print("daily_20190927 返回数据 row 行数 = "+str(daily_20190927.shape[0]))
daily_20190927_addname_dataframe.to_excel(daily_201909_excel_writer,'27_5',index=False)
daily_201909_excel_writer.save()
daily_20190928 = pro.daily(start_date='',end_date='',trade_date='20190928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190928_tscode_list = list() 
for ts_code_sh in daily_20190928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190928_tscode_list.append(stock_name)
daily_20190928_addname_dataframe=pd.DataFrame()
daily_20190928_addname_dataframe['cname'] = daily_20190928_tscode_list
for table_name in daily_20190928.columns.values.tolist():
    daily_20190928_addname_dataframe[table_name] = daily_20190928[table_name]
print("daily_20190928 返回数据 row 行数 = "+str(daily_20190928.shape[0]))
daily_20190928_addname_dataframe.to_excel(daily_201909_excel_writer,'28_6',index=False)
daily_201909_excel_writer.save()
daily_20190929 = pro.daily(start_date='',end_date='',trade_date='20190929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190929_tscode_list = list() 
for ts_code_sh in daily_20190929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190929_tscode_list.append(stock_name)
daily_20190929_addname_dataframe=pd.DataFrame()
daily_20190929_addname_dataframe['cname'] = daily_20190929_tscode_list
for table_name in daily_20190929.columns.values.tolist():
    daily_20190929_addname_dataframe[table_name] = daily_20190929[table_name]
print("daily_20190929 返回数据 row 行数 = "+str(daily_20190929.shape[0]))
daily_20190929_addname_dataframe.to_excel(daily_201909_excel_writer,'29_7',index=False)
daily_201909_excel_writer.save()
daily_20190930 = pro.daily(start_date='',end_date='',trade_date='20190930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190930_tscode_list = list() 
for ts_code_sh in daily_20190930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190930_tscode_list.append(stock_name)
daily_20190930_addname_dataframe=pd.DataFrame()
daily_20190930_addname_dataframe['cname'] = daily_20190930_tscode_list
for table_name in daily_20190930.columns.values.tolist():
    daily_20190930_addname_dataframe[table_name] = daily_20190930[table_name]
print("daily_20190930 返回数据 row 行数 = "+str(daily_20190930.shape[0]))
daily_20190930_addname_dataframe.to_excel(daily_201909_excel_writer,'30_1',index=False)
daily_201909_excel_writer.save()




createexcel('daily_201910.xlsx')
daily_201910_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201910.xlsx')
daily_201910_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201910.xlsx', engine='openpyxl')
daily_201910_excel_writer.book = daily_201910_book
daily_201910_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201910_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20191001")       ###  更新 记录日期
daily_20191001 = pro.daily(start_date='',end_date='',trade_date='20191001', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191001_tscode_list = list() 
for ts_code_sh in daily_20191001['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191001_tscode_list.append(stock_name)
daily_20191001_addname_dataframe=pd.DataFrame()
daily_20191001_addname_dataframe['cname'] = daily_20191001_tscode_list
for table_name in daily_20191001.columns.values.tolist():
    daily_20191001_addname_dataframe[table_name] = daily_20191001[table_name]
print("daily_20191001 返回数据 row 行数 = "+str(daily_20191001.shape[0]))
daily_20191001_addname_dataframe.to_excel(daily_201910_excel_writer,'1_2',index=False)
daily_201910_excel_writer.save()
daily_20191002 = pro.daily(start_date='',end_date='',trade_date='20191002', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191002_tscode_list = list() 
for ts_code_sh in daily_20191002['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191002_tscode_list.append(stock_name)
daily_20191002_addname_dataframe=pd.DataFrame()
daily_20191002_addname_dataframe['cname'] = daily_20191002_tscode_list
for table_name in daily_20191002.columns.values.tolist():
    daily_20191002_addname_dataframe[table_name] = daily_20191002[table_name]
print("daily_20191002 返回数据 row 行数 = "+str(daily_20191002.shape[0]))
daily_20191002_addname_dataframe.to_excel(daily_201910_excel_writer,'2_3',index=False)
daily_201910_excel_writer.save()
daily_20191003 = pro.daily(start_date='',end_date='',trade_date='20191003', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191003_tscode_list = list() 
for ts_code_sh in daily_20191003['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191003_tscode_list.append(stock_name)
daily_20191003_addname_dataframe=pd.DataFrame()
daily_20191003_addname_dataframe['cname'] = daily_20191003_tscode_list
for table_name in daily_20191003.columns.values.tolist():
    daily_20191003_addname_dataframe[table_name] = daily_20191003[table_name]
print("daily_20191003 返回数据 row 行数 = "+str(daily_20191003.shape[0]))
daily_20191003_addname_dataframe.to_excel(daily_201910_excel_writer,'3_4',index=False)
daily_201910_excel_writer.save()
daily_20191004 = pro.daily(start_date='',end_date='',trade_date='20191004', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191004_tscode_list = list() 
for ts_code_sh in daily_20191004['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191004_tscode_list.append(stock_name)
daily_20191004_addname_dataframe=pd.DataFrame()
daily_20191004_addname_dataframe['cname'] = daily_20191004_tscode_list
for table_name in daily_20191004.columns.values.tolist():
    daily_20191004_addname_dataframe[table_name] = daily_20191004[table_name]
print("daily_20191004 返回数据 row 行数 = "+str(daily_20191004.shape[0]))
daily_20191004_addname_dataframe.to_excel(daily_201910_excel_writer,'4_5',index=False)
daily_201910_excel_writer.save()
daily_20191005 = pro.daily(start_date='',end_date='',trade_date='20191005', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191005_tscode_list = list() 
for ts_code_sh in daily_20191005['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191005_tscode_list.append(stock_name)
daily_20191005_addname_dataframe=pd.DataFrame()
daily_20191005_addname_dataframe['cname'] = daily_20191005_tscode_list
for table_name in daily_20191005.columns.values.tolist():
    daily_20191005_addname_dataframe[table_name] = daily_20191005[table_name]
print("daily_20191005 返回数据 row 行数 = "+str(daily_20191005.shape[0]))
daily_20191005_addname_dataframe.to_excel(daily_201910_excel_writer,'5_6',index=False)
daily_201910_excel_writer.save()
daily_20191006 = pro.daily(start_date='',end_date='',trade_date='20191006', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191006_tscode_list = list() 
for ts_code_sh in daily_20191006['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191006_tscode_list.append(stock_name)
daily_20191006_addname_dataframe=pd.DataFrame()
daily_20191006_addname_dataframe['cname'] = daily_20191006_tscode_list
for table_name in daily_20191006.columns.values.tolist():
    daily_20191006_addname_dataframe[table_name] = daily_20191006[table_name]
print("daily_20191006 返回数据 row 行数 = "+str(daily_20191006.shape[0]))
daily_20191006_addname_dataframe.to_excel(daily_201910_excel_writer,'6_7',index=False)
daily_201910_excel_writer.save()
daily_20191007 = pro.daily(start_date='',end_date='',trade_date='20191007', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191007_tscode_list = list() 
for ts_code_sh in daily_20191007['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191007_tscode_list.append(stock_name)
daily_20191007_addname_dataframe=pd.DataFrame()
daily_20191007_addname_dataframe['cname'] = daily_20191007_tscode_list
for table_name in daily_20191007.columns.values.tolist():
    daily_20191007_addname_dataframe[table_name] = daily_20191007[table_name]
print("daily_20191007 返回数据 row 行数 = "+str(daily_20191007.shape[0]))
daily_20191007_addname_dataframe.to_excel(daily_201910_excel_writer,'7_1',index=False)
daily_201910_excel_writer.save()
daily_20191008 = pro.daily(start_date='',end_date='',trade_date='20191008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191008_tscode_list = list() 
for ts_code_sh in daily_20191008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191008_tscode_list.append(stock_name)
daily_20191008_addname_dataframe=pd.DataFrame()
daily_20191008_addname_dataframe['cname'] = daily_20191008_tscode_list
for table_name in daily_20191008.columns.values.tolist():
    daily_20191008_addname_dataframe[table_name] = daily_20191008[table_name]
print("daily_20191008 返回数据 row 行数 = "+str(daily_20191008.shape[0]))
daily_20191008_addname_dataframe.to_excel(daily_201910_excel_writer,'8_2',index=False)
daily_201910_excel_writer.save()
daily_20191009 = pro.daily(start_date='',end_date='',trade_date='20191009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191009_tscode_list = list() 
for ts_code_sh in daily_20191009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191009_tscode_list.append(stock_name)
daily_20191009_addname_dataframe=pd.DataFrame()
daily_20191009_addname_dataframe['cname'] = daily_20191009_tscode_list
for table_name in daily_20191009.columns.values.tolist():
    daily_20191009_addname_dataframe[table_name] = daily_20191009[table_name]
print("daily_20191009 返回数据 row 行数 = "+str(daily_20191009.shape[0]))
daily_20191009_addname_dataframe.to_excel(daily_201910_excel_writer,'9_3',index=False)
daily_201910_excel_writer.save()
daily_20191010 = pro.daily(start_date='',end_date='',trade_date='20191010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191010_tscode_list = list() 
for ts_code_sh in daily_20191010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191010_tscode_list.append(stock_name)
daily_20191010_addname_dataframe=pd.DataFrame()
daily_20191010_addname_dataframe['cname'] = daily_20191010_tscode_list
for table_name in daily_20191010.columns.values.tolist():
    daily_20191010_addname_dataframe[table_name] = daily_20191010[table_name]
print("daily_20191010 返回数据 row 行数 = "+str(daily_20191010.shape[0]))
daily_20191010_addname_dataframe.to_excel(daily_201910_excel_writer,'10_4',index=False)
daily_201910_excel_writer.save()
daily_20191011 = pro.daily(start_date='',end_date='',trade_date='20191011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191011_tscode_list = list() 
for ts_code_sh in daily_20191011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191011_tscode_list.append(stock_name)
daily_20191011_addname_dataframe=pd.DataFrame()
daily_20191011_addname_dataframe['cname'] = daily_20191011_tscode_list
for table_name in daily_20191011.columns.values.tolist():
    daily_20191011_addname_dataframe[table_name] = daily_20191011[table_name]
print("daily_20191011 返回数据 row 行数 = "+str(daily_20191011.shape[0]))
daily_20191011_addname_dataframe.to_excel(daily_201910_excel_writer,'11_5',index=False)
daily_201910_excel_writer.save()
daily_20191012 = pro.daily(start_date='',end_date='',trade_date='20191012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191012_tscode_list = list() 
for ts_code_sh in daily_20191012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191012_tscode_list.append(stock_name)
daily_20191012_addname_dataframe=pd.DataFrame()
daily_20191012_addname_dataframe['cname'] = daily_20191012_tscode_list
for table_name in daily_20191012.columns.values.tolist():
    daily_20191012_addname_dataframe[table_name] = daily_20191012[table_name]
print("daily_20191012 返回数据 row 行数 = "+str(daily_20191012.shape[0]))
daily_20191012_addname_dataframe.to_excel(daily_201910_excel_writer,'12_6',index=False)
daily_201910_excel_writer.save()
daily_20191013 = pro.daily(start_date='',end_date='',trade_date='20191013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191013_tscode_list = list() 
for ts_code_sh in daily_20191013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191013_tscode_list.append(stock_name)
daily_20191013_addname_dataframe=pd.DataFrame()
daily_20191013_addname_dataframe['cname'] = daily_20191013_tscode_list
for table_name in daily_20191013.columns.values.tolist():
    daily_20191013_addname_dataframe[table_name] = daily_20191013[table_name]
print("daily_20191013 返回数据 row 行数 = "+str(daily_20191013.shape[0]))
daily_20191013_addname_dataframe.to_excel(daily_201910_excel_writer,'13_7',index=False)
daily_201910_excel_writer.save()
daily_20191014 = pro.daily(start_date='',end_date='',trade_date='20191014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191014_tscode_list = list() 
for ts_code_sh in daily_20191014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191014_tscode_list.append(stock_name)
daily_20191014_addname_dataframe=pd.DataFrame()
daily_20191014_addname_dataframe['cname'] = daily_20191014_tscode_list
for table_name in daily_20191014.columns.values.tolist():
    daily_20191014_addname_dataframe[table_name] = daily_20191014[table_name]
print("daily_20191014 返回数据 row 行数 = "+str(daily_20191014.shape[0]))
daily_20191014_addname_dataframe.to_excel(daily_201910_excel_writer,'14_1',index=False)
daily_201910_excel_writer.save()
daily_20191015 = pro.daily(start_date='',end_date='',trade_date='20191015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191015_tscode_list = list() 
for ts_code_sh in daily_20191015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191015_tscode_list.append(stock_name)
daily_20191015_addname_dataframe=pd.DataFrame()
daily_20191015_addname_dataframe['cname'] = daily_20191015_tscode_list
for table_name in daily_20191015.columns.values.tolist():
    daily_20191015_addname_dataframe[table_name] = daily_20191015[table_name]
print("daily_20191015 返回数据 row 行数 = "+str(daily_20191015.shape[0]))
daily_20191015_addname_dataframe.to_excel(daily_201910_excel_writer,'15_2',index=False)
daily_201910_excel_writer.save()
daily_20191016 = pro.daily(start_date='',end_date='',trade_date='20191016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191016_tscode_list = list() 
for ts_code_sh in daily_20191016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191016_tscode_list.append(stock_name)
daily_20191016_addname_dataframe=pd.DataFrame()
daily_20191016_addname_dataframe['cname'] = daily_20191016_tscode_list
for table_name in daily_20191016.columns.values.tolist():
    daily_20191016_addname_dataframe[table_name] = daily_20191016[table_name]
print("daily_20191016 返回数据 row 行数 = "+str(daily_20191016.shape[0]))
daily_20191016_addname_dataframe.to_excel(daily_201910_excel_writer,'16_3',index=False)
daily_201910_excel_writer.save()
daily_20191017 = pro.daily(start_date='',end_date='',trade_date='20191017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191017_tscode_list = list() 
for ts_code_sh in daily_20191017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191017_tscode_list.append(stock_name)
daily_20191017_addname_dataframe=pd.DataFrame()
daily_20191017_addname_dataframe['cname'] = daily_20191017_tscode_list
for table_name in daily_20191017.columns.values.tolist():
    daily_20191017_addname_dataframe[table_name] = daily_20191017[table_name]
print("daily_20191017 返回数据 row 行数 = "+str(daily_20191017.shape[0]))
daily_20191017_addname_dataframe.to_excel(daily_201910_excel_writer,'17_4',index=False)
daily_201910_excel_writer.save()
daily_20191018 = pro.daily(start_date='',end_date='',trade_date='20191018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191018_tscode_list = list() 
for ts_code_sh in daily_20191018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191018_tscode_list.append(stock_name)
daily_20191018_addname_dataframe=pd.DataFrame()
daily_20191018_addname_dataframe['cname'] = daily_20191018_tscode_list
for table_name in daily_20191018.columns.values.tolist():
    daily_20191018_addname_dataframe[table_name] = daily_20191018[table_name]
print("daily_20191018 返回数据 row 行数 = "+str(daily_20191018.shape[0]))
daily_20191018_addname_dataframe.to_excel(daily_201910_excel_writer,'18_5',index=False)
daily_201910_excel_writer.save()
daily_20191019 = pro.daily(start_date='',end_date='',trade_date='20191019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191019_tscode_list = list() 
for ts_code_sh in daily_20191019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191019_tscode_list.append(stock_name)
daily_20191019_addname_dataframe=pd.DataFrame()
daily_20191019_addname_dataframe['cname'] = daily_20191019_tscode_list
for table_name in daily_20191019.columns.values.tolist():
    daily_20191019_addname_dataframe[table_name] = daily_20191019[table_name]
print("daily_20191019 返回数据 row 行数 = "+str(daily_20191019.shape[0]))
daily_20191019_addname_dataframe.to_excel(daily_201910_excel_writer,'19_6',index=False)
daily_201910_excel_writer.save()
daily_20191020 = pro.daily(start_date='',end_date='',trade_date='20191020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191020_tscode_list = list() 
for ts_code_sh in daily_20191020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191020_tscode_list.append(stock_name)
daily_20191020_addname_dataframe=pd.DataFrame()
daily_20191020_addname_dataframe['cname'] = daily_20191020_tscode_list
for table_name in daily_20191020.columns.values.tolist():
    daily_20191020_addname_dataframe[table_name] = daily_20191020[table_name]
print("daily_20191020 返回数据 row 行数 = "+str(daily_20191020.shape[0]))
daily_20191020_addname_dataframe.to_excel(daily_201910_excel_writer,'20_7',index=False)
daily_201910_excel_writer.save()
daily_20191021 = pro.daily(start_date='',end_date='',trade_date='20191021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191021_tscode_list = list() 
for ts_code_sh in daily_20191021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191021_tscode_list.append(stock_name)
daily_20191021_addname_dataframe=pd.DataFrame()
daily_20191021_addname_dataframe['cname'] = daily_20191021_tscode_list
for table_name in daily_20191021.columns.values.tolist():
    daily_20191021_addname_dataframe[table_name] = daily_20191021[table_name]
print("daily_20191021 返回数据 row 行数 = "+str(daily_20191021.shape[0]))
daily_20191021_addname_dataframe.to_excel(daily_201910_excel_writer,'21_1',index=False)
daily_201910_excel_writer.save()
daily_20191022 = pro.daily(start_date='',end_date='',trade_date='20191022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191022_tscode_list = list() 
for ts_code_sh in daily_20191022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191022_tscode_list.append(stock_name)
daily_20191022_addname_dataframe=pd.DataFrame()
daily_20191022_addname_dataframe['cname'] = daily_20191022_tscode_list
for table_name in daily_20191022.columns.values.tolist():
    daily_20191022_addname_dataframe[table_name] = daily_20191022[table_name]
print("daily_20191022 返回数据 row 行数 = "+str(daily_20191022.shape[0]))
daily_20191022_addname_dataframe.to_excel(daily_201910_excel_writer,'22_2',index=False)
daily_201910_excel_writer.save()
daily_20191023 = pro.daily(start_date='',end_date='',trade_date='20191023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191023_tscode_list = list() 
for ts_code_sh in daily_20191023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191023_tscode_list.append(stock_name)
daily_20191023_addname_dataframe=pd.DataFrame()
daily_20191023_addname_dataframe['cname'] = daily_20191023_tscode_list
for table_name in daily_20191023.columns.values.tolist():
    daily_20191023_addname_dataframe[table_name] = daily_20191023[table_name]
print("daily_20191023 返回数据 row 行数 = "+str(daily_20191023.shape[0]))
daily_20191023_addname_dataframe.to_excel(daily_201910_excel_writer,'23_3',index=False)
daily_201910_excel_writer.save()
daily_20191024 = pro.daily(start_date='',end_date='',trade_date='20191024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191024_tscode_list = list() 
for ts_code_sh in daily_20191024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191024_tscode_list.append(stock_name)
daily_20191024_addname_dataframe=pd.DataFrame()
daily_20191024_addname_dataframe['cname'] = daily_20191024_tscode_list
for table_name in daily_20191024.columns.values.tolist():
    daily_20191024_addname_dataframe[table_name] = daily_20191024[table_name]
print("daily_20191024 返回数据 row 行数 = "+str(daily_20191024.shape[0]))
daily_20191024_addname_dataframe.to_excel(daily_201910_excel_writer,'24_4',index=False)
daily_201910_excel_writer.save()
daily_20191025 = pro.daily(start_date='',end_date='',trade_date='20191025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191025_tscode_list = list() 
for ts_code_sh in daily_20191025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191025_tscode_list.append(stock_name)
daily_20191025_addname_dataframe=pd.DataFrame()
daily_20191025_addname_dataframe['cname'] = daily_20191025_tscode_list
for table_name in daily_20191025.columns.values.tolist():
    daily_20191025_addname_dataframe[table_name] = daily_20191025[table_name]
print("daily_20191025 返回数据 row 行数 = "+str(daily_20191025.shape[0]))
daily_20191025_addname_dataframe.to_excel(daily_201910_excel_writer,'25_5',index=False)
daily_201910_excel_writer.save()
daily_20191026 = pro.daily(start_date='',end_date='',trade_date='20191026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191026_tscode_list = list() 
for ts_code_sh in daily_20191026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191026_tscode_list.append(stock_name)
daily_20191026_addname_dataframe=pd.DataFrame()
daily_20191026_addname_dataframe['cname'] = daily_20191026_tscode_list
for table_name in daily_20191026.columns.values.tolist():
    daily_20191026_addname_dataframe[table_name] = daily_20191026[table_name]
print("daily_20191026 返回数据 row 行数 = "+str(daily_20191026.shape[0]))
daily_20191026_addname_dataframe.to_excel(daily_201910_excel_writer,'26_6',index=False)
daily_201910_excel_writer.save()
daily_20191027 = pro.daily(start_date='',end_date='',trade_date='20191027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191027_tscode_list = list() 
for ts_code_sh in daily_20191027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191027_tscode_list.append(stock_name)
daily_20191027_addname_dataframe=pd.DataFrame()
daily_20191027_addname_dataframe['cname'] = daily_20191027_tscode_list
for table_name in daily_20191027.columns.values.tolist():
    daily_20191027_addname_dataframe[table_name] = daily_20191027[table_name]
print("daily_20191027 返回数据 row 行数 = "+str(daily_20191027.shape[0]))
daily_20191027_addname_dataframe.to_excel(daily_201910_excel_writer,'27_7',index=False)
daily_201910_excel_writer.save()
daily_20191028 = pro.daily(start_date='',end_date='',trade_date='20191028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191028_tscode_list = list() 
for ts_code_sh in daily_20191028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191028_tscode_list.append(stock_name)
daily_20191028_addname_dataframe=pd.DataFrame()
daily_20191028_addname_dataframe['cname'] = daily_20191028_tscode_list
for table_name in daily_20191028.columns.values.tolist():
    daily_20191028_addname_dataframe[table_name] = daily_20191028[table_name]
print("daily_20191028 返回数据 row 行数 = "+str(daily_20191028.shape[0]))
daily_20191028_addname_dataframe.to_excel(daily_201910_excel_writer,'28_1',index=False)
daily_201910_excel_writer.save()
daily_20191029 = pro.daily(start_date='',end_date='',trade_date='20191029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191029_tscode_list = list() 
for ts_code_sh in daily_20191029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191029_tscode_list.append(stock_name)
daily_20191029_addname_dataframe=pd.DataFrame()
daily_20191029_addname_dataframe['cname'] = daily_20191029_tscode_list
for table_name in daily_20191029.columns.values.tolist():
    daily_20191029_addname_dataframe[table_name] = daily_20191029[table_name]
print("daily_20191029 返回数据 row 行数 = "+str(daily_20191029.shape[0]))
daily_20191029_addname_dataframe.to_excel(daily_201910_excel_writer,'29_2',index=False)
daily_201910_excel_writer.save()
daily_20191030 = pro.daily(start_date='',end_date='',trade_date='20191030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191030_tscode_list = list() 
for ts_code_sh in daily_20191030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191030_tscode_list.append(stock_name)
daily_20191030_addname_dataframe=pd.DataFrame()
daily_20191030_addname_dataframe['cname'] = daily_20191030_tscode_list
for table_name in daily_20191030.columns.values.tolist():
    daily_20191030_addname_dataframe[table_name] = daily_20191030[table_name]
print("daily_20191030 返回数据 row 行数 = "+str(daily_20191030.shape[0]))
daily_20191030_addname_dataframe.to_excel(daily_201910_excel_writer,'30_3',index=False)
daily_201910_excel_writer.save()
daily_20191031 = pro.daily(start_date='',end_date='',trade_date='20191031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191031_tscode_list = list() 
for ts_code_sh in daily_20191031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191031_tscode_list.append(stock_name)
daily_20191031_addname_dataframe=pd.DataFrame()
daily_20191031_addname_dataframe['cname'] = daily_20191031_tscode_list
for table_name in daily_20191031.columns.values.tolist():
    daily_20191031_addname_dataframe[table_name] = daily_20191031[table_name]
print("daily_20191031 返回数据 row 行数 = "+str(daily_20191031.shape[0]))
daily_20191031_addname_dataframe.to_excel(daily_201910_excel_writer,'31_4',index=False)
daily_201910_excel_writer.save()




createexcel('daily_201911.xlsx')
daily_201911_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201911.xlsx')
daily_201911_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201911.xlsx', engine='openpyxl')
daily_201911_excel_writer.book = daily_201911_book
daily_201911_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201911_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20191101")       ###  更新 记录日期
daily_20191101 = pro.daily(start_date='',end_date='',trade_date='20191101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191101_tscode_list = list() 
for ts_code_sh in daily_20191101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191101_tscode_list.append(stock_name)
daily_20191101_addname_dataframe=pd.DataFrame()
daily_20191101_addname_dataframe['cname'] = daily_20191101_tscode_list
for table_name in daily_20191101.columns.values.tolist():
    daily_20191101_addname_dataframe[table_name] = daily_20191101[table_name]
print("daily_20191101 返回数据 row 行数 = "+str(daily_20191101.shape[0]))
daily_20191101_addname_dataframe.to_excel(daily_201911_excel_writer,'1_5',index=False)
daily_201911_excel_writer.save()
daily_20191102 = pro.daily(start_date='',end_date='',trade_date='20191102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191102_tscode_list = list() 
for ts_code_sh in daily_20191102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191102_tscode_list.append(stock_name)
daily_20191102_addname_dataframe=pd.DataFrame()
daily_20191102_addname_dataframe['cname'] = daily_20191102_tscode_list
for table_name in daily_20191102.columns.values.tolist():
    daily_20191102_addname_dataframe[table_name] = daily_20191102[table_name]
print("daily_20191102 返回数据 row 行数 = "+str(daily_20191102.shape[0]))
daily_20191102_addname_dataframe.to_excel(daily_201911_excel_writer,'2_6',index=False)
daily_201911_excel_writer.save()
daily_20191103 = pro.daily(start_date='',end_date='',trade_date='20191103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191103_tscode_list = list() 
for ts_code_sh in daily_20191103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191103_tscode_list.append(stock_name)
daily_20191103_addname_dataframe=pd.DataFrame()
daily_20191103_addname_dataframe['cname'] = daily_20191103_tscode_list
for table_name in daily_20191103.columns.values.tolist():
    daily_20191103_addname_dataframe[table_name] = daily_20191103[table_name]
print("daily_20191103 返回数据 row 行数 = "+str(daily_20191103.shape[0]))
daily_20191103_addname_dataframe.to_excel(daily_201911_excel_writer,'3_7',index=False)
daily_201911_excel_writer.save()
daily_20191104 = pro.daily(start_date='',end_date='',trade_date='20191104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191104_tscode_list = list() 
for ts_code_sh in daily_20191104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191104_tscode_list.append(stock_name)
daily_20191104_addname_dataframe=pd.DataFrame()
daily_20191104_addname_dataframe['cname'] = daily_20191104_tscode_list
for table_name in daily_20191104.columns.values.tolist():
    daily_20191104_addname_dataframe[table_name] = daily_20191104[table_name]
print("daily_20191104 返回数据 row 行数 = "+str(daily_20191104.shape[0]))
daily_20191104_addname_dataframe.to_excel(daily_201911_excel_writer,'4_1',index=False)
daily_201911_excel_writer.save()
daily_20191105 = pro.daily(start_date='',end_date='',trade_date='20191105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191105_tscode_list = list() 
for ts_code_sh in daily_20191105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191105_tscode_list.append(stock_name)
daily_20191105_addname_dataframe=pd.DataFrame()
daily_20191105_addname_dataframe['cname'] = daily_20191105_tscode_list
for table_name in daily_20191105.columns.values.tolist():
    daily_20191105_addname_dataframe[table_name] = daily_20191105[table_name]
print("daily_20191105 返回数据 row 行数 = "+str(daily_20191105.shape[0]))
daily_20191105_addname_dataframe.to_excel(daily_201911_excel_writer,'5_2',index=False)
daily_201911_excel_writer.save()
daily_20191106 = pro.daily(start_date='',end_date='',trade_date='20191106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191106_tscode_list = list() 
for ts_code_sh in daily_20191106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191106_tscode_list.append(stock_name)
daily_20191106_addname_dataframe=pd.DataFrame()
daily_20191106_addname_dataframe['cname'] = daily_20191106_tscode_list
for table_name in daily_20191106.columns.values.tolist():
    daily_20191106_addname_dataframe[table_name] = daily_20191106[table_name]
print("daily_20191106 返回数据 row 行数 = "+str(daily_20191106.shape[0]))
daily_20191106_addname_dataframe.to_excel(daily_201911_excel_writer,'6_3',index=False)
daily_201911_excel_writer.save()
daily_20191107 = pro.daily(start_date='',end_date='',trade_date='20191107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191107_tscode_list = list() 
for ts_code_sh in daily_20191107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191107_tscode_list.append(stock_name)
daily_20191107_addname_dataframe=pd.DataFrame()
daily_20191107_addname_dataframe['cname'] = daily_20191107_tscode_list
for table_name in daily_20191107.columns.values.tolist():
    daily_20191107_addname_dataframe[table_name] = daily_20191107[table_name]
print("daily_20191107 返回数据 row 行数 = "+str(daily_20191107.shape[0]))
daily_20191107_addname_dataframe.to_excel(daily_201911_excel_writer,'7_4',index=False)
daily_201911_excel_writer.save()
daily_20191108 = pro.daily(start_date='',end_date='',trade_date='20191108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191108_tscode_list = list() 
for ts_code_sh in daily_20191108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191108_tscode_list.append(stock_name)
daily_20191108_addname_dataframe=pd.DataFrame()
daily_20191108_addname_dataframe['cname'] = daily_20191108_tscode_list
for table_name in daily_20191108.columns.values.tolist():
    daily_20191108_addname_dataframe[table_name] = daily_20191108[table_name]
print("daily_20191108 返回数据 row 行数 = "+str(daily_20191108.shape[0]))
daily_20191108_addname_dataframe.to_excel(daily_201911_excel_writer,'8_5',index=False)
daily_201911_excel_writer.save()
daily_20191109 = pro.daily(start_date='',end_date='',trade_date='20191109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191109_tscode_list = list() 
for ts_code_sh in daily_20191109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191109_tscode_list.append(stock_name)
daily_20191109_addname_dataframe=pd.DataFrame()
daily_20191109_addname_dataframe['cname'] = daily_20191109_tscode_list
for table_name in daily_20191109.columns.values.tolist():
    daily_20191109_addname_dataframe[table_name] = daily_20191109[table_name]
print("daily_20191109 返回数据 row 行数 = "+str(daily_20191109.shape[0]))
daily_20191109_addname_dataframe.to_excel(daily_201911_excel_writer,'9_6',index=False)
daily_201911_excel_writer.save()
daily_20191110 = pro.daily(start_date='',end_date='',trade_date='20191110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191110_tscode_list = list() 
for ts_code_sh in daily_20191110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191110_tscode_list.append(stock_name)
daily_20191110_addname_dataframe=pd.DataFrame()
daily_20191110_addname_dataframe['cname'] = daily_20191110_tscode_list
for table_name in daily_20191110.columns.values.tolist():
    daily_20191110_addname_dataframe[table_name] = daily_20191110[table_name]
print("daily_20191110 返回数据 row 行数 = "+str(daily_20191110.shape[0]))
daily_20191110_addname_dataframe.to_excel(daily_201911_excel_writer,'10_7',index=False)
daily_201911_excel_writer.save()
daily_20191111 = pro.daily(start_date='',end_date='',trade_date='20191111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191111_tscode_list = list() 
for ts_code_sh in daily_20191111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191111_tscode_list.append(stock_name)
daily_20191111_addname_dataframe=pd.DataFrame()
daily_20191111_addname_dataframe['cname'] = daily_20191111_tscode_list
for table_name in daily_20191111.columns.values.tolist():
    daily_20191111_addname_dataframe[table_name] = daily_20191111[table_name]
print("daily_20191111 返回数据 row 行数 = "+str(daily_20191111.shape[0]))
daily_20191111_addname_dataframe.to_excel(daily_201911_excel_writer,'11_1',index=False)
daily_201911_excel_writer.save()
daily_20191112 = pro.daily(start_date='',end_date='',trade_date='20191112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191112_tscode_list = list() 
for ts_code_sh in daily_20191112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191112_tscode_list.append(stock_name)
daily_20191112_addname_dataframe=pd.DataFrame()
daily_20191112_addname_dataframe['cname'] = daily_20191112_tscode_list
for table_name in daily_20191112.columns.values.tolist():
    daily_20191112_addname_dataframe[table_name] = daily_20191112[table_name]
print("daily_20191112 返回数据 row 行数 = "+str(daily_20191112.shape[0]))
daily_20191112_addname_dataframe.to_excel(daily_201911_excel_writer,'12_2',index=False)
daily_201911_excel_writer.save()
daily_20191113 = pro.daily(start_date='',end_date='',trade_date='20191113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191113_tscode_list = list() 
for ts_code_sh in daily_20191113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191113_tscode_list.append(stock_name)
daily_20191113_addname_dataframe=pd.DataFrame()
daily_20191113_addname_dataframe['cname'] = daily_20191113_tscode_list
for table_name in daily_20191113.columns.values.tolist():
    daily_20191113_addname_dataframe[table_name] = daily_20191113[table_name]
print("daily_20191113 返回数据 row 行数 = "+str(daily_20191113.shape[0]))
daily_20191113_addname_dataframe.to_excel(daily_201911_excel_writer,'13_3',index=False)
daily_201911_excel_writer.save()
daily_20191114 = pro.daily(start_date='',end_date='',trade_date='20191114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191114_tscode_list = list() 
for ts_code_sh in daily_20191114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191114_tscode_list.append(stock_name)
daily_20191114_addname_dataframe=pd.DataFrame()
daily_20191114_addname_dataframe['cname'] = daily_20191114_tscode_list
for table_name in daily_20191114.columns.values.tolist():
    daily_20191114_addname_dataframe[table_name] = daily_20191114[table_name]
print("daily_20191114 返回数据 row 行数 = "+str(daily_20191114.shape[0]))
daily_20191114_addname_dataframe.to_excel(daily_201911_excel_writer,'14_4',index=False)
daily_201911_excel_writer.save()
daily_20191115 = pro.daily(start_date='',end_date='',trade_date='20191115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191115_tscode_list = list() 
for ts_code_sh in daily_20191115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191115_tscode_list.append(stock_name)
daily_20191115_addname_dataframe=pd.DataFrame()
daily_20191115_addname_dataframe['cname'] = daily_20191115_tscode_list
for table_name in daily_20191115.columns.values.tolist():
    daily_20191115_addname_dataframe[table_name] = daily_20191115[table_name]
print("daily_20191115 返回数据 row 行数 = "+str(daily_20191115.shape[0]))
daily_20191115_addname_dataframe.to_excel(daily_201911_excel_writer,'15_5',index=False)
daily_201911_excel_writer.save()
daily_20191116 = pro.daily(start_date='',end_date='',trade_date='20191116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191116_tscode_list = list() 
for ts_code_sh in daily_20191116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191116_tscode_list.append(stock_name)
daily_20191116_addname_dataframe=pd.DataFrame()
daily_20191116_addname_dataframe['cname'] = daily_20191116_tscode_list
for table_name in daily_20191116.columns.values.tolist():
    daily_20191116_addname_dataframe[table_name] = daily_20191116[table_name]
print("daily_20191116 返回数据 row 行数 = "+str(daily_20191116.shape[0]))
daily_20191116_addname_dataframe.to_excel(daily_201911_excel_writer,'16_6',index=False)
daily_201911_excel_writer.save()
daily_20191117 = pro.daily(start_date='',end_date='',trade_date='20191117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191117_tscode_list = list() 
for ts_code_sh in daily_20191117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191117_tscode_list.append(stock_name)
daily_20191117_addname_dataframe=pd.DataFrame()
daily_20191117_addname_dataframe['cname'] = daily_20191117_tscode_list
for table_name in daily_20191117.columns.values.tolist():
    daily_20191117_addname_dataframe[table_name] = daily_20191117[table_name]
print("daily_20191117 返回数据 row 行数 = "+str(daily_20191117.shape[0]))
daily_20191117_addname_dataframe.to_excel(daily_201911_excel_writer,'17_7',index=False)
daily_201911_excel_writer.save()
daily_20191118 = pro.daily(start_date='',end_date='',trade_date='20191118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191118_tscode_list = list() 
for ts_code_sh in daily_20191118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191118_tscode_list.append(stock_name)
daily_20191118_addname_dataframe=pd.DataFrame()
daily_20191118_addname_dataframe['cname'] = daily_20191118_tscode_list
for table_name in daily_20191118.columns.values.tolist():
    daily_20191118_addname_dataframe[table_name] = daily_20191118[table_name]
print("daily_20191118 返回数据 row 行数 = "+str(daily_20191118.shape[0]))
daily_20191118_addname_dataframe.to_excel(daily_201911_excel_writer,'18_1',index=False)
daily_201911_excel_writer.save()
daily_20191119 = pro.daily(start_date='',end_date='',trade_date='20191119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191119_tscode_list = list() 
for ts_code_sh in daily_20191119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191119_tscode_list.append(stock_name)
daily_20191119_addname_dataframe=pd.DataFrame()
daily_20191119_addname_dataframe['cname'] = daily_20191119_tscode_list
for table_name in daily_20191119.columns.values.tolist():
    daily_20191119_addname_dataframe[table_name] = daily_20191119[table_name]
print("daily_20191119 返回数据 row 行数 = "+str(daily_20191119.shape[0]))
daily_20191119_addname_dataframe.to_excel(daily_201911_excel_writer,'19_2',index=False)
daily_201911_excel_writer.save()
daily_20191120 = pro.daily(start_date='',end_date='',trade_date='20191120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191120_tscode_list = list() 
for ts_code_sh in daily_20191120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191120_tscode_list.append(stock_name)
daily_20191120_addname_dataframe=pd.DataFrame()
daily_20191120_addname_dataframe['cname'] = daily_20191120_tscode_list
for table_name in daily_20191120.columns.values.tolist():
    daily_20191120_addname_dataframe[table_name] = daily_20191120[table_name]
print("daily_20191120 返回数据 row 行数 = "+str(daily_20191120.shape[0]))
daily_20191120_addname_dataframe.to_excel(daily_201911_excel_writer,'20_3',index=False)
daily_201911_excel_writer.save()
daily_20191121 = pro.daily(start_date='',end_date='',trade_date='20191121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191121_tscode_list = list() 
for ts_code_sh in daily_20191121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191121_tscode_list.append(stock_name)
daily_20191121_addname_dataframe=pd.DataFrame()
daily_20191121_addname_dataframe['cname'] = daily_20191121_tscode_list
for table_name in daily_20191121.columns.values.tolist():
    daily_20191121_addname_dataframe[table_name] = daily_20191121[table_name]
print("daily_20191121 返回数据 row 行数 = "+str(daily_20191121.shape[0]))
daily_20191121_addname_dataframe.to_excel(daily_201911_excel_writer,'21_4',index=False)
daily_201911_excel_writer.save()
daily_20191122 = pro.daily(start_date='',end_date='',trade_date='20191122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191122_tscode_list = list() 
for ts_code_sh in daily_20191122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191122_tscode_list.append(stock_name)
daily_20191122_addname_dataframe=pd.DataFrame()
daily_20191122_addname_dataframe['cname'] = daily_20191122_tscode_list
for table_name in daily_20191122.columns.values.tolist():
    daily_20191122_addname_dataframe[table_name] = daily_20191122[table_name]
print("daily_20191122 返回数据 row 行数 = "+str(daily_20191122.shape[0]))
daily_20191122_addname_dataframe.to_excel(daily_201911_excel_writer,'22_5',index=False)
daily_201911_excel_writer.save()
daily_20191123 = pro.daily(start_date='',end_date='',trade_date='20191123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191123_tscode_list = list() 
for ts_code_sh in daily_20191123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191123_tscode_list.append(stock_name)
daily_20191123_addname_dataframe=pd.DataFrame()
daily_20191123_addname_dataframe['cname'] = daily_20191123_tscode_list
for table_name in daily_20191123.columns.values.tolist():
    daily_20191123_addname_dataframe[table_name] = daily_20191123[table_name]
print("daily_20191123 返回数据 row 行数 = "+str(daily_20191123.shape[0]))
daily_20191123_addname_dataframe.to_excel(daily_201911_excel_writer,'23_6',index=False)
daily_201911_excel_writer.save()
daily_20191124 = pro.daily(start_date='',end_date='',trade_date='20191124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191124_tscode_list = list() 
for ts_code_sh in daily_20191124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191124_tscode_list.append(stock_name)
daily_20191124_addname_dataframe=pd.DataFrame()
daily_20191124_addname_dataframe['cname'] = daily_20191124_tscode_list
for table_name in daily_20191124.columns.values.tolist():
    daily_20191124_addname_dataframe[table_name] = daily_20191124[table_name]
print("daily_20191124 返回数据 row 行数 = "+str(daily_20191124.shape[0]))
daily_20191124_addname_dataframe.to_excel(daily_201911_excel_writer,'24_7',index=False)
daily_201911_excel_writer.save()
daily_20191125 = pro.daily(start_date='',end_date='',trade_date='20191125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191125_tscode_list = list() 
for ts_code_sh in daily_20191125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191125_tscode_list.append(stock_name)
daily_20191125_addname_dataframe=pd.DataFrame()
daily_20191125_addname_dataframe['cname'] = daily_20191125_tscode_list
for table_name in daily_20191125.columns.values.tolist():
    daily_20191125_addname_dataframe[table_name] = daily_20191125[table_name]
print("daily_20191125 返回数据 row 行数 = "+str(daily_20191125.shape[0]))
daily_20191125_addname_dataframe.to_excel(daily_201911_excel_writer,'25_1',index=False)
daily_201911_excel_writer.save()
daily_20191126 = pro.daily(start_date='',end_date='',trade_date='20191126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191126_tscode_list = list() 
for ts_code_sh in daily_20191126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191126_tscode_list.append(stock_name)
daily_20191126_addname_dataframe=pd.DataFrame()
daily_20191126_addname_dataframe['cname'] = daily_20191126_tscode_list
for table_name in daily_20191126.columns.values.tolist():
    daily_20191126_addname_dataframe[table_name] = daily_20191126[table_name]
print("daily_20191126 返回数据 row 行数 = "+str(daily_20191126.shape[0]))
daily_20191126_addname_dataframe.to_excel(daily_201911_excel_writer,'26_2',index=False)
daily_201911_excel_writer.save()
daily_20191127 = pro.daily(start_date='',end_date='',trade_date='20191127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191127_tscode_list = list() 
for ts_code_sh in daily_20191127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191127_tscode_list.append(stock_name)
daily_20191127_addname_dataframe=pd.DataFrame()
daily_20191127_addname_dataframe['cname'] = daily_20191127_tscode_list
for table_name in daily_20191127.columns.values.tolist():
    daily_20191127_addname_dataframe[table_name] = daily_20191127[table_name]
print("daily_20191127 返回数据 row 行数 = "+str(daily_20191127.shape[0]))
daily_20191127_addname_dataframe.to_excel(daily_201911_excel_writer,'27_3',index=False)
daily_201911_excel_writer.save()
daily_20191128 = pro.daily(start_date='',end_date='',trade_date='20191128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191128_tscode_list = list() 
for ts_code_sh in daily_20191128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191128_tscode_list.append(stock_name)
daily_20191128_addname_dataframe=pd.DataFrame()
daily_20191128_addname_dataframe['cname'] = daily_20191128_tscode_list
for table_name in daily_20191128.columns.values.tolist():
    daily_20191128_addname_dataframe[table_name] = daily_20191128[table_name]
print("daily_20191128 返回数据 row 行数 = "+str(daily_20191128.shape[0]))
daily_20191128_addname_dataframe.to_excel(daily_201911_excel_writer,'28_4',index=False)
daily_201911_excel_writer.save()
daily_20191129 = pro.daily(start_date='',end_date='',trade_date='20191129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191129_tscode_list = list() 
for ts_code_sh in daily_20191129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191129_tscode_list.append(stock_name)
daily_20191129_addname_dataframe=pd.DataFrame()
daily_20191129_addname_dataframe['cname'] = daily_20191129_tscode_list
for table_name in daily_20191129.columns.values.tolist():
    daily_20191129_addname_dataframe[table_name] = daily_20191129[table_name]
print("daily_20191129 返回数据 row 行数 = "+str(daily_20191129.shape[0]))
daily_20191129_addname_dataframe.to_excel(daily_201911_excel_writer,'29_5',index=False)
daily_201911_excel_writer.save()
daily_20191130 = pro.daily(start_date='',end_date='',trade_date='20191130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191130_tscode_list = list() 
for ts_code_sh in daily_20191130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191130_tscode_list.append(stock_name)
daily_20191130_addname_dataframe=pd.DataFrame()
daily_20191130_addname_dataframe['cname'] = daily_20191130_tscode_list
for table_name in daily_20191130.columns.values.tolist():
    daily_20191130_addname_dataframe[table_name] = daily_20191130[table_name]
print("daily_20191130 返回数据 row 行数 = "+str(daily_20191130.shape[0]))
daily_20191130_addname_dataframe.to_excel(daily_201911_excel_writer,'30_6',index=False)
daily_201911_excel_writer.save()




createexcel('daily_201912.xlsx')
daily_201912_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201912.xlsx')
daily_201912_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_201912.xlsx', engine='openpyxl')
daily_201912_excel_writer.book = daily_201912_book
daily_201912_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201912_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20191201")       ###  更新 记录日期
daily_20191201 = pro.daily(start_date='',end_date='',trade_date='20191201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191201_tscode_list = list() 
for ts_code_sh in daily_20191201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191201_tscode_list.append(stock_name)
daily_20191201_addname_dataframe=pd.DataFrame()
daily_20191201_addname_dataframe['cname'] = daily_20191201_tscode_list
for table_name in daily_20191201.columns.values.tolist():
    daily_20191201_addname_dataframe[table_name] = daily_20191201[table_name]
print("daily_20191201 返回数据 row 行数 = "+str(daily_20191201.shape[0]))
daily_20191201_addname_dataframe.to_excel(daily_201912_excel_writer,'1_7',index=False)
daily_201912_excel_writer.save()
daily_20191202 = pro.daily(start_date='',end_date='',trade_date='20191202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191202_tscode_list = list() 
for ts_code_sh in daily_20191202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191202_tscode_list.append(stock_name)
daily_20191202_addname_dataframe=pd.DataFrame()
daily_20191202_addname_dataframe['cname'] = daily_20191202_tscode_list
for table_name in daily_20191202.columns.values.tolist():
    daily_20191202_addname_dataframe[table_name] = daily_20191202[table_name]
print("daily_20191202 返回数据 row 行数 = "+str(daily_20191202.shape[0]))
daily_20191202_addname_dataframe.to_excel(daily_201912_excel_writer,'2_1',index=False)
daily_201912_excel_writer.save()
daily_20191203 = pro.daily(start_date='',end_date='',trade_date='20191203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191203_tscode_list = list() 
for ts_code_sh in daily_20191203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191203_tscode_list.append(stock_name)
daily_20191203_addname_dataframe=pd.DataFrame()
daily_20191203_addname_dataframe['cname'] = daily_20191203_tscode_list
for table_name in daily_20191203.columns.values.tolist():
    daily_20191203_addname_dataframe[table_name] = daily_20191203[table_name]
print("daily_20191203 返回数据 row 行数 = "+str(daily_20191203.shape[0]))
daily_20191203_addname_dataframe.to_excel(daily_201912_excel_writer,'3_2',index=False)
daily_201912_excel_writer.save()
daily_20191204 = pro.daily(start_date='',end_date='',trade_date='20191204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191204_tscode_list = list() 
for ts_code_sh in daily_20191204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191204_tscode_list.append(stock_name)
daily_20191204_addname_dataframe=pd.DataFrame()
daily_20191204_addname_dataframe['cname'] = daily_20191204_tscode_list
for table_name in daily_20191204.columns.values.tolist():
    daily_20191204_addname_dataframe[table_name] = daily_20191204[table_name]
print("daily_20191204 返回数据 row 行数 = "+str(daily_20191204.shape[0]))
daily_20191204_addname_dataframe.to_excel(daily_201912_excel_writer,'4_3',index=False)
daily_201912_excel_writer.save()
daily_20191205 = pro.daily(start_date='',end_date='',trade_date='20191205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191205_tscode_list = list() 
for ts_code_sh in daily_20191205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191205_tscode_list.append(stock_name)
daily_20191205_addname_dataframe=pd.DataFrame()
daily_20191205_addname_dataframe['cname'] = daily_20191205_tscode_list
for table_name in daily_20191205.columns.values.tolist():
    daily_20191205_addname_dataframe[table_name] = daily_20191205[table_name]
print("daily_20191205 返回数据 row 行数 = "+str(daily_20191205.shape[0]))
daily_20191205_addname_dataframe.to_excel(daily_201912_excel_writer,'5_4',index=False)
daily_201912_excel_writer.save()
daily_20191206 = pro.daily(start_date='',end_date='',trade_date='20191206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191206_tscode_list = list() 
for ts_code_sh in daily_20191206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191206_tscode_list.append(stock_name)
daily_20191206_addname_dataframe=pd.DataFrame()
daily_20191206_addname_dataframe['cname'] = daily_20191206_tscode_list
for table_name in daily_20191206.columns.values.tolist():
    daily_20191206_addname_dataframe[table_name] = daily_20191206[table_name]
print("daily_20191206 返回数据 row 行数 = "+str(daily_20191206.shape[0]))
daily_20191206_addname_dataframe.to_excel(daily_201912_excel_writer,'6_5',index=False)
daily_201912_excel_writer.save()
daily_20191207 = pro.daily(start_date='',end_date='',trade_date='20191207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191207_tscode_list = list() 
for ts_code_sh in daily_20191207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191207_tscode_list.append(stock_name)
daily_20191207_addname_dataframe=pd.DataFrame()
daily_20191207_addname_dataframe['cname'] = daily_20191207_tscode_list
for table_name in daily_20191207.columns.values.tolist():
    daily_20191207_addname_dataframe[table_name] = daily_20191207[table_name]
print("daily_20191207 返回数据 row 行数 = "+str(daily_20191207.shape[0]))
daily_20191207_addname_dataframe.to_excel(daily_201912_excel_writer,'7_6',index=False)
daily_201912_excel_writer.save()
daily_20191208 = pro.daily(start_date='',end_date='',trade_date='20191208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191208_tscode_list = list() 
for ts_code_sh in daily_20191208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191208_tscode_list.append(stock_name)
daily_20191208_addname_dataframe=pd.DataFrame()
daily_20191208_addname_dataframe['cname'] = daily_20191208_tscode_list
for table_name in daily_20191208.columns.values.tolist():
    daily_20191208_addname_dataframe[table_name] = daily_20191208[table_name]
print("daily_20191208 返回数据 row 行数 = "+str(daily_20191208.shape[0]))
daily_20191208_addname_dataframe.to_excel(daily_201912_excel_writer,'8_7',index=False)
daily_201912_excel_writer.save()
daily_20191209 = pro.daily(start_date='',end_date='',trade_date='20191209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191209_tscode_list = list() 
for ts_code_sh in daily_20191209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191209_tscode_list.append(stock_name)
daily_20191209_addname_dataframe=pd.DataFrame()
daily_20191209_addname_dataframe['cname'] = daily_20191209_tscode_list
for table_name in daily_20191209.columns.values.tolist():
    daily_20191209_addname_dataframe[table_name] = daily_20191209[table_name]
print("daily_20191209 返回数据 row 行数 = "+str(daily_20191209.shape[0]))
daily_20191209_addname_dataframe.to_excel(daily_201912_excel_writer,'9_1',index=False)
daily_201912_excel_writer.save()
daily_20191210 = pro.daily(start_date='',end_date='',trade_date='20191210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191210_tscode_list = list() 
for ts_code_sh in daily_20191210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191210_tscode_list.append(stock_name)
daily_20191210_addname_dataframe=pd.DataFrame()
daily_20191210_addname_dataframe['cname'] = daily_20191210_tscode_list
for table_name in daily_20191210.columns.values.tolist():
    daily_20191210_addname_dataframe[table_name] = daily_20191210[table_name]
print("daily_20191210 返回数据 row 行数 = "+str(daily_20191210.shape[0]))
daily_20191210_addname_dataframe.to_excel(daily_201912_excel_writer,'10_2',index=False)
daily_201912_excel_writer.save()
daily_20191211 = pro.daily(start_date='',end_date='',trade_date='20191211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191211_tscode_list = list() 
for ts_code_sh in daily_20191211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191211_tscode_list.append(stock_name)
daily_20191211_addname_dataframe=pd.DataFrame()
daily_20191211_addname_dataframe['cname'] = daily_20191211_tscode_list
for table_name in daily_20191211.columns.values.tolist():
    daily_20191211_addname_dataframe[table_name] = daily_20191211[table_name]
print("daily_20191211 返回数据 row 行数 = "+str(daily_20191211.shape[0]))
daily_20191211_addname_dataframe.to_excel(daily_201912_excel_writer,'11_3',index=False)
daily_201912_excel_writer.save()
daily_20191212 = pro.daily(start_date='',end_date='',trade_date='20191212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191212_tscode_list = list() 
for ts_code_sh in daily_20191212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191212_tscode_list.append(stock_name)
daily_20191212_addname_dataframe=pd.DataFrame()
daily_20191212_addname_dataframe['cname'] = daily_20191212_tscode_list
for table_name in daily_20191212.columns.values.tolist():
    daily_20191212_addname_dataframe[table_name] = daily_20191212[table_name]
print("daily_20191212 返回数据 row 行数 = "+str(daily_20191212.shape[0]))
daily_20191212_addname_dataframe.to_excel(daily_201912_excel_writer,'12_4',index=False)
daily_201912_excel_writer.save()
daily_20191213 = pro.daily(start_date='',end_date='',trade_date='20191213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191213_tscode_list = list() 
for ts_code_sh in daily_20191213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191213_tscode_list.append(stock_name)
daily_20191213_addname_dataframe=pd.DataFrame()
daily_20191213_addname_dataframe['cname'] = daily_20191213_tscode_list
for table_name in daily_20191213.columns.values.tolist():
    daily_20191213_addname_dataframe[table_name] = daily_20191213[table_name]
print("daily_20191213 返回数据 row 行数 = "+str(daily_20191213.shape[0]))
daily_20191213_addname_dataframe.to_excel(daily_201912_excel_writer,'13_5',index=False)
daily_201912_excel_writer.save()
daily_20191214 = pro.daily(start_date='',end_date='',trade_date='20191214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191214_tscode_list = list() 
for ts_code_sh in daily_20191214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191214_tscode_list.append(stock_name)
daily_20191214_addname_dataframe=pd.DataFrame()
daily_20191214_addname_dataframe['cname'] = daily_20191214_tscode_list
for table_name in daily_20191214.columns.values.tolist():
    daily_20191214_addname_dataframe[table_name] = daily_20191214[table_name]
print("daily_20191214 返回数据 row 行数 = "+str(daily_20191214.shape[0]))
daily_20191214_addname_dataframe.to_excel(daily_201912_excel_writer,'14_6',index=False)
daily_201912_excel_writer.save()
daily_20191215 = pro.daily(start_date='',end_date='',trade_date='20191215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191215_tscode_list = list() 
for ts_code_sh in daily_20191215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191215_tscode_list.append(stock_name)
daily_20191215_addname_dataframe=pd.DataFrame()
daily_20191215_addname_dataframe['cname'] = daily_20191215_tscode_list
for table_name in daily_20191215.columns.values.tolist():
    daily_20191215_addname_dataframe[table_name] = daily_20191215[table_name]
print("daily_20191215 返回数据 row 行数 = "+str(daily_20191215.shape[0]))
daily_20191215_addname_dataframe.to_excel(daily_201912_excel_writer,'15_7',index=False)
daily_201912_excel_writer.save()
daily_20191216 = pro.daily(start_date='',end_date='',trade_date='20191216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191216_tscode_list = list() 
for ts_code_sh in daily_20191216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191216_tscode_list.append(stock_name)
daily_20191216_addname_dataframe=pd.DataFrame()
daily_20191216_addname_dataframe['cname'] = daily_20191216_tscode_list
for table_name in daily_20191216.columns.values.tolist():
    daily_20191216_addname_dataframe[table_name] = daily_20191216[table_name]
print("daily_20191216 返回数据 row 行数 = "+str(daily_20191216.shape[0]))
daily_20191216_addname_dataframe.to_excel(daily_201912_excel_writer,'16_1',index=False)
daily_201912_excel_writer.save()
daily_20191217 = pro.daily(start_date='',end_date='',trade_date='20191217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191217_tscode_list = list() 
for ts_code_sh in daily_20191217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191217_tscode_list.append(stock_name)
daily_20191217_addname_dataframe=pd.DataFrame()
daily_20191217_addname_dataframe['cname'] = daily_20191217_tscode_list
for table_name in daily_20191217.columns.values.tolist():
    daily_20191217_addname_dataframe[table_name] = daily_20191217[table_name]
print("daily_20191217 返回数据 row 行数 = "+str(daily_20191217.shape[0]))
daily_20191217_addname_dataframe.to_excel(daily_201912_excel_writer,'17_2',index=False)
daily_201912_excel_writer.save()
daily_20191218 = pro.daily(start_date='',end_date='',trade_date='20191218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191218_tscode_list = list() 
for ts_code_sh in daily_20191218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191218_tscode_list.append(stock_name)
daily_20191218_addname_dataframe=pd.DataFrame()
daily_20191218_addname_dataframe['cname'] = daily_20191218_tscode_list
for table_name in daily_20191218.columns.values.tolist():
    daily_20191218_addname_dataframe[table_name] = daily_20191218[table_name]
print("daily_20191218 返回数据 row 行数 = "+str(daily_20191218.shape[0]))
daily_20191218_addname_dataframe.to_excel(daily_201912_excel_writer,'18_3',index=False)
daily_201912_excel_writer.save()
daily_20191219 = pro.daily(start_date='',end_date='',trade_date='20191219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191219_tscode_list = list() 
for ts_code_sh in daily_20191219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191219_tscode_list.append(stock_name)
daily_20191219_addname_dataframe=pd.DataFrame()
daily_20191219_addname_dataframe['cname'] = daily_20191219_tscode_list
for table_name in daily_20191219.columns.values.tolist():
    daily_20191219_addname_dataframe[table_name] = daily_20191219[table_name]
print("daily_20191219 返回数据 row 行数 = "+str(daily_20191219.shape[0]))
daily_20191219_addname_dataframe.to_excel(daily_201912_excel_writer,'19_4',index=False)
daily_201912_excel_writer.save()
daily_20191220 = pro.daily(start_date='',end_date='',trade_date='20191220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191220_tscode_list = list() 
for ts_code_sh in daily_20191220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191220_tscode_list.append(stock_name)
daily_20191220_addname_dataframe=pd.DataFrame()
daily_20191220_addname_dataframe['cname'] = daily_20191220_tscode_list
for table_name in daily_20191220.columns.values.tolist():
    daily_20191220_addname_dataframe[table_name] = daily_20191220[table_name]
print("daily_20191220 返回数据 row 行数 = "+str(daily_20191220.shape[0]))
daily_20191220_addname_dataframe.to_excel(daily_201912_excel_writer,'20_5',index=False)
daily_201912_excel_writer.save()
daily_20191221 = pro.daily(start_date='',end_date='',trade_date='20191221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191221_tscode_list = list() 
for ts_code_sh in daily_20191221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191221_tscode_list.append(stock_name)
daily_20191221_addname_dataframe=pd.DataFrame()
daily_20191221_addname_dataframe['cname'] = daily_20191221_tscode_list
for table_name in daily_20191221.columns.values.tolist():
    daily_20191221_addname_dataframe[table_name] = daily_20191221[table_name]
print("daily_20191221 返回数据 row 行数 = "+str(daily_20191221.shape[0]))
daily_20191221_addname_dataframe.to_excel(daily_201912_excel_writer,'21_6',index=False)
daily_201912_excel_writer.save()
daily_20191222 = pro.daily(start_date='',end_date='',trade_date='20191222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191222_tscode_list = list() 
for ts_code_sh in daily_20191222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191222_tscode_list.append(stock_name)
daily_20191222_addname_dataframe=pd.DataFrame()
daily_20191222_addname_dataframe['cname'] = daily_20191222_tscode_list
for table_name in daily_20191222.columns.values.tolist():
    daily_20191222_addname_dataframe[table_name] = daily_20191222[table_name]
print("daily_20191222 返回数据 row 行数 = "+str(daily_20191222.shape[0]))
daily_20191222_addname_dataframe.to_excel(daily_201912_excel_writer,'22_7',index=False)
daily_201912_excel_writer.save()
daily_20191223 = pro.daily(start_date='',end_date='',trade_date='20191223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191223_tscode_list = list() 
for ts_code_sh in daily_20191223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191223_tscode_list.append(stock_name)
daily_20191223_addname_dataframe=pd.DataFrame()
daily_20191223_addname_dataframe['cname'] = daily_20191223_tscode_list
for table_name in daily_20191223.columns.values.tolist():
    daily_20191223_addname_dataframe[table_name] = daily_20191223[table_name]
print("daily_20191223 返回数据 row 行数 = "+str(daily_20191223.shape[0]))
daily_20191223_addname_dataframe.to_excel(daily_201912_excel_writer,'23_1',index=False)
daily_201912_excel_writer.save()
daily_20191224 = pro.daily(start_date='',end_date='',trade_date='20191224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191224_tscode_list = list() 
for ts_code_sh in daily_20191224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191224_tscode_list.append(stock_name)
daily_20191224_addname_dataframe=pd.DataFrame()
daily_20191224_addname_dataframe['cname'] = daily_20191224_tscode_list
for table_name in daily_20191224.columns.values.tolist():
    daily_20191224_addname_dataframe[table_name] = daily_20191224[table_name]
print("daily_20191224 返回数据 row 行数 = "+str(daily_20191224.shape[0]))
daily_20191224_addname_dataframe.to_excel(daily_201912_excel_writer,'24_2',index=False)
daily_201912_excel_writer.save()
daily_20191225 = pro.daily(start_date='',end_date='',trade_date='20191225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191225_tscode_list = list() 
for ts_code_sh in daily_20191225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191225_tscode_list.append(stock_name)
daily_20191225_addname_dataframe=pd.DataFrame()
daily_20191225_addname_dataframe['cname'] = daily_20191225_tscode_list
for table_name in daily_20191225.columns.values.tolist():
    daily_20191225_addname_dataframe[table_name] = daily_20191225[table_name]
print("daily_20191225 返回数据 row 行数 = "+str(daily_20191225.shape[0]))
daily_20191225_addname_dataframe.to_excel(daily_201912_excel_writer,'25_3',index=False)
daily_201912_excel_writer.save()
daily_20191226 = pro.daily(start_date='',end_date='',trade_date='20191226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191226_tscode_list = list() 
for ts_code_sh in daily_20191226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191226_tscode_list.append(stock_name)
daily_20191226_addname_dataframe=pd.DataFrame()
daily_20191226_addname_dataframe['cname'] = daily_20191226_tscode_list
for table_name in daily_20191226.columns.values.tolist():
    daily_20191226_addname_dataframe[table_name] = daily_20191226[table_name]
print("daily_20191226 返回数据 row 行数 = "+str(daily_20191226.shape[0]))
daily_20191226_addname_dataframe.to_excel(daily_201912_excel_writer,'26_4',index=False)
daily_201912_excel_writer.save()
daily_20191227 = pro.daily(start_date='',end_date='',trade_date='20191227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191227_tscode_list = list() 
for ts_code_sh in daily_20191227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191227_tscode_list.append(stock_name)
daily_20191227_addname_dataframe=pd.DataFrame()
daily_20191227_addname_dataframe['cname'] = daily_20191227_tscode_list
for table_name in daily_20191227.columns.values.tolist():
    daily_20191227_addname_dataframe[table_name] = daily_20191227[table_name]
print("daily_20191227 返回数据 row 行数 = "+str(daily_20191227.shape[0]))
daily_20191227_addname_dataframe.to_excel(daily_201912_excel_writer,'27_5',index=False)
daily_201912_excel_writer.save()
daily_20191228 = pro.daily(start_date='',end_date='',trade_date='20191228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191228_tscode_list = list() 
for ts_code_sh in daily_20191228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191228_tscode_list.append(stock_name)
daily_20191228_addname_dataframe=pd.DataFrame()
daily_20191228_addname_dataframe['cname'] = daily_20191228_tscode_list
for table_name in daily_20191228.columns.values.tolist():
    daily_20191228_addname_dataframe[table_name] = daily_20191228[table_name]
print("daily_20191228 返回数据 row 行数 = "+str(daily_20191228.shape[0]))
daily_20191228_addname_dataframe.to_excel(daily_201912_excel_writer,'28_6',index=False)
daily_201912_excel_writer.save()
daily_20191229 = pro.daily(start_date='',end_date='',trade_date='20191229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191229_tscode_list = list() 
for ts_code_sh in daily_20191229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191229_tscode_list.append(stock_name)
daily_20191229_addname_dataframe=pd.DataFrame()
daily_20191229_addname_dataframe['cname'] = daily_20191229_tscode_list
for table_name in daily_20191229.columns.values.tolist():
    daily_20191229_addname_dataframe[table_name] = daily_20191229[table_name]
print("daily_20191229 返回数据 row 行数 = "+str(daily_20191229.shape[0]))
daily_20191229_addname_dataframe.to_excel(daily_201912_excel_writer,'29_7',index=False)
daily_201912_excel_writer.save()
daily_20191230 = pro.daily(start_date='',end_date='',trade_date='20191230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191230_tscode_list = list() 
for ts_code_sh in daily_20191230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191230_tscode_list.append(stock_name)
daily_20191230_addname_dataframe=pd.DataFrame()
daily_20191230_addname_dataframe['cname'] = daily_20191230_tscode_list
for table_name in daily_20191230.columns.values.tolist():
    daily_20191230_addname_dataframe[table_name] = daily_20191230[table_name]
print("daily_20191230 返回数据 row 行数 = "+str(daily_20191230.shape[0]))
daily_20191230_addname_dataframe.to_excel(daily_201912_excel_writer,'30_1',index=False)
daily_201912_excel_writer.save()
daily_20191231 = pro.daily(start_date='',end_date='',trade_date='20191231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191231_tscode_list = list() 
for ts_code_sh in daily_20191231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191231_tscode_list.append(stock_name)
daily_20191231_addname_dataframe=pd.DataFrame()
daily_20191231_addname_dataframe['cname'] = daily_20191231_tscode_list
for table_name in daily_20191231.columns.values.tolist():
    daily_20191231_addname_dataframe[table_name] = daily_20191231[table_name]
print("daily_20191231 返回数据 row 行数 = "+str(daily_20191231.shape[0]))
daily_20191231_addname_dataframe.to_excel(daily_201912_excel_writer,'31_2',index=False)
daily_201912_excel_writer.save()




createexcel('daily_202001.xlsx')
daily_202001_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202001.xlsx')
daily_202001_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202001.xlsx', engine='openpyxl')
daily_202001_excel_writer.book = daily_202001_book
daily_202001_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202001_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200101")       ###  更新 记录日期
daily_20200101 = pro.daily(start_date='',end_date='',trade_date='20200101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200101_tscode_list = list() 
for ts_code_sh in daily_20200101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200101_tscode_list.append(stock_name)
daily_20200101_addname_dataframe=pd.DataFrame()
daily_20200101_addname_dataframe['cname'] = daily_20200101_tscode_list
for table_name in daily_20200101.columns.values.tolist():
    daily_20200101_addname_dataframe[table_name] = daily_20200101[table_name]
print("daily_20200101 返回数据 row 行数 = "+str(daily_20200101.shape[0]))
daily_20200101_addname_dataframe.to_excel(daily_202001_excel_writer,'1_3',index=False)
daily_202001_excel_writer.save()
daily_20200102 = pro.daily(start_date='',end_date='',trade_date='20200102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200102_tscode_list = list() 
for ts_code_sh in daily_20200102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200102_tscode_list.append(stock_name)
daily_20200102_addname_dataframe=pd.DataFrame()
daily_20200102_addname_dataframe['cname'] = daily_20200102_tscode_list
for table_name in daily_20200102.columns.values.tolist():
    daily_20200102_addname_dataframe[table_name] = daily_20200102[table_name]
print("daily_20200102 返回数据 row 行数 = "+str(daily_20200102.shape[0]))
daily_20200102_addname_dataframe.to_excel(daily_202001_excel_writer,'2_4',index=False)
daily_202001_excel_writer.save()
daily_20200103 = pro.daily(start_date='',end_date='',trade_date='20200103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200103_tscode_list = list() 
for ts_code_sh in daily_20200103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200103_tscode_list.append(stock_name)
daily_20200103_addname_dataframe=pd.DataFrame()
daily_20200103_addname_dataframe['cname'] = daily_20200103_tscode_list
for table_name in daily_20200103.columns.values.tolist():
    daily_20200103_addname_dataframe[table_name] = daily_20200103[table_name]
print("daily_20200103 返回数据 row 行数 = "+str(daily_20200103.shape[0]))
daily_20200103_addname_dataframe.to_excel(daily_202001_excel_writer,'3_5',index=False)
daily_202001_excel_writer.save()
daily_20200104 = pro.daily(start_date='',end_date='',trade_date='20200104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200104_tscode_list = list() 
for ts_code_sh in daily_20200104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200104_tscode_list.append(stock_name)
daily_20200104_addname_dataframe=pd.DataFrame()
daily_20200104_addname_dataframe['cname'] = daily_20200104_tscode_list
for table_name in daily_20200104.columns.values.tolist():
    daily_20200104_addname_dataframe[table_name] = daily_20200104[table_name]
print("daily_20200104 返回数据 row 行数 = "+str(daily_20200104.shape[0]))
daily_20200104_addname_dataframe.to_excel(daily_202001_excel_writer,'4_6',index=False)
daily_202001_excel_writer.save()
daily_20200105 = pro.daily(start_date='',end_date='',trade_date='20200105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200105_tscode_list = list() 
for ts_code_sh in daily_20200105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200105_tscode_list.append(stock_name)
daily_20200105_addname_dataframe=pd.DataFrame()
daily_20200105_addname_dataframe['cname'] = daily_20200105_tscode_list
for table_name in daily_20200105.columns.values.tolist():
    daily_20200105_addname_dataframe[table_name] = daily_20200105[table_name]
print("daily_20200105 返回数据 row 行数 = "+str(daily_20200105.shape[0]))
daily_20200105_addname_dataframe.to_excel(daily_202001_excel_writer,'5_7',index=False)
daily_202001_excel_writer.save()
daily_20200106 = pro.daily(start_date='',end_date='',trade_date='20200106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200106_tscode_list = list() 
for ts_code_sh in daily_20200106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200106_tscode_list.append(stock_name)
daily_20200106_addname_dataframe=pd.DataFrame()
daily_20200106_addname_dataframe['cname'] = daily_20200106_tscode_list
for table_name in daily_20200106.columns.values.tolist():
    daily_20200106_addname_dataframe[table_name] = daily_20200106[table_name]
print("daily_20200106 返回数据 row 行数 = "+str(daily_20200106.shape[0]))
daily_20200106_addname_dataframe.to_excel(daily_202001_excel_writer,'6_1',index=False)
daily_202001_excel_writer.save()
daily_20200107 = pro.daily(start_date='',end_date='',trade_date='20200107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200107_tscode_list = list() 
for ts_code_sh in daily_20200107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200107_tscode_list.append(stock_name)
daily_20200107_addname_dataframe=pd.DataFrame()
daily_20200107_addname_dataframe['cname'] = daily_20200107_tscode_list
for table_name in daily_20200107.columns.values.tolist():
    daily_20200107_addname_dataframe[table_name] = daily_20200107[table_name]
print("daily_20200107 返回数据 row 行数 = "+str(daily_20200107.shape[0]))
daily_20200107_addname_dataframe.to_excel(daily_202001_excel_writer,'7_2',index=False)
daily_202001_excel_writer.save()
daily_20200108 = pro.daily(start_date='',end_date='',trade_date='20200108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200108_tscode_list = list() 
for ts_code_sh in daily_20200108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200108_tscode_list.append(stock_name)
daily_20200108_addname_dataframe=pd.DataFrame()
daily_20200108_addname_dataframe['cname'] = daily_20200108_tscode_list
for table_name in daily_20200108.columns.values.tolist():
    daily_20200108_addname_dataframe[table_name] = daily_20200108[table_name]
print("daily_20200108 返回数据 row 行数 = "+str(daily_20200108.shape[0]))
daily_20200108_addname_dataframe.to_excel(daily_202001_excel_writer,'8_3',index=False)
daily_202001_excel_writer.save()
daily_20200109 = pro.daily(start_date='',end_date='',trade_date='20200109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200109_tscode_list = list() 
for ts_code_sh in daily_20200109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200109_tscode_list.append(stock_name)
daily_20200109_addname_dataframe=pd.DataFrame()
daily_20200109_addname_dataframe['cname'] = daily_20200109_tscode_list
for table_name in daily_20200109.columns.values.tolist():
    daily_20200109_addname_dataframe[table_name] = daily_20200109[table_name]
print("daily_20200109 返回数据 row 行数 = "+str(daily_20200109.shape[0]))
daily_20200109_addname_dataframe.to_excel(daily_202001_excel_writer,'9_4',index=False)
daily_202001_excel_writer.save()
daily_20200110 = pro.daily(start_date='',end_date='',trade_date='20200110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200110_tscode_list = list() 
for ts_code_sh in daily_20200110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200110_tscode_list.append(stock_name)
daily_20200110_addname_dataframe=pd.DataFrame()
daily_20200110_addname_dataframe['cname'] = daily_20200110_tscode_list
for table_name in daily_20200110.columns.values.tolist():
    daily_20200110_addname_dataframe[table_name] = daily_20200110[table_name]
print("daily_20200110 返回数据 row 行数 = "+str(daily_20200110.shape[0]))
daily_20200110_addname_dataframe.to_excel(daily_202001_excel_writer,'10_5',index=False)
daily_202001_excel_writer.save()
daily_20200111 = pro.daily(start_date='',end_date='',trade_date='20200111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200111_tscode_list = list() 
for ts_code_sh in daily_20200111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200111_tscode_list.append(stock_name)
daily_20200111_addname_dataframe=pd.DataFrame()
daily_20200111_addname_dataframe['cname'] = daily_20200111_tscode_list
for table_name in daily_20200111.columns.values.tolist():
    daily_20200111_addname_dataframe[table_name] = daily_20200111[table_name]
print("daily_20200111 返回数据 row 行数 = "+str(daily_20200111.shape[0]))
daily_20200111_addname_dataframe.to_excel(daily_202001_excel_writer,'11_6',index=False)
daily_202001_excel_writer.save()
daily_20200112 = pro.daily(start_date='',end_date='',trade_date='20200112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200112_tscode_list = list() 
for ts_code_sh in daily_20200112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200112_tscode_list.append(stock_name)
daily_20200112_addname_dataframe=pd.DataFrame()
daily_20200112_addname_dataframe['cname'] = daily_20200112_tscode_list
for table_name in daily_20200112.columns.values.tolist():
    daily_20200112_addname_dataframe[table_name] = daily_20200112[table_name]
print("daily_20200112 返回数据 row 行数 = "+str(daily_20200112.shape[0]))
daily_20200112_addname_dataframe.to_excel(daily_202001_excel_writer,'12_7',index=False)
daily_202001_excel_writer.save()
daily_20200113 = pro.daily(start_date='',end_date='',trade_date='20200113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200113_tscode_list = list() 
for ts_code_sh in daily_20200113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200113_tscode_list.append(stock_name)
daily_20200113_addname_dataframe=pd.DataFrame()
daily_20200113_addname_dataframe['cname'] = daily_20200113_tscode_list
for table_name in daily_20200113.columns.values.tolist():
    daily_20200113_addname_dataframe[table_name] = daily_20200113[table_name]
print("daily_20200113 返回数据 row 行数 = "+str(daily_20200113.shape[0]))
daily_20200113_addname_dataframe.to_excel(daily_202001_excel_writer,'13_1',index=False)
daily_202001_excel_writer.save()
daily_20200114 = pro.daily(start_date='',end_date='',trade_date='20200114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200114_tscode_list = list() 
for ts_code_sh in daily_20200114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200114_tscode_list.append(stock_name)
daily_20200114_addname_dataframe=pd.DataFrame()
daily_20200114_addname_dataframe['cname'] = daily_20200114_tscode_list
for table_name in daily_20200114.columns.values.tolist():
    daily_20200114_addname_dataframe[table_name] = daily_20200114[table_name]
print("daily_20200114 返回数据 row 行数 = "+str(daily_20200114.shape[0]))
daily_20200114_addname_dataframe.to_excel(daily_202001_excel_writer,'14_2',index=False)
daily_202001_excel_writer.save()
daily_20200115 = pro.daily(start_date='',end_date='',trade_date='20200115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200115_tscode_list = list() 
for ts_code_sh in daily_20200115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200115_tscode_list.append(stock_name)
daily_20200115_addname_dataframe=pd.DataFrame()
daily_20200115_addname_dataframe['cname'] = daily_20200115_tscode_list
for table_name in daily_20200115.columns.values.tolist():
    daily_20200115_addname_dataframe[table_name] = daily_20200115[table_name]
print("daily_20200115 返回数据 row 行数 = "+str(daily_20200115.shape[0]))
daily_20200115_addname_dataframe.to_excel(daily_202001_excel_writer,'15_3',index=False)
daily_202001_excel_writer.save()
daily_20200116 = pro.daily(start_date='',end_date='',trade_date='20200116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200116_tscode_list = list() 
for ts_code_sh in daily_20200116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200116_tscode_list.append(stock_name)
daily_20200116_addname_dataframe=pd.DataFrame()
daily_20200116_addname_dataframe['cname'] = daily_20200116_tscode_list
for table_name in daily_20200116.columns.values.tolist():
    daily_20200116_addname_dataframe[table_name] = daily_20200116[table_name]
print("daily_20200116 返回数据 row 行数 = "+str(daily_20200116.shape[0]))
daily_20200116_addname_dataframe.to_excel(daily_202001_excel_writer,'16_4',index=False)
daily_202001_excel_writer.save()
daily_20200117 = pro.daily(start_date='',end_date='',trade_date='20200117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200117_tscode_list = list() 
for ts_code_sh in daily_20200117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200117_tscode_list.append(stock_name)
daily_20200117_addname_dataframe=pd.DataFrame()
daily_20200117_addname_dataframe['cname'] = daily_20200117_tscode_list
for table_name in daily_20200117.columns.values.tolist():
    daily_20200117_addname_dataframe[table_name] = daily_20200117[table_name]
print("daily_20200117 返回数据 row 行数 = "+str(daily_20200117.shape[0]))
daily_20200117_addname_dataframe.to_excel(daily_202001_excel_writer,'17_5',index=False)
daily_202001_excel_writer.save()
daily_20200118 = pro.daily(start_date='',end_date='',trade_date='20200118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200118_tscode_list = list() 
for ts_code_sh in daily_20200118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200118_tscode_list.append(stock_name)
daily_20200118_addname_dataframe=pd.DataFrame()
daily_20200118_addname_dataframe['cname'] = daily_20200118_tscode_list
for table_name in daily_20200118.columns.values.tolist():
    daily_20200118_addname_dataframe[table_name] = daily_20200118[table_name]
print("daily_20200118 返回数据 row 行数 = "+str(daily_20200118.shape[0]))
daily_20200118_addname_dataframe.to_excel(daily_202001_excel_writer,'18_6',index=False)
daily_202001_excel_writer.save()
daily_20200119 = pro.daily(start_date='',end_date='',trade_date='20200119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200119_tscode_list = list() 
for ts_code_sh in daily_20200119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200119_tscode_list.append(stock_name)
daily_20200119_addname_dataframe=pd.DataFrame()
daily_20200119_addname_dataframe['cname'] = daily_20200119_tscode_list
for table_name in daily_20200119.columns.values.tolist():
    daily_20200119_addname_dataframe[table_name] = daily_20200119[table_name]
print("daily_20200119 返回数据 row 行数 = "+str(daily_20200119.shape[0]))
daily_20200119_addname_dataframe.to_excel(daily_202001_excel_writer,'19_7',index=False)
daily_202001_excel_writer.save()
daily_20200120 = pro.daily(start_date='',end_date='',trade_date='20200120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200120_tscode_list = list() 
for ts_code_sh in daily_20200120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200120_tscode_list.append(stock_name)
daily_20200120_addname_dataframe=pd.DataFrame()
daily_20200120_addname_dataframe['cname'] = daily_20200120_tscode_list
for table_name in daily_20200120.columns.values.tolist():
    daily_20200120_addname_dataframe[table_name] = daily_20200120[table_name]
print("daily_20200120 返回数据 row 行数 = "+str(daily_20200120.shape[0]))
daily_20200120_addname_dataframe.to_excel(daily_202001_excel_writer,'20_1',index=False)
daily_202001_excel_writer.save()
daily_20200121 = pro.daily(start_date='',end_date='',trade_date='20200121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200121_tscode_list = list() 
for ts_code_sh in daily_20200121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200121_tscode_list.append(stock_name)
daily_20200121_addname_dataframe=pd.DataFrame()
daily_20200121_addname_dataframe['cname'] = daily_20200121_tscode_list
for table_name in daily_20200121.columns.values.tolist():
    daily_20200121_addname_dataframe[table_name] = daily_20200121[table_name]
print("daily_20200121 返回数据 row 行数 = "+str(daily_20200121.shape[0]))
daily_20200121_addname_dataframe.to_excel(daily_202001_excel_writer,'21_2',index=False)
daily_202001_excel_writer.save()
daily_20200122 = pro.daily(start_date='',end_date='',trade_date='20200122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200122_tscode_list = list() 
for ts_code_sh in daily_20200122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200122_tscode_list.append(stock_name)
daily_20200122_addname_dataframe=pd.DataFrame()
daily_20200122_addname_dataframe['cname'] = daily_20200122_tscode_list
for table_name in daily_20200122.columns.values.tolist():
    daily_20200122_addname_dataframe[table_name] = daily_20200122[table_name]
print("daily_20200122 返回数据 row 行数 = "+str(daily_20200122.shape[0]))
daily_20200122_addname_dataframe.to_excel(daily_202001_excel_writer,'22_3',index=False)
daily_202001_excel_writer.save()
daily_20200123 = pro.daily(start_date='',end_date='',trade_date='20200123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200123_tscode_list = list() 
for ts_code_sh in daily_20200123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200123_tscode_list.append(stock_name)
daily_20200123_addname_dataframe=pd.DataFrame()
daily_20200123_addname_dataframe['cname'] = daily_20200123_tscode_list
for table_name in daily_20200123.columns.values.tolist():
    daily_20200123_addname_dataframe[table_name] = daily_20200123[table_name]
print("daily_20200123 返回数据 row 行数 = "+str(daily_20200123.shape[0]))
daily_20200123_addname_dataframe.to_excel(daily_202001_excel_writer,'23_4',index=False)
daily_202001_excel_writer.save()
daily_20200124 = pro.daily(start_date='',end_date='',trade_date='20200124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200124_tscode_list = list() 
for ts_code_sh in daily_20200124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200124_tscode_list.append(stock_name)
daily_20200124_addname_dataframe=pd.DataFrame()
daily_20200124_addname_dataframe['cname'] = daily_20200124_tscode_list
for table_name in daily_20200124.columns.values.tolist():
    daily_20200124_addname_dataframe[table_name] = daily_20200124[table_name]
print("daily_20200124 返回数据 row 行数 = "+str(daily_20200124.shape[0]))
daily_20200124_addname_dataframe.to_excel(daily_202001_excel_writer,'24_5',index=False)
daily_202001_excel_writer.save()
daily_20200125 = pro.daily(start_date='',end_date='',trade_date='20200125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200125_tscode_list = list() 
for ts_code_sh in daily_20200125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200125_tscode_list.append(stock_name)
daily_20200125_addname_dataframe=pd.DataFrame()
daily_20200125_addname_dataframe['cname'] = daily_20200125_tscode_list
for table_name in daily_20200125.columns.values.tolist():
    daily_20200125_addname_dataframe[table_name] = daily_20200125[table_name]
print("daily_20200125 返回数据 row 行数 = "+str(daily_20200125.shape[0]))
daily_20200125_addname_dataframe.to_excel(daily_202001_excel_writer,'25_6',index=False)
daily_202001_excel_writer.save()
daily_20200126 = pro.daily(start_date='',end_date='',trade_date='20200126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200126_tscode_list = list() 
for ts_code_sh in daily_20200126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200126_tscode_list.append(stock_name)
daily_20200126_addname_dataframe=pd.DataFrame()
daily_20200126_addname_dataframe['cname'] = daily_20200126_tscode_list
for table_name in daily_20200126.columns.values.tolist():
    daily_20200126_addname_dataframe[table_name] = daily_20200126[table_name]
print("daily_20200126 返回数据 row 行数 = "+str(daily_20200126.shape[0]))
daily_20200126_addname_dataframe.to_excel(daily_202001_excel_writer,'26_7',index=False)
daily_202001_excel_writer.save()
daily_20200127 = pro.daily(start_date='',end_date='',trade_date='20200127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200127_tscode_list = list() 
for ts_code_sh in daily_20200127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200127_tscode_list.append(stock_name)
daily_20200127_addname_dataframe=pd.DataFrame()
daily_20200127_addname_dataframe['cname'] = daily_20200127_tscode_list
for table_name in daily_20200127.columns.values.tolist():
    daily_20200127_addname_dataframe[table_name] = daily_20200127[table_name]
print("daily_20200127 返回数据 row 行数 = "+str(daily_20200127.shape[0]))
daily_20200127_addname_dataframe.to_excel(daily_202001_excel_writer,'27_1',index=False)
daily_202001_excel_writer.save()
daily_20200128 = pro.daily(start_date='',end_date='',trade_date='20200128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200128_tscode_list = list() 
for ts_code_sh in daily_20200128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200128_tscode_list.append(stock_name)
daily_20200128_addname_dataframe=pd.DataFrame()
daily_20200128_addname_dataframe['cname'] = daily_20200128_tscode_list
for table_name in daily_20200128.columns.values.tolist():
    daily_20200128_addname_dataframe[table_name] = daily_20200128[table_name]
print("daily_20200128 返回数据 row 行数 = "+str(daily_20200128.shape[0]))
daily_20200128_addname_dataframe.to_excel(daily_202001_excel_writer,'28_2',index=False)
daily_202001_excel_writer.save()
daily_20200129 = pro.daily(start_date='',end_date='',trade_date='20200129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200129_tscode_list = list() 
for ts_code_sh in daily_20200129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200129_tscode_list.append(stock_name)
daily_20200129_addname_dataframe=pd.DataFrame()
daily_20200129_addname_dataframe['cname'] = daily_20200129_tscode_list
for table_name in daily_20200129.columns.values.tolist():
    daily_20200129_addname_dataframe[table_name] = daily_20200129[table_name]
print("daily_20200129 返回数据 row 行数 = "+str(daily_20200129.shape[0]))
daily_20200129_addname_dataframe.to_excel(daily_202001_excel_writer,'29_3',index=False)
daily_202001_excel_writer.save()
daily_20200130 = pro.daily(start_date='',end_date='',trade_date='20200130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200130_tscode_list = list() 
for ts_code_sh in daily_20200130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200130_tscode_list.append(stock_name)
daily_20200130_addname_dataframe=pd.DataFrame()
daily_20200130_addname_dataframe['cname'] = daily_20200130_tscode_list
for table_name in daily_20200130.columns.values.tolist():
    daily_20200130_addname_dataframe[table_name] = daily_20200130[table_name]
print("daily_20200130 返回数据 row 行数 = "+str(daily_20200130.shape[0]))
daily_20200130_addname_dataframe.to_excel(daily_202001_excel_writer,'30_4',index=False)
daily_202001_excel_writer.save()
daily_20200131 = pro.daily(start_date='',end_date='',trade_date='20200131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200131_tscode_list = list() 
for ts_code_sh in daily_20200131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200131_tscode_list.append(stock_name)
daily_20200131_addname_dataframe=pd.DataFrame()
daily_20200131_addname_dataframe['cname'] = daily_20200131_tscode_list
for table_name in daily_20200131.columns.values.tolist():
    daily_20200131_addname_dataframe[table_name] = daily_20200131[table_name]
print("daily_20200131 返回数据 row 行数 = "+str(daily_20200131.shape[0]))
daily_20200131_addname_dataframe.to_excel(daily_202001_excel_writer,'31_5',index=False)
daily_202001_excel_writer.save()




createexcel('daily_202002.xlsx')
daily_202002_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202002.xlsx')
daily_202002_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202002.xlsx', engine='openpyxl')
daily_202002_excel_writer.book = daily_202002_book
daily_202002_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202002_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200201")       ###  更新 记录日期
daily_20200201 = pro.daily(start_date='',end_date='',trade_date='20200201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200201_tscode_list = list() 
for ts_code_sh in daily_20200201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200201_tscode_list.append(stock_name)
daily_20200201_addname_dataframe=pd.DataFrame()
daily_20200201_addname_dataframe['cname'] = daily_20200201_tscode_list
for table_name in daily_20200201.columns.values.tolist():
    daily_20200201_addname_dataframe[table_name] = daily_20200201[table_name]
print("daily_20200201 返回数据 row 行数 = "+str(daily_20200201.shape[0]))
daily_20200201_addname_dataframe.to_excel(daily_202002_excel_writer,'1_6',index=False)
daily_202002_excel_writer.save()
daily_20200202 = pro.daily(start_date='',end_date='',trade_date='20200202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200202_tscode_list = list() 
for ts_code_sh in daily_20200202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200202_tscode_list.append(stock_name)
daily_20200202_addname_dataframe=pd.DataFrame()
daily_20200202_addname_dataframe['cname'] = daily_20200202_tscode_list
for table_name in daily_20200202.columns.values.tolist():
    daily_20200202_addname_dataframe[table_name] = daily_20200202[table_name]
print("daily_20200202 返回数据 row 行数 = "+str(daily_20200202.shape[0]))
daily_20200202_addname_dataframe.to_excel(daily_202002_excel_writer,'2_7',index=False)
daily_202002_excel_writer.save()
daily_20200203 = pro.daily(start_date='',end_date='',trade_date='20200203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200203_tscode_list = list() 
for ts_code_sh in daily_20200203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200203_tscode_list.append(stock_name)
daily_20200203_addname_dataframe=pd.DataFrame()
daily_20200203_addname_dataframe['cname'] = daily_20200203_tscode_list
for table_name in daily_20200203.columns.values.tolist():
    daily_20200203_addname_dataframe[table_name] = daily_20200203[table_name]
print("daily_20200203 返回数据 row 行数 = "+str(daily_20200203.shape[0]))
daily_20200203_addname_dataframe.to_excel(daily_202002_excel_writer,'3_1',index=False)
daily_202002_excel_writer.save()
daily_20200204 = pro.daily(start_date='',end_date='',trade_date='20200204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200204_tscode_list = list() 
for ts_code_sh in daily_20200204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200204_tscode_list.append(stock_name)
daily_20200204_addname_dataframe=pd.DataFrame()
daily_20200204_addname_dataframe['cname'] = daily_20200204_tscode_list
for table_name in daily_20200204.columns.values.tolist():
    daily_20200204_addname_dataframe[table_name] = daily_20200204[table_name]
print("daily_20200204 返回数据 row 行数 = "+str(daily_20200204.shape[0]))
daily_20200204_addname_dataframe.to_excel(daily_202002_excel_writer,'4_2',index=False)
daily_202002_excel_writer.save()
daily_20200205 = pro.daily(start_date='',end_date='',trade_date='20200205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200205_tscode_list = list() 
for ts_code_sh in daily_20200205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200205_tscode_list.append(stock_name)
daily_20200205_addname_dataframe=pd.DataFrame()
daily_20200205_addname_dataframe['cname'] = daily_20200205_tscode_list
for table_name in daily_20200205.columns.values.tolist():
    daily_20200205_addname_dataframe[table_name] = daily_20200205[table_name]
print("daily_20200205 返回数据 row 行数 = "+str(daily_20200205.shape[0]))
daily_20200205_addname_dataframe.to_excel(daily_202002_excel_writer,'5_3',index=False)
daily_202002_excel_writer.save()
daily_20200206 = pro.daily(start_date='',end_date='',trade_date='20200206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200206_tscode_list = list() 
for ts_code_sh in daily_20200206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200206_tscode_list.append(stock_name)
daily_20200206_addname_dataframe=pd.DataFrame()
daily_20200206_addname_dataframe['cname'] = daily_20200206_tscode_list
for table_name in daily_20200206.columns.values.tolist():
    daily_20200206_addname_dataframe[table_name] = daily_20200206[table_name]
print("daily_20200206 返回数据 row 行数 = "+str(daily_20200206.shape[0]))
daily_20200206_addname_dataframe.to_excel(daily_202002_excel_writer,'6_4',index=False)
daily_202002_excel_writer.save()
daily_20200207 = pro.daily(start_date='',end_date='',trade_date='20200207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200207_tscode_list = list() 
for ts_code_sh in daily_20200207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200207_tscode_list.append(stock_name)
daily_20200207_addname_dataframe=pd.DataFrame()
daily_20200207_addname_dataframe['cname'] = daily_20200207_tscode_list
for table_name in daily_20200207.columns.values.tolist():
    daily_20200207_addname_dataframe[table_name] = daily_20200207[table_name]
print("daily_20200207 返回数据 row 行数 = "+str(daily_20200207.shape[0]))
daily_20200207_addname_dataframe.to_excel(daily_202002_excel_writer,'7_5',index=False)
daily_202002_excel_writer.save()
daily_20200208 = pro.daily(start_date='',end_date='',trade_date='20200208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200208_tscode_list = list() 
for ts_code_sh in daily_20200208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200208_tscode_list.append(stock_name)
daily_20200208_addname_dataframe=pd.DataFrame()
daily_20200208_addname_dataframe['cname'] = daily_20200208_tscode_list
for table_name in daily_20200208.columns.values.tolist():
    daily_20200208_addname_dataframe[table_name] = daily_20200208[table_name]
print("daily_20200208 返回数据 row 行数 = "+str(daily_20200208.shape[0]))
daily_20200208_addname_dataframe.to_excel(daily_202002_excel_writer,'8_6',index=False)
daily_202002_excel_writer.save()
daily_20200209 = pro.daily(start_date='',end_date='',trade_date='20200209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200209_tscode_list = list() 
for ts_code_sh in daily_20200209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200209_tscode_list.append(stock_name)
daily_20200209_addname_dataframe=pd.DataFrame()
daily_20200209_addname_dataframe['cname'] = daily_20200209_tscode_list
for table_name in daily_20200209.columns.values.tolist():
    daily_20200209_addname_dataframe[table_name] = daily_20200209[table_name]
print("daily_20200209 返回数据 row 行数 = "+str(daily_20200209.shape[0]))
daily_20200209_addname_dataframe.to_excel(daily_202002_excel_writer,'9_7',index=False)
daily_202002_excel_writer.save()
daily_20200210 = pro.daily(start_date='',end_date='',trade_date='20200210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200210_tscode_list = list() 
for ts_code_sh in daily_20200210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200210_tscode_list.append(stock_name)
daily_20200210_addname_dataframe=pd.DataFrame()
daily_20200210_addname_dataframe['cname'] = daily_20200210_tscode_list
for table_name in daily_20200210.columns.values.tolist():
    daily_20200210_addname_dataframe[table_name] = daily_20200210[table_name]
print("daily_20200210 返回数据 row 行数 = "+str(daily_20200210.shape[0]))
daily_20200210_addname_dataframe.to_excel(daily_202002_excel_writer,'10_1',index=False)
daily_202002_excel_writer.save()
daily_20200211 = pro.daily(start_date='',end_date='',trade_date='20200211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200211_tscode_list = list() 
for ts_code_sh in daily_20200211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200211_tscode_list.append(stock_name)
daily_20200211_addname_dataframe=pd.DataFrame()
daily_20200211_addname_dataframe['cname'] = daily_20200211_tscode_list
for table_name in daily_20200211.columns.values.tolist():
    daily_20200211_addname_dataframe[table_name] = daily_20200211[table_name]
print("daily_20200211 返回数据 row 行数 = "+str(daily_20200211.shape[0]))
daily_20200211_addname_dataframe.to_excel(daily_202002_excel_writer,'11_2',index=False)
daily_202002_excel_writer.save()
daily_20200212 = pro.daily(start_date='',end_date='',trade_date='20200212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200212_tscode_list = list() 
for ts_code_sh in daily_20200212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200212_tscode_list.append(stock_name)
daily_20200212_addname_dataframe=pd.DataFrame()
daily_20200212_addname_dataframe['cname'] = daily_20200212_tscode_list
for table_name in daily_20200212.columns.values.tolist():
    daily_20200212_addname_dataframe[table_name] = daily_20200212[table_name]
print("daily_20200212 返回数据 row 行数 = "+str(daily_20200212.shape[0]))
daily_20200212_addname_dataframe.to_excel(daily_202002_excel_writer,'12_3',index=False)
daily_202002_excel_writer.save()
daily_20200213 = pro.daily(start_date='',end_date='',trade_date='20200213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200213_tscode_list = list() 
for ts_code_sh in daily_20200213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200213_tscode_list.append(stock_name)
daily_20200213_addname_dataframe=pd.DataFrame()
daily_20200213_addname_dataframe['cname'] = daily_20200213_tscode_list
for table_name in daily_20200213.columns.values.tolist():
    daily_20200213_addname_dataframe[table_name] = daily_20200213[table_name]
print("daily_20200213 返回数据 row 行数 = "+str(daily_20200213.shape[0]))
daily_20200213_addname_dataframe.to_excel(daily_202002_excel_writer,'13_4',index=False)
daily_202002_excel_writer.save()
daily_20200214 = pro.daily(start_date='',end_date='',trade_date='20200214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200214_tscode_list = list() 
for ts_code_sh in daily_20200214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200214_tscode_list.append(stock_name)
daily_20200214_addname_dataframe=pd.DataFrame()
daily_20200214_addname_dataframe['cname'] = daily_20200214_tscode_list
for table_name in daily_20200214.columns.values.tolist():
    daily_20200214_addname_dataframe[table_name] = daily_20200214[table_name]
print("daily_20200214 返回数据 row 行数 = "+str(daily_20200214.shape[0]))
daily_20200214_addname_dataframe.to_excel(daily_202002_excel_writer,'14_5',index=False)
daily_202002_excel_writer.save()
daily_20200215 = pro.daily(start_date='',end_date='',trade_date='20200215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200215_tscode_list = list() 
for ts_code_sh in daily_20200215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200215_tscode_list.append(stock_name)
daily_20200215_addname_dataframe=pd.DataFrame()
daily_20200215_addname_dataframe['cname'] = daily_20200215_tscode_list
for table_name in daily_20200215.columns.values.tolist():
    daily_20200215_addname_dataframe[table_name] = daily_20200215[table_name]
print("daily_20200215 返回数据 row 行数 = "+str(daily_20200215.shape[0]))
daily_20200215_addname_dataframe.to_excel(daily_202002_excel_writer,'15_6',index=False)
daily_202002_excel_writer.save()
daily_20200216 = pro.daily(start_date='',end_date='',trade_date='20200216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200216_tscode_list = list() 
for ts_code_sh in daily_20200216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200216_tscode_list.append(stock_name)
daily_20200216_addname_dataframe=pd.DataFrame()
daily_20200216_addname_dataframe['cname'] = daily_20200216_tscode_list
for table_name in daily_20200216.columns.values.tolist():
    daily_20200216_addname_dataframe[table_name] = daily_20200216[table_name]
print("daily_20200216 返回数据 row 行数 = "+str(daily_20200216.shape[0]))
daily_20200216_addname_dataframe.to_excel(daily_202002_excel_writer,'16_7',index=False)
daily_202002_excel_writer.save()
daily_20200217 = pro.daily(start_date='',end_date='',trade_date='20200217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200217_tscode_list = list() 
for ts_code_sh in daily_20200217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200217_tscode_list.append(stock_name)
daily_20200217_addname_dataframe=pd.DataFrame()
daily_20200217_addname_dataframe['cname'] = daily_20200217_tscode_list
for table_name in daily_20200217.columns.values.tolist():
    daily_20200217_addname_dataframe[table_name] = daily_20200217[table_name]
print("daily_20200217 返回数据 row 行数 = "+str(daily_20200217.shape[0]))
daily_20200217_addname_dataframe.to_excel(daily_202002_excel_writer,'17_1',index=False)
daily_202002_excel_writer.save()
daily_20200218 = pro.daily(start_date='',end_date='',trade_date='20200218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200218_tscode_list = list() 
for ts_code_sh in daily_20200218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200218_tscode_list.append(stock_name)
daily_20200218_addname_dataframe=pd.DataFrame()
daily_20200218_addname_dataframe['cname'] = daily_20200218_tscode_list
for table_name in daily_20200218.columns.values.tolist():
    daily_20200218_addname_dataframe[table_name] = daily_20200218[table_name]
print("daily_20200218 返回数据 row 行数 = "+str(daily_20200218.shape[0]))
daily_20200218_addname_dataframe.to_excel(daily_202002_excel_writer,'18_2',index=False)
daily_202002_excel_writer.save()
daily_20200219 = pro.daily(start_date='',end_date='',trade_date='20200219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200219_tscode_list = list() 
for ts_code_sh in daily_20200219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200219_tscode_list.append(stock_name)
daily_20200219_addname_dataframe=pd.DataFrame()
daily_20200219_addname_dataframe['cname'] = daily_20200219_tscode_list
for table_name in daily_20200219.columns.values.tolist():
    daily_20200219_addname_dataframe[table_name] = daily_20200219[table_name]
print("daily_20200219 返回数据 row 行数 = "+str(daily_20200219.shape[0]))
daily_20200219_addname_dataframe.to_excel(daily_202002_excel_writer,'19_3',index=False)
daily_202002_excel_writer.save()
daily_20200220 = pro.daily(start_date='',end_date='',trade_date='20200220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200220_tscode_list = list() 
for ts_code_sh in daily_20200220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200220_tscode_list.append(stock_name)
daily_20200220_addname_dataframe=pd.DataFrame()
daily_20200220_addname_dataframe['cname'] = daily_20200220_tscode_list
for table_name in daily_20200220.columns.values.tolist():
    daily_20200220_addname_dataframe[table_name] = daily_20200220[table_name]
print("daily_20200220 返回数据 row 行数 = "+str(daily_20200220.shape[0]))
daily_20200220_addname_dataframe.to_excel(daily_202002_excel_writer,'20_4',index=False)
daily_202002_excel_writer.save()
daily_20200221 = pro.daily(start_date='',end_date='',trade_date='20200221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200221_tscode_list = list() 
for ts_code_sh in daily_20200221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200221_tscode_list.append(stock_name)
daily_20200221_addname_dataframe=pd.DataFrame()
daily_20200221_addname_dataframe['cname'] = daily_20200221_tscode_list
for table_name in daily_20200221.columns.values.tolist():
    daily_20200221_addname_dataframe[table_name] = daily_20200221[table_name]
print("daily_20200221 返回数据 row 行数 = "+str(daily_20200221.shape[0]))
daily_20200221_addname_dataframe.to_excel(daily_202002_excel_writer,'21_5',index=False)
daily_202002_excel_writer.save()
daily_20200222 = pro.daily(start_date='',end_date='',trade_date='20200222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200222_tscode_list = list() 
for ts_code_sh in daily_20200222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200222_tscode_list.append(stock_name)
daily_20200222_addname_dataframe=pd.DataFrame()
daily_20200222_addname_dataframe['cname'] = daily_20200222_tscode_list
for table_name in daily_20200222.columns.values.tolist():
    daily_20200222_addname_dataframe[table_name] = daily_20200222[table_name]
print("daily_20200222 返回数据 row 行数 = "+str(daily_20200222.shape[0]))
daily_20200222_addname_dataframe.to_excel(daily_202002_excel_writer,'22_6',index=False)
daily_202002_excel_writer.save()
daily_20200223 = pro.daily(start_date='',end_date='',trade_date='20200223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200223_tscode_list = list() 
for ts_code_sh in daily_20200223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200223_tscode_list.append(stock_name)
daily_20200223_addname_dataframe=pd.DataFrame()
daily_20200223_addname_dataframe['cname'] = daily_20200223_tscode_list
for table_name in daily_20200223.columns.values.tolist():
    daily_20200223_addname_dataframe[table_name] = daily_20200223[table_name]
print("daily_20200223 返回数据 row 行数 = "+str(daily_20200223.shape[0]))
daily_20200223_addname_dataframe.to_excel(daily_202002_excel_writer,'23_7',index=False)
daily_202002_excel_writer.save()
daily_20200224 = pro.daily(start_date='',end_date='',trade_date='20200224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200224_tscode_list = list() 
for ts_code_sh in daily_20200224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200224_tscode_list.append(stock_name)
daily_20200224_addname_dataframe=pd.DataFrame()
daily_20200224_addname_dataframe['cname'] = daily_20200224_tscode_list
for table_name in daily_20200224.columns.values.tolist():
    daily_20200224_addname_dataframe[table_name] = daily_20200224[table_name]
print("daily_20200224 返回数据 row 行数 = "+str(daily_20200224.shape[0]))
daily_20200224_addname_dataframe.to_excel(daily_202002_excel_writer,'24_1',index=False)
daily_202002_excel_writer.save()
daily_20200225 = pro.daily(start_date='',end_date='',trade_date='20200225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200225_tscode_list = list() 
for ts_code_sh in daily_20200225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200225_tscode_list.append(stock_name)
daily_20200225_addname_dataframe=pd.DataFrame()
daily_20200225_addname_dataframe['cname'] = daily_20200225_tscode_list
for table_name in daily_20200225.columns.values.tolist():
    daily_20200225_addname_dataframe[table_name] = daily_20200225[table_name]
print("daily_20200225 返回数据 row 行数 = "+str(daily_20200225.shape[0]))
daily_20200225_addname_dataframe.to_excel(daily_202002_excel_writer,'25_2',index=False)
daily_202002_excel_writer.save()
daily_20200226 = pro.daily(start_date='',end_date='',trade_date='20200226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200226_tscode_list = list() 
for ts_code_sh in daily_20200226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200226_tscode_list.append(stock_name)
daily_20200226_addname_dataframe=pd.DataFrame()
daily_20200226_addname_dataframe['cname'] = daily_20200226_tscode_list
for table_name in daily_20200226.columns.values.tolist():
    daily_20200226_addname_dataframe[table_name] = daily_20200226[table_name]
print("daily_20200226 返回数据 row 行数 = "+str(daily_20200226.shape[0]))
daily_20200226_addname_dataframe.to_excel(daily_202002_excel_writer,'26_3',index=False)
daily_202002_excel_writer.save()
daily_20200227 = pro.daily(start_date='',end_date='',trade_date='20200227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200227_tscode_list = list() 
for ts_code_sh in daily_20200227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200227_tscode_list.append(stock_name)
daily_20200227_addname_dataframe=pd.DataFrame()
daily_20200227_addname_dataframe['cname'] = daily_20200227_tscode_list
for table_name in daily_20200227.columns.values.tolist():
    daily_20200227_addname_dataframe[table_name] = daily_20200227[table_name]
print("daily_20200227 返回数据 row 行数 = "+str(daily_20200227.shape[0]))
daily_20200227_addname_dataframe.to_excel(daily_202002_excel_writer,'27_4',index=False)
daily_202002_excel_writer.save()
daily_20200228 = pro.daily(start_date='',end_date='',trade_date='20200228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200228_tscode_list = list() 
for ts_code_sh in daily_20200228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200228_tscode_list.append(stock_name)
daily_20200228_addname_dataframe=pd.DataFrame()
daily_20200228_addname_dataframe['cname'] = daily_20200228_tscode_list
for table_name in daily_20200228.columns.values.tolist():
    daily_20200228_addname_dataframe[table_name] = daily_20200228[table_name]
print("daily_20200228 返回数据 row 行数 = "+str(daily_20200228.shape[0]))
daily_20200228_addname_dataframe.to_excel(daily_202002_excel_writer,'28_5',index=False)
daily_202002_excel_writer.save()
daily_20200229 = pro.daily(start_date='',end_date='',trade_date='20200229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200229_tscode_list = list() 
for ts_code_sh in daily_20200229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200229_tscode_list.append(stock_name)
daily_20200229_addname_dataframe=pd.DataFrame()
daily_20200229_addname_dataframe['cname'] = daily_20200229_tscode_list
for table_name in daily_20200229.columns.values.tolist():
    daily_20200229_addname_dataframe[table_name] = daily_20200229[table_name]
print("daily_20200229 返回数据 row 行数 = "+str(daily_20200229.shape[0]))
daily_20200229_addname_dataframe.to_excel(daily_202002_excel_writer,'29_6',index=False)
daily_202002_excel_writer.save()




createexcel('daily_202003.xlsx')
daily_202003_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202003.xlsx')
daily_202003_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202003.xlsx', engine='openpyxl')
daily_202003_excel_writer.book = daily_202003_book
daily_202003_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202003_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200301")       ###  更新 记录日期
daily_20200301 = pro.daily(start_date='',end_date='',trade_date='20200301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200301_tscode_list = list() 
for ts_code_sh in daily_20200301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200301_tscode_list.append(stock_name)
daily_20200301_addname_dataframe=pd.DataFrame()
daily_20200301_addname_dataframe['cname'] = daily_20200301_tscode_list
for table_name in daily_20200301.columns.values.tolist():
    daily_20200301_addname_dataframe[table_name] = daily_20200301[table_name]
print("daily_20200301 返回数据 row 行数 = "+str(daily_20200301.shape[0]))
daily_20200301_addname_dataframe.to_excel(daily_202003_excel_writer,'1_7',index=False)
daily_202003_excel_writer.save()
daily_20200302 = pro.daily(start_date='',end_date='',trade_date='20200302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200302_tscode_list = list() 
for ts_code_sh in daily_20200302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200302_tscode_list.append(stock_name)
daily_20200302_addname_dataframe=pd.DataFrame()
daily_20200302_addname_dataframe['cname'] = daily_20200302_tscode_list
for table_name in daily_20200302.columns.values.tolist():
    daily_20200302_addname_dataframe[table_name] = daily_20200302[table_name]
print("daily_20200302 返回数据 row 行数 = "+str(daily_20200302.shape[0]))
daily_20200302_addname_dataframe.to_excel(daily_202003_excel_writer,'2_1',index=False)
daily_202003_excel_writer.save()
daily_20200303 = pro.daily(start_date='',end_date='',trade_date='20200303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200303_tscode_list = list() 
for ts_code_sh in daily_20200303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200303_tscode_list.append(stock_name)
daily_20200303_addname_dataframe=pd.DataFrame()
daily_20200303_addname_dataframe['cname'] = daily_20200303_tscode_list
for table_name in daily_20200303.columns.values.tolist():
    daily_20200303_addname_dataframe[table_name] = daily_20200303[table_name]
print("daily_20200303 返回数据 row 行数 = "+str(daily_20200303.shape[0]))
daily_20200303_addname_dataframe.to_excel(daily_202003_excel_writer,'3_2',index=False)
daily_202003_excel_writer.save()
daily_20200304 = pro.daily(start_date='',end_date='',trade_date='20200304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200304_tscode_list = list() 
for ts_code_sh in daily_20200304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200304_tscode_list.append(stock_name)
daily_20200304_addname_dataframe=pd.DataFrame()
daily_20200304_addname_dataframe['cname'] = daily_20200304_tscode_list
for table_name in daily_20200304.columns.values.tolist():
    daily_20200304_addname_dataframe[table_name] = daily_20200304[table_name]
print("daily_20200304 返回数据 row 行数 = "+str(daily_20200304.shape[0]))
daily_20200304_addname_dataframe.to_excel(daily_202003_excel_writer,'4_3',index=False)
daily_202003_excel_writer.save()
daily_20200305 = pro.daily(start_date='',end_date='',trade_date='20200305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200305_tscode_list = list() 
for ts_code_sh in daily_20200305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200305_tscode_list.append(stock_name)
daily_20200305_addname_dataframe=pd.DataFrame()
daily_20200305_addname_dataframe['cname'] = daily_20200305_tscode_list
for table_name in daily_20200305.columns.values.tolist():
    daily_20200305_addname_dataframe[table_name] = daily_20200305[table_name]
print("daily_20200305 返回数据 row 行数 = "+str(daily_20200305.shape[0]))
daily_20200305_addname_dataframe.to_excel(daily_202003_excel_writer,'5_4',index=False)
daily_202003_excel_writer.save()
daily_20200306 = pro.daily(start_date='',end_date='',trade_date='20200306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200306_tscode_list = list() 
for ts_code_sh in daily_20200306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200306_tscode_list.append(stock_name)
daily_20200306_addname_dataframe=pd.DataFrame()
daily_20200306_addname_dataframe['cname'] = daily_20200306_tscode_list
for table_name in daily_20200306.columns.values.tolist():
    daily_20200306_addname_dataframe[table_name] = daily_20200306[table_name]
print("daily_20200306 返回数据 row 行数 = "+str(daily_20200306.shape[0]))
daily_20200306_addname_dataframe.to_excel(daily_202003_excel_writer,'6_5',index=False)
daily_202003_excel_writer.save()
daily_20200307 = pro.daily(start_date='',end_date='',trade_date='20200307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200307_tscode_list = list() 
for ts_code_sh in daily_20200307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200307_tscode_list.append(stock_name)
daily_20200307_addname_dataframe=pd.DataFrame()
daily_20200307_addname_dataframe['cname'] = daily_20200307_tscode_list
for table_name in daily_20200307.columns.values.tolist():
    daily_20200307_addname_dataframe[table_name] = daily_20200307[table_name]
print("daily_20200307 返回数据 row 行数 = "+str(daily_20200307.shape[0]))
daily_20200307_addname_dataframe.to_excel(daily_202003_excel_writer,'7_6',index=False)
daily_202003_excel_writer.save()
daily_20200308 = pro.daily(start_date='',end_date='',trade_date='20200308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200308_tscode_list = list() 
for ts_code_sh in daily_20200308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200308_tscode_list.append(stock_name)
daily_20200308_addname_dataframe=pd.DataFrame()
daily_20200308_addname_dataframe['cname'] = daily_20200308_tscode_list
for table_name in daily_20200308.columns.values.tolist():
    daily_20200308_addname_dataframe[table_name] = daily_20200308[table_name]
print("daily_20200308 返回数据 row 行数 = "+str(daily_20200308.shape[0]))
daily_20200308_addname_dataframe.to_excel(daily_202003_excel_writer,'8_7',index=False)
daily_202003_excel_writer.save()
daily_20200309 = pro.daily(start_date='',end_date='',trade_date='20200309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200309_tscode_list = list() 
for ts_code_sh in daily_20200309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200309_tscode_list.append(stock_name)
daily_20200309_addname_dataframe=pd.DataFrame()
daily_20200309_addname_dataframe['cname'] = daily_20200309_tscode_list
for table_name in daily_20200309.columns.values.tolist():
    daily_20200309_addname_dataframe[table_name] = daily_20200309[table_name]
print("daily_20200309 返回数据 row 行数 = "+str(daily_20200309.shape[0]))
daily_20200309_addname_dataframe.to_excel(daily_202003_excel_writer,'9_1',index=False)
daily_202003_excel_writer.save()
daily_20200310 = pro.daily(start_date='',end_date='',trade_date='20200310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200310_tscode_list = list() 
for ts_code_sh in daily_20200310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200310_tscode_list.append(stock_name)
daily_20200310_addname_dataframe=pd.DataFrame()
daily_20200310_addname_dataframe['cname'] = daily_20200310_tscode_list
for table_name in daily_20200310.columns.values.tolist():
    daily_20200310_addname_dataframe[table_name] = daily_20200310[table_name]
print("daily_20200310 返回数据 row 行数 = "+str(daily_20200310.shape[0]))
daily_20200310_addname_dataframe.to_excel(daily_202003_excel_writer,'10_2',index=False)
daily_202003_excel_writer.save()
daily_20200311 = pro.daily(start_date='',end_date='',trade_date='20200311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200311_tscode_list = list() 
for ts_code_sh in daily_20200311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200311_tscode_list.append(stock_name)
daily_20200311_addname_dataframe=pd.DataFrame()
daily_20200311_addname_dataframe['cname'] = daily_20200311_tscode_list
for table_name in daily_20200311.columns.values.tolist():
    daily_20200311_addname_dataframe[table_name] = daily_20200311[table_name]
print("daily_20200311 返回数据 row 行数 = "+str(daily_20200311.shape[0]))
daily_20200311_addname_dataframe.to_excel(daily_202003_excel_writer,'11_3',index=False)
daily_202003_excel_writer.save()
daily_20200312 = pro.daily(start_date='',end_date='',trade_date='20200312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200312_tscode_list = list() 
for ts_code_sh in daily_20200312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200312_tscode_list.append(stock_name)
daily_20200312_addname_dataframe=pd.DataFrame()
daily_20200312_addname_dataframe['cname'] = daily_20200312_tscode_list
for table_name in daily_20200312.columns.values.tolist():
    daily_20200312_addname_dataframe[table_name] = daily_20200312[table_name]
print("daily_20200312 返回数据 row 行数 = "+str(daily_20200312.shape[0]))
daily_20200312_addname_dataframe.to_excel(daily_202003_excel_writer,'12_4',index=False)
daily_202003_excel_writer.save()
daily_20200313 = pro.daily(start_date='',end_date='',trade_date='20200313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200313_tscode_list = list() 
for ts_code_sh in daily_20200313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200313_tscode_list.append(stock_name)
daily_20200313_addname_dataframe=pd.DataFrame()
daily_20200313_addname_dataframe['cname'] = daily_20200313_tscode_list
for table_name in daily_20200313.columns.values.tolist():
    daily_20200313_addname_dataframe[table_name] = daily_20200313[table_name]
print("daily_20200313 返回数据 row 行数 = "+str(daily_20200313.shape[0]))
daily_20200313_addname_dataframe.to_excel(daily_202003_excel_writer,'13_5',index=False)
daily_202003_excel_writer.save()
daily_20200314 = pro.daily(start_date='',end_date='',trade_date='20200314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200314_tscode_list = list() 
for ts_code_sh in daily_20200314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200314_tscode_list.append(stock_name)
daily_20200314_addname_dataframe=pd.DataFrame()
daily_20200314_addname_dataframe['cname'] = daily_20200314_tscode_list
for table_name in daily_20200314.columns.values.tolist():
    daily_20200314_addname_dataframe[table_name] = daily_20200314[table_name]
print("daily_20200314 返回数据 row 行数 = "+str(daily_20200314.shape[0]))
daily_20200314_addname_dataframe.to_excel(daily_202003_excel_writer,'14_6',index=False)
daily_202003_excel_writer.save()
daily_20200315 = pro.daily(start_date='',end_date='',trade_date='20200315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200315_tscode_list = list() 
for ts_code_sh in daily_20200315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200315_tscode_list.append(stock_name)
daily_20200315_addname_dataframe=pd.DataFrame()
daily_20200315_addname_dataframe['cname'] = daily_20200315_tscode_list
for table_name in daily_20200315.columns.values.tolist():
    daily_20200315_addname_dataframe[table_name] = daily_20200315[table_name]
print("daily_20200315 返回数据 row 行数 = "+str(daily_20200315.shape[0]))
daily_20200315_addname_dataframe.to_excel(daily_202003_excel_writer,'15_7',index=False)
daily_202003_excel_writer.save()
daily_20200316 = pro.daily(start_date='',end_date='',trade_date='20200316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200316_tscode_list = list() 
for ts_code_sh in daily_20200316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200316_tscode_list.append(stock_name)
daily_20200316_addname_dataframe=pd.DataFrame()
daily_20200316_addname_dataframe['cname'] = daily_20200316_tscode_list
for table_name in daily_20200316.columns.values.tolist():
    daily_20200316_addname_dataframe[table_name] = daily_20200316[table_name]
print("daily_20200316 返回数据 row 行数 = "+str(daily_20200316.shape[0]))
daily_20200316_addname_dataframe.to_excel(daily_202003_excel_writer,'16_1',index=False)
daily_202003_excel_writer.save()
daily_20200317 = pro.daily(start_date='',end_date='',trade_date='20200317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200317_tscode_list = list() 
for ts_code_sh in daily_20200317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200317_tscode_list.append(stock_name)
daily_20200317_addname_dataframe=pd.DataFrame()
daily_20200317_addname_dataframe['cname'] = daily_20200317_tscode_list
for table_name in daily_20200317.columns.values.tolist():
    daily_20200317_addname_dataframe[table_name] = daily_20200317[table_name]
print("daily_20200317 返回数据 row 行数 = "+str(daily_20200317.shape[0]))
daily_20200317_addname_dataframe.to_excel(daily_202003_excel_writer,'17_2',index=False)
daily_202003_excel_writer.save()
daily_20200318 = pro.daily(start_date='',end_date='',trade_date='20200318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200318_tscode_list = list() 
for ts_code_sh in daily_20200318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200318_tscode_list.append(stock_name)
daily_20200318_addname_dataframe=pd.DataFrame()
daily_20200318_addname_dataframe['cname'] = daily_20200318_tscode_list
for table_name in daily_20200318.columns.values.tolist():
    daily_20200318_addname_dataframe[table_name] = daily_20200318[table_name]
print("daily_20200318 返回数据 row 行数 = "+str(daily_20200318.shape[0]))
daily_20200318_addname_dataframe.to_excel(daily_202003_excel_writer,'18_3',index=False)
daily_202003_excel_writer.save()
daily_20200319 = pro.daily(start_date='',end_date='',trade_date='20200319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200319_tscode_list = list() 
for ts_code_sh in daily_20200319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200319_tscode_list.append(stock_name)
daily_20200319_addname_dataframe=pd.DataFrame()
daily_20200319_addname_dataframe['cname'] = daily_20200319_tscode_list
for table_name in daily_20200319.columns.values.tolist():
    daily_20200319_addname_dataframe[table_name] = daily_20200319[table_name]
print("daily_20200319 返回数据 row 行数 = "+str(daily_20200319.shape[0]))
daily_20200319_addname_dataframe.to_excel(daily_202003_excel_writer,'19_4',index=False)
daily_202003_excel_writer.save()
daily_20200320 = pro.daily(start_date='',end_date='',trade_date='20200320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200320_tscode_list = list() 
for ts_code_sh in daily_20200320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200320_tscode_list.append(stock_name)
daily_20200320_addname_dataframe=pd.DataFrame()
daily_20200320_addname_dataframe['cname'] = daily_20200320_tscode_list
for table_name in daily_20200320.columns.values.tolist():
    daily_20200320_addname_dataframe[table_name] = daily_20200320[table_name]
print("daily_20200320 返回数据 row 行数 = "+str(daily_20200320.shape[0]))
daily_20200320_addname_dataframe.to_excel(daily_202003_excel_writer,'20_5',index=False)
daily_202003_excel_writer.save()
daily_20200321 = pro.daily(start_date='',end_date='',trade_date='20200321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200321_tscode_list = list() 
for ts_code_sh in daily_20200321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200321_tscode_list.append(stock_name)
daily_20200321_addname_dataframe=pd.DataFrame()
daily_20200321_addname_dataframe['cname'] = daily_20200321_tscode_list
for table_name in daily_20200321.columns.values.tolist():
    daily_20200321_addname_dataframe[table_name] = daily_20200321[table_name]
print("daily_20200321 返回数据 row 行数 = "+str(daily_20200321.shape[0]))
daily_20200321_addname_dataframe.to_excel(daily_202003_excel_writer,'21_6',index=False)
daily_202003_excel_writer.save()
daily_20200322 = pro.daily(start_date='',end_date='',trade_date='20200322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200322_tscode_list = list() 
for ts_code_sh in daily_20200322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200322_tscode_list.append(stock_name)
daily_20200322_addname_dataframe=pd.DataFrame()
daily_20200322_addname_dataframe['cname'] = daily_20200322_tscode_list
for table_name in daily_20200322.columns.values.tolist():
    daily_20200322_addname_dataframe[table_name] = daily_20200322[table_name]
print("daily_20200322 返回数据 row 行数 = "+str(daily_20200322.shape[0]))
daily_20200322_addname_dataframe.to_excel(daily_202003_excel_writer,'22_7',index=False)
daily_202003_excel_writer.save()
daily_20200323 = pro.daily(start_date='',end_date='',trade_date='20200323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200323_tscode_list = list() 
for ts_code_sh in daily_20200323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200323_tscode_list.append(stock_name)
daily_20200323_addname_dataframe=pd.DataFrame()
daily_20200323_addname_dataframe['cname'] = daily_20200323_tscode_list
for table_name in daily_20200323.columns.values.tolist():
    daily_20200323_addname_dataframe[table_name] = daily_20200323[table_name]
print("daily_20200323 返回数据 row 行数 = "+str(daily_20200323.shape[0]))
daily_20200323_addname_dataframe.to_excel(daily_202003_excel_writer,'23_1',index=False)
daily_202003_excel_writer.save()
daily_20200324 = pro.daily(start_date='',end_date='',trade_date='20200324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200324_tscode_list = list() 
for ts_code_sh in daily_20200324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200324_tscode_list.append(stock_name)
daily_20200324_addname_dataframe=pd.DataFrame()
daily_20200324_addname_dataframe['cname'] = daily_20200324_tscode_list
for table_name in daily_20200324.columns.values.tolist():
    daily_20200324_addname_dataframe[table_name] = daily_20200324[table_name]
print("daily_20200324 返回数据 row 行数 = "+str(daily_20200324.shape[0]))
daily_20200324_addname_dataframe.to_excel(daily_202003_excel_writer,'24_2',index=False)
daily_202003_excel_writer.save()
daily_20200325 = pro.daily(start_date='',end_date='',trade_date='20200325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200325_tscode_list = list() 
for ts_code_sh in daily_20200325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200325_tscode_list.append(stock_name)
daily_20200325_addname_dataframe=pd.DataFrame()
daily_20200325_addname_dataframe['cname'] = daily_20200325_tscode_list
for table_name in daily_20200325.columns.values.tolist():
    daily_20200325_addname_dataframe[table_name] = daily_20200325[table_name]
print("daily_20200325 返回数据 row 行数 = "+str(daily_20200325.shape[0]))
daily_20200325_addname_dataframe.to_excel(daily_202003_excel_writer,'25_3',index=False)
daily_202003_excel_writer.save()
daily_20200326 = pro.daily(start_date='',end_date='',trade_date='20200326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200326_tscode_list = list() 
for ts_code_sh in daily_20200326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200326_tscode_list.append(stock_name)
daily_20200326_addname_dataframe=pd.DataFrame()
daily_20200326_addname_dataframe['cname'] = daily_20200326_tscode_list
for table_name in daily_20200326.columns.values.tolist():
    daily_20200326_addname_dataframe[table_name] = daily_20200326[table_name]
print("daily_20200326 返回数据 row 行数 = "+str(daily_20200326.shape[0]))
daily_20200326_addname_dataframe.to_excel(daily_202003_excel_writer,'26_4',index=False)
daily_202003_excel_writer.save()
daily_20200327 = pro.daily(start_date='',end_date='',trade_date='20200327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200327_tscode_list = list() 
for ts_code_sh in daily_20200327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200327_tscode_list.append(stock_name)
daily_20200327_addname_dataframe=pd.DataFrame()
daily_20200327_addname_dataframe['cname'] = daily_20200327_tscode_list
for table_name in daily_20200327.columns.values.tolist():
    daily_20200327_addname_dataframe[table_name] = daily_20200327[table_name]
print("daily_20200327 返回数据 row 行数 = "+str(daily_20200327.shape[0]))
daily_20200327_addname_dataframe.to_excel(daily_202003_excel_writer,'27_5',index=False)
daily_202003_excel_writer.save()
daily_20200328 = pro.daily(start_date='',end_date='',trade_date='20200328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200328_tscode_list = list() 
for ts_code_sh in daily_20200328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200328_tscode_list.append(stock_name)
daily_20200328_addname_dataframe=pd.DataFrame()
daily_20200328_addname_dataframe['cname'] = daily_20200328_tscode_list
for table_name in daily_20200328.columns.values.tolist():
    daily_20200328_addname_dataframe[table_name] = daily_20200328[table_name]
print("daily_20200328 返回数据 row 行数 = "+str(daily_20200328.shape[0]))
daily_20200328_addname_dataframe.to_excel(daily_202003_excel_writer,'28_6',index=False)
daily_202003_excel_writer.save()
daily_20200329 = pro.daily(start_date='',end_date='',trade_date='20200329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200329_tscode_list = list() 
for ts_code_sh in daily_20200329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200329_tscode_list.append(stock_name)
daily_20200329_addname_dataframe=pd.DataFrame()
daily_20200329_addname_dataframe['cname'] = daily_20200329_tscode_list
for table_name in daily_20200329.columns.values.tolist():
    daily_20200329_addname_dataframe[table_name] = daily_20200329[table_name]
print("daily_20200329 返回数据 row 行数 = "+str(daily_20200329.shape[0]))
daily_20200329_addname_dataframe.to_excel(daily_202003_excel_writer,'29_7',index=False)
daily_202003_excel_writer.save()
daily_20200330 = pro.daily(start_date='',end_date='',trade_date='20200330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200330_tscode_list = list() 
for ts_code_sh in daily_20200330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200330_tscode_list.append(stock_name)
daily_20200330_addname_dataframe=pd.DataFrame()
daily_20200330_addname_dataframe['cname'] = daily_20200330_tscode_list
for table_name in daily_20200330.columns.values.tolist():
    daily_20200330_addname_dataframe[table_name] = daily_20200330[table_name]
print("daily_20200330 返回数据 row 行数 = "+str(daily_20200330.shape[0]))
daily_20200330_addname_dataframe.to_excel(daily_202003_excel_writer,'30_1',index=False)
daily_202003_excel_writer.save()
daily_20200331 = pro.daily(start_date='',end_date='',trade_date='20200331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200331_tscode_list = list() 
for ts_code_sh in daily_20200331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200331_tscode_list.append(stock_name)
daily_20200331_addname_dataframe=pd.DataFrame()
daily_20200331_addname_dataframe['cname'] = daily_20200331_tscode_list
for table_name in daily_20200331.columns.values.tolist():
    daily_20200331_addname_dataframe[table_name] = daily_20200331[table_name]
print("daily_20200331 返回数据 row 行数 = "+str(daily_20200331.shape[0]))
daily_20200331_addname_dataframe.to_excel(daily_202003_excel_writer,'31_2',index=False)
daily_202003_excel_writer.save()




createexcel('daily_202004.xlsx')
daily_202004_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202004.xlsx')
daily_202004_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202004.xlsx', engine='openpyxl')
daily_202004_excel_writer.book = daily_202004_book
daily_202004_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202004_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200401")       ###  更新 记录日期
daily_20200401 = pro.daily(start_date='',end_date='',trade_date='20200401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200401_tscode_list = list() 
for ts_code_sh in daily_20200401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200401_tscode_list.append(stock_name)
daily_20200401_addname_dataframe=pd.DataFrame()
daily_20200401_addname_dataframe['cname'] = daily_20200401_tscode_list
for table_name in daily_20200401.columns.values.tolist():
    daily_20200401_addname_dataframe[table_name] = daily_20200401[table_name]
print("daily_20200401 返回数据 row 行数 = "+str(daily_20200401.shape[0]))
daily_20200401_addname_dataframe.to_excel(daily_202004_excel_writer,'1_3',index=False)
daily_202004_excel_writer.save()
daily_20200402 = pro.daily(start_date='',end_date='',trade_date='20200402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200402_tscode_list = list() 
for ts_code_sh in daily_20200402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200402_tscode_list.append(stock_name)
daily_20200402_addname_dataframe=pd.DataFrame()
daily_20200402_addname_dataframe['cname'] = daily_20200402_tscode_list
for table_name in daily_20200402.columns.values.tolist():
    daily_20200402_addname_dataframe[table_name] = daily_20200402[table_name]
print("daily_20200402 返回数据 row 行数 = "+str(daily_20200402.shape[0]))
daily_20200402_addname_dataframe.to_excel(daily_202004_excel_writer,'2_4',index=False)
daily_202004_excel_writer.save()
daily_20200403 = pro.daily(start_date='',end_date='',trade_date='20200403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200403_tscode_list = list() 
for ts_code_sh in daily_20200403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200403_tscode_list.append(stock_name)
daily_20200403_addname_dataframe=pd.DataFrame()
daily_20200403_addname_dataframe['cname'] = daily_20200403_tscode_list
for table_name in daily_20200403.columns.values.tolist():
    daily_20200403_addname_dataframe[table_name] = daily_20200403[table_name]
print("daily_20200403 返回数据 row 行数 = "+str(daily_20200403.shape[0]))
daily_20200403_addname_dataframe.to_excel(daily_202004_excel_writer,'3_5',index=False)
daily_202004_excel_writer.save()
daily_20200404 = pro.daily(start_date='',end_date='',trade_date='20200404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200404_tscode_list = list() 
for ts_code_sh in daily_20200404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200404_tscode_list.append(stock_name)
daily_20200404_addname_dataframe=pd.DataFrame()
daily_20200404_addname_dataframe['cname'] = daily_20200404_tscode_list
for table_name in daily_20200404.columns.values.tolist():
    daily_20200404_addname_dataframe[table_name] = daily_20200404[table_name]
print("daily_20200404 返回数据 row 行数 = "+str(daily_20200404.shape[0]))
daily_20200404_addname_dataframe.to_excel(daily_202004_excel_writer,'4_6',index=False)
daily_202004_excel_writer.save()
daily_20200405 = pro.daily(start_date='',end_date='',trade_date='20200405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200405_tscode_list = list() 
for ts_code_sh in daily_20200405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200405_tscode_list.append(stock_name)
daily_20200405_addname_dataframe=pd.DataFrame()
daily_20200405_addname_dataframe['cname'] = daily_20200405_tscode_list
for table_name in daily_20200405.columns.values.tolist():
    daily_20200405_addname_dataframe[table_name] = daily_20200405[table_name]
print("daily_20200405 返回数据 row 行数 = "+str(daily_20200405.shape[0]))
daily_20200405_addname_dataframe.to_excel(daily_202004_excel_writer,'5_7',index=False)
daily_202004_excel_writer.save()
daily_20200406 = pro.daily(start_date='',end_date='',trade_date='20200406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200406_tscode_list = list() 
for ts_code_sh in daily_20200406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200406_tscode_list.append(stock_name)
daily_20200406_addname_dataframe=pd.DataFrame()
daily_20200406_addname_dataframe['cname'] = daily_20200406_tscode_list
for table_name in daily_20200406.columns.values.tolist():
    daily_20200406_addname_dataframe[table_name] = daily_20200406[table_name]
print("daily_20200406 返回数据 row 行数 = "+str(daily_20200406.shape[0]))
daily_20200406_addname_dataframe.to_excel(daily_202004_excel_writer,'6_1',index=False)
daily_202004_excel_writer.save()
daily_20200407 = pro.daily(start_date='',end_date='',trade_date='20200407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200407_tscode_list = list() 
for ts_code_sh in daily_20200407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200407_tscode_list.append(stock_name)
daily_20200407_addname_dataframe=pd.DataFrame()
daily_20200407_addname_dataframe['cname'] = daily_20200407_tscode_list
for table_name in daily_20200407.columns.values.tolist():
    daily_20200407_addname_dataframe[table_name] = daily_20200407[table_name]
print("daily_20200407 返回数据 row 行数 = "+str(daily_20200407.shape[0]))
daily_20200407_addname_dataframe.to_excel(daily_202004_excel_writer,'7_2',index=False)
daily_202004_excel_writer.save()
daily_20200408 = pro.daily(start_date='',end_date='',trade_date='20200408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200408_tscode_list = list() 
for ts_code_sh in daily_20200408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200408_tscode_list.append(stock_name)
daily_20200408_addname_dataframe=pd.DataFrame()
daily_20200408_addname_dataframe['cname'] = daily_20200408_tscode_list
for table_name in daily_20200408.columns.values.tolist():
    daily_20200408_addname_dataframe[table_name] = daily_20200408[table_name]
print("daily_20200408 返回数据 row 行数 = "+str(daily_20200408.shape[0]))
daily_20200408_addname_dataframe.to_excel(daily_202004_excel_writer,'8_3',index=False)
daily_202004_excel_writer.save()
daily_20200409 = pro.daily(start_date='',end_date='',trade_date='20200409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200409_tscode_list = list() 
for ts_code_sh in daily_20200409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200409_tscode_list.append(stock_name)
daily_20200409_addname_dataframe=pd.DataFrame()
daily_20200409_addname_dataframe['cname'] = daily_20200409_tscode_list
for table_name in daily_20200409.columns.values.tolist():
    daily_20200409_addname_dataframe[table_name] = daily_20200409[table_name]
print("daily_20200409 返回数据 row 行数 = "+str(daily_20200409.shape[0]))
daily_20200409_addname_dataframe.to_excel(daily_202004_excel_writer,'9_4',index=False)
daily_202004_excel_writer.save()
daily_20200410 = pro.daily(start_date='',end_date='',trade_date='20200410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200410_tscode_list = list() 
for ts_code_sh in daily_20200410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200410_tscode_list.append(stock_name)
daily_20200410_addname_dataframe=pd.DataFrame()
daily_20200410_addname_dataframe['cname'] = daily_20200410_tscode_list
for table_name in daily_20200410.columns.values.tolist():
    daily_20200410_addname_dataframe[table_name] = daily_20200410[table_name]
print("daily_20200410 返回数据 row 行数 = "+str(daily_20200410.shape[0]))
daily_20200410_addname_dataframe.to_excel(daily_202004_excel_writer,'10_5',index=False)
daily_202004_excel_writer.save()
daily_20200411 = pro.daily(start_date='',end_date='',trade_date='20200411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200411_tscode_list = list() 
for ts_code_sh in daily_20200411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200411_tscode_list.append(stock_name)
daily_20200411_addname_dataframe=pd.DataFrame()
daily_20200411_addname_dataframe['cname'] = daily_20200411_tscode_list
for table_name in daily_20200411.columns.values.tolist():
    daily_20200411_addname_dataframe[table_name] = daily_20200411[table_name]
print("daily_20200411 返回数据 row 行数 = "+str(daily_20200411.shape[0]))
daily_20200411_addname_dataframe.to_excel(daily_202004_excel_writer,'11_6',index=False)
daily_202004_excel_writer.save()
daily_20200412 = pro.daily(start_date='',end_date='',trade_date='20200412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200412_tscode_list = list() 
for ts_code_sh in daily_20200412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200412_tscode_list.append(stock_name)
daily_20200412_addname_dataframe=pd.DataFrame()
daily_20200412_addname_dataframe['cname'] = daily_20200412_tscode_list
for table_name in daily_20200412.columns.values.tolist():
    daily_20200412_addname_dataframe[table_name] = daily_20200412[table_name]
print("daily_20200412 返回数据 row 行数 = "+str(daily_20200412.shape[0]))
daily_20200412_addname_dataframe.to_excel(daily_202004_excel_writer,'12_7',index=False)
daily_202004_excel_writer.save()
daily_20200413 = pro.daily(start_date='',end_date='',trade_date='20200413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200413_tscode_list = list() 
for ts_code_sh in daily_20200413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200413_tscode_list.append(stock_name)
daily_20200413_addname_dataframe=pd.DataFrame()
daily_20200413_addname_dataframe['cname'] = daily_20200413_tscode_list
for table_name in daily_20200413.columns.values.tolist():
    daily_20200413_addname_dataframe[table_name] = daily_20200413[table_name]
print("daily_20200413 返回数据 row 行数 = "+str(daily_20200413.shape[0]))
daily_20200413_addname_dataframe.to_excel(daily_202004_excel_writer,'13_1',index=False)
daily_202004_excel_writer.save()
daily_20200414 = pro.daily(start_date='',end_date='',trade_date='20200414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200414_tscode_list = list() 
for ts_code_sh in daily_20200414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200414_tscode_list.append(stock_name)
daily_20200414_addname_dataframe=pd.DataFrame()
daily_20200414_addname_dataframe['cname'] = daily_20200414_tscode_list
for table_name in daily_20200414.columns.values.tolist():
    daily_20200414_addname_dataframe[table_name] = daily_20200414[table_name]
print("daily_20200414 返回数据 row 行数 = "+str(daily_20200414.shape[0]))
daily_20200414_addname_dataframe.to_excel(daily_202004_excel_writer,'14_2',index=False)
daily_202004_excel_writer.save()
daily_20200415 = pro.daily(start_date='',end_date='',trade_date='20200415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200415_tscode_list = list() 
for ts_code_sh in daily_20200415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200415_tscode_list.append(stock_name)
daily_20200415_addname_dataframe=pd.DataFrame()
daily_20200415_addname_dataframe['cname'] = daily_20200415_tscode_list
for table_name in daily_20200415.columns.values.tolist():
    daily_20200415_addname_dataframe[table_name] = daily_20200415[table_name]
print("daily_20200415 返回数据 row 行数 = "+str(daily_20200415.shape[0]))
daily_20200415_addname_dataframe.to_excel(daily_202004_excel_writer,'15_3',index=False)
daily_202004_excel_writer.save()
daily_20200416 = pro.daily(start_date='',end_date='',trade_date='20200416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200416_tscode_list = list() 
for ts_code_sh in daily_20200416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200416_tscode_list.append(stock_name)
daily_20200416_addname_dataframe=pd.DataFrame()
daily_20200416_addname_dataframe['cname'] = daily_20200416_tscode_list
for table_name in daily_20200416.columns.values.tolist():
    daily_20200416_addname_dataframe[table_name] = daily_20200416[table_name]
print("daily_20200416 返回数据 row 行数 = "+str(daily_20200416.shape[0]))
daily_20200416_addname_dataframe.to_excel(daily_202004_excel_writer,'16_4',index=False)
daily_202004_excel_writer.save()
daily_20200417 = pro.daily(start_date='',end_date='',trade_date='20200417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200417_tscode_list = list() 
for ts_code_sh in daily_20200417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200417_tscode_list.append(stock_name)
daily_20200417_addname_dataframe=pd.DataFrame()
daily_20200417_addname_dataframe['cname'] = daily_20200417_tscode_list
for table_name in daily_20200417.columns.values.tolist():
    daily_20200417_addname_dataframe[table_name] = daily_20200417[table_name]
print("daily_20200417 返回数据 row 行数 = "+str(daily_20200417.shape[0]))
daily_20200417_addname_dataframe.to_excel(daily_202004_excel_writer,'17_5',index=False)
daily_202004_excel_writer.save()
daily_20200418 = pro.daily(start_date='',end_date='',trade_date='20200418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200418_tscode_list = list() 
for ts_code_sh in daily_20200418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200418_tscode_list.append(stock_name)
daily_20200418_addname_dataframe=pd.DataFrame()
daily_20200418_addname_dataframe['cname'] = daily_20200418_tscode_list
for table_name in daily_20200418.columns.values.tolist():
    daily_20200418_addname_dataframe[table_name] = daily_20200418[table_name]
print("daily_20200418 返回数据 row 行数 = "+str(daily_20200418.shape[0]))
daily_20200418_addname_dataframe.to_excel(daily_202004_excel_writer,'18_6',index=False)
daily_202004_excel_writer.save()
daily_20200419 = pro.daily(start_date='',end_date='',trade_date='20200419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200419_tscode_list = list() 
for ts_code_sh in daily_20200419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200419_tscode_list.append(stock_name)
daily_20200419_addname_dataframe=pd.DataFrame()
daily_20200419_addname_dataframe['cname'] = daily_20200419_tscode_list
for table_name in daily_20200419.columns.values.tolist():
    daily_20200419_addname_dataframe[table_name] = daily_20200419[table_name]
print("daily_20200419 返回数据 row 行数 = "+str(daily_20200419.shape[0]))
daily_20200419_addname_dataframe.to_excel(daily_202004_excel_writer,'19_7',index=False)
daily_202004_excel_writer.save()
daily_20200420 = pro.daily(start_date='',end_date='',trade_date='20200420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200420_tscode_list = list() 
for ts_code_sh in daily_20200420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200420_tscode_list.append(stock_name)
daily_20200420_addname_dataframe=pd.DataFrame()
daily_20200420_addname_dataframe['cname'] = daily_20200420_tscode_list
for table_name in daily_20200420.columns.values.tolist():
    daily_20200420_addname_dataframe[table_name] = daily_20200420[table_name]
print("daily_20200420 返回数据 row 行数 = "+str(daily_20200420.shape[0]))
daily_20200420_addname_dataframe.to_excel(daily_202004_excel_writer,'20_1',index=False)
daily_202004_excel_writer.save()
daily_20200421 = pro.daily(start_date='',end_date='',trade_date='20200421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200421_tscode_list = list() 
for ts_code_sh in daily_20200421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200421_tscode_list.append(stock_name)
daily_20200421_addname_dataframe=pd.DataFrame()
daily_20200421_addname_dataframe['cname'] = daily_20200421_tscode_list
for table_name in daily_20200421.columns.values.tolist():
    daily_20200421_addname_dataframe[table_name] = daily_20200421[table_name]
print("daily_20200421 返回数据 row 行数 = "+str(daily_20200421.shape[0]))
daily_20200421_addname_dataframe.to_excel(daily_202004_excel_writer,'21_2',index=False)
daily_202004_excel_writer.save()
daily_20200422 = pro.daily(start_date='',end_date='',trade_date='20200422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200422_tscode_list = list() 
for ts_code_sh in daily_20200422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200422_tscode_list.append(stock_name)
daily_20200422_addname_dataframe=pd.DataFrame()
daily_20200422_addname_dataframe['cname'] = daily_20200422_tscode_list
for table_name in daily_20200422.columns.values.tolist():
    daily_20200422_addname_dataframe[table_name] = daily_20200422[table_name]
print("daily_20200422 返回数据 row 行数 = "+str(daily_20200422.shape[0]))
daily_20200422_addname_dataframe.to_excel(daily_202004_excel_writer,'22_3',index=False)
daily_202004_excel_writer.save()
daily_20200423 = pro.daily(start_date='',end_date='',trade_date='20200423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200423_tscode_list = list() 
for ts_code_sh in daily_20200423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200423_tscode_list.append(stock_name)
daily_20200423_addname_dataframe=pd.DataFrame()
daily_20200423_addname_dataframe['cname'] = daily_20200423_tscode_list
for table_name in daily_20200423.columns.values.tolist():
    daily_20200423_addname_dataframe[table_name] = daily_20200423[table_name]
print("daily_20200423 返回数据 row 行数 = "+str(daily_20200423.shape[0]))
daily_20200423_addname_dataframe.to_excel(daily_202004_excel_writer,'23_4',index=False)
daily_202004_excel_writer.save()
daily_20200424 = pro.daily(start_date='',end_date='',trade_date='20200424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200424_tscode_list = list() 
for ts_code_sh in daily_20200424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200424_tscode_list.append(stock_name)
daily_20200424_addname_dataframe=pd.DataFrame()
daily_20200424_addname_dataframe['cname'] = daily_20200424_tscode_list
for table_name in daily_20200424.columns.values.tolist():
    daily_20200424_addname_dataframe[table_name] = daily_20200424[table_name]
print("daily_20200424 返回数据 row 行数 = "+str(daily_20200424.shape[0]))
daily_20200424_addname_dataframe.to_excel(daily_202004_excel_writer,'24_5',index=False)
daily_202004_excel_writer.save()
daily_20200425 = pro.daily(start_date='',end_date='',trade_date='20200425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200425_tscode_list = list() 
for ts_code_sh in daily_20200425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200425_tscode_list.append(stock_name)
daily_20200425_addname_dataframe=pd.DataFrame()
daily_20200425_addname_dataframe['cname'] = daily_20200425_tscode_list
for table_name in daily_20200425.columns.values.tolist():
    daily_20200425_addname_dataframe[table_name] = daily_20200425[table_name]
print("daily_20200425 返回数据 row 行数 = "+str(daily_20200425.shape[0]))
daily_20200425_addname_dataframe.to_excel(daily_202004_excel_writer,'25_6',index=False)
daily_202004_excel_writer.save()
daily_20200426 = pro.daily(start_date='',end_date='',trade_date='20200426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200426_tscode_list = list() 
for ts_code_sh in daily_20200426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200426_tscode_list.append(stock_name)
daily_20200426_addname_dataframe=pd.DataFrame()
daily_20200426_addname_dataframe['cname'] = daily_20200426_tscode_list
for table_name in daily_20200426.columns.values.tolist():
    daily_20200426_addname_dataframe[table_name] = daily_20200426[table_name]
print("daily_20200426 返回数据 row 行数 = "+str(daily_20200426.shape[0]))
daily_20200426_addname_dataframe.to_excel(daily_202004_excel_writer,'26_7',index=False)
daily_202004_excel_writer.save()
daily_20200427 = pro.daily(start_date='',end_date='',trade_date='20200427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200427_tscode_list = list() 
for ts_code_sh in daily_20200427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200427_tscode_list.append(stock_name)
daily_20200427_addname_dataframe=pd.DataFrame()
daily_20200427_addname_dataframe['cname'] = daily_20200427_tscode_list
for table_name in daily_20200427.columns.values.tolist():
    daily_20200427_addname_dataframe[table_name] = daily_20200427[table_name]
print("daily_20200427 返回数据 row 行数 = "+str(daily_20200427.shape[0]))
daily_20200427_addname_dataframe.to_excel(daily_202004_excel_writer,'27_1',index=False)
daily_202004_excel_writer.save()
daily_20200428 = pro.daily(start_date='',end_date='',trade_date='20200428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200428_tscode_list = list() 
for ts_code_sh in daily_20200428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200428_tscode_list.append(stock_name)
daily_20200428_addname_dataframe=pd.DataFrame()
daily_20200428_addname_dataframe['cname'] = daily_20200428_tscode_list
for table_name in daily_20200428.columns.values.tolist():
    daily_20200428_addname_dataframe[table_name] = daily_20200428[table_name]
print("daily_20200428 返回数据 row 行数 = "+str(daily_20200428.shape[0]))
daily_20200428_addname_dataframe.to_excel(daily_202004_excel_writer,'28_2',index=False)
daily_202004_excel_writer.save()
daily_20200429 = pro.daily(start_date='',end_date='',trade_date='20200429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200429_tscode_list = list() 
for ts_code_sh in daily_20200429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200429_tscode_list.append(stock_name)
daily_20200429_addname_dataframe=pd.DataFrame()
daily_20200429_addname_dataframe['cname'] = daily_20200429_tscode_list
for table_name in daily_20200429.columns.values.tolist():
    daily_20200429_addname_dataframe[table_name] = daily_20200429[table_name]
print("daily_20200429 返回数据 row 行数 = "+str(daily_20200429.shape[0]))
daily_20200429_addname_dataframe.to_excel(daily_202004_excel_writer,'29_3',index=False)
daily_202004_excel_writer.save()
daily_20200430 = pro.daily(start_date='',end_date='',trade_date='20200430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200430_tscode_list = list() 
for ts_code_sh in daily_20200430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200430_tscode_list.append(stock_name)
daily_20200430_addname_dataframe=pd.DataFrame()
daily_20200430_addname_dataframe['cname'] = daily_20200430_tscode_list
for table_name in daily_20200430.columns.values.tolist():
    daily_20200430_addname_dataframe[table_name] = daily_20200430[table_name]
print("daily_20200430 返回数据 row 行数 = "+str(daily_20200430.shape[0]))
daily_20200430_addname_dataframe.to_excel(daily_202004_excel_writer,'30_4',index=False)
daily_202004_excel_writer.save()




createexcel('daily_202005.xlsx')
daily_202005_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202005.xlsx')
daily_202005_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202005.xlsx', engine='openpyxl')
daily_202005_excel_writer.book = daily_202005_book
daily_202005_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202005_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200501")       ###  更新 记录日期
daily_20200501 = pro.daily(start_date='',end_date='',trade_date='20200501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200501_tscode_list = list() 
for ts_code_sh in daily_20200501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200501_tscode_list.append(stock_name)
daily_20200501_addname_dataframe=pd.DataFrame()
daily_20200501_addname_dataframe['cname'] = daily_20200501_tscode_list
for table_name in daily_20200501.columns.values.tolist():
    daily_20200501_addname_dataframe[table_name] = daily_20200501[table_name]
print("daily_20200501 返回数据 row 行数 = "+str(daily_20200501.shape[0]))
daily_20200501_addname_dataframe.to_excel(daily_202005_excel_writer,'1_5',index=False)
daily_202005_excel_writer.save()
daily_20200502 = pro.daily(start_date='',end_date='',trade_date='20200502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200502_tscode_list = list() 
for ts_code_sh in daily_20200502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200502_tscode_list.append(stock_name)
daily_20200502_addname_dataframe=pd.DataFrame()
daily_20200502_addname_dataframe['cname'] = daily_20200502_tscode_list
for table_name in daily_20200502.columns.values.tolist():
    daily_20200502_addname_dataframe[table_name] = daily_20200502[table_name]
print("daily_20200502 返回数据 row 行数 = "+str(daily_20200502.shape[0]))
daily_20200502_addname_dataframe.to_excel(daily_202005_excel_writer,'2_6',index=False)
daily_202005_excel_writer.save()
daily_20200503 = pro.daily(start_date='',end_date='',trade_date='20200503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200503_tscode_list = list() 
for ts_code_sh in daily_20200503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200503_tscode_list.append(stock_name)
daily_20200503_addname_dataframe=pd.DataFrame()
daily_20200503_addname_dataframe['cname'] = daily_20200503_tscode_list
for table_name in daily_20200503.columns.values.tolist():
    daily_20200503_addname_dataframe[table_name] = daily_20200503[table_name]
print("daily_20200503 返回数据 row 行数 = "+str(daily_20200503.shape[0]))
daily_20200503_addname_dataframe.to_excel(daily_202005_excel_writer,'3_7',index=False)
daily_202005_excel_writer.save()
daily_20200504 = pro.daily(start_date='',end_date='',trade_date='20200504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200504_tscode_list = list() 
for ts_code_sh in daily_20200504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200504_tscode_list.append(stock_name)
daily_20200504_addname_dataframe=pd.DataFrame()
daily_20200504_addname_dataframe['cname'] = daily_20200504_tscode_list
for table_name in daily_20200504.columns.values.tolist():
    daily_20200504_addname_dataframe[table_name] = daily_20200504[table_name]
print("daily_20200504 返回数据 row 行数 = "+str(daily_20200504.shape[0]))
daily_20200504_addname_dataframe.to_excel(daily_202005_excel_writer,'4_1',index=False)
daily_202005_excel_writer.save()
daily_20200505 = pro.daily(start_date='',end_date='',trade_date='20200505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200505_tscode_list = list() 
for ts_code_sh in daily_20200505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200505_tscode_list.append(stock_name)
daily_20200505_addname_dataframe=pd.DataFrame()
daily_20200505_addname_dataframe['cname'] = daily_20200505_tscode_list
for table_name in daily_20200505.columns.values.tolist():
    daily_20200505_addname_dataframe[table_name] = daily_20200505[table_name]
print("daily_20200505 返回数据 row 行数 = "+str(daily_20200505.shape[0]))
daily_20200505_addname_dataframe.to_excel(daily_202005_excel_writer,'5_2',index=False)
daily_202005_excel_writer.save()
daily_20200506 = pro.daily(start_date='',end_date='',trade_date='20200506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200506_tscode_list = list() 
for ts_code_sh in daily_20200506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200506_tscode_list.append(stock_name)
daily_20200506_addname_dataframe=pd.DataFrame()
daily_20200506_addname_dataframe['cname'] = daily_20200506_tscode_list
for table_name in daily_20200506.columns.values.tolist():
    daily_20200506_addname_dataframe[table_name] = daily_20200506[table_name]
print("daily_20200506 返回数据 row 行数 = "+str(daily_20200506.shape[0]))
daily_20200506_addname_dataframe.to_excel(daily_202005_excel_writer,'6_3',index=False)
daily_202005_excel_writer.save()
daily_20200507 = pro.daily(start_date='',end_date='',trade_date='20200507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200507_tscode_list = list() 
for ts_code_sh in daily_20200507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200507_tscode_list.append(stock_name)
daily_20200507_addname_dataframe=pd.DataFrame()
daily_20200507_addname_dataframe['cname'] = daily_20200507_tscode_list
for table_name in daily_20200507.columns.values.tolist():
    daily_20200507_addname_dataframe[table_name] = daily_20200507[table_name]
print("daily_20200507 返回数据 row 行数 = "+str(daily_20200507.shape[0]))
daily_20200507_addname_dataframe.to_excel(daily_202005_excel_writer,'7_4',index=False)
daily_202005_excel_writer.save()
daily_20200508 = pro.daily(start_date='',end_date='',trade_date='20200508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200508_tscode_list = list() 
for ts_code_sh in daily_20200508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200508_tscode_list.append(stock_name)
daily_20200508_addname_dataframe=pd.DataFrame()
daily_20200508_addname_dataframe['cname'] = daily_20200508_tscode_list
for table_name in daily_20200508.columns.values.tolist():
    daily_20200508_addname_dataframe[table_name] = daily_20200508[table_name]
print("daily_20200508 返回数据 row 行数 = "+str(daily_20200508.shape[0]))
daily_20200508_addname_dataframe.to_excel(daily_202005_excel_writer,'8_5',index=False)
daily_202005_excel_writer.save()
daily_20200509 = pro.daily(start_date='',end_date='',trade_date='20200509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200509_tscode_list = list() 
for ts_code_sh in daily_20200509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200509_tscode_list.append(stock_name)
daily_20200509_addname_dataframe=pd.DataFrame()
daily_20200509_addname_dataframe['cname'] = daily_20200509_tscode_list
for table_name in daily_20200509.columns.values.tolist():
    daily_20200509_addname_dataframe[table_name] = daily_20200509[table_name]
print("daily_20200509 返回数据 row 行数 = "+str(daily_20200509.shape[0]))
daily_20200509_addname_dataframe.to_excel(daily_202005_excel_writer,'9_6',index=False)
daily_202005_excel_writer.save()
daily_20200510 = pro.daily(start_date='',end_date='',trade_date='20200510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200510_tscode_list = list() 
for ts_code_sh in daily_20200510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200510_tscode_list.append(stock_name)
daily_20200510_addname_dataframe=pd.DataFrame()
daily_20200510_addname_dataframe['cname'] = daily_20200510_tscode_list
for table_name in daily_20200510.columns.values.tolist():
    daily_20200510_addname_dataframe[table_name] = daily_20200510[table_name]
print("daily_20200510 返回数据 row 行数 = "+str(daily_20200510.shape[0]))
daily_20200510_addname_dataframe.to_excel(daily_202005_excel_writer,'10_7',index=False)
daily_202005_excel_writer.save()
daily_20200511 = pro.daily(start_date='',end_date='',trade_date='20200511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200511_tscode_list = list() 
for ts_code_sh in daily_20200511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200511_tscode_list.append(stock_name)
daily_20200511_addname_dataframe=pd.DataFrame()
daily_20200511_addname_dataframe['cname'] = daily_20200511_tscode_list
for table_name in daily_20200511.columns.values.tolist():
    daily_20200511_addname_dataframe[table_name] = daily_20200511[table_name]
print("daily_20200511 返回数据 row 行数 = "+str(daily_20200511.shape[0]))
daily_20200511_addname_dataframe.to_excel(daily_202005_excel_writer,'11_1',index=False)
daily_202005_excel_writer.save()
daily_20200512 = pro.daily(start_date='',end_date='',trade_date='20200512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200512_tscode_list = list() 
for ts_code_sh in daily_20200512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200512_tscode_list.append(stock_name)
daily_20200512_addname_dataframe=pd.DataFrame()
daily_20200512_addname_dataframe['cname'] = daily_20200512_tscode_list
for table_name in daily_20200512.columns.values.tolist():
    daily_20200512_addname_dataframe[table_name] = daily_20200512[table_name]
print("daily_20200512 返回数据 row 行数 = "+str(daily_20200512.shape[0]))
daily_20200512_addname_dataframe.to_excel(daily_202005_excel_writer,'12_2',index=False)
daily_202005_excel_writer.save()
daily_20200513 = pro.daily(start_date='',end_date='',trade_date='20200513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200513_tscode_list = list() 
for ts_code_sh in daily_20200513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200513_tscode_list.append(stock_name)
daily_20200513_addname_dataframe=pd.DataFrame()
daily_20200513_addname_dataframe['cname'] = daily_20200513_tscode_list
for table_name in daily_20200513.columns.values.tolist():
    daily_20200513_addname_dataframe[table_name] = daily_20200513[table_name]
print("daily_20200513 返回数据 row 行数 = "+str(daily_20200513.shape[0]))
daily_20200513_addname_dataframe.to_excel(daily_202005_excel_writer,'13_3',index=False)
daily_202005_excel_writer.save()
daily_20200514 = pro.daily(start_date='',end_date='',trade_date='20200514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200514_tscode_list = list() 
for ts_code_sh in daily_20200514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200514_tscode_list.append(stock_name)
daily_20200514_addname_dataframe=pd.DataFrame()
daily_20200514_addname_dataframe['cname'] = daily_20200514_tscode_list
for table_name in daily_20200514.columns.values.tolist():
    daily_20200514_addname_dataframe[table_name] = daily_20200514[table_name]
print("daily_20200514 返回数据 row 行数 = "+str(daily_20200514.shape[0]))
daily_20200514_addname_dataframe.to_excel(daily_202005_excel_writer,'14_4',index=False)
daily_202005_excel_writer.save()
daily_20200515 = pro.daily(start_date='',end_date='',trade_date='20200515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200515_tscode_list = list() 
for ts_code_sh in daily_20200515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200515_tscode_list.append(stock_name)
daily_20200515_addname_dataframe=pd.DataFrame()
daily_20200515_addname_dataframe['cname'] = daily_20200515_tscode_list
for table_name in daily_20200515.columns.values.tolist():
    daily_20200515_addname_dataframe[table_name] = daily_20200515[table_name]
print("daily_20200515 返回数据 row 行数 = "+str(daily_20200515.shape[0]))
daily_20200515_addname_dataframe.to_excel(daily_202005_excel_writer,'15_5',index=False)
daily_202005_excel_writer.save()
daily_20200516 = pro.daily(start_date='',end_date='',trade_date='20200516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200516_tscode_list = list() 
for ts_code_sh in daily_20200516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200516_tscode_list.append(stock_name)
daily_20200516_addname_dataframe=pd.DataFrame()
daily_20200516_addname_dataframe['cname'] = daily_20200516_tscode_list
for table_name in daily_20200516.columns.values.tolist():
    daily_20200516_addname_dataframe[table_name] = daily_20200516[table_name]
print("daily_20200516 返回数据 row 行数 = "+str(daily_20200516.shape[0]))
daily_20200516_addname_dataframe.to_excel(daily_202005_excel_writer,'16_6',index=False)
daily_202005_excel_writer.save()
daily_20200517 = pro.daily(start_date='',end_date='',trade_date='20200517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200517_tscode_list = list() 
for ts_code_sh in daily_20200517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200517_tscode_list.append(stock_name)
daily_20200517_addname_dataframe=pd.DataFrame()
daily_20200517_addname_dataframe['cname'] = daily_20200517_tscode_list
for table_name in daily_20200517.columns.values.tolist():
    daily_20200517_addname_dataframe[table_name] = daily_20200517[table_name]
print("daily_20200517 返回数据 row 行数 = "+str(daily_20200517.shape[0]))
daily_20200517_addname_dataframe.to_excel(daily_202005_excel_writer,'17_7',index=False)
daily_202005_excel_writer.save()
daily_20200518 = pro.daily(start_date='',end_date='',trade_date='20200518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200518_tscode_list = list() 
for ts_code_sh in daily_20200518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200518_tscode_list.append(stock_name)
daily_20200518_addname_dataframe=pd.DataFrame()
daily_20200518_addname_dataframe['cname'] = daily_20200518_tscode_list
for table_name in daily_20200518.columns.values.tolist():
    daily_20200518_addname_dataframe[table_name] = daily_20200518[table_name]
print("daily_20200518 返回数据 row 行数 = "+str(daily_20200518.shape[0]))
daily_20200518_addname_dataframe.to_excel(daily_202005_excel_writer,'18_1',index=False)
daily_202005_excel_writer.save()
daily_20200519 = pro.daily(start_date='',end_date='',trade_date='20200519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200519_tscode_list = list() 
for ts_code_sh in daily_20200519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200519_tscode_list.append(stock_name)
daily_20200519_addname_dataframe=pd.DataFrame()
daily_20200519_addname_dataframe['cname'] = daily_20200519_tscode_list
for table_name in daily_20200519.columns.values.tolist():
    daily_20200519_addname_dataframe[table_name] = daily_20200519[table_name]
print("daily_20200519 返回数据 row 行数 = "+str(daily_20200519.shape[0]))
daily_20200519_addname_dataframe.to_excel(daily_202005_excel_writer,'19_2',index=False)
daily_202005_excel_writer.save()
daily_20200520 = pro.daily(start_date='',end_date='',trade_date='20200520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200520_tscode_list = list() 
for ts_code_sh in daily_20200520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200520_tscode_list.append(stock_name)
daily_20200520_addname_dataframe=pd.DataFrame()
daily_20200520_addname_dataframe['cname'] = daily_20200520_tscode_list
for table_name in daily_20200520.columns.values.tolist():
    daily_20200520_addname_dataframe[table_name] = daily_20200520[table_name]
print("daily_20200520 返回数据 row 行数 = "+str(daily_20200520.shape[0]))
daily_20200520_addname_dataframe.to_excel(daily_202005_excel_writer,'20_3',index=False)
daily_202005_excel_writer.save()
daily_20200521 = pro.daily(start_date='',end_date='',trade_date='20200521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200521_tscode_list = list() 
for ts_code_sh in daily_20200521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200521_tscode_list.append(stock_name)
daily_20200521_addname_dataframe=pd.DataFrame()
daily_20200521_addname_dataframe['cname'] = daily_20200521_tscode_list
for table_name in daily_20200521.columns.values.tolist():
    daily_20200521_addname_dataframe[table_name] = daily_20200521[table_name]
print("daily_20200521 返回数据 row 行数 = "+str(daily_20200521.shape[0]))
daily_20200521_addname_dataframe.to_excel(daily_202005_excel_writer,'21_4',index=False)
daily_202005_excel_writer.save()
daily_20200522 = pro.daily(start_date='',end_date='',trade_date='20200522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200522_tscode_list = list() 
for ts_code_sh in daily_20200522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200522_tscode_list.append(stock_name)
daily_20200522_addname_dataframe=pd.DataFrame()
daily_20200522_addname_dataframe['cname'] = daily_20200522_tscode_list
for table_name in daily_20200522.columns.values.tolist():
    daily_20200522_addname_dataframe[table_name] = daily_20200522[table_name]
print("daily_20200522 返回数据 row 行数 = "+str(daily_20200522.shape[0]))
daily_20200522_addname_dataframe.to_excel(daily_202005_excel_writer,'22_5',index=False)
daily_202005_excel_writer.save()
daily_20200523 = pro.daily(start_date='',end_date='',trade_date='20200523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200523_tscode_list = list() 
for ts_code_sh in daily_20200523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200523_tscode_list.append(stock_name)
daily_20200523_addname_dataframe=pd.DataFrame()
daily_20200523_addname_dataframe['cname'] = daily_20200523_tscode_list
for table_name in daily_20200523.columns.values.tolist():
    daily_20200523_addname_dataframe[table_name] = daily_20200523[table_name]
print("daily_20200523 返回数据 row 行数 = "+str(daily_20200523.shape[0]))
daily_20200523_addname_dataframe.to_excel(daily_202005_excel_writer,'23_6',index=False)
daily_202005_excel_writer.save()
daily_20200524 = pro.daily(start_date='',end_date='',trade_date='20200524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200524_tscode_list = list() 
for ts_code_sh in daily_20200524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200524_tscode_list.append(stock_name)
daily_20200524_addname_dataframe=pd.DataFrame()
daily_20200524_addname_dataframe['cname'] = daily_20200524_tscode_list
for table_name in daily_20200524.columns.values.tolist():
    daily_20200524_addname_dataframe[table_name] = daily_20200524[table_name]
print("daily_20200524 返回数据 row 行数 = "+str(daily_20200524.shape[0]))
daily_20200524_addname_dataframe.to_excel(daily_202005_excel_writer,'24_7',index=False)
daily_202005_excel_writer.save()
daily_20200525 = pro.daily(start_date='',end_date='',trade_date='20200525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200525_tscode_list = list() 
for ts_code_sh in daily_20200525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200525_tscode_list.append(stock_name)
daily_20200525_addname_dataframe=pd.DataFrame()
daily_20200525_addname_dataframe['cname'] = daily_20200525_tscode_list
for table_name in daily_20200525.columns.values.tolist():
    daily_20200525_addname_dataframe[table_name] = daily_20200525[table_name]
print("daily_20200525 返回数据 row 行数 = "+str(daily_20200525.shape[0]))
daily_20200525_addname_dataframe.to_excel(daily_202005_excel_writer,'25_1',index=False)
daily_202005_excel_writer.save()
daily_20200526 = pro.daily(start_date='',end_date='',trade_date='20200526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200526_tscode_list = list() 
for ts_code_sh in daily_20200526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200526_tscode_list.append(stock_name)
daily_20200526_addname_dataframe=pd.DataFrame()
daily_20200526_addname_dataframe['cname'] = daily_20200526_tscode_list
for table_name in daily_20200526.columns.values.tolist():
    daily_20200526_addname_dataframe[table_name] = daily_20200526[table_name]
print("daily_20200526 返回数据 row 行数 = "+str(daily_20200526.shape[0]))
daily_20200526_addname_dataframe.to_excel(daily_202005_excel_writer,'26_2',index=False)
daily_202005_excel_writer.save()
daily_20200527 = pro.daily(start_date='',end_date='',trade_date='20200527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200527_tscode_list = list() 
for ts_code_sh in daily_20200527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200527_tscode_list.append(stock_name)
daily_20200527_addname_dataframe=pd.DataFrame()
daily_20200527_addname_dataframe['cname'] = daily_20200527_tscode_list
for table_name in daily_20200527.columns.values.tolist():
    daily_20200527_addname_dataframe[table_name] = daily_20200527[table_name]
print("daily_20200527 返回数据 row 行数 = "+str(daily_20200527.shape[0]))
daily_20200527_addname_dataframe.to_excel(daily_202005_excel_writer,'27_3',index=False)
daily_202005_excel_writer.save()
daily_20200528 = pro.daily(start_date='',end_date='',trade_date='20200528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200528_tscode_list = list() 
for ts_code_sh in daily_20200528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200528_tscode_list.append(stock_name)
daily_20200528_addname_dataframe=pd.DataFrame()
daily_20200528_addname_dataframe['cname'] = daily_20200528_tscode_list
for table_name in daily_20200528.columns.values.tolist():
    daily_20200528_addname_dataframe[table_name] = daily_20200528[table_name]
print("daily_20200528 返回数据 row 行数 = "+str(daily_20200528.shape[0]))
daily_20200528_addname_dataframe.to_excel(daily_202005_excel_writer,'28_4',index=False)
daily_202005_excel_writer.save()
daily_20200529 = pro.daily(start_date='',end_date='',trade_date='20200529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200529_tscode_list = list() 
for ts_code_sh in daily_20200529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200529_tscode_list.append(stock_name)
daily_20200529_addname_dataframe=pd.DataFrame()
daily_20200529_addname_dataframe['cname'] = daily_20200529_tscode_list
for table_name in daily_20200529.columns.values.tolist():
    daily_20200529_addname_dataframe[table_name] = daily_20200529[table_name]
print("daily_20200529 返回数据 row 行数 = "+str(daily_20200529.shape[0]))
daily_20200529_addname_dataframe.to_excel(daily_202005_excel_writer,'29_5',index=False)
daily_202005_excel_writer.save()
daily_20200530 = pro.daily(start_date='',end_date='',trade_date='20200530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200530_tscode_list = list() 
for ts_code_sh in daily_20200530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200530_tscode_list.append(stock_name)
daily_20200530_addname_dataframe=pd.DataFrame()
daily_20200530_addname_dataframe['cname'] = daily_20200530_tscode_list
for table_name in daily_20200530.columns.values.tolist():
    daily_20200530_addname_dataframe[table_name] = daily_20200530[table_name]
print("daily_20200530 返回数据 row 行数 = "+str(daily_20200530.shape[0]))
daily_20200530_addname_dataframe.to_excel(daily_202005_excel_writer,'30_6',index=False)
daily_202005_excel_writer.save()
daily_20200531 = pro.daily(start_date='',end_date='',trade_date='20200531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200531_tscode_list = list() 
for ts_code_sh in daily_20200531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200531_tscode_list.append(stock_name)
daily_20200531_addname_dataframe=pd.DataFrame()
daily_20200531_addname_dataframe['cname'] = daily_20200531_tscode_list
for table_name in daily_20200531.columns.values.tolist():
    daily_20200531_addname_dataframe[table_name] = daily_20200531[table_name]
print("daily_20200531 返回数据 row 行数 = "+str(daily_20200531.shape[0]))
daily_20200531_addname_dataframe.to_excel(daily_202005_excel_writer,'31_7',index=False)
daily_202005_excel_writer.save()




createexcel('daily_202006.xlsx')
daily_202006_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202006.xlsx')
daily_202006_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202006.xlsx', engine='openpyxl')
daily_202006_excel_writer.book = daily_202006_book
daily_202006_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202006_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200601")       ###  更新 记录日期
daily_20200601 = pro.daily(start_date='',end_date='',trade_date='20200601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200601_tscode_list = list() 
for ts_code_sh in daily_20200601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200601_tscode_list.append(stock_name)
daily_20200601_addname_dataframe=pd.DataFrame()
daily_20200601_addname_dataframe['cname'] = daily_20200601_tscode_list
for table_name in daily_20200601.columns.values.tolist():
    daily_20200601_addname_dataframe[table_name] = daily_20200601[table_name]
print("daily_20200601 返回数据 row 行数 = "+str(daily_20200601.shape[0]))
daily_20200601_addname_dataframe.to_excel(daily_202006_excel_writer,'1_1',index=False)
daily_202006_excel_writer.save()
daily_20200602 = pro.daily(start_date='',end_date='',trade_date='20200602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200602_tscode_list = list() 
for ts_code_sh in daily_20200602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200602_tscode_list.append(stock_name)
daily_20200602_addname_dataframe=pd.DataFrame()
daily_20200602_addname_dataframe['cname'] = daily_20200602_tscode_list
for table_name in daily_20200602.columns.values.tolist():
    daily_20200602_addname_dataframe[table_name] = daily_20200602[table_name]
print("daily_20200602 返回数据 row 行数 = "+str(daily_20200602.shape[0]))
daily_20200602_addname_dataframe.to_excel(daily_202006_excel_writer,'2_2',index=False)
daily_202006_excel_writer.save()
daily_20200603 = pro.daily(start_date='',end_date='',trade_date='20200603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200603_tscode_list = list() 
for ts_code_sh in daily_20200603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200603_tscode_list.append(stock_name)
daily_20200603_addname_dataframe=pd.DataFrame()
daily_20200603_addname_dataframe['cname'] = daily_20200603_tscode_list
for table_name in daily_20200603.columns.values.tolist():
    daily_20200603_addname_dataframe[table_name] = daily_20200603[table_name]
print("daily_20200603 返回数据 row 行数 = "+str(daily_20200603.shape[0]))
daily_20200603_addname_dataframe.to_excel(daily_202006_excel_writer,'3_3',index=False)
daily_202006_excel_writer.save()
daily_20200604 = pro.daily(start_date='',end_date='',trade_date='20200604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200604_tscode_list = list() 
for ts_code_sh in daily_20200604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200604_tscode_list.append(stock_name)
daily_20200604_addname_dataframe=pd.DataFrame()
daily_20200604_addname_dataframe['cname'] = daily_20200604_tscode_list
for table_name in daily_20200604.columns.values.tolist():
    daily_20200604_addname_dataframe[table_name] = daily_20200604[table_name]
print("daily_20200604 返回数据 row 行数 = "+str(daily_20200604.shape[0]))
daily_20200604_addname_dataframe.to_excel(daily_202006_excel_writer,'4_4',index=False)
daily_202006_excel_writer.save()
daily_20200605 = pro.daily(start_date='',end_date='',trade_date='20200605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200605_tscode_list = list() 
for ts_code_sh in daily_20200605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200605_tscode_list.append(stock_name)
daily_20200605_addname_dataframe=pd.DataFrame()
daily_20200605_addname_dataframe['cname'] = daily_20200605_tscode_list
for table_name in daily_20200605.columns.values.tolist():
    daily_20200605_addname_dataframe[table_name] = daily_20200605[table_name]
print("daily_20200605 返回数据 row 行数 = "+str(daily_20200605.shape[0]))
daily_20200605_addname_dataframe.to_excel(daily_202006_excel_writer,'5_5',index=False)
daily_202006_excel_writer.save()
daily_20200606 = pro.daily(start_date='',end_date='',trade_date='20200606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200606_tscode_list = list() 
for ts_code_sh in daily_20200606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200606_tscode_list.append(stock_name)
daily_20200606_addname_dataframe=pd.DataFrame()
daily_20200606_addname_dataframe['cname'] = daily_20200606_tscode_list
for table_name in daily_20200606.columns.values.tolist():
    daily_20200606_addname_dataframe[table_name] = daily_20200606[table_name]
print("daily_20200606 返回数据 row 行数 = "+str(daily_20200606.shape[0]))
daily_20200606_addname_dataframe.to_excel(daily_202006_excel_writer,'6_6',index=False)
daily_202006_excel_writer.save()
daily_20200607 = pro.daily(start_date='',end_date='',trade_date='20200607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200607_tscode_list = list() 
for ts_code_sh in daily_20200607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200607_tscode_list.append(stock_name)
daily_20200607_addname_dataframe=pd.DataFrame()
daily_20200607_addname_dataframe['cname'] = daily_20200607_tscode_list
for table_name in daily_20200607.columns.values.tolist():
    daily_20200607_addname_dataframe[table_name] = daily_20200607[table_name]
print("daily_20200607 返回数据 row 行数 = "+str(daily_20200607.shape[0]))
daily_20200607_addname_dataframe.to_excel(daily_202006_excel_writer,'7_7',index=False)
daily_202006_excel_writer.save()
daily_20200608 = pro.daily(start_date='',end_date='',trade_date='20200608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200608_tscode_list = list() 
for ts_code_sh in daily_20200608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200608_tscode_list.append(stock_name)
daily_20200608_addname_dataframe=pd.DataFrame()
daily_20200608_addname_dataframe['cname'] = daily_20200608_tscode_list
for table_name in daily_20200608.columns.values.tolist():
    daily_20200608_addname_dataframe[table_name] = daily_20200608[table_name]
print("daily_20200608 返回数据 row 行数 = "+str(daily_20200608.shape[0]))
daily_20200608_addname_dataframe.to_excel(daily_202006_excel_writer,'8_1',index=False)
daily_202006_excel_writer.save()
daily_20200609 = pro.daily(start_date='',end_date='',trade_date='20200609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200609_tscode_list = list() 
for ts_code_sh in daily_20200609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200609_tscode_list.append(stock_name)
daily_20200609_addname_dataframe=pd.DataFrame()
daily_20200609_addname_dataframe['cname'] = daily_20200609_tscode_list
for table_name in daily_20200609.columns.values.tolist():
    daily_20200609_addname_dataframe[table_name] = daily_20200609[table_name]
print("daily_20200609 返回数据 row 行数 = "+str(daily_20200609.shape[0]))
daily_20200609_addname_dataframe.to_excel(daily_202006_excel_writer,'9_2',index=False)
daily_202006_excel_writer.save()
daily_20200610 = pro.daily(start_date='',end_date='',trade_date='20200610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200610_tscode_list = list() 
for ts_code_sh in daily_20200610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200610_tscode_list.append(stock_name)
daily_20200610_addname_dataframe=pd.DataFrame()
daily_20200610_addname_dataframe['cname'] = daily_20200610_tscode_list
for table_name in daily_20200610.columns.values.tolist():
    daily_20200610_addname_dataframe[table_name] = daily_20200610[table_name]
print("daily_20200610 返回数据 row 行数 = "+str(daily_20200610.shape[0]))
daily_20200610_addname_dataframe.to_excel(daily_202006_excel_writer,'10_3',index=False)
daily_202006_excel_writer.save()
daily_20200611 = pro.daily(start_date='',end_date='',trade_date='20200611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200611_tscode_list = list() 
for ts_code_sh in daily_20200611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200611_tscode_list.append(stock_name)
daily_20200611_addname_dataframe=pd.DataFrame()
daily_20200611_addname_dataframe['cname'] = daily_20200611_tscode_list
for table_name in daily_20200611.columns.values.tolist():
    daily_20200611_addname_dataframe[table_name] = daily_20200611[table_name]
print("daily_20200611 返回数据 row 行数 = "+str(daily_20200611.shape[0]))
daily_20200611_addname_dataframe.to_excel(daily_202006_excel_writer,'11_4',index=False)
daily_202006_excel_writer.save()
daily_20200612 = pro.daily(start_date='',end_date='',trade_date='20200612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200612_tscode_list = list() 
for ts_code_sh in daily_20200612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200612_tscode_list.append(stock_name)
daily_20200612_addname_dataframe=pd.DataFrame()
daily_20200612_addname_dataframe['cname'] = daily_20200612_tscode_list
for table_name in daily_20200612.columns.values.tolist():
    daily_20200612_addname_dataframe[table_name] = daily_20200612[table_name]
print("daily_20200612 返回数据 row 行数 = "+str(daily_20200612.shape[0]))
daily_20200612_addname_dataframe.to_excel(daily_202006_excel_writer,'12_5',index=False)
daily_202006_excel_writer.save()
daily_20200613 = pro.daily(start_date='',end_date='',trade_date='20200613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200613_tscode_list = list() 
for ts_code_sh in daily_20200613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200613_tscode_list.append(stock_name)
daily_20200613_addname_dataframe=pd.DataFrame()
daily_20200613_addname_dataframe['cname'] = daily_20200613_tscode_list
for table_name in daily_20200613.columns.values.tolist():
    daily_20200613_addname_dataframe[table_name] = daily_20200613[table_name]
print("daily_20200613 返回数据 row 行数 = "+str(daily_20200613.shape[0]))
daily_20200613_addname_dataframe.to_excel(daily_202006_excel_writer,'13_6',index=False)
daily_202006_excel_writer.save()
daily_20200614 = pro.daily(start_date='',end_date='',trade_date='20200614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200614_tscode_list = list() 
for ts_code_sh in daily_20200614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200614_tscode_list.append(stock_name)
daily_20200614_addname_dataframe=pd.DataFrame()
daily_20200614_addname_dataframe['cname'] = daily_20200614_tscode_list
for table_name in daily_20200614.columns.values.tolist():
    daily_20200614_addname_dataframe[table_name] = daily_20200614[table_name]
print("daily_20200614 返回数据 row 行数 = "+str(daily_20200614.shape[0]))
daily_20200614_addname_dataframe.to_excel(daily_202006_excel_writer,'14_7',index=False)
daily_202006_excel_writer.save()
daily_20200615 = pro.daily(start_date='',end_date='',trade_date='20200615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200615_tscode_list = list() 
for ts_code_sh in daily_20200615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200615_tscode_list.append(stock_name)
daily_20200615_addname_dataframe=pd.DataFrame()
daily_20200615_addname_dataframe['cname'] = daily_20200615_tscode_list
for table_name in daily_20200615.columns.values.tolist():
    daily_20200615_addname_dataframe[table_name] = daily_20200615[table_name]
print("daily_20200615 返回数据 row 行数 = "+str(daily_20200615.shape[0]))
daily_20200615_addname_dataframe.to_excel(daily_202006_excel_writer,'15_1',index=False)
daily_202006_excel_writer.save()
daily_20200616 = pro.daily(start_date='',end_date='',trade_date='20200616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200616_tscode_list = list() 
for ts_code_sh in daily_20200616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200616_tscode_list.append(stock_name)
daily_20200616_addname_dataframe=pd.DataFrame()
daily_20200616_addname_dataframe['cname'] = daily_20200616_tscode_list
for table_name in daily_20200616.columns.values.tolist():
    daily_20200616_addname_dataframe[table_name] = daily_20200616[table_name]
print("daily_20200616 返回数据 row 行数 = "+str(daily_20200616.shape[0]))
daily_20200616_addname_dataframe.to_excel(daily_202006_excel_writer,'16_2',index=False)
daily_202006_excel_writer.save()
daily_20200617 = pro.daily(start_date='',end_date='',trade_date='20200617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200617_tscode_list = list() 
for ts_code_sh in daily_20200617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200617_tscode_list.append(stock_name)
daily_20200617_addname_dataframe=pd.DataFrame()
daily_20200617_addname_dataframe['cname'] = daily_20200617_tscode_list
for table_name in daily_20200617.columns.values.tolist():
    daily_20200617_addname_dataframe[table_name] = daily_20200617[table_name]
print("daily_20200617 返回数据 row 行数 = "+str(daily_20200617.shape[0]))
daily_20200617_addname_dataframe.to_excel(daily_202006_excel_writer,'17_3',index=False)
daily_202006_excel_writer.save()
daily_20200618 = pro.daily(start_date='',end_date='',trade_date='20200618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200618_tscode_list = list() 
for ts_code_sh in daily_20200618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200618_tscode_list.append(stock_name)
daily_20200618_addname_dataframe=pd.DataFrame()
daily_20200618_addname_dataframe['cname'] = daily_20200618_tscode_list
for table_name in daily_20200618.columns.values.tolist():
    daily_20200618_addname_dataframe[table_name] = daily_20200618[table_name]
print("daily_20200618 返回数据 row 行数 = "+str(daily_20200618.shape[0]))
daily_20200618_addname_dataframe.to_excel(daily_202006_excel_writer,'18_4',index=False)
daily_202006_excel_writer.save()
daily_20200619 = pro.daily(start_date='',end_date='',trade_date='20200619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200619_tscode_list = list() 
for ts_code_sh in daily_20200619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200619_tscode_list.append(stock_name)
daily_20200619_addname_dataframe=pd.DataFrame()
daily_20200619_addname_dataframe['cname'] = daily_20200619_tscode_list
for table_name in daily_20200619.columns.values.tolist():
    daily_20200619_addname_dataframe[table_name] = daily_20200619[table_name]
print("daily_20200619 返回数据 row 行数 = "+str(daily_20200619.shape[0]))
daily_20200619_addname_dataframe.to_excel(daily_202006_excel_writer,'19_5',index=False)
daily_202006_excel_writer.save()
daily_20200620 = pro.daily(start_date='',end_date='',trade_date='20200620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200620_tscode_list = list() 
for ts_code_sh in daily_20200620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200620_tscode_list.append(stock_name)
daily_20200620_addname_dataframe=pd.DataFrame()
daily_20200620_addname_dataframe['cname'] = daily_20200620_tscode_list
for table_name in daily_20200620.columns.values.tolist():
    daily_20200620_addname_dataframe[table_name] = daily_20200620[table_name]
print("daily_20200620 返回数据 row 行数 = "+str(daily_20200620.shape[0]))
daily_20200620_addname_dataframe.to_excel(daily_202006_excel_writer,'20_6',index=False)
daily_202006_excel_writer.save()
daily_20200621 = pro.daily(start_date='',end_date='',trade_date='20200621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200621_tscode_list = list() 
for ts_code_sh in daily_20200621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200621_tscode_list.append(stock_name)
daily_20200621_addname_dataframe=pd.DataFrame()
daily_20200621_addname_dataframe['cname'] = daily_20200621_tscode_list
for table_name in daily_20200621.columns.values.tolist():
    daily_20200621_addname_dataframe[table_name] = daily_20200621[table_name]
print("daily_20200621 返回数据 row 行数 = "+str(daily_20200621.shape[0]))
daily_20200621_addname_dataframe.to_excel(daily_202006_excel_writer,'21_7',index=False)
daily_202006_excel_writer.save()
daily_20200622 = pro.daily(start_date='',end_date='',trade_date='20200622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200622_tscode_list = list() 
for ts_code_sh in daily_20200622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200622_tscode_list.append(stock_name)
daily_20200622_addname_dataframe=pd.DataFrame()
daily_20200622_addname_dataframe['cname'] = daily_20200622_tscode_list
for table_name in daily_20200622.columns.values.tolist():
    daily_20200622_addname_dataframe[table_name] = daily_20200622[table_name]
print("daily_20200622 返回数据 row 行数 = "+str(daily_20200622.shape[0]))
daily_20200622_addname_dataframe.to_excel(daily_202006_excel_writer,'22_1',index=False)
daily_202006_excel_writer.save()
daily_20200623 = pro.daily(start_date='',end_date='',trade_date='20200623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200623_tscode_list = list() 
for ts_code_sh in daily_20200623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200623_tscode_list.append(stock_name)
daily_20200623_addname_dataframe=pd.DataFrame()
daily_20200623_addname_dataframe['cname'] = daily_20200623_tscode_list
for table_name in daily_20200623.columns.values.tolist():
    daily_20200623_addname_dataframe[table_name] = daily_20200623[table_name]
print("daily_20200623 返回数据 row 行数 = "+str(daily_20200623.shape[0]))
daily_20200623_addname_dataframe.to_excel(daily_202006_excel_writer,'23_2',index=False)
daily_202006_excel_writer.save()
daily_20200624 = pro.daily(start_date='',end_date='',trade_date='20200624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200624_tscode_list = list() 
for ts_code_sh in daily_20200624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200624_tscode_list.append(stock_name)
daily_20200624_addname_dataframe=pd.DataFrame()
daily_20200624_addname_dataframe['cname'] = daily_20200624_tscode_list
for table_name in daily_20200624.columns.values.tolist():
    daily_20200624_addname_dataframe[table_name] = daily_20200624[table_name]
print("daily_20200624 返回数据 row 行数 = "+str(daily_20200624.shape[0]))
daily_20200624_addname_dataframe.to_excel(daily_202006_excel_writer,'24_3',index=False)
daily_202006_excel_writer.save()
daily_20200625 = pro.daily(start_date='',end_date='',trade_date='20200625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200625_tscode_list = list() 
for ts_code_sh in daily_20200625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200625_tscode_list.append(stock_name)
daily_20200625_addname_dataframe=pd.DataFrame()
daily_20200625_addname_dataframe['cname'] = daily_20200625_tscode_list
for table_name in daily_20200625.columns.values.tolist():
    daily_20200625_addname_dataframe[table_name] = daily_20200625[table_name]
print("daily_20200625 返回数据 row 行数 = "+str(daily_20200625.shape[0]))
daily_20200625_addname_dataframe.to_excel(daily_202006_excel_writer,'25_4',index=False)
daily_202006_excel_writer.save()
daily_20200626 = pro.daily(start_date='',end_date='',trade_date='20200626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200626_tscode_list = list() 
for ts_code_sh in daily_20200626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200626_tscode_list.append(stock_name)
daily_20200626_addname_dataframe=pd.DataFrame()
daily_20200626_addname_dataframe['cname'] = daily_20200626_tscode_list
for table_name in daily_20200626.columns.values.tolist():
    daily_20200626_addname_dataframe[table_name] = daily_20200626[table_name]
print("daily_20200626 返回数据 row 行数 = "+str(daily_20200626.shape[0]))
daily_20200626_addname_dataframe.to_excel(daily_202006_excel_writer,'26_5',index=False)
daily_202006_excel_writer.save()
daily_20200627 = pro.daily(start_date='',end_date='',trade_date='20200627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200627_tscode_list = list() 
for ts_code_sh in daily_20200627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200627_tscode_list.append(stock_name)
daily_20200627_addname_dataframe=pd.DataFrame()
daily_20200627_addname_dataframe['cname'] = daily_20200627_tscode_list
for table_name in daily_20200627.columns.values.tolist():
    daily_20200627_addname_dataframe[table_name] = daily_20200627[table_name]
print("daily_20200627 返回数据 row 行数 = "+str(daily_20200627.shape[0]))
daily_20200627_addname_dataframe.to_excel(daily_202006_excel_writer,'27_6',index=False)
daily_202006_excel_writer.save()
daily_20200628 = pro.daily(start_date='',end_date='',trade_date='20200628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200628_tscode_list = list() 
for ts_code_sh in daily_20200628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200628_tscode_list.append(stock_name)
daily_20200628_addname_dataframe=pd.DataFrame()
daily_20200628_addname_dataframe['cname'] = daily_20200628_tscode_list
for table_name in daily_20200628.columns.values.tolist():
    daily_20200628_addname_dataframe[table_name] = daily_20200628[table_name]
print("daily_20200628 返回数据 row 行数 = "+str(daily_20200628.shape[0]))
daily_20200628_addname_dataframe.to_excel(daily_202006_excel_writer,'28_7',index=False)
daily_202006_excel_writer.save()
daily_20200629 = pro.daily(start_date='',end_date='',trade_date='20200629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200629_tscode_list = list() 
for ts_code_sh in daily_20200629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200629_tscode_list.append(stock_name)
daily_20200629_addname_dataframe=pd.DataFrame()
daily_20200629_addname_dataframe['cname'] = daily_20200629_tscode_list
for table_name in daily_20200629.columns.values.tolist():
    daily_20200629_addname_dataframe[table_name] = daily_20200629[table_name]
print("daily_20200629 返回数据 row 行数 = "+str(daily_20200629.shape[0]))
daily_20200629_addname_dataframe.to_excel(daily_202006_excel_writer,'29_1',index=False)
daily_202006_excel_writer.save()
daily_20200630 = pro.daily(start_date='',end_date='',trade_date='20200630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200630_tscode_list = list() 
for ts_code_sh in daily_20200630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200630_tscode_list.append(stock_name)
daily_20200630_addname_dataframe=pd.DataFrame()
daily_20200630_addname_dataframe['cname'] = daily_20200630_tscode_list
for table_name in daily_20200630.columns.values.tolist():
    daily_20200630_addname_dataframe[table_name] = daily_20200630[table_name]
print("daily_20200630 返回数据 row 行数 = "+str(daily_20200630.shape[0]))
daily_20200630_addname_dataframe.to_excel(daily_202006_excel_writer,'30_2',index=False)
daily_202006_excel_writer.save()




createexcel('daily_202007.xlsx')
daily_202007_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202007.xlsx')
daily_202007_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202007.xlsx', engine='openpyxl')
daily_202007_excel_writer.book = daily_202007_book
daily_202007_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202007_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200701")       ###  更新 记录日期
daily_20200701 = pro.daily(start_date='',end_date='',trade_date='20200701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200701_tscode_list = list() 
for ts_code_sh in daily_20200701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200701_tscode_list.append(stock_name)
daily_20200701_addname_dataframe=pd.DataFrame()
daily_20200701_addname_dataframe['cname'] = daily_20200701_tscode_list
for table_name in daily_20200701.columns.values.tolist():
    daily_20200701_addname_dataframe[table_name] = daily_20200701[table_name]
print("daily_20200701 返回数据 row 行数 = "+str(daily_20200701.shape[0]))
daily_20200701_addname_dataframe.to_excel(daily_202007_excel_writer,'1_3',index=False)
daily_202007_excel_writer.save()
daily_20200702 = pro.daily(start_date='',end_date='',trade_date='20200702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200702_tscode_list = list() 
for ts_code_sh in daily_20200702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200702_tscode_list.append(stock_name)
daily_20200702_addname_dataframe=pd.DataFrame()
daily_20200702_addname_dataframe['cname'] = daily_20200702_tscode_list
for table_name in daily_20200702.columns.values.tolist():
    daily_20200702_addname_dataframe[table_name] = daily_20200702[table_name]
print("daily_20200702 返回数据 row 行数 = "+str(daily_20200702.shape[0]))
daily_20200702_addname_dataframe.to_excel(daily_202007_excel_writer,'2_4',index=False)
daily_202007_excel_writer.save()
daily_20200703 = pro.daily(start_date='',end_date='',trade_date='20200703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200703_tscode_list = list() 
for ts_code_sh in daily_20200703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200703_tscode_list.append(stock_name)
daily_20200703_addname_dataframe=pd.DataFrame()
daily_20200703_addname_dataframe['cname'] = daily_20200703_tscode_list
for table_name in daily_20200703.columns.values.tolist():
    daily_20200703_addname_dataframe[table_name] = daily_20200703[table_name]
print("daily_20200703 返回数据 row 行数 = "+str(daily_20200703.shape[0]))
daily_20200703_addname_dataframe.to_excel(daily_202007_excel_writer,'3_5',index=False)
daily_202007_excel_writer.save()
daily_20200704 = pro.daily(start_date='',end_date='',trade_date='20200704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200704_tscode_list = list() 
for ts_code_sh in daily_20200704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200704_tscode_list.append(stock_name)
daily_20200704_addname_dataframe=pd.DataFrame()
daily_20200704_addname_dataframe['cname'] = daily_20200704_tscode_list
for table_name in daily_20200704.columns.values.tolist():
    daily_20200704_addname_dataframe[table_name] = daily_20200704[table_name]
print("daily_20200704 返回数据 row 行数 = "+str(daily_20200704.shape[0]))
daily_20200704_addname_dataframe.to_excel(daily_202007_excel_writer,'4_6',index=False)
daily_202007_excel_writer.save()
daily_20200705 = pro.daily(start_date='',end_date='',trade_date='20200705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200705_tscode_list = list() 
for ts_code_sh in daily_20200705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200705_tscode_list.append(stock_name)
daily_20200705_addname_dataframe=pd.DataFrame()
daily_20200705_addname_dataframe['cname'] = daily_20200705_tscode_list
for table_name in daily_20200705.columns.values.tolist():
    daily_20200705_addname_dataframe[table_name] = daily_20200705[table_name]
print("daily_20200705 返回数据 row 行数 = "+str(daily_20200705.shape[0]))
daily_20200705_addname_dataframe.to_excel(daily_202007_excel_writer,'5_7',index=False)
daily_202007_excel_writer.save()
daily_20200706 = pro.daily(start_date='',end_date='',trade_date='20200706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200706_tscode_list = list() 
for ts_code_sh in daily_20200706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200706_tscode_list.append(stock_name)
daily_20200706_addname_dataframe=pd.DataFrame()
daily_20200706_addname_dataframe['cname'] = daily_20200706_tscode_list
for table_name in daily_20200706.columns.values.tolist():
    daily_20200706_addname_dataframe[table_name] = daily_20200706[table_name]
print("daily_20200706 返回数据 row 行数 = "+str(daily_20200706.shape[0]))
daily_20200706_addname_dataframe.to_excel(daily_202007_excel_writer,'6_1',index=False)
daily_202007_excel_writer.save()
daily_20200707 = pro.daily(start_date='',end_date='',trade_date='20200707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200707_tscode_list = list() 
for ts_code_sh in daily_20200707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200707_tscode_list.append(stock_name)
daily_20200707_addname_dataframe=pd.DataFrame()
daily_20200707_addname_dataframe['cname'] = daily_20200707_tscode_list
for table_name in daily_20200707.columns.values.tolist():
    daily_20200707_addname_dataframe[table_name] = daily_20200707[table_name]
print("daily_20200707 返回数据 row 行数 = "+str(daily_20200707.shape[0]))
daily_20200707_addname_dataframe.to_excel(daily_202007_excel_writer,'7_2',index=False)
daily_202007_excel_writer.save()
daily_20200708 = pro.daily(start_date='',end_date='',trade_date='20200708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200708_tscode_list = list() 
for ts_code_sh in daily_20200708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200708_tscode_list.append(stock_name)
daily_20200708_addname_dataframe=pd.DataFrame()
daily_20200708_addname_dataframe['cname'] = daily_20200708_tscode_list
for table_name in daily_20200708.columns.values.tolist():
    daily_20200708_addname_dataframe[table_name] = daily_20200708[table_name]
print("daily_20200708 返回数据 row 行数 = "+str(daily_20200708.shape[0]))
daily_20200708_addname_dataframe.to_excel(daily_202007_excel_writer,'8_3',index=False)
daily_202007_excel_writer.save()
daily_20200709 = pro.daily(start_date='',end_date='',trade_date='20200709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200709_tscode_list = list() 
for ts_code_sh in daily_20200709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200709_tscode_list.append(stock_name)
daily_20200709_addname_dataframe=pd.DataFrame()
daily_20200709_addname_dataframe['cname'] = daily_20200709_tscode_list
for table_name in daily_20200709.columns.values.tolist():
    daily_20200709_addname_dataframe[table_name] = daily_20200709[table_name]
print("daily_20200709 返回数据 row 行数 = "+str(daily_20200709.shape[0]))
daily_20200709_addname_dataframe.to_excel(daily_202007_excel_writer,'9_4',index=False)
daily_202007_excel_writer.save()
daily_20200710 = pro.daily(start_date='',end_date='',trade_date='20200710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200710_tscode_list = list() 
for ts_code_sh in daily_20200710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200710_tscode_list.append(stock_name)
daily_20200710_addname_dataframe=pd.DataFrame()
daily_20200710_addname_dataframe['cname'] = daily_20200710_tscode_list
for table_name in daily_20200710.columns.values.tolist():
    daily_20200710_addname_dataframe[table_name] = daily_20200710[table_name]
print("daily_20200710 返回数据 row 行数 = "+str(daily_20200710.shape[0]))
daily_20200710_addname_dataframe.to_excel(daily_202007_excel_writer,'10_5',index=False)
daily_202007_excel_writer.save()
daily_20200711 = pro.daily(start_date='',end_date='',trade_date='20200711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200711_tscode_list = list() 
for ts_code_sh in daily_20200711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200711_tscode_list.append(stock_name)
daily_20200711_addname_dataframe=pd.DataFrame()
daily_20200711_addname_dataframe['cname'] = daily_20200711_tscode_list
for table_name in daily_20200711.columns.values.tolist():
    daily_20200711_addname_dataframe[table_name] = daily_20200711[table_name]
print("daily_20200711 返回数据 row 行数 = "+str(daily_20200711.shape[0]))
daily_20200711_addname_dataframe.to_excel(daily_202007_excel_writer,'11_6',index=False)
daily_202007_excel_writer.save()
daily_20200712 = pro.daily(start_date='',end_date='',trade_date='20200712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200712_tscode_list = list() 
for ts_code_sh in daily_20200712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200712_tscode_list.append(stock_name)
daily_20200712_addname_dataframe=pd.DataFrame()
daily_20200712_addname_dataframe['cname'] = daily_20200712_tscode_list
for table_name in daily_20200712.columns.values.tolist():
    daily_20200712_addname_dataframe[table_name] = daily_20200712[table_name]
print("daily_20200712 返回数据 row 行数 = "+str(daily_20200712.shape[0]))
daily_20200712_addname_dataframe.to_excel(daily_202007_excel_writer,'12_7',index=False)
daily_202007_excel_writer.save()
daily_20200713 = pro.daily(start_date='',end_date='',trade_date='20200713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200713_tscode_list = list() 
for ts_code_sh in daily_20200713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200713_tscode_list.append(stock_name)
daily_20200713_addname_dataframe=pd.DataFrame()
daily_20200713_addname_dataframe['cname'] = daily_20200713_tscode_list
for table_name in daily_20200713.columns.values.tolist():
    daily_20200713_addname_dataframe[table_name] = daily_20200713[table_name]
print("daily_20200713 返回数据 row 行数 = "+str(daily_20200713.shape[0]))
daily_20200713_addname_dataframe.to_excel(daily_202007_excel_writer,'13_1',index=False)
daily_202007_excel_writer.save()
daily_20200714 = pro.daily(start_date='',end_date='',trade_date='20200714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200714_tscode_list = list() 
for ts_code_sh in daily_20200714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200714_tscode_list.append(stock_name)
daily_20200714_addname_dataframe=pd.DataFrame()
daily_20200714_addname_dataframe['cname'] = daily_20200714_tscode_list
for table_name in daily_20200714.columns.values.tolist():
    daily_20200714_addname_dataframe[table_name] = daily_20200714[table_name]
print("daily_20200714 返回数据 row 行数 = "+str(daily_20200714.shape[0]))
daily_20200714_addname_dataframe.to_excel(daily_202007_excel_writer,'14_2',index=False)
daily_202007_excel_writer.save()
daily_20200715 = pro.daily(start_date='',end_date='',trade_date='20200715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200715_tscode_list = list() 
for ts_code_sh in daily_20200715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200715_tscode_list.append(stock_name)
daily_20200715_addname_dataframe=pd.DataFrame()
daily_20200715_addname_dataframe['cname'] = daily_20200715_tscode_list
for table_name in daily_20200715.columns.values.tolist():
    daily_20200715_addname_dataframe[table_name] = daily_20200715[table_name]
print("daily_20200715 返回数据 row 行数 = "+str(daily_20200715.shape[0]))
daily_20200715_addname_dataframe.to_excel(daily_202007_excel_writer,'15_3',index=False)
daily_202007_excel_writer.save()
daily_20200716 = pro.daily(start_date='',end_date='',trade_date='20200716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200716_tscode_list = list() 
for ts_code_sh in daily_20200716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200716_tscode_list.append(stock_name)
daily_20200716_addname_dataframe=pd.DataFrame()
daily_20200716_addname_dataframe['cname'] = daily_20200716_tscode_list
for table_name in daily_20200716.columns.values.tolist():
    daily_20200716_addname_dataframe[table_name] = daily_20200716[table_name]
print("daily_20200716 返回数据 row 行数 = "+str(daily_20200716.shape[0]))
daily_20200716_addname_dataframe.to_excel(daily_202007_excel_writer,'16_4',index=False)
daily_202007_excel_writer.save()
daily_20200717 = pro.daily(start_date='',end_date='',trade_date='20200717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200717_tscode_list = list() 
for ts_code_sh in daily_20200717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200717_tscode_list.append(stock_name)
daily_20200717_addname_dataframe=pd.DataFrame()
daily_20200717_addname_dataframe['cname'] = daily_20200717_tscode_list
for table_name in daily_20200717.columns.values.tolist():
    daily_20200717_addname_dataframe[table_name] = daily_20200717[table_name]
print("daily_20200717 返回数据 row 行数 = "+str(daily_20200717.shape[0]))
daily_20200717_addname_dataframe.to_excel(daily_202007_excel_writer,'17_5',index=False)
daily_202007_excel_writer.save()
daily_20200718 = pro.daily(start_date='',end_date='',trade_date='20200718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200718_tscode_list = list() 
for ts_code_sh in daily_20200718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200718_tscode_list.append(stock_name)
daily_20200718_addname_dataframe=pd.DataFrame()
daily_20200718_addname_dataframe['cname'] = daily_20200718_tscode_list
for table_name in daily_20200718.columns.values.tolist():
    daily_20200718_addname_dataframe[table_name] = daily_20200718[table_name]
print("daily_20200718 返回数据 row 行数 = "+str(daily_20200718.shape[0]))
daily_20200718_addname_dataframe.to_excel(daily_202007_excel_writer,'18_6',index=False)
daily_202007_excel_writer.save()
daily_20200719 = pro.daily(start_date='',end_date='',trade_date='20200719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200719_tscode_list = list() 
for ts_code_sh in daily_20200719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200719_tscode_list.append(stock_name)
daily_20200719_addname_dataframe=pd.DataFrame()
daily_20200719_addname_dataframe['cname'] = daily_20200719_tscode_list
for table_name in daily_20200719.columns.values.tolist():
    daily_20200719_addname_dataframe[table_name] = daily_20200719[table_name]
print("daily_20200719 返回数据 row 行数 = "+str(daily_20200719.shape[0]))
daily_20200719_addname_dataframe.to_excel(daily_202007_excel_writer,'19_7',index=False)
daily_202007_excel_writer.save()
daily_20200720 = pro.daily(start_date='',end_date='',trade_date='20200720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200720_tscode_list = list() 
for ts_code_sh in daily_20200720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200720_tscode_list.append(stock_name)
daily_20200720_addname_dataframe=pd.DataFrame()
daily_20200720_addname_dataframe['cname'] = daily_20200720_tscode_list
for table_name in daily_20200720.columns.values.tolist():
    daily_20200720_addname_dataframe[table_name] = daily_20200720[table_name]
print("daily_20200720 返回数据 row 行数 = "+str(daily_20200720.shape[0]))
daily_20200720_addname_dataframe.to_excel(daily_202007_excel_writer,'20_1',index=False)
daily_202007_excel_writer.save()
daily_20200721 = pro.daily(start_date='',end_date='',trade_date='20200721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200721_tscode_list = list() 
for ts_code_sh in daily_20200721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200721_tscode_list.append(stock_name)
daily_20200721_addname_dataframe=pd.DataFrame()
daily_20200721_addname_dataframe['cname'] = daily_20200721_tscode_list
for table_name in daily_20200721.columns.values.tolist():
    daily_20200721_addname_dataframe[table_name] = daily_20200721[table_name]
print("daily_20200721 返回数据 row 行数 = "+str(daily_20200721.shape[0]))
daily_20200721_addname_dataframe.to_excel(daily_202007_excel_writer,'21_2',index=False)
daily_202007_excel_writer.save()
daily_20200722 = pro.daily(start_date='',end_date='',trade_date='20200722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200722_tscode_list = list() 
for ts_code_sh in daily_20200722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200722_tscode_list.append(stock_name)
daily_20200722_addname_dataframe=pd.DataFrame()
daily_20200722_addname_dataframe['cname'] = daily_20200722_tscode_list
for table_name in daily_20200722.columns.values.tolist():
    daily_20200722_addname_dataframe[table_name] = daily_20200722[table_name]
print("daily_20200722 返回数据 row 行数 = "+str(daily_20200722.shape[0]))
daily_20200722_addname_dataframe.to_excel(daily_202007_excel_writer,'22_3',index=False)
daily_202007_excel_writer.save()
daily_20200723 = pro.daily(start_date='',end_date='',trade_date='20200723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200723_tscode_list = list() 
for ts_code_sh in daily_20200723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200723_tscode_list.append(stock_name)
daily_20200723_addname_dataframe=pd.DataFrame()
daily_20200723_addname_dataframe['cname'] = daily_20200723_tscode_list
for table_name in daily_20200723.columns.values.tolist():
    daily_20200723_addname_dataframe[table_name] = daily_20200723[table_name]
print("daily_20200723 返回数据 row 行数 = "+str(daily_20200723.shape[0]))
daily_20200723_addname_dataframe.to_excel(daily_202007_excel_writer,'23_4',index=False)
daily_202007_excel_writer.save()
daily_20200724 = pro.daily(start_date='',end_date='',trade_date='20200724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200724_tscode_list = list() 
for ts_code_sh in daily_20200724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200724_tscode_list.append(stock_name)
daily_20200724_addname_dataframe=pd.DataFrame()
daily_20200724_addname_dataframe['cname'] = daily_20200724_tscode_list
for table_name in daily_20200724.columns.values.tolist():
    daily_20200724_addname_dataframe[table_name] = daily_20200724[table_name]
print("daily_20200724 返回数据 row 行数 = "+str(daily_20200724.shape[0]))
daily_20200724_addname_dataframe.to_excel(daily_202007_excel_writer,'24_5',index=False)
daily_202007_excel_writer.save()
daily_20200725 = pro.daily(start_date='',end_date='',trade_date='20200725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200725_tscode_list = list() 
for ts_code_sh in daily_20200725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200725_tscode_list.append(stock_name)
daily_20200725_addname_dataframe=pd.DataFrame()
daily_20200725_addname_dataframe['cname'] = daily_20200725_tscode_list
for table_name in daily_20200725.columns.values.tolist():
    daily_20200725_addname_dataframe[table_name] = daily_20200725[table_name]
print("daily_20200725 返回数据 row 行数 = "+str(daily_20200725.shape[0]))
daily_20200725_addname_dataframe.to_excel(daily_202007_excel_writer,'25_6',index=False)
daily_202007_excel_writer.save()
daily_20200726 = pro.daily(start_date='',end_date='',trade_date='20200726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200726_tscode_list = list() 
for ts_code_sh in daily_20200726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200726_tscode_list.append(stock_name)
daily_20200726_addname_dataframe=pd.DataFrame()
daily_20200726_addname_dataframe['cname'] = daily_20200726_tscode_list
for table_name in daily_20200726.columns.values.tolist():
    daily_20200726_addname_dataframe[table_name] = daily_20200726[table_name]
print("daily_20200726 返回数据 row 行数 = "+str(daily_20200726.shape[0]))
daily_20200726_addname_dataframe.to_excel(daily_202007_excel_writer,'26_7',index=False)
daily_202007_excel_writer.save()
daily_20200727 = pro.daily(start_date='',end_date='',trade_date='20200727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200727_tscode_list = list() 
for ts_code_sh in daily_20200727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200727_tscode_list.append(stock_name)
daily_20200727_addname_dataframe=pd.DataFrame()
daily_20200727_addname_dataframe['cname'] = daily_20200727_tscode_list
for table_name in daily_20200727.columns.values.tolist():
    daily_20200727_addname_dataframe[table_name] = daily_20200727[table_name]
print("daily_20200727 返回数据 row 行数 = "+str(daily_20200727.shape[0]))
daily_20200727_addname_dataframe.to_excel(daily_202007_excel_writer,'27_1',index=False)
daily_202007_excel_writer.save()
daily_20200728 = pro.daily(start_date='',end_date='',trade_date='20200728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200728_tscode_list = list() 
for ts_code_sh in daily_20200728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200728_tscode_list.append(stock_name)
daily_20200728_addname_dataframe=pd.DataFrame()
daily_20200728_addname_dataframe['cname'] = daily_20200728_tscode_list
for table_name in daily_20200728.columns.values.tolist():
    daily_20200728_addname_dataframe[table_name] = daily_20200728[table_name]
print("daily_20200728 返回数据 row 行数 = "+str(daily_20200728.shape[0]))
daily_20200728_addname_dataframe.to_excel(daily_202007_excel_writer,'28_2',index=False)
daily_202007_excel_writer.save()
daily_20200729 = pro.daily(start_date='',end_date='',trade_date='20200729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200729_tscode_list = list() 
for ts_code_sh in daily_20200729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200729_tscode_list.append(stock_name)
daily_20200729_addname_dataframe=pd.DataFrame()
daily_20200729_addname_dataframe['cname'] = daily_20200729_tscode_list
for table_name in daily_20200729.columns.values.tolist():
    daily_20200729_addname_dataframe[table_name] = daily_20200729[table_name]
print("daily_20200729 返回数据 row 行数 = "+str(daily_20200729.shape[0]))
daily_20200729_addname_dataframe.to_excel(daily_202007_excel_writer,'29_3',index=False)
daily_202007_excel_writer.save()
daily_20200730 = pro.daily(start_date='',end_date='',trade_date='20200730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200730_tscode_list = list() 
for ts_code_sh in daily_20200730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200730_tscode_list.append(stock_name)
daily_20200730_addname_dataframe=pd.DataFrame()
daily_20200730_addname_dataframe['cname'] = daily_20200730_tscode_list
for table_name in daily_20200730.columns.values.tolist():
    daily_20200730_addname_dataframe[table_name] = daily_20200730[table_name]
print("daily_20200730 返回数据 row 行数 = "+str(daily_20200730.shape[0]))
daily_20200730_addname_dataframe.to_excel(daily_202007_excel_writer,'30_4',index=False)
daily_202007_excel_writer.save()
daily_20200731 = pro.daily(start_date='',end_date='',trade_date='20200731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200731_tscode_list = list() 
for ts_code_sh in daily_20200731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200731_tscode_list.append(stock_name)
daily_20200731_addname_dataframe=pd.DataFrame()
daily_20200731_addname_dataframe['cname'] = daily_20200731_tscode_list
for table_name in daily_20200731.columns.values.tolist():
    daily_20200731_addname_dataframe[table_name] = daily_20200731[table_name]
print("daily_20200731 返回数据 row 行数 = "+str(daily_20200731.shape[0]))
daily_20200731_addname_dataframe.to_excel(daily_202007_excel_writer,'31_5',index=False)
daily_202007_excel_writer.save()




createexcel('daily_202008.xlsx')
daily_202008_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202008.xlsx')
daily_202008_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202008.xlsx', engine='openpyxl')
daily_202008_excel_writer.book = daily_202008_book
daily_202008_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202008_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200801")       ###  更新 记录日期
daily_20200801 = pro.daily(start_date='',end_date='',trade_date='20200801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200801_tscode_list = list() 
for ts_code_sh in daily_20200801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200801_tscode_list.append(stock_name)
daily_20200801_addname_dataframe=pd.DataFrame()
daily_20200801_addname_dataframe['cname'] = daily_20200801_tscode_list
for table_name in daily_20200801.columns.values.tolist():
    daily_20200801_addname_dataframe[table_name] = daily_20200801[table_name]
print("daily_20200801 返回数据 row 行数 = "+str(daily_20200801.shape[0]))
daily_20200801_addname_dataframe.to_excel(daily_202008_excel_writer,'1_6',index=False)
daily_202008_excel_writer.save()
daily_20200802 = pro.daily(start_date='',end_date='',trade_date='20200802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200802_tscode_list = list() 
for ts_code_sh in daily_20200802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200802_tscode_list.append(stock_name)
daily_20200802_addname_dataframe=pd.DataFrame()
daily_20200802_addname_dataframe['cname'] = daily_20200802_tscode_list
for table_name in daily_20200802.columns.values.tolist():
    daily_20200802_addname_dataframe[table_name] = daily_20200802[table_name]
print("daily_20200802 返回数据 row 行数 = "+str(daily_20200802.shape[0]))
daily_20200802_addname_dataframe.to_excel(daily_202008_excel_writer,'2_7',index=False)
daily_202008_excel_writer.save()
daily_20200803 = pro.daily(start_date='',end_date='',trade_date='20200803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200803_tscode_list = list() 
for ts_code_sh in daily_20200803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200803_tscode_list.append(stock_name)
daily_20200803_addname_dataframe=pd.DataFrame()
daily_20200803_addname_dataframe['cname'] = daily_20200803_tscode_list
for table_name in daily_20200803.columns.values.tolist():
    daily_20200803_addname_dataframe[table_name] = daily_20200803[table_name]
print("daily_20200803 返回数据 row 行数 = "+str(daily_20200803.shape[0]))
daily_20200803_addname_dataframe.to_excel(daily_202008_excel_writer,'3_1',index=False)
daily_202008_excel_writer.save()
daily_20200804 = pro.daily(start_date='',end_date='',trade_date='20200804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200804_tscode_list = list() 
for ts_code_sh in daily_20200804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200804_tscode_list.append(stock_name)
daily_20200804_addname_dataframe=pd.DataFrame()
daily_20200804_addname_dataframe['cname'] = daily_20200804_tscode_list
for table_name in daily_20200804.columns.values.tolist():
    daily_20200804_addname_dataframe[table_name] = daily_20200804[table_name]
print("daily_20200804 返回数据 row 行数 = "+str(daily_20200804.shape[0]))
daily_20200804_addname_dataframe.to_excel(daily_202008_excel_writer,'4_2',index=False)
daily_202008_excel_writer.save()
daily_20200805 = pro.daily(start_date='',end_date='',trade_date='20200805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200805_tscode_list = list() 
for ts_code_sh in daily_20200805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200805_tscode_list.append(stock_name)
daily_20200805_addname_dataframe=pd.DataFrame()
daily_20200805_addname_dataframe['cname'] = daily_20200805_tscode_list
for table_name in daily_20200805.columns.values.tolist():
    daily_20200805_addname_dataframe[table_name] = daily_20200805[table_name]
print("daily_20200805 返回数据 row 行数 = "+str(daily_20200805.shape[0]))
daily_20200805_addname_dataframe.to_excel(daily_202008_excel_writer,'5_3',index=False)
daily_202008_excel_writer.save()
daily_20200806 = pro.daily(start_date='',end_date='',trade_date='20200806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200806_tscode_list = list() 
for ts_code_sh in daily_20200806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200806_tscode_list.append(stock_name)
daily_20200806_addname_dataframe=pd.DataFrame()
daily_20200806_addname_dataframe['cname'] = daily_20200806_tscode_list
for table_name in daily_20200806.columns.values.tolist():
    daily_20200806_addname_dataframe[table_name] = daily_20200806[table_name]
print("daily_20200806 返回数据 row 行数 = "+str(daily_20200806.shape[0]))
daily_20200806_addname_dataframe.to_excel(daily_202008_excel_writer,'6_4',index=False)
daily_202008_excel_writer.save()
daily_20200807 = pro.daily(start_date='',end_date='',trade_date='20200807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200807_tscode_list = list() 
for ts_code_sh in daily_20200807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200807_tscode_list.append(stock_name)
daily_20200807_addname_dataframe=pd.DataFrame()
daily_20200807_addname_dataframe['cname'] = daily_20200807_tscode_list
for table_name in daily_20200807.columns.values.tolist():
    daily_20200807_addname_dataframe[table_name] = daily_20200807[table_name]
print("daily_20200807 返回数据 row 行数 = "+str(daily_20200807.shape[0]))
daily_20200807_addname_dataframe.to_excel(daily_202008_excel_writer,'7_5',index=False)
daily_202008_excel_writer.save()
daily_20200808 = pro.daily(start_date='',end_date='',trade_date='20200808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200808_tscode_list = list() 
for ts_code_sh in daily_20200808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200808_tscode_list.append(stock_name)
daily_20200808_addname_dataframe=pd.DataFrame()
daily_20200808_addname_dataframe['cname'] = daily_20200808_tscode_list
for table_name in daily_20200808.columns.values.tolist():
    daily_20200808_addname_dataframe[table_name] = daily_20200808[table_name]
print("daily_20200808 返回数据 row 行数 = "+str(daily_20200808.shape[0]))
daily_20200808_addname_dataframe.to_excel(daily_202008_excel_writer,'8_6',index=False)
daily_202008_excel_writer.save()
daily_20200809 = pro.daily(start_date='',end_date='',trade_date='20200809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200809_tscode_list = list() 
for ts_code_sh in daily_20200809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200809_tscode_list.append(stock_name)
daily_20200809_addname_dataframe=pd.DataFrame()
daily_20200809_addname_dataframe['cname'] = daily_20200809_tscode_list
for table_name in daily_20200809.columns.values.tolist():
    daily_20200809_addname_dataframe[table_name] = daily_20200809[table_name]
print("daily_20200809 返回数据 row 行数 = "+str(daily_20200809.shape[0]))
daily_20200809_addname_dataframe.to_excel(daily_202008_excel_writer,'9_7',index=False)
daily_202008_excel_writer.save()
daily_20200810 = pro.daily(start_date='',end_date='',trade_date='20200810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200810_tscode_list = list() 
for ts_code_sh in daily_20200810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200810_tscode_list.append(stock_name)
daily_20200810_addname_dataframe=pd.DataFrame()
daily_20200810_addname_dataframe['cname'] = daily_20200810_tscode_list
for table_name in daily_20200810.columns.values.tolist():
    daily_20200810_addname_dataframe[table_name] = daily_20200810[table_name]
print("daily_20200810 返回数据 row 行数 = "+str(daily_20200810.shape[0]))
daily_20200810_addname_dataframe.to_excel(daily_202008_excel_writer,'10_1',index=False)
daily_202008_excel_writer.save()
daily_20200811 = pro.daily(start_date='',end_date='',trade_date='20200811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200811_tscode_list = list() 
for ts_code_sh in daily_20200811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200811_tscode_list.append(stock_name)
daily_20200811_addname_dataframe=pd.DataFrame()
daily_20200811_addname_dataframe['cname'] = daily_20200811_tscode_list
for table_name in daily_20200811.columns.values.tolist():
    daily_20200811_addname_dataframe[table_name] = daily_20200811[table_name]
print("daily_20200811 返回数据 row 行数 = "+str(daily_20200811.shape[0]))
daily_20200811_addname_dataframe.to_excel(daily_202008_excel_writer,'11_2',index=False)
daily_202008_excel_writer.save()
daily_20200812 = pro.daily(start_date='',end_date='',trade_date='20200812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200812_tscode_list = list() 
for ts_code_sh in daily_20200812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200812_tscode_list.append(stock_name)
daily_20200812_addname_dataframe=pd.DataFrame()
daily_20200812_addname_dataframe['cname'] = daily_20200812_tscode_list
for table_name in daily_20200812.columns.values.tolist():
    daily_20200812_addname_dataframe[table_name] = daily_20200812[table_name]
print("daily_20200812 返回数据 row 行数 = "+str(daily_20200812.shape[0]))
daily_20200812_addname_dataframe.to_excel(daily_202008_excel_writer,'12_3',index=False)
daily_202008_excel_writer.save()
daily_20200813 = pro.daily(start_date='',end_date='',trade_date='20200813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200813_tscode_list = list() 
for ts_code_sh in daily_20200813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200813_tscode_list.append(stock_name)
daily_20200813_addname_dataframe=pd.DataFrame()
daily_20200813_addname_dataframe['cname'] = daily_20200813_tscode_list
for table_name in daily_20200813.columns.values.tolist():
    daily_20200813_addname_dataframe[table_name] = daily_20200813[table_name]
print("daily_20200813 返回数据 row 行数 = "+str(daily_20200813.shape[0]))
daily_20200813_addname_dataframe.to_excel(daily_202008_excel_writer,'13_4',index=False)
daily_202008_excel_writer.save()
daily_20200814 = pro.daily(start_date='',end_date='',trade_date='20200814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200814_tscode_list = list() 
for ts_code_sh in daily_20200814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200814_tscode_list.append(stock_name)
daily_20200814_addname_dataframe=pd.DataFrame()
daily_20200814_addname_dataframe['cname'] = daily_20200814_tscode_list
for table_name in daily_20200814.columns.values.tolist():
    daily_20200814_addname_dataframe[table_name] = daily_20200814[table_name]
print("daily_20200814 返回数据 row 行数 = "+str(daily_20200814.shape[0]))
daily_20200814_addname_dataframe.to_excel(daily_202008_excel_writer,'14_5',index=False)
daily_202008_excel_writer.save()
daily_20200815 = pro.daily(start_date='',end_date='',trade_date='20200815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200815_tscode_list = list() 
for ts_code_sh in daily_20200815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200815_tscode_list.append(stock_name)
daily_20200815_addname_dataframe=pd.DataFrame()
daily_20200815_addname_dataframe['cname'] = daily_20200815_tscode_list
for table_name in daily_20200815.columns.values.tolist():
    daily_20200815_addname_dataframe[table_name] = daily_20200815[table_name]
print("daily_20200815 返回数据 row 行数 = "+str(daily_20200815.shape[0]))
daily_20200815_addname_dataframe.to_excel(daily_202008_excel_writer,'15_6',index=False)
daily_202008_excel_writer.save()
daily_20200816 = pro.daily(start_date='',end_date='',trade_date='20200816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200816_tscode_list = list() 
for ts_code_sh in daily_20200816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200816_tscode_list.append(stock_name)
daily_20200816_addname_dataframe=pd.DataFrame()
daily_20200816_addname_dataframe['cname'] = daily_20200816_tscode_list
for table_name in daily_20200816.columns.values.tolist():
    daily_20200816_addname_dataframe[table_name] = daily_20200816[table_name]
print("daily_20200816 返回数据 row 行数 = "+str(daily_20200816.shape[0]))
daily_20200816_addname_dataframe.to_excel(daily_202008_excel_writer,'16_7',index=False)
daily_202008_excel_writer.save()
daily_20200817 = pro.daily(start_date='',end_date='',trade_date='20200817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200817_tscode_list = list() 
for ts_code_sh in daily_20200817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200817_tscode_list.append(stock_name)
daily_20200817_addname_dataframe=pd.DataFrame()
daily_20200817_addname_dataframe['cname'] = daily_20200817_tscode_list
for table_name in daily_20200817.columns.values.tolist():
    daily_20200817_addname_dataframe[table_name] = daily_20200817[table_name]
print("daily_20200817 返回数据 row 行数 = "+str(daily_20200817.shape[0]))
daily_20200817_addname_dataframe.to_excel(daily_202008_excel_writer,'17_1',index=False)
daily_202008_excel_writer.save()
daily_20200818 = pro.daily(start_date='',end_date='',trade_date='20200818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200818_tscode_list = list() 
for ts_code_sh in daily_20200818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200818_tscode_list.append(stock_name)
daily_20200818_addname_dataframe=pd.DataFrame()
daily_20200818_addname_dataframe['cname'] = daily_20200818_tscode_list
for table_name in daily_20200818.columns.values.tolist():
    daily_20200818_addname_dataframe[table_name] = daily_20200818[table_name]
print("daily_20200818 返回数据 row 行数 = "+str(daily_20200818.shape[0]))
daily_20200818_addname_dataframe.to_excel(daily_202008_excel_writer,'18_2',index=False)
daily_202008_excel_writer.save()
daily_20200819 = pro.daily(start_date='',end_date='',trade_date='20200819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200819_tscode_list = list() 
for ts_code_sh in daily_20200819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200819_tscode_list.append(stock_name)
daily_20200819_addname_dataframe=pd.DataFrame()
daily_20200819_addname_dataframe['cname'] = daily_20200819_tscode_list
for table_name in daily_20200819.columns.values.tolist():
    daily_20200819_addname_dataframe[table_name] = daily_20200819[table_name]
print("daily_20200819 返回数据 row 行数 = "+str(daily_20200819.shape[0]))
daily_20200819_addname_dataframe.to_excel(daily_202008_excel_writer,'19_3',index=False)
daily_202008_excel_writer.save()
daily_20200820 = pro.daily(start_date='',end_date='',trade_date='20200820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200820_tscode_list = list() 
for ts_code_sh in daily_20200820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200820_tscode_list.append(stock_name)
daily_20200820_addname_dataframe=pd.DataFrame()
daily_20200820_addname_dataframe['cname'] = daily_20200820_tscode_list
for table_name in daily_20200820.columns.values.tolist():
    daily_20200820_addname_dataframe[table_name] = daily_20200820[table_name]
print("daily_20200820 返回数据 row 行数 = "+str(daily_20200820.shape[0]))
daily_20200820_addname_dataframe.to_excel(daily_202008_excel_writer,'20_4',index=False)
daily_202008_excel_writer.save()
daily_20200821 = pro.daily(start_date='',end_date='',trade_date='20200821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200821_tscode_list = list() 
for ts_code_sh in daily_20200821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200821_tscode_list.append(stock_name)
daily_20200821_addname_dataframe=pd.DataFrame()
daily_20200821_addname_dataframe['cname'] = daily_20200821_tscode_list
for table_name in daily_20200821.columns.values.tolist():
    daily_20200821_addname_dataframe[table_name] = daily_20200821[table_name]
print("daily_20200821 返回数据 row 行数 = "+str(daily_20200821.shape[0]))
daily_20200821_addname_dataframe.to_excel(daily_202008_excel_writer,'21_5',index=False)
daily_202008_excel_writer.save()
daily_20200822 = pro.daily(start_date='',end_date='',trade_date='20200822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200822_tscode_list = list() 
for ts_code_sh in daily_20200822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200822_tscode_list.append(stock_name)
daily_20200822_addname_dataframe=pd.DataFrame()
daily_20200822_addname_dataframe['cname'] = daily_20200822_tscode_list
for table_name in daily_20200822.columns.values.tolist():
    daily_20200822_addname_dataframe[table_name] = daily_20200822[table_name]
print("daily_20200822 返回数据 row 行数 = "+str(daily_20200822.shape[0]))
daily_20200822_addname_dataframe.to_excel(daily_202008_excel_writer,'22_6',index=False)
daily_202008_excel_writer.save()
daily_20200823 = pro.daily(start_date='',end_date='',trade_date='20200823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200823_tscode_list = list() 
for ts_code_sh in daily_20200823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200823_tscode_list.append(stock_name)
daily_20200823_addname_dataframe=pd.DataFrame()
daily_20200823_addname_dataframe['cname'] = daily_20200823_tscode_list
for table_name in daily_20200823.columns.values.tolist():
    daily_20200823_addname_dataframe[table_name] = daily_20200823[table_name]
print("daily_20200823 返回数据 row 行数 = "+str(daily_20200823.shape[0]))
daily_20200823_addname_dataframe.to_excel(daily_202008_excel_writer,'23_7',index=False)
daily_202008_excel_writer.save()
daily_20200824 = pro.daily(start_date='',end_date='',trade_date='20200824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200824_tscode_list = list() 
for ts_code_sh in daily_20200824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200824_tscode_list.append(stock_name)
daily_20200824_addname_dataframe=pd.DataFrame()
daily_20200824_addname_dataframe['cname'] = daily_20200824_tscode_list
for table_name in daily_20200824.columns.values.tolist():
    daily_20200824_addname_dataframe[table_name] = daily_20200824[table_name]
print("daily_20200824 返回数据 row 行数 = "+str(daily_20200824.shape[0]))
daily_20200824_addname_dataframe.to_excel(daily_202008_excel_writer,'24_1',index=False)
daily_202008_excel_writer.save()
daily_20200825 = pro.daily(start_date='',end_date='',trade_date='20200825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200825_tscode_list = list() 
for ts_code_sh in daily_20200825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200825_tscode_list.append(stock_name)
daily_20200825_addname_dataframe=pd.DataFrame()
daily_20200825_addname_dataframe['cname'] = daily_20200825_tscode_list
for table_name in daily_20200825.columns.values.tolist():
    daily_20200825_addname_dataframe[table_name] = daily_20200825[table_name]
print("daily_20200825 返回数据 row 行数 = "+str(daily_20200825.shape[0]))
daily_20200825_addname_dataframe.to_excel(daily_202008_excel_writer,'25_2',index=False)
daily_202008_excel_writer.save()
daily_20200826 = pro.daily(start_date='',end_date='',trade_date='20200826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200826_tscode_list = list() 
for ts_code_sh in daily_20200826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200826_tscode_list.append(stock_name)
daily_20200826_addname_dataframe=pd.DataFrame()
daily_20200826_addname_dataframe['cname'] = daily_20200826_tscode_list
for table_name in daily_20200826.columns.values.tolist():
    daily_20200826_addname_dataframe[table_name] = daily_20200826[table_name]
print("daily_20200826 返回数据 row 行数 = "+str(daily_20200826.shape[0]))
daily_20200826_addname_dataframe.to_excel(daily_202008_excel_writer,'26_3',index=False)
daily_202008_excel_writer.save()




createexcel('daily_202009.xlsx')
daily_202009_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202009.xlsx')
daily_202009_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0\\daily_202009.xlsx', engine='openpyxl')
daily_202009_excel_writer.book = daily_202009_book
daily_202009_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202009_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200901")       ###  更新 记录日期




J0_PROPS.put(tree_node_name+"record_date", "20200826")       ###  更新 记录日期
